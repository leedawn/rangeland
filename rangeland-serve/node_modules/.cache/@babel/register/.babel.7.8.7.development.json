{
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/index.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst koa = require('koa');\n\nconst helmet = require('koa-helmet');\n\nconst statics = require('koa-static');\n\nconst cors = require('@koa/cors');\n\nconst JWT = require('koa-jwt');\n\nconst compress = require('koa-compress');\n\nconst router = require('./routes/routes');\n\nconst path = require('path');\n\nconst koaBody = require('koa-body');\n\nconst jsonutil = require('koa-json');\n\nconst compose = require('koa-compose');\n\nconst config = require('./config/index');\n\nconst errorHandle = require('./common/ErrorHandle');\n\nconst app = new koa();\nconst isDevMode = process.env.NODE_ENV === 'production' ? false : true; //除了公共路径，其他路径都需要鉴权\n\nconst jwt = JWT({\n  secret: config.JWT_SECRET\n}).unless({\n  path: [/^\\/public/, /^\\/login/, /^\\/img/]\n});\nconst middleware = compose([koaBody({\n  multipart: true,\n  formidable: {\n    keepExtensions: true,\n    maxFieldsSize: 5 * 1024 * 1024\n  },\n  onError: err => {\n    console.log('koabody TCL:err', err);\n  }\n}), statics(path.join(__dirname, '../public')), cors(), jsonutil({\n  pretty: false,\n  param: 'pretty'\n}), helmet(), errorHandle, jwt]);\n\nif (!isDevMode) {\n  app.use(compress());\n}\n\napp.use(middleware); // app.use(statics(path.join(__dirname,'../public')))\n\napp.use(router());\napp.listen(3000);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImtvYSIsInJlcXVpcmUiLCJoZWxtZXQiLCJzdGF0aWNzIiwiY29ycyIsIkpXVCIsImNvbXByZXNzIiwicm91dGVyIiwicGF0aCIsImtvYUJvZHkiLCJqc29udXRpbCIsImNvbXBvc2UiLCJjb25maWciLCJlcnJvckhhbmRsZSIsImFwcCIsImlzRGV2TW9kZSIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImp3dCIsInNlY3JldCIsIkpXVF9TRUNSRVQiLCJ1bmxlc3MiLCJtaWRkbGV3YXJlIiwibXVsdGlwYXJ0IiwiZm9ybWlkYWJsZSIsImtlZXBFeHRlbnNpb25zIiwibWF4RmllbGRzU2l6ZSIsIm9uRXJyb3IiLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiam9pbiIsIl9fZGlybmFtZSIsInByZXR0eSIsInBhcmFtIiwidXNlIiwibGlzdGVuIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLEdBQUcsR0FBQ0MsT0FBTyxDQUFDLEtBQUQsQ0FBakI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFDRCxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNRSxPQUFPLEdBQUNGLE9BQU8sQ0FBQyxZQUFELENBQXJCOztBQUNBLE1BQU1HLElBQUksR0FBQ0gsT0FBTyxDQUFDLFdBQUQsQ0FBbEI7O0FBQ0EsTUFBTUksR0FBRyxHQUFDSixPQUFPLENBQUMsU0FBRCxDQUFqQjs7QUFDQSxNQUFNSyxRQUFRLEdBQUNMLE9BQU8sQ0FBQyxjQUFELENBQXRCOztBQUNBLE1BQU1NLE1BQU0sR0FBQ04sT0FBTyxDQUFDLGlCQUFELENBQXBCOztBQUNBLE1BQU1PLElBQUksR0FBQ1AsT0FBTyxDQUFDLE1BQUQsQ0FBbEI7O0FBQ0EsTUFBTVEsT0FBTyxHQUFDUixPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxNQUFNUyxRQUFRLEdBQUNULE9BQU8sQ0FBQyxVQUFELENBQXRCOztBQUNBLE1BQU1VLE9BQU8sR0FBQ1YsT0FBTyxDQUFDLGFBQUQsQ0FBckI7O0FBQ0EsTUFBTVcsTUFBTSxHQUFDWCxPQUFPLENBQUMsZ0JBQUQsQ0FBcEI7O0FBQ0EsTUFBTVksV0FBVyxHQUFDWixPQUFPLENBQUMsc0JBQUQsQ0FBekI7O0FBRUEsTUFBTWEsR0FBRyxHQUFDLElBQUlkLEdBQUosRUFBVjtBQUlBLE1BQU1lLFNBQVMsR0FBQ0MsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFFBQVosS0FBdUIsWUFBdkIsR0FBb0MsS0FBcEMsR0FBMEMsSUFBMUQsQyxDQUVBOztBQUNBLE1BQU1DLEdBQUcsR0FBQ2QsR0FBRyxDQUFDO0FBQUNlLEVBQUFBLE1BQU0sRUFBQ1IsTUFBTSxDQUFDUztBQUFmLENBQUQsQ0FBSCxDQUFnQ0MsTUFBaEMsQ0FBdUM7QUFBQ2QsRUFBQUEsSUFBSSxFQUFDLENBQUMsV0FBRCxFQUFhLFVBQWIsRUFBd0IsUUFBeEI7QUFBTixDQUF2QyxDQUFWO0FBRUEsTUFBTWUsVUFBVSxHQUFDWixPQUFPLENBQUMsQ0FDckJGLE9BQU8sQ0FBQztBQUNKZSxFQUFBQSxTQUFTLEVBQUUsSUFEUDtBQUVKQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsY0FBYyxFQUFDLElBRFA7QUFFUkMsSUFBQUEsYUFBYSxFQUFDLElBQUUsSUFBRixHQUFPO0FBRmIsR0FGUjtBQU1KQyxFQUFBQSxPQUFPLEVBQUVDLEdBQUcsSUFBRTtBQUNWQyxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQkFBWixFQUE4QkYsR0FBOUI7QUFDSDtBQVJHLENBQUQsQ0FEYyxFQVdyQjFCLE9BQU8sQ0FBQ0ssSUFBSSxDQUFDd0IsSUFBTCxDQUFVQyxTQUFWLEVBQW9CLFdBQXBCLENBQUQsQ0FYYyxFQVlyQjdCLElBQUksRUFaaUIsRUFhckJNLFFBQVEsQ0FBQztBQUFDd0IsRUFBQUEsTUFBTSxFQUFDLEtBQVI7QUFBY0MsRUFBQUEsS0FBSyxFQUFDO0FBQXBCLENBQUQsQ0FiYSxFQWNyQmpDLE1BQU0sRUFkZSxFQWVyQlcsV0FmcUIsRUFnQnJCTSxHQWhCcUIsQ0FBRCxDQUF4Qjs7QUFtQkEsSUFBSSxDQUFDSixTQUFMLEVBQWdCO0FBQ1pELEVBQUFBLEdBQUcsQ0FBQ3NCLEdBQUosQ0FBUTlCLFFBQVEsRUFBaEI7QUFDSDs7QUFDRFEsR0FBRyxDQUFDc0IsR0FBSixDQUFRYixVQUFSLEUsQ0FDQTs7QUFDQVQsR0FBRyxDQUFDc0IsR0FBSixDQUFRN0IsTUFBTSxFQUFkO0FBRUFPLEdBQUcsQ0FBQ3VCLE1BQUosQ0FBVyxJQUFYIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qga29hPXJlcXVpcmUoJ2tvYScpXG5jb25zdCBoZWxtZXQ9cmVxdWlyZSgna29hLWhlbG1ldCcpXG5jb25zdCBzdGF0aWNzPXJlcXVpcmUoJ2tvYS1zdGF0aWMnKVxuY29uc3QgY29ycz1yZXF1aXJlKCdAa29hL2NvcnMnKVxuY29uc3QgSldUPXJlcXVpcmUoJ2tvYS1qd3QnKVxuY29uc3QgY29tcHJlc3M9cmVxdWlyZSgna29hLWNvbXByZXNzJylcbmNvbnN0IHJvdXRlcj1yZXF1aXJlKCcuL3JvdXRlcy9yb3V0ZXMnKVxuY29uc3QgcGF0aD1yZXF1aXJlKCdwYXRoJylcbmNvbnN0IGtvYUJvZHk9cmVxdWlyZSgna29hLWJvZHknKVxuY29uc3QganNvbnV0aWw9cmVxdWlyZSgna29hLWpzb24nKVxuY29uc3QgY29tcG9zZT1yZXF1aXJlKCdrb2EtY29tcG9zZScpXG5jb25zdCBjb25maWc9cmVxdWlyZSgnLi9jb25maWcvaW5kZXgnKVxuY29uc3QgZXJyb3JIYW5kbGU9cmVxdWlyZSgnLi9jb21tb24vRXJyb3JIYW5kbGUnKVxuXG5jb25zdCBhcHA9bmV3IGtvYSgpXG5cblxuXG5jb25zdCBpc0Rldk1vZGU9cHJvY2Vzcy5lbnYuTk9ERV9FTlY9PT0ncHJvZHVjdGlvbic/ZmFsc2U6dHJ1ZVxuXG4vL+mZpOS6huWFrOWFsei3r+W+hO+8jOWFtuS7lui3r+W+hOmDvemcgOimgemJtOadg1xuY29uc3Qgand0PUpXVCh7c2VjcmV0OmNvbmZpZy5KV1RfU0VDUkVUfSkudW5sZXNzKHtwYXRoOlsvXlxcL3B1YmxpYy8sL15cXC9sb2dpbi8sL15cXC9pbWcvXX0pXG5cbmNvbnN0IG1pZGRsZXdhcmU9Y29tcG9zZShbXG4gICAga29hQm9keSh7XG4gICAgICAgIG11bHRpcGFydDogdHJ1ZSxcbiAgICAgICAgZm9ybWlkYWJsZToge1xuICAgICAgICAgICAga2VlcEV4dGVuc2lvbnM6dHJ1ZSxcbiAgICAgICAgICAgIG1heEZpZWxkc1NpemU6NSoxMDI0KjEwMjRcbiAgICAgICAgfSxcbiAgICAgICAgb25FcnJvcjogZXJyPT57XG4gICAgICAgICAgICBjb25zb2xlLmxvZygna29hYm9keSBUQ0w6ZXJyJyxlcnIpXG4gICAgICAgIH1cbiAgICB9KSxcbiAgICBzdGF0aWNzKHBhdGguam9pbihfX2Rpcm5hbWUsJy4uL3B1YmxpYycpKSxcbiAgICBjb3JzKCksXG4gICAganNvbnV0aWwoe3ByZXR0eTpmYWxzZSxwYXJhbToncHJldHR5J30pLFxuICAgIGhlbG1ldCgpLFxuICAgIGVycm9ySGFuZGxlLFxuICAgIGp3dFxuXSlcblxuaWYgKCFpc0Rldk1vZGUpIHtcbiAgICBhcHAudXNlKGNvbXByZXNzKCkpXG59XG5hcHAudXNlKG1pZGRsZXdhcmUpXG4vLyBhcHAudXNlKHN0YXRpY3MocGF0aC5qb2luKF9fZGlybmFtZSwnLi4vcHVibGljJykpKVxuYXBwLnVzZShyb3V0ZXIoKSlcblxuYXBwLmxpc3RlbigzMDAwKSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "koa",
        "require",
        "helmet",
        "statics",
        "cors",
        "JWT",
        "compress",
        "router",
        "path",
        "koaBody",
        "jsonutil",
        "compose",
        "config",
        "errorHandle",
        "app",
        "isDevMode",
        "process",
        "env",
        "NODE_ENV",
        "jwt",
        "secret",
        "JWT_SECRET",
        "unless",
        "middleware",
        "multipart",
        "formidable",
        "keepExtensions",
        "maxFieldsSize",
        "onError",
        "err",
        "console",
        "log",
        "join",
        "__dirname",
        "pretty",
        "param",
        "use",
        "listen"
      ],
      "mappings": ";;AAAA,MAAMA,GAAG,GAACC,OAAO,CAAC,KAAD,CAAjB;;AACA,MAAMC,MAAM,GAACD,OAAO,CAAC,YAAD,CAApB;;AACA,MAAME,OAAO,GAACF,OAAO,CAAC,YAAD,CAArB;;AACA,MAAMG,IAAI,GAACH,OAAO,CAAC,WAAD,CAAlB;;AACA,MAAMI,GAAG,GAACJ,OAAO,CAAC,SAAD,CAAjB;;AACA,MAAMK,QAAQ,GAACL,OAAO,CAAC,cAAD,CAAtB;;AACA,MAAMM,MAAM,GAACN,OAAO,CAAC,iBAAD,CAApB;;AACA,MAAMO,IAAI,GAACP,OAAO,CAAC,MAAD,CAAlB;;AACA,MAAMQ,OAAO,GAACR,OAAO,CAAC,UAAD,CAArB;;AACA,MAAMS,QAAQ,GAACT,OAAO,CAAC,UAAD,CAAtB;;AACA,MAAMU,OAAO,GAACV,OAAO,CAAC,aAAD,CAArB;;AACA,MAAMW,MAAM,GAACX,OAAO,CAAC,gBAAD,CAApB;;AACA,MAAMY,WAAW,GAACZ,OAAO,CAAC,sBAAD,CAAzB;;AAEA,MAAMa,GAAG,GAAC,IAAId,GAAJ,EAAV;AAIA,MAAMe,SAAS,GAACC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAuB,YAAvB,GAAoC,KAApC,GAA0C,IAA1D,C,CAEA;;AACA,MAAMC,GAAG,GAACd,GAAG,CAAC;AAACe,EAAAA,MAAM,EAACR,MAAM,CAACS;AAAf,CAAD,CAAH,CAAgCC,MAAhC,CAAuC;AAACd,EAAAA,IAAI,EAAC,CAAC,WAAD,EAAa,UAAb,EAAwB,QAAxB;AAAN,CAAvC,CAAV;AAEA,MAAMe,UAAU,GAACZ,OAAO,CAAC,CACrBF,OAAO,CAAC;AACJe,EAAAA,SAAS,EAAE,IADP;AAEJC,EAAAA,UAAU,EAAE;AACRC,IAAAA,cAAc,EAAC,IADP;AAERC,IAAAA,aAAa,EAAC,IAAE,IAAF,GAAO;AAFb,GAFR;AAMJC,EAAAA,OAAO,EAAEC,GAAG,IAAE;AACVC,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA8BF,GAA9B;AACH;AARG,CAAD,CADc,EAWrB1B,OAAO,CAACK,IAAI,CAACwB,IAAL,CAAUC,SAAV,EAAoB,WAApB,CAAD,CAXc,EAYrB7B,IAAI,EAZiB,EAarBM,QAAQ,CAAC;AAACwB,EAAAA,MAAM,EAAC,KAAR;AAAcC,EAAAA,KAAK,EAAC;AAApB,CAAD,CAba,EAcrBjC,MAAM,EAde,EAerBW,WAfqB,EAgBrBM,GAhBqB,CAAD,CAAxB;;AAmBA,IAAI,CAACJ,SAAL,EAAgB;AACZD,EAAAA,GAAG,CAACsB,GAAJ,CAAQ9B,QAAQ,EAAhB;AACH;;AACDQ,GAAG,CAACsB,GAAJ,CAAQb,UAAR,E,CACA;;AACAT,GAAG,CAACsB,GAAJ,CAAQ7B,MAAM,EAAd;AAEAO,GAAG,CAACuB,MAAJ,CAAW,IAAX",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src",
      "sourcesContent": [
        "const koa=require('koa')\nconst helmet=require('koa-helmet')\nconst statics=require('koa-static')\nconst cors=require('@koa/cors')\nconst JWT=require('koa-jwt')\nconst compress=require('koa-compress')\nconst router=require('./routes/routes')\nconst path=require('path')\nconst koaBody=require('koa-body')\nconst jsonutil=require('koa-json')\nconst compose=require('koa-compose')\nconst config=require('./config/index')\nconst errorHandle=require('./common/ErrorHandle')\n\nconst app=new koa()\n\n\n\nconst isDevMode=process.env.NODE_ENV==='production'?false:true\n\n//除了公共路径，其他路径都需要鉴权\nconst jwt=JWT({secret:config.JWT_SECRET}).unless({path:[/^\\/public/,/^\\/login/,/^\\/img/]})\n\nconst middleware=compose([\n    koaBody({\n        multipart: true,\n        formidable: {\n            keepExtensions:true,\n            maxFieldsSize:5*1024*1024\n        },\n        onError: err=>{\n            console.log('koabody TCL:err',err)\n        }\n    }),\n    statics(path.join(__dirname,'../public')),\n    cors(),\n    jsonutil({pretty:false,param:'pretty'}),\n    helmet(),\n    errorHandle,\n    jwt\n])\n\nif (!isDevMode) {\n    app.use(compress())\n}\napp.use(middleware)\n// app.use(statics(path.join(__dirname,'../public')))\napp.use(router())\n\napp.listen(3000)"
      ]
    },
    "sourceType": "script",
    "mtime": 1584439937226
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/routes.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/routes.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/routes.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/routes.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes",
        "sourceFileName": "routes.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import combineRoutes from 'koa-combine-routers'\n// const moduleFiles = require.context('./modules', true, /\\.js$/)\n// const modules = moduleFiles.keys().reduce((items, path) => {\n//     const value = moduleFiles(path)\n//     items.push(value.default)\n//     return items\n// }, [])\n// export default combineRoutes(modules)\nconst combineRoutes = require('koa-combine-routers');\n\nconst publicRoutes = require('./modules/publicRouter');\n\nconst userRoutes = require('./modules/userRouter');\n\nconst loginRoutes = require('./modules/loginRouter');\n\nconst contentRouter = require('./modules/contentRouter');\n\nmodule.exports = combineRoutes(publicRoutes, loginRoutes, userRoutes, contentRouter);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy5qcyJdLCJuYW1lcyI6WyJjb21iaW5lUm91dGVzIiwicmVxdWlyZSIsInB1YmxpY1JvdXRlcyIsInVzZXJSb3V0ZXMiLCJsb2dpblJvdXRlcyIsImNvbnRlbnRSb3V0ZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFHQSxNQUFNQSxhQUFhLEdBQUNDLE9BQU8sQ0FBQyxxQkFBRCxDQUEzQjs7QUFDQSxNQUFNQyxZQUFZLEdBQUNELE9BQU8sQ0FBQyx3QkFBRCxDQUExQjs7QUFDQSxNQUFNRSxVQUFVLEdBQUNGLE9BQU8sQ0FBQyxzQkFBRCxDQUF4Qjs7QUFDQSxNQUFNRyxXQUFXLEdBQUNILE9BQU8sQ0FBQyx1QkFBRCxDQUF6Qjs7QUFDQSxNQUFNSSxhQUFhLEdBQUNKLE9BQU8sQ0FBQyx5QkFBRCxDQUEzQjs7QUFFQUssTUFBTSxDQUFDQyxPQUFQLEdBQWVQLGFBQWEsQ0FDeEJFLFlBRHdCLEVBRXhCRSxXQUZ3QixFQUd4QkQsVUFId0IsRUFJeEJFLGFBSndCLENBQTVCIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL3JvdXRlcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCBjb21iaW5lUm91dGVzIGZyb20gJ2tvYS1jb21iaW5lLXJvdXRlcnMnXG5cbi8vIGNvbnN0IG1vZHVsZUZpbGVzID0gcmVxdWlyZS5jb250ZXh0KCcuL21vZHVsZXMnLCB0cnVlLCAvXFwuanMkLylcblxuLy8gY29uc3QgbW9kdWxlcyA9IG1vZHVsZUZpbGVzLmtleXMoKS5yZWR1Y2UoKGl0ZW1zLCBwYXRoKSA9PiB7XG4vLyAgICAgY29uc3QgdmFsdWUgPSBtb2R1bGVGaWxlcyhwYXRoKVxuLy8gICAgIGl0ZW1zLnB1c2godmFsdWUuZGVmYXVsdClcbi8vICAgICByZXR1cm4gaXRlbXNcbi8vIH0sIFtdKVxuXG4vLyBleHBvcnQgZGVmYXVsdCBjb21iaW5lUm91dGVzKG1vZHVsZXMpXG5cblxuY29uc3QgY29tYmluZVJvdXRlcz1yZXF1aXJlKCdrb2EtY29tYmluZS1yb3V0ZXJzJylcbmNvbnN0IHB1YmxpY1JvdXRlcz1yZXF1aXJlKCcuL21vZHVsZXMvcHVibGljUm91dGVyJylcbmNvbnN0IHVzZXJSb3V0ZXM9cmVxdWlyZSgnLi9tb2R1bGVzL3VzZXJSb3V0ZXInKVxuY29uc3QgbG9naW5Sb3V0ZXM9cmVxdWlyZSgnLi9tb2R1bGVzL2xvZ2luUm91dGVyJylcbmNvbnN0IGNvbnRlbnRSb3V0ZXI9cmVxdWlyZSgnLi9tb2R1bGVzL2NvbnRlbnRSb3V0ZXInKVxuXG5tb2R1bGUuZXhwb3J0cz1jb21iaW5lUm91dGVzKFxuICAgIHB1YmxpY1JvdXRlcyxcbiAgICBsb2dpblJvdXRlcyxcbiAgICB1c2VyUm91dGVzLFxuICAgIGNvbnRlbnRSb3V0ZXJcbikiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "routes.js"
      ],
      "names": [
        "combineRoutes",
        "require",
        "publicRoutes",
        "userRoutes",
        "loginRoutes",
        "contentRouter",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAGA,MAAMA,aAAa,GAACC,OAAO,CAAC,qBAAD,CAA3B;;AACA,MAAMC,YAAY,GAACD,OAAO,CAAC,wBAAD,CAA1B;;AACA,MAAME,UAAU,GAACF,OAAO,CAAC,sBAAD,CAAxB;;AACA,MAAMG,WAAW,GAACH,OAAO,CAAC,uBAAD,CAAzB;;AACA,MAAMI,aAAa,GAACJ,OAAO,CAAC,yBAAD,CAA3B;;AAEAK,MAAM,CAACC,OAAP,GAAeP,aAAa,CACxBE,YADwB,EAExBE,WAFwB,EAGxBD,UAHwB,EAIxBE,aAJwB,CAA5B",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes",
      "sourcesContent": [
        "// import combineRoutes from 'koa-combine-routers'\n\n// const moduleFiles = require.context('./modules', true, /\\.js$/)\n\n// const modules = moduleFiles.keys().reduce((items, path) => {\n//     const value = moduleFiles(path)\n//     items.push(value.default)\n//     return items\n// }, [])\n\n// export default combineRoutes(modules)\n\n\nconst combineRoutes=require('koa-combine-routers')\nconst publicRoutes=require('./modules/publicRouter')\nconst userRoutes=require('./modules/userRouter')\nconst loginRoutes=require('./modules/loginRouter')\nconst contentRouter=require('./modules/contentRouter')\n\nmodule.exports=combineRoutes(\n    publicRoutes,\n    loginRoutes,\n    userRoutes,\n    contentRouter\n)"
      ]
    },
    "sourceType": "script",
    "mtime": 1584431878976
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/publicRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/publicRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/publicRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/publicRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "publicRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst publicController = require('../../api/PublicController');\n\nconst contentController = require('../../api/ContentController');\n\nconst router = new Router();\nrouter.prefix('/public');\nrouter.get('/getCaptcha', publicController);\nrouter.get('/list', contentController.getPostList);\nrouter.get('/content/detail', contentController.getPostDetail);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1YmxpY1JvdXRlci5qcyJdLCJuYW1lcyI6WyJSb3V0ZXIiLCJyZXF1aXJlIiwicHVibGljQ29udHJvbGxlciIsImNvbnRlbnRDb250cm9sbGVyIiwicm91dGVyIiwicHJlZml4IiwiZ2V0IiwiZ2V0UG9zdExpc3QiLCJnZXRQb3N0RGV0YWlsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxNQUFNLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXBCOztBQUNBLE1BQU1DLGdCQUFnQixHQUFDRCxPQUFPLENBQUMsNEJBQUQsQ0FBOUI7O0FBQ0EsTUFBTUUsaUJBQWlCLEdBQUNGLE9BQU8sQ0FBQyw2QkFBRCxDQUEvQjs7QUFFQSxNQUFNRyxNQUFNLEdBQUMsSUFBSUosTUFBSixFQUFiO0FBRUFJLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFNBQWQ7QUFDQUQsTUFBTSxDQUFDRSxHQUFQLENBQVcsYUFBWCxFQUF5QkosZ0JBQXpCO0FBRUFFLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLE9BQVgsRUFBb0JILGlCQUFpQixDQUFDSSxXQUF0QztBQUVBSCxNQUFNLENBQUNFLEdBQVAsQ0FBVyxpQkFBWCxFQUE2QkgsaUJBQWlCLENBQUNLLGFBQS9DO0FBRUFDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlTixNQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL3JvdXRlcy9tb2R1bGVzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUm91dGVyPXJlcXVpcmUoJ2tvYS1yb3V0ZXInKVxuY29uc3QgcHVibGljQ29udHJvbGxlcj1yZXF1aXJlKCcuLi8uLi9hcGkvUHVibGljQ29udHJvbGxlcicpXG5jb25zdCBjb250ZW50Q29udHJvbGxlcj1yZXF1aXJlKCcuLi8uLi9hcGkvQ29udGVudENvbnRyb2xsZXInKVxuXG5jb25zdCByb3V0ZXI9bmV3IFJvdXRlcigpXG5cbnJvdXRlci5wcmVmaXgoJy9wdWJsaWMnKVxucm91dGVyLmdldCgnL2dldENhcHRjaGEnLHB1YmxpY0NvbnRyb2xsZXIpXG5cbnJvdXRlci5nZXQoJy9saXN0JywgY29udGVudENvbnRyb2xsZXIuZ2V0UG9zdExpc3QpXG5cbnJvdXRlci5nZXQoJy9jb250ZW50L2RldGFpbCcsY29udGVudENvbnRyb2xsZXIuZ2V0UG9zdERldGFpbClcblxubW9kdWxlLmV4cG9ydHM9cm91dGVyIl19",
    "map": {
      "version": 3,
      "sources": [
        "publicRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "publicController",
        "contentController",
        "router",
        "prefix",
        "get",
        "getPostList",
        "getPostDetail",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,gBAAgB,GAACD,OAAO,CAAC,4BAAD,CAA9B;;AACA,MAAME,iBAAiB,GAACF,OAAO,CAAC,6BAAD,CAA/B;;AAEA,MAAMG,MAAM,GAAC,IAAIJ,MAAJ,EAAb;AAEAI,MAAM,CAACC,MAAP,CAAc,SAAd;AACAD,MAAM,CAACE,GAAP,CAAW,aAAX,EAAyBJ,gBAAzB;AAEAE,MAAM,CAACE,GAAP,CAAW,OAAX,EAAoBH,iBAAiB,CAACI,WAAtC;AAEAH,MAAM,CAACE,GAAP,CAAW,iBAAX,EAA6BH,iBAAiB,CAACK,aAA/C;AAEAC,MAAM,CAACC,OAAP,GAAeN,MAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst publicController=require('../../api/PublicController')\nconst contentController=require('../../api/ContentController')\n\nconst router=new Router()\n\nrouter.prefix('/public')\nrouter.get('/getCaptcha',publicController)\n\nrouter.get('/list', contentController.getPostList)\n\nrouter.get('/content/detail',contentController.getPostDetail)\n\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585035107865
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/PublicController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/PublicController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/PublicController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/PublicController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "PublicController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst svgCaptcha = require('svg-captcha');\n\nconst redisConfig = require('../config/RedisConfig'); // const redisConfig=require('@/config/RedisConfig')\n// import svgCaptcha from 'svg-captcha'     es6\n// class PublicController{\n//     constructor() {}\n//     async getCaptcha(ctx) {\n//         const body = ctx.request.query\n//         console.log(body.sid)\n//         const newCaptcha=svgCaptcha.create({\n//             size: 4,\n//             ignoreChars: '0olil',\n//             color: true,\n//             noise: Math.floor(Math.random() * 5),\n//             width: 150,\n//             height: 50\n//         })\n//         // console.log(newCaptcha)\n//         ctx.body={\n//             code: 200,\n//             data: newCaptcha.data,\n//         }\n//     }\n// }\n\n\nmodule.exports = function (ctx) {\n  const body = ctx.request.query;\n  console.log(body.sid);\n  const newCaptcha = svgCaptcha.create({\n    size: 4,\n    ignoreChars: '0olil',\n    color: true,\n    noise: Math.floor(Math.random() * 5),\n    width: 150,\n    height: 50\n  }); // console.log(newCaptcha)\n\n  redisConfig.setValue(body.sid, newCaptcha.text, 10 * 60); //save for 10m\n  // redisConfig.getValue(body.sid).then((res) => {\n  //     console.log(res)\n  // })\n\n  ctx.body = {\n    code: 200,\n    data: newCaptcha.data\n  };\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlB1YmxpY0NvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsic3ZnQ2FwdGNoYSIsInJlcXVpcmUiLCJyZWRpc0NvbmZpZyIsIm1vZHVsZSIsImV4cG9ydHMiLCJjdHgiLCJib2R5IiwicmVxdWVzdCIsInF1ZXJ5IiwiY29uc29sZSIsImxvZyIsInNpZCIsIm5ld0NhcHRjaGEiLCJjcmVhdGUiLCJzaXplIiwiaWdub3JlQ2hhcnMiLCJjb2xvciIsIm5vaXNlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwid2lkdGgiLCJoZWlnaHQiLCJzZXRWYWx1ZSIsInRleHQiLCJjb2RlIiwiZGF0YSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxVQUFVLEdBQUNDLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLE1BQU1DLFdBQVcsR0FBQ0QsT0FBTyxDQUFDLHVCQUFELENBQXpCLEMsQ0FDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0FFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlLFVBQVNDLEdBQVQsRUFBYTtBQUN4QixRQUFNQyxJQUFJLEdBQUdELEdBQUcsQ0FBQ0UsT0FBSixDQUFZQyxLQUF6QjtBQUNBQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUosSUFBSSxDQUFDSyxHQUFqQjtBQUNBLFFBQU1DLFVBQVUsR0FBQ1osVUFBVSxDQUFDYSxNQUFYLENBQWtCO0FBQy9CQyxJQUFBQSxJQUFJLEVBQUUsQ0FEeUI7QUFFL0JDLElBQUFBLFdBQVcsRUFBRSxPQUZrQjtBQUcvQkMsSUFBQUEsS0FBSyxFQUFFLElBSHdCO0FBSS9CQyxJQUFBQSxLQUFLLEVBQUVDLElBQUksQ0FBQ0MsS0FBTCxDQUFXRCxJQUFJLENBQUNFLE1BQUwsS0FBZ0IsQ0FBM0IsQ0FKd0I7QUFLL0JDLElBQUFBLEtBQUssRUFBRSxHQUx3QjtBQU0vQkMsSUFBQUEsTUFBTSxFQUFFO0FBTnVCLEdBQWxCLENBQWpCLENBSHdCLENBV3hCOztBQUNBcEIsRUFBQUEsV0FBVyxDQUFDcUIsUUFBWixDQUFxQmpCLElBQUksQ0FBQ0ssR0FBMUIsRUFBK0JDLFVBQVUsQ0FBQ1ksSUFBMUMsRUFBK0MsS0FBSyxFQUFwRCxFQVp3QixDQVlnQztBQUN4RDtBQUNBO0FBQ0E7O0FBQ0FuQixFQUFBQSxHQUFHLENBQUNDLElBQUosR0FBUztBQUNMbUIsSUFBQUEsSUFBSSxFQUFDLEdBREE7QUFFTEMsSUFBQUEsSUFBSSxFQUFDZCxVQUFVLENBQUNjO0FBRlgsR0FBVDtBQUlILENBcEJEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL2FwaSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHN2Z0NhcHRjaGE9cmVxdWlyZSgnc3ZnLWNhcHRjaGEnKVxuY29uc3QgcmVkaXNDb25maWc9cmVxdWlyZSgnLi4vY29uZmlnL1JlZGlzQ29uZmlnJylcbi8vIGNvbnN0IHJlZGlzQ29uZmlnPXJlcXVpcmUoJ0AvY29uZmlnL1JlZGlzQ29uZmlnJylcbi8vIGltcG9ydCBzdmdDYXB0Y2hhIGZyb20gJ3N2Zy1jYXB0Y2hhJyAgICAgZXM2XG5cblxuLy8gY2xhc3MgUHVibGljQ29udHJvbGxlcntcbi8vICAgICBjb25zdHJ1Y3RvcigpIHt9XG4vLyAgICAgYXN5bmMgZ2V0Q2FwdGNoYShjdHgpIHtcbi8vICAgICAgICAgY29uc3QgYm9keSA9IGN0eC5yZXF1ZXN0LnF1ZXJ5XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKGJvZHkuc2lkKVxuLy8gICAgICAgICBjb25zdCBuZXdDYXB0Y2hhPXN2Z0NhcHRjaGEuY3JlYXRlKHtcbi8vICAgICAgICAgICAgIHNpemU6IDQsXG4vLyAgICAgICAgICAgICBpZ25vcmVDaGFyczogJzBvbGlsJyxcbi8vICAgICAgICAgICAgIGNvbG9yOiB0cnVlLFxuLy8gICAgICAgICAgICAgbm9pc2U6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpLFxuLy8gICAgICAgICAgICAgd2lkdGg6IDE1MCxcbi8vICAgICAgICAgICAgIGhlaWdodDogNTBcbi8vICAgICAgICAgfSlcbi8vICAgICAgICAgLy8gY29uc29sZS5sb2cobmV3Q2FwdGNoYSlcbi8vICAgICAgICAgY3R4LmJvZHk9e1xuLy8gICAgICAgICAgICAgY29kZTogMjAwLFxuLy8gICAgICAgICAgICAgZGF0YTogbmV3Q2FwdGNoYS5kYXRhLFxuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxubW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oY3R4KXtcbiAgICBjb25zdCBib2R5ID0gY3R4LnJlcXVlc3QucXVlcnlcbiAgICBjb25zb2xlLmxvZyhib2R5LnNpZClcbiAgICBjb25zdCBuZXdDYXB0Y2hhPXN2Z0NhcHRjaGEuY3JlYXRlKHtcbiAgICAgICAgc2l6ZTogNCxcbiAgICAgICAgaWdub3JlQ2hhcnM6ICcwb2xpbCcsXG4gICAgICAgIGNvbG9yOiB0cnVlLFxuICAgICAgICBub2lzZTogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSksXG4gICAgICAgIHdpZHRoOiAxNTAsXG4gICAgICAgIGhlaWdodDogNTBcbiAgICB9KVxuICAgIC8vIGNvbnNvbGUubG9nKG5ld0NhcHRjaGEpXG4gICAgcmVkaXNDb25maWcuc2V0VmFsdWUoYm9keS5zaWQsIG5ld0NhcHRjaGEudGV4dCwxMCAqIDYwKSAvL3NhdmUgZm9yIDEwbVxuICAgIC8vIHJlZGlzQ29uZmlnLmdldFZhbHVlKGJvZHkuc2lkKS50aGVuKChyZXMpID0+IHtcbiAgICAvLyAgICAgY29uc29sZS5sb2cocmVzKVxuICAgIC8vIH0pXG4gICAgY3R4LmJvZHk9e1xuICAgICAgICBjb2RlOjIwMCxcbiAgICAgICAgZGF0YTpuZXdDYXB0Y2hhLmRhdGEsXG4gICAgfVxufSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "PublicController.js"
      ],
      "names": [
        "svgCaptcha",
        "require",
        "redisConfig",
        "module",
        "exports",
        "ctx",
        "body",
        "request",
        "query",
        "console",
        "log",
        "sid",
        "newCaptcha",
        "create",
        "size",
        "ignoreChars",
        "color",
        "noise",
        "Math",
        "floor",
        "random",
        "width",
        "height",
        "setValue",
        "text",
        "code",
        "data"
      ],
      "mappings": ";;AAAA,MAAMA,UAAU,GAACC,OAAO,CAAC,aAAD,CAAxB;;AACA,MAAMC,WAAW,GAACD,OAAO,CAAC,uBAAD,CAAzB,C,CACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAE,MAAM,CAACC,OAAP,GAAe,UAASC,GAAT,EAAa;AACxB,QAAMC,IAAI,GAAGD,GAAG,CAACE,OAAJ,CAAYC,KAAzB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYJ,IAAI,CAACK,GAAjB;AACA,QAAMC,UAAU,GAACZ,UAAU,CAACa,MAAX,CAAkB;AAC/BC,IAAAA,IAAI,EAAE,CADyB;AAE/BC,IAAAA,WAAW,EAAE,OAFkB;AAG/BC,IAAAA,KAAK,EAAE,IAHwB;AAI/BC,IAAAA,KAAK,EAAEC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,CAA3B,CAJwB;AAK/BC,IAAAA,KAAK,EAAE,GALwB;AAM/BC,IAAAA,MAAM,EAAE;AANuB,GAAlB,CAAjB,CAHwB,CAWxB;;AACApB,EAAAA,WAAW,CAACqB,QAAZ,CAAqBjB,IAAI,CAACK,GAA1B,EAA+BC,UAAU,CAACY,IAA1C,EAA+C,KAAK,EAApD,EAZwB,CAYgC;AACxD;AACA;AACA;;AACAnB,EAAAA,GAAG,CAACC,IAAJ,GAAS;AACLmB,IAAAA,IAAI,EAAC,GADA;AAELC,IAAAA,IAAI,EAACd,UAAU,CAACc;AAFX,GAAT;AAIH,CApBD",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "const svgCaptcha=require('svg-captcha')\nconst redisConfig=require('../config/RedisConfig')\n// const redisConfig=require('@/config/RedisConfig')\n// import svgCaptcha from 'svg-captcha'     es6\n\n\n// class PublicController{\n//     constructor() {}\n//     async getCaptcha(ctx) {\n//         const body = ctx.request.query\n//         console.log(body.sid)\n//         const newCaptcha=svgCaptcha.create({\n//             size: 4,\n//             ignoreChars: '0olil',\n//             color: true,\n//             noise: Math.floor(Math.random() * 5),\n//             width: 150,\n//             height: 50\n//         })\n//         // console.log(newCaptcha)\n//         ctx.body={\n//             code: 200,\n//             data: newCaptcha.data,\n//         }\n//     }\n// }\nmodule.exports=function(ctx){\n    const body = ctx.request.query\n    console.log(body.sid)\n    const newCaptcha=svgCaptcha.create({\n        size: 4,\n        ignoreChars: '0olil',\n        color: true,\n        noise: Math.floor(Math.random() * 5),\n        width: 150,\n        height: 50\n    })\n    // console.log(newCaptcha)\n    redisConfig.setValue(body.sid, newCaptcha.text,10 * 60) //save for 10m\n    // redisConfig.getValue(body.sid).then((res) => {\n    //     console.log(res)\n    // })\n    ctx.body={\n        code:200,\n        data:newCaptcha.data,\n    }\n}"
      ]
    },
    "sourceType": "script",
    "mtime": 1584437157098
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/RedisConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/RedisConfig.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/RedisConfig.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/RedisConfig.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
        "sourceFileName": "RedisConfig.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// for es5: const => var\nconst redis = require(\"redis\"); // import redis from 'redis'\n// const config = require(\"./index\")\n\n\nvar Promise = require('bluebird');\n\nvar DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb';\nvar REDIS = {\n  host: '47.99.202.255',\n  port: 15001,\n  password: '123456'\n};\nvar options = {\n  host: REDIS.host,\n  port: REDIS.port,\n  password: REDIS.password,\n  detect_buffers: true,\n  retry_strategy: function (options) {\n    if (options.error && options.error.code === 'ECONNREFUSED') {\n      return new Error('The server refused the connection');\n    }\n\n    if (options.total_retry_time > 1000 * 60 * 60) {\n      return new Error('Retry time exhausted');\n    }\n\n    if (options.attempt > 10) {\n      return undefined;\n    }\n\n    return Math.min(options.attempt * 100, 3000);\n  }\n};\nconst client = Promise.promisifyAll(redis.createClient(options)); // const client = redis.createClient(options)\n\nclient.on('error', function (err) {\n  console.log('Redis Client Error:' + err);\n});\n\nfunction setValue(key, value, time) {\n  if (typeof value === 'undefined' || value == null || value === '') {\n    return;\n  }\n\n  if (typeof value === 'string') {\n    if (typeof time !== 'undefined') {\n      client.set(key, value, 'EX', time);\n    } else {\n      client.set(key, value);\n    }\n  } else if (typeof value === 'object') {\n    Object.keys(value).forEach(item => {\n      client.hset(key, item, value[item], redis.print);\n    });\n  }\n} // setValue('id','24')\n\n\nfunction getValue(key) {\n  return client.getAsync(key);\n}\n\nvar getHValue = key => {\n  return client.hgetallAsync(key);\n};\n\nvar delValue = key => {\n  client.del(key, (err, res) => {\n    if (res === 1) {\n      console.log('delete successfully');\n    } else {\n      console.log('delete redis key error:' + err);\n    }\n  });\n}; // export {\n//     client,\n//     setValue,\n//     getValue,\n//     getHValue,\n//     delValue\n// }\n\n\nmodule.exports = {\n  client,\n  setValue,\n  getValue,\n  getHValue,\n  delValue\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlZGlzQ29uZmlnLmpzIl0sIm5hbWVzIjpbInJlZGlzIiwicmVxdWlyZSIsIlByb21pc2UiLCJEQl9VUkwiLCJSRURJUyIsImhvc3QiLCJwb3J0IiwicGFzc3dvcmQiLCJvcHRpb25zIiwiZGV0ZWN0X2J1ZmZlcnMiLCJyZXRyeV9zdHJhdGVneSIsImVycm9yIiwiY29kZSIsIkVycm9yIiwidG90YWxfcmV0cnlfdGltZSIsImF0dGVtcHQiLCJ1bmRlZmluZWQiLCJNYXRoIiwibWluIiwiY2xpZW50IiwicHJvbWlzaWZ5QWxsIiwiY3JlYXRlQ2xpZW50Iiwib24iLCJlcnIiLCJjb25zb2xlIiwibG9nIiwic2V0VmFsdWUiLCJrZXkiLCJ2YWx1ZSIsInRpbWUiLCJzZXQiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsIml0ZW0iLCJoc2V0IiwicHJpbnQiLCJnZXRWYWx1ZSIsImdldEFzeW5jIiwiZ2V0SFZhbHVlIiwiaGdldGFsbEFzeW5jIiwiZGVsVmFsdWUiLCJkZWwiLCJyZXMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFyQixDLENBQ0E7QUFDQTs7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFFQSxJQUFJRSxNQUFNLEdBQUMsa0RBQVg7QUFDQSxJQUFJQyxLQUFLLEdBQUc7QUFDUkMsRUFBQUEsSUFBSSxFQUFFLGVBREU7QUFFUkMsRUFBQUEsSUFBSSxFQUFFLEtBRkU7QUFHUkMsRUFBQUEsUUFBUSxFQUFFO0FBSEYsQ0FBWjtBQU1BLElBQUlDLE9BQU8sR0FBRztBQUNWSCxFQUFBQSxJQUFJLEVBQUVELEtBQUssQ0FBQ0MsSUFERjtBQUVWQyxFQUFBQSxJQUFJLEVBQUVGLEtBQUssQ0FBQ0UsSUFGRjtBQUdWQyxFQUFBQSxRQUFRLEVBQUVILEtBQUssQ0FBQ0csUUFITjtBQUlWRSxFQUFBQSxjQUFjLEVBQUUsSUFKTjtBQUtWQyxFQUFBQSxjQUFjLEVBQUUsVUFBVUYsT0FBVixFQUFtQjtBQUMvQixRQUFJQSxPQUFPLENBQUNHLEtBQVIsSUFBaUJILE9BQU8sQ0FBQ0csS0FBUixDQUFjQyxJQUFkLEtBQXVCLGNBQTVDLEVBQTREO0FBQ3hELGFBQU8sSUFBSUMsS0FBSixDQUFVLG1DQUFWLENBQVA7QUFDSDs7QUFDRCxRQUFJTCxPQUFPLENBQUNNLGdCQUFSLEdBQTJCLE9BQU8sRUFBUCxHQUFZLEVBQTNDLEVBQStDO0FBQzNDLGFBQU8sSUFBSUQsS0FBSixDQUFVLHNCQUFWLENBQVA7QUFDSDs7QUFDRCxRQUFJTCxPQUFPLENBQUNPLE9BQVIsR0FBa0IsRUFBdEIsRUFBMEI7QUFDdEIsYUFBT0MsU0FBUDtBQUNIOztBQUNELFdBQU9DLElBQUksQ0FBQ0MsR0FBTCxDQUFTVixPQUFPLENBQUNPLE9BQVIsR0FBa0IsR0FBM0IsRUFBZ0MsSUFBaEMsQ0FBUDtBQUNIO0FBaEJTLENBQWQ7QUFtQkEsTUFBTUksTUFBTSxHQUFHakIsT0FBTyxDQUFDa0IsWUFBUixDQUFxQnBCLEtBQUssQ0FBQ3FCLFlBQU4sQ0FBbUJiLE9BQW5CLENBQXJCLENBQWYsQyxDQUNBOztBQUVBVyxNQUFNLENBQUNHLEVBQVAsQ0FBVSxPQUFWLEVBQW1CLFVBQVVDLEdBQVYsRUFBZTtBQUM5QkMsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksd0JBQXdCRixHQUFwQztBQUNILENBRkQ7O0FBSUEsU0FBU0csUUFBVCxDQUFtQkMsR0FBbkIsRUFBd0JDLEtBQXhCLEVBQStCQyxJQUEvQixFQUFxQztBQUNqQyxNQUFJLE9BQU9ELEtBQVAsS0FBaUIsV0FBakIsSUFBZ0NBLEtBQUssSUFBSSxJQUF6QyxJQUFpREEsS0FBSyxLQUFLLEVBQS9ELEVBQWtFO0FBQzlEO0FBQ0g7O0FBQ0QsTUFBSSxPQUFPQSxLQUFQLEtBQWlCLFFBQXJCLEVBQStCO0FBQzNCLFFBQUcsT0FBT0MsSUFBUCxLQUFnQixXQUFuQixFQUFnQztBQUM1QlYsTUFBQUEsTUFBTSxDQUFDVyxHQUFQLENBQVdILEdBQVgsRUFBZUMsS0FBZixFQUFxQixJQUFyQixFQUEwQkMsSUFBMUI7QUFDSCxLQUZELE1BRU87QUFDSFYsTUFBQUEsTUFBTSxDQUFDVyxHQUFQLENBQVdILEdBQVgsRUFBZUMsS0FBZjtBQUNIO0FBQ0osR0FORCxNQU1PLElBQUksT0FBT0EsS0FBUCxLQUFpQixRQUFyQixFQUE4QjtBQUNqQ0csSUFBQUEsTUFBTSxDQUFDQyxJQUFQLENBQVlKLEtBQVosRUFBbUJLLE9BQW5CLENBQTRCQyxJQUFELElBQVU7QUFDakNmLE1BQUFBLE1BQU0sQ0FBQ2dCLElBQVAsQ0FBWVIsR0FBWixFQUFpQk8sSUFBakIsRUFBdUJOLEtBQUssQ0FBQ00sSUFBRCxDQUE1QixFQUFvQ2xDLEtBQUssQ0FBQ29DLEtBQTFDO0FBQ0gsS0FGRDtBQUdIO0FBQ0osQyxDQUVEOzs7QUFFQSxTQUFTQyxRQUFULENBQW1CVixHQUFuQixFQUF3QjtBQUNwQixTQUFPUixNQUFNLENBQUNtQixRQUFQLENBQWdCWCxHQUFoQixDQUFQO0FBQ0g7O0FBRUQsSUFBSVksU0FBUyxHQUFJWixHQUFELElBQVM7QUFDckIsU0FBT1IsTUFBTSxDQUFDcUIsWUFBUCxDQUFvQmIsR0FBcEIsQ0FBUDtBQUNILENBRkQ7O0FBSUEsSUFBSWMsUUFBUSxHQUFJZCxHQUFELElBQVM7QUFDcEJSLEVBQUFBLE1BQU0sQ0FBQ3VCLEdBQVAsQ0FBV2YsR0FBWCxFQUFnQixDQUFDSixHQUFELEVBQU1vQixHQUFOLEtBQWM7QUFDMUIsUUFBSUEsR0FBRyxLQUFHLENBQVYsRUFBWTtBQUNSbkIsTUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVkscUJBQVo7QUFDSCxLQUZELE1BRU87QUFDSEQsTUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksNEJBQTRCRixHQUF4QztBQUNIO0FBQ0osR0FORDtBQU9ILENBUkQsQyxDQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFDQXFCLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlO0FBQUMxQixFQUFBQSxNQUFEO0FBQVFPLEVBQUFBLFFBQVI7QUFBaUJXLEVBQUFBLFFBQWpCO0FBQTBCRSxFQUFBQSxTQUExQjtBQUFvQ0UsRUFBQUE7QUFBcEMsQ0FBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyIvLyBmb3IgZXM1OiBjb25zdCA9PiB2YXJcblxuY29uc3QgcmVkaXMgPSByZXF1aXJlKFwicmVkaXNcIilcbi8vIGltcG9ydCByZWRpcyBmcm9tICdyZWRpcydcbi8vIGNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoXCIuL2luZGV4XCIpXG52YXIgUHJvbWlzZSA9IHJlcXVpcmUoJ2JsdWViaXJkJylcblxudmFyIERCX1VSTD0nbW9uZ29kYjovL3Rlc3Q6MTIzNDU2QDQ3Ljk5LjIwMi4yNTU6MTUwMDEvdGVzdGRiJ1xudmFyIFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAxNTAwMSxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cblxudmFyIG9wdGlvbnMgPSB7XG4gICAgaG9zdDogUkVESVMuaG9zdCxcbiAgICBwb3J0OiBSRURJUy5wb3J0LFxuICAgIHBhc3N3b3JkOiBSRURJUy5wYXNzd29yZCxcbiAgICBkZXRlY3RfYnVmZmVyczogdHJ1ZSxcbiAgICByZXRyeV9zdHJhdGVneTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuZXJyb3IgJiYgb3B0aW9ucy5lcnJvci5jb2RlID09PSAnRUNPTk5SRUZVU0VEJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignVGhlIHNlcnZlciByZWZ1c2VkIHRoZSBjb25uZWN0aW9uJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMudG90YWxfcmV0cnlfdGltZSA+IDEwMDAgKiA2MCAqIDYwKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdSZXRyeSB0aW1lIGV4aGF1c3RlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmF0dGVtcHQgPiAxMCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTWF0aC5taW4ob3B0aW9ucy5hdHRlbXB0ICogMTAwLCAzMDAwKTtcbiAgICB9XG59XG5cbmNvbnN0IGNsaWVudCA9IFByb21pc2UucHJvbWlzaWZ5QWxsKHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKSlcbi8vIGNvbnN0IGNsaWVudCA9IHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKVxuXG5jbGllbnQub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycikge1xuICAgIGNvbnNvbGUubG9nKCdSZWRpcyBDbGllbnQgRXJyb3I6JyArIGVycilcbn0pXG5cbmZ1bmN0aW9uIHNldFZhbHVlIChrZXksIHZhbHVlLCB0aW1lKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgdmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycpe1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYodHlwZW9mIHRpbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjbGllbnQuc2V0KGtleSx2YWx1ZSwnRVgnLHRpbWUpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjbGllbnQuc2V0KGtleSx2YWx1ZSlcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jyl7XG4gICAgICAgIE9iamVjdC5rZXlzKHZhbHVlKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICBjbGllbnQuaHNldChrZXksIGl0ZW0sIHZhbHVlW2l0ZW1dLCByZWRpcy5wcmludClcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbi8vIHNldFZhbHVlKCdpZCcsJzI0JylcblxuZnVuY3Rpb24gZ2V0VmFsdWUgKGtleSkge1xuICAgIHJldHVybiBjbGllbnQuZ2V0QXN5bmMoa2V5KVxufVxuXG52YXIgZ2V0SFZhbHVlID0gKGtleSkgPT4ge1xuICAgIHJldHVybiBjbGllbnQuaGdldGFsbEFzeW5jKGtleSlcbn1cblxudmFyIGRlbFZhbHVlID0gKGtleSkgPT4ge1xuICAgIGNsaWVudC5kZWwoa2V5LCAoZXJyLCByZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcz09PTEpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0ZSBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGUgcmVkaXMga2V5IGVycm9yOicgKyBlcnIpXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG4vLyBleHBvcnQge1xuLy8gICAgIGNsaWVudCxcbi8vICAgICBzZXRWYWx1ZSxcbi8vICAgICBnZXRWYWx1ZSxcbi8vICAgICBnZXRIVmFsdWUsXG4vLyAgICAgZGVsVmFsdWVcbi8vIH1cbm1vZHVsZS5leHBvcnRzPXtjbGllbnQsc2V0VmFsdWUsZ2V0VmFsdWUsZ2V0SFZhbHVlLGRlbFZhbHVlfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "RedisConfig.js"
      ],
      "names": [
        "redis",
        "require",
        "Promise",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "options",
        "detect_buffers",
        "retry_strategy",
        "error",
        "code",
        "Error",
        "total_retry_time",
        "attempt",
        "undefined",
        "Math",
        "min",
        "client",
        "promisifyAll",
        "createClient",
        "on",
        "err",
        "console",
        "log",
        "setValue",
        "key",
        "value",
        "time",
        "set",
        "Object",
        "keys",
        "forEach",
        "item",
        "hset",
        "print",
        "getValue",
        "getAsync",
        "getHValue",
        "hgetallAsync",
        "delValue",
        "del",
        "res",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "sourcesContent": [
        "// for es5: const => var\n\nconst redis = require(\"redis\")\n// import redis from 'redis'\n// const config = require(\"./index\")\nvar Promise = require('bluebird')\n\nvar DB_URL='mongodb://test:123456@47.99.202.255:15001/testdb'\nvar REDIS = {\n    host: '47.99.202.255',\n    port: 15001,\n    password: '123456'\n}\n\nvar options = {\n    host: REDIS.host,\n    port: REDIS.port,\n    password: REDIS.password,\n    detect_buffers: true,\n    retry_strategy: function (options) {\n        if (options.error && options.error.code === 'ECONNREFUSED') {\n            return new Error('The server refused the connection');\n        }\n        if (options.total_retry_time > 1000 * 60 * 60) {\n            return new Error('Retry time exhausted');\n        }\n        if (options.attempt > 10) {\n            return undefined;\n        }\n        return Math.min(options.attempt * 100, 3000);\n    }\n}\n\nconst client = Promise.promisifyAll(redis.createClient(options))\n// const client = redis.createClient(options)\n\nclient.on('error', function (err) {\n    console.log('Redis Client Error:' + err)\n})\n\nfunction setValue (key, value, time) {\n    if (typeof value === 'undefined' || value == null || value === ''){\n        return\n    }\n    if (typeof value === 'string') {\n        if(typeof time !== 'undefined') {\n            client.set(key,value,'EX',time)\n        } else {\n            client.set(key,value)\n        }\n    } else if (typeof value === 'object'){\n        Object.keys(value).forEach((item) => {\n            client.hset(key, item, value[item], redis.print)\n        })\n    }\n}\n\n// setValue('id','24')\n\nfunction getValue (key) {\n    return client.getAsync(key)\n}\n\nvar getHValue = (key) => {\n    return client.hgetallAsync(key)\n}\n\nvar delValue = (key) => {\n    client.del(key, (err, res) => {\n        if (res===1){\n            console.log('delete successfully');\n        } else {\n            console.log('delete redis key error:' + err)\n        }\n    })\n}\n\n// export {\n//     client,\n//     setValue,\n//     getValue,\n//     getHValue,\n//     delValue\n// }\nmodule.exports={client,setValue,getValue,getHValue,delValue}"
      ]
    },
    "sourceType": "script",
    "mtime": 1582788906050
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/ContentController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/ContentController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/ContentController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/ContentController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "ContentController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import Post from '../model/Post'\nconst Post = require('../model/Post');\n\nconst config = require('../config/index');\n\nconst User = require('../model/User');\n\nconst Comment = require('../model/Comment');\n\nconst {\n  checkCode,\n  getJWTPayload\n} = require('../common/Utils');\n\nconst UserCollect = require('../model/UserCollect');\n\nconst moment = require('dayjs');\n\nconst mkdir = require('make-dir');\n\nconst uuid = require(\"uuid/v4\");\n\nconst fs = require('fs');\n\nasync function getPostList(ctx) {\n  // const post = new Post({\n  //     uid:'5e6db4551418c95ecec41ac8',  //现在插入需要 uid ，之前不知道是怎么插入成功的\n  //     title:'test title5',\n  //     content:'test content 1',\n  //     catalog:'share',\n  //     fav:20,\n  //     isEnd:'0',\n  //     reads:'0',\n  //     answer:'0',\n  //     status:'0',\n  //     isTop:'0',\n  //     sort:'0',\n  //     tags:[{\n  //         name:'精华',\n  //         class: ''\n  //     }]\n  // })\n  // const tmp=await post.save()\n  // console.log(\"module.exports -> tmp\", tmp)\n  const body = ctx.query;\n  const sort = body.sort ? body.sort : 'created';\n  const page = body.page ? parseInt(body.page) : 0;\n  const limit = body.limit ? parseInt(body.limit) : 20;\n  const options = {};\n\n  if (typeof body.catalog !== 'undefined' && body.catalog !== '') {\n    options.catalog = body.catalog;\n  }\n\n  if (typeof body.isTop !== 'undefined') {\n    options.isTop = body.isTop;\n  }\n\n  if (typeof body.status !== 'undefined' && body.status !== '') {\n    options.isEnd = body.status;\n  }\n\n  if (typeof body.tag !== 'undefined' && body.tag !== '') {\n    options.tags = {\n      $elemMatch: {\n        name: body.tag\n      }\n    };\n  } // const result = await Post.getList(options, sort, page, limit)\n  // const result = Post.getList(options, sort, page, limit)\n\n\n  const result = await Post.getList(options, sort, page, limit);\n  console.log(result);\n  ctx.body = {\n    code: 200,\n    data: result,\n    msg: '获取文章列表成功'\n  };\n}\n\nasync function uploadImg(ctx) {\n  const file = ctx.request.files.file;\n  console.log(\"uploadImg -> file\", file);\n  const ext = file.name.split('.').pop(); //删除并返回最后一个元素\n\n  const dir = `${config.uploadPath}/${moment().format('YYYYMMDD')}`;\n  await mkdir(dir);\n  const picname = uuid();\n  const destPath = `${dir}/${picname}.${ext}`;\n  const reader = fs.createReadStream(file.path); //文件路径\n\n  const upStream = fs.createWriteStream(destPath); //目标路径\n\n  const filePath = `/${moment().format('YYYYMMDD')}/${picname}.${ext}`; //日期/uuid.png\n\n  reader.pipe(upStream);\n  ctx.body = {\n    code: 200,\n    msg: '图片上传成功',\n    data: filePath\n  };\n}\n\nasync function addPost(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"addPost -> body\", body);\n  const sid = body.sid;\n  const code = body.code;\n  const result = await checkCode(sid, code);\n\n  if (result) {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const user = await User.findById({\n      _id: obj._id\n    });\n    console.log(\"addPost -> user\", user);\n\n    if (user.favs < body.fav) {\n      ctx.body = {\n        code: 501,\n        msg: '积分不足'\n      };\n      return;\n    } else {\n      await User.updateOne({\n        _id: obj._id\n      }, {\n        $inc: {\n          favs: -body.fav\n        }\n      });\n    }\n\n    const newPost = new Post(body);\n    newPost.uid = obj._id;\n    const result = await newPost.save();\n    ctx.body = {\n      code: 200,\n      msg: '成功保存的文章',\n      date: result\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '图片验证码验证失败'\n    };\n  }\n}\n\nasync function getPostDetail(ctx) {\n  const params = ctx.query;\n\n  if (!params.tid) {\n    ctx.body = {\n      code: 500,\n      msg: '文章id为空'\n    };\n    return;\n  }\n\n  const post = await Post.findByTid(params.tid);\n  let isFav = 0;\n\n  if (typeof ctx.header.authorization !== 'undefined' && ctx.header.authorization !== '') {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const userCollect = await UserCollect.findOne({\n      uid: obj._id,\n      tid: params.tid\n    });\n\n    if (userCollect && userCollect.tid) {\n      isFav = 1;\n    }\n  }\n\n  const newPost = post.toJSON();\n  newPost.isFav = isFav;\n  const result = await Post.updateOne({\n    _id: params.tid\n  }, {\n    $inc: {\n      reads: 1\n    }\n  });\n\n  if (post._id && result.ok === 1) {\n    ctx.body = {\n      code: 200,\n      data: newPost,\n      msg: '查询文章详情成功'\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '获取文章详情失败'\n    };\n  }\n}\n\nmodule.exports = {\n  getPostList,\n  uploadImg,\n  addPost,\n  getPostDetail\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbnRlbnRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlBvc3QiLCJyZXF1aXJlIiwiY29uZmlnIiwiVXNlciIsIkNvbW1lbnQiLCJjaGVja0NvZGUiLCJnZXRKV1RQYXlsb2FkIiwiVXNlckNvbGxlY3QiLCJtb21lbnQiLCJta2RpciIsInV1aWQiLCJmcyIsImdldFBvc3RMaXN0IiwiY3R4IiwiYm9keSIsInF1ZXJ5Iiwic29ydCIsInBhZ2UiLCJwYXJzZUludCIsImxpbWl0Iiwib3B0aW9ucyIsImNhdGFsb2ciLCJpc1RvcCIsInN0YXR1cyIsImlzRW5kIiwidGFnIiwidGFncyIsIiRlbGVtTWF0Y2giLCJuYW1lIiwicmVzdWx0IiwiZ2V0TGlzdCIsImNvbnNvbGUiLCJsb2ciLCJjb2RlIiwiZGF0YSIsIm1zZyIsInVwbG9hZEltZyIsImZpbGUiLCJyZXF1ZXN0IiwiZmlsZXMiLCJleHQiLCJzcGxpdCIsInBvcCIsImRpciIsInVwbG9hZFBhdGgiLCJmb3JtYXQiLCJwaWNuYW1lIiwiZGVzdFBhdGgiLCJyZWFkZXIiLCJjcmVhdGVSZWFkU3RyZWFtIiwicGF0aCIsInVwU3RyZWFtIiwiY3JlYXRlV3JpdGVTdHJlYW0iLCJmaWxlUGF0aCIsInBpcGUiLCJhZGRQb3N0Iiwic2lkIiwib2JqIiwiaGVhZGVyIiwiYXV0aG9yaXphdGlvbiIsInVzZXIiLCJmaW5kQnlJZCIsIl9pZCIsImZhdnMiLCJmYXYiLCJ1cGRhdGVPbmUiLCIkaW5jIiwibmV3UG9zdCIsInVpZCIsInNhdmUiLCJkYXRlIiwiZ2V0UG9zdERldGFpbCIsInBhcmFtcyIsInRpZCIsInBvc3QiLCJmaW5kQnlUaWQiLCJpc0ZhdiIsInVzZXJDb2xsZWN0IiwiZmluZE9uZSIsInRvSlNPTiIsInJlYWRzIiwib2siLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBQ0EsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsZUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxNQUFNLEdB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bi1mcm9udC1lbmQva29hLWRlbW8vc3JjL2FwaSIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCBQb3N0IGZyb20gJy4uL21vZGVsL1Bvc3QnXG5jb25zdCBQb3N0ID0gcmVxdWlyZSgnLi4vbW9kZWwvUG9zdCcpXG5jb25zdCBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcvaW5kZXgnKVxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXInKVxuY29uc3QgQ29tbWVudCA9IHJlcXVpcmUoJy4uL21vZGVsL0NvbW1lbnQnKVxuY29uc3QgeyBjaGVja0NvZGUsIGdldEpXVFBheWxvYWQgfSA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG5jb25zdCBVc2VyQ29sbGVjdCA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXJDb2xsZWN0JylcblxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuY29uc3QgbWtkaXIgPSByZXF1aXJlKCdtYWtlLWRpcicpXG5jb25zdCB1dWlkID0gcmVxdWlyZShcInV1aWQvdjRcIilcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0TGlzdCAoY3R4KSB7XG4gICAgLy8gY29uc3QgcG9zdCA9IG5ldyBQb3N0KHtcbiAgICAvLyAgICAgdWlkOic1ZTZkYjQ1NTE0MThjOTVlY2VjNDFhYzgnLCAgLy/njrDlnKjmj5LlhaXpnIDopoEgdWlkIO+8jOS5i+WJjeS4jeefpemBk+aYr+aAjuS5iOaPkuWFpeaIkOWKn+eahFxuICAgIC8vICAgICB0aXRsZTondGVzdCB0aXRsZTUnLFxuICAgIC8vICAgICBjb250ZW50Oid0ZXN0IGNvbnRlbnQgMScsXG4gICAgLy8gICAgIGNhdGFsb2c6J3NoYXJlJyxcbiAgICAvLyAgICAgZmF2OjIwLFxuICAgIC8vICAgICBpc0VuZDonMCcsXG4gICAgLy8gICAgIHJlYWRzOicwJyxcbiAgICAvLyAgICAgYW5zd2VyOicwJyxcbiAgICAvLyAgICAgc3RhdHVzOicwJyxcbiAgICAvLyAgICAgaXNUb3A6JzAnLFxuICAgIC8vICAgICBzb3J0OicwJyxcbiAgICAvLyAgICAgdGFnczpbe1xuICAgIC8vICAgICAgICAgbmFtZTon57K+5Y2OJyxcbiAgICAvLyAgICAgICAgIGNsYXNzOiAnJ1xuICAgIC8vICAgICB9XVxuICAgIC8vIH0pXG4gICAgLy8gY29uc3QgdG1wPWF3YWl0IHBvc3Quc2F2ZSgpXG4gICAgLy8gY29uc29sZS5sb2coXCJtb2R1bGUuZXhwb3J0cyAtPiB0bXBcIiwgdG1wKVxuXG5cbiAgICBjb25zdCBib2R5ID0gY3R4LnF1ZXJ5XG4gICAgY29uc3Qgc29ydCA9IGJvZHkuc29ydCA/IGJvZHkuc29ydCA6ICdjcmVhdGVkJ1xuICAgIGNvbnN0IHBhZ2UgPSBib2R5LnBhZ2UgPyBwYXJzZUludChib2R5LnBhZ2UpIDogMFxuICAgIGNvbnN0IGxpbWl0ID0gYm9keS5saW1pdCA/IHBhcnNlSW50KGJvZHkubGltaXQpIDogMjBcbiAgICBjb25zdCBvcHRpb25zID0ge31cblxuICAgIGlmICh0eXBlb2YgYm9keS5jYXRhbG9nICE9PSAndW5kZWZpbmVkJyAmJiBib2R5LmNhdGFsb2cgIT09ICcnKSB7XG4gICAgICAgIG9wdGlvbnMuY2F0YWxvZyA9IGJvZHkuY2F0YWxvZ1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGJvZHkuaXNUb3AgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIG9wdGlvbnMuaXNUb3AgPSBib2R5LmlzVG9wXG4gICAgfVxuICAgIGlmICh0eXBlb2YgYm9keS5zdGF0dXMgIT09ICd1bmRlZmluZWQnICYmIGJvZHkuc3RhdHVzICE9PSAnJykge1xuICAgICAgICBvcHRpb25zLmlzRW5kID0gYm9keS5zdGF0dXNcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBib2R5LnRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYm9keS50YWcgIT09ICcnKSB7XG4gICAgICAgIG9wdGlvbnMudGFncyA9IHsgJGVsZW1NYXRjaDogeyBuYW1lOiBib2R5LnRhZyB9IH1cbiAgICB9XG4gICAgLy8gY29uc3QgcmVzdWx0ID0gYXdhaXQgUG9zdC5nZXRMaXN0KG9wdGlvbnMsIHNvcnQsIHBhZ2UsIGxpbWl0KVxuICAgIC8vIGNvbnN0IHJlc3VsdCA9IFBvc3QuZ2V0TGlzdChvcHRpb25zLCBzb3J0LCBwYWdlLCBsaW1pdClcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBQb3N0LmdldExpc3Qob3B0aW9ucywgc29ydCwgcGFnZSwgbGltaXQpXG4gICAgY29uc29sZS5sb2cocmVzdWx0KVxuXG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICBtc2c6ICfojrflj5bmlofnq6DliJfooajmiJDlip8nXG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiB1cGxvYWRJbWcgKGN0eCkge1xuICAgIGNvbnN0IGZpbGUgPSBjdHgucmVxdWVzdC5maWxlcy5maWxlXG4gICAgY29uc29sZS5sb2coXCJ1cGxvYWRJbWcgLT4gZmlsZVwiLCBmaWxlKVxuICAgIGNvbnN0IGV4dCA9IGZpbGUubmFtZS5zcGxpdCgnLicpLnBvcCgpIC8v5Yig6Zmk5bm26L+U5Zue5pyA5ZCO5LiA5Liq5YWD57SgXG4gICAgY29uc3QgZGlyID0gYCR7Y29uZmlnLnVwbG9hZFBhdGh9LyR7bW9tZW50KCkuZm9ybWF0KCdZWVlZTU1ERCcpfWBcbiAgICBhd2FpdCBta2RpcihkaXIpXG4gICAgY29uc3QgcGljbmFtZSA9IHV1aWQoKVxuICAgIGNvbnN0IGRlc3RQYXRoID0gYCR7ZGlyfS8ke3BpY25hbWV9LiR7ZXh0fWBcbiAgICBjb25zdCByZWFkZXIgPSBmcy5jcmVhdGVSZWFkU3RyZWFtKGZpbGUucGF0aCkgIC8v5paH5Lu26Lev5b6EXG4gICAgY29uc3QgdXBTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShkZXN0UGF0aCkgLy/nm67moIfot6/lvoRcbiAgICBjb25zdCBmaWxlUGF0aCA9IGAvJHttb21lbnQoKS5mb3JtYXQoJ1lZWVlNTUREJyl9LyR7cGljbmFtZX0uJHtleHR9YCAgLy/ml6XmnJ8vdXVpZC5wbmdcbiAgICByZWFkZXIucGlwZSh1cFN0cmVhbSlcbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICBtc2c6ICflm77niYfkuIrkvKDmiJDlip8nLFxuICAgICAgICBkYXRhOiBmaWxlUGF0aFxuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gYWRkUG9zdCAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwiYWRkUG9zdCAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgc2lkID0gYm9keS5zaWRcbiAgICBjb25zdCBjb2RlID0gYm9keS5jb2RlXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tDb2RlKHNpZCwgY29kZSlcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh7IF9pZDogb2JqLl9pZCB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcImFkZFBvc3QgLT4gdXNlclwiLCB1c2VyKVxuICAgICAgICBpZiAodXNlci5mYXZzIDwgYm9keS5mYXYpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDUwMSxcbiAgICAgICAgICAgICAgICBtc2c6ICfnp6/liIbkuI3otrMnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IFVzZXIudXBkYXRlT25lKHsgX2lkOiBvYmouX2lkIH0sIHsgJGluYzogeyBmYXZzOiAtYm9keS5mYXYgfSB9KVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld1Bvc3QgPSBuZXcgUG9zdChib2R5KVxuICAgICAgICBuZXdQb3N0LnVpZCA9IG9iai5faWRcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3UG9zdC5zYXZlKClcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBtc2c6ICfmiJDlip/kv53lrZjnmoTmlofnq6AnLFxuICAgICAgICAgICAgZGF0ZTogcmVzdWx0XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggemqjOivgeWksei0pSdcblxuICAgICAgICB9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0RGV0YWlsIChjdHgpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBjdHgucXVlcnlcbiAgICBpZiAoIXBhcmFtcy50aWQpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmlofnq6BpZOS4uuepuidcbiAgICAgICAgfVxuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5VGlkKHBhcmFtcy50aWQpXG4gICAgbGV0IGlzRmF2ID0gMFxuICAgIGlmIChcbiAgICAgICAgdHlwZW9mIGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbiAhPT0gJ3VuZGVmaW5lZCcgJiYgY3R4LmhlYWRlci5hdXRob3JpemF0aW9uICE9PSAnJ1xuICAgICkge1xuICAgICAgICBjb25zdCBvYmogPSBhd2FpdCBnZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICAgICAgY29uc3QgdXNlckNvbGxlY3QgPSBhd2FpdCBVc2VyQ29sbGVjdC5maW5kT25lKHtcbiAgICAgICAgICAgIHVpZDogb2JqLl9pZCxcbiAgICAgICAgICAgIHRpZDogcGFyYW1zLnRpZFxuICAgICAgICB9KVxuICAgICAgICBpZiAodXNlckNvbGxlY3QgJiYgdXNlckNvbGxlY3QudGlkKSB7XG4gICAgICAgICAgICBpc0ZhdiA9IDFcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBuZXdQb3N0ID0gcG9zdC50b0pTT04oKVxuICAgIG5ld1Bvc3QuaXNGYXYgPSBpc0ZhdlxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFBvc3QudXBkYXRlT25lKFxuICAgICAgICB7IF9pZDogcGFyYW1zLnRpZCB9LFxuICAgICAgICB7ICRpbmM6IHsgcmVhZHM6IDEgfSB9XG4gICAgKVxuICAgIGlmIChwb3N0Ll9pZCAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBkYXRhOiBuZXdQb3N0LFxuICAgICAgICAgICAgbXNnOiAn5p+l6K+i5paH56ug6K+m5oOF5oiQ5YqfJ1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfojrflj5bmlofnq6Dor6bmg4XlpLHotKUnXG4gICAgICAgIH1cbiAgICB9XG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7IGdldFBvc3RMaXN0LCB1cGxvYWRJbWcsIGFkZFBvc3QsIGdldFBvc3REZXRhaWwgfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "ContentController.js"
      ],
      "names": [
        "Post",
        "require",
        "config",
        "User",
        "Comment",
        "checkCode",
        "getJWTPayload",
        "UserCollect",
        "moment",
        "mkdir",
        "uuid",
        "fs",
        "getPostList",
        "ctx",
        "body",
        "query",
        "sort",
        "page",
        "parseInt",
        "limit",
        "options",
        "catalog",
        "isTop",
        "status",
        "isEnd",
        "tag",
        "tags",
        "$elemMatch",
        "name",
        "result",
        "getList",
        "console",
        "log",
        "code",
        "data",
        "msg",
        "uploadImg",
        "file",
        "request",
        "files",
        "ext",
        "split",
        "pop",
        "dir",
        "uploadPath",
        "format",
        "picname",
        "destPath",
        "reader",
        "createReadStream",
        "path",
        "upStream",
        "createWriteStream",
        "filePath",
        "pipe",
        "addPost",
        "sid",
        "obj",
        "header",
        "authorization",
        "user",
        "findById",
        "_id",
        "favs",
        "fav",
        "updateOne",
        "$inc",
        "newPost",
        "uid",
        "save",
        "date",
        "getPostDetail",
        "params",
        "tid",
        "post",
        "findByTid",
        "isFav",
        "userCollect",
        "findOne",
        "toJSON",
        "reads",
        "ok",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "// import Post from '../model/Post'\nconst Post = require('../model/Post')\nconst config = require('../config/index')\nconst User = require('../model/User')\nconst Comment = require('../model/Comment')\nconst { checkCode, getJWTPayload } = require('../common/Utils')\nconst UserCollect = require('../model/UserCollect')\n\nconst moment = require('dayjs')\nconst mkdir = require('make-dir')\nconst uuid = require(\"uuid/v4\")\nconst fs = require('fs')\n\nasync function getPostList (ctx) {\n    // const post = new Post({\n    //     uid:'5e6db4551418c95ecec41ac8',  //现在插入需要 uid ，之前不知道是怎么插入成功的\n    //     title:'test title5',\n    //     content:'test content 1',\n    //     catalog:'share',\n    //     fav:20,\n    //     isEnd:'0',\n    //     reads:'0',\n    //     answer:'0',\n    //     status:'0',\n    //     isTop:'0',\n    //     sort:'0',\n    //     tags:[{\n    //         name:'精华',\n    //         class: ''\n    //     }]\n    // })\n    // const tmp=await post.save()\n    // console.log(\"module.exports -> tmp\", tmp)\n\n\n    const body = ctx.query\n    const sort = body.sort ? body.sort : 'created'\n    const page = body.page ? parseInt(body.page) : 0\n    const limit = body.limit ? parseInt(body.limit) : 20\n    const options = {}\n\n    if (typeof body.catalog !== 'undefined' && body.catalog !== '') {\n        options.catalog = body.catalog\n    }\n    if (typeof body.isTop !== 'undefined') {\n        options.isTop = body.isTop\n    }\n    if (typeof body.status !== 'undefined' && body.status !== '') {\n        options.isEnd = body.status\n    }\n    if (typeof body.tag !== 'undefined' && body.tag !== '') {\n        options.tags = { $elemMatch: { name: body.tag } }\n    }\n    // const result = await Post.getList(options, sort, page, limit)\n    // const result = Post.getList(options, sort, page, limit)\n    const result = await Post.getList(options, sort, page, limit)\n    console.log(result)\n\n    ctx.body = {\n        code: 200,\n        data: result,\n        msg: '获取文章列表成功'\n    }\n}\n\nasync function uploadImg (ctx) {\n    const file = ctx.request.files.file\n    console.log(\"uploadImg -> file\", file)\n    const ext = file.name.split('.').pop() //删除并返回最后一个元素\n    const dir = `${config.uploadPath}/${moment().format('YYYYMMDD')}`\n    await mkdir(dir)\n    const picname = uuid()\n    const destPath = `${dir}/${picname}.${ext}`\n    const reader = fs.createReadStream(file.path)  //文件路径\n    const upStream = fs.createWriteStream(destPath) //目标路径\n    const filePath = `/${moment().format('YYYYMMDD')}/${picname}.${ext}`  //日期/uuid.png\n    reader.pipe(upStream)\n    ctx.body = {\n        code: 200,\n        msg: '图片上传成功',\n        data: filePath\n    }\n}\n\nasync function addPost (ctx) {\n    const { body } = ctx.request\n    console.log(\"addPost -> body\", body)\n    const sid = body.sid\n    const code = body.code\n    const result = await checkCode(sid, code)\n    if (result) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const user = await User.findById({ _id: obj._id })\n        console.log(\"addPost -> user\", user)\n        if (user.favs < body.fav) {\n            ctx.body = {\n                code: 501,\n                msg: '积分不足'\n            }\n            return\n        } else {\n            await User.updateOne({ _id: obj._id }, { $inc: { favs: -body.fav } })\n        }\n        const newPost = new Post(body)\n        newPost.uid = obj._id\n        const result = await newPost.save()\n        ctx.body = {\n            code: 200,\n            msg: '成功保存的文章',\n            date: result\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '图片验证码验证失败'\n\n        }\n    }\n}\n\nasync function getPostDetail (ctx) {\n    const params = ctx.query\n    if (!params.tid) {\n        ctx.body = {\n            code: 500,\n            msg: '文章id为空'\n        }\n        return\n    }\n    const post = await Post.findByTid(params.tid)\n    let isFav = 0\n    if (\n        typeof ctx.header.authorization !== 'undefined' && ctx.header.authorization !== ''\n    ) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const userCollect = await UserCollect.findOne({\n            uid: obj._id,\n            tid: params.tid\n        })\n        if (userCollect && userCollect.tid) {\n            isFav = 1\n        }\n    }\n    const newPost = post.toJSON()\n    newPost.isFav = isFav\n    const result = await Post.updateOne(\n        { _id: params.tid },\n        { $inc: { reads: 1 } }\n    )\n    if (post._id && result.ok === 1) {\n        ctx.body = {\n            code: 200,\n            data: newPost,\n            msg: '查询文章详情成功'\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '获取文章详情失败'\n        }\n    }\n}\n\n\nmodule.exports = { getPostList, uploadImg, addPost, getPostDetail }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585714023226
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Post.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Post.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Post.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Post.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "Post.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import mongoose from '@/config/DBHelpler'\n// import moment from 'dayjs'\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst PostSchema = new Schema({\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  title: {\n    type: String\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  catalog: {\n    type: String\n  },\n  fav: {\n    type: String,\n    default: ''\n  },\n  isEnd: {\n    type: String,\n    default: '0'\n  },\n  reads: {\n    type: Number,\n    default: 0\n  },\n  answer: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '0'\n  },\n  isTop: {\n    type: String,\n    default: '0'\n  },\n  sort: {\n    type: String,\n    default: 100\n  },\n  tags: {\n    type: Array,\n    default: [// {\n      //   name: '',\n      //   class: ''\n      // }\n    ]\n  }\n});\nPostSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n});\nPostSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss');\n  next();\n});\nPostSchema.statics = {\n  /**\n   * 获取文章列表数据\n   * @param {Object} options 筛选条件\n   * @param {String} sort 排序方式\n   * @param {Number} page 分页页数\n   * @param {Number} limit 分页条数\n   */\n  // getList: function (options, sort, page, limit) {\n  //   return this.find(options)\n  //     .sort({ [sort]: -1 })\n  //     .skip(page * limit)\n  //     .limit(limit)\n  //     // .populate({\n  //     //   path: 'uid',\n  //     //   select: 'name isVip pic'\n  //     // })\n  // },\n  // 通过 sort，skip，limit，populate 去查询文章，其中 populate 可以查询到 user 的信息\n  getList: function (options, sort, page, limit) {\n    return this.find(options).sort({\n      [sort]: -1\n    }).skip(page * limit).limit(limit).populate({\n      path: 'uid',\n      select: 'name isVip pic'\n    });\n  },\n  getTopWeek: function () {\n    return this.find({\n      created: {\n        $gte: moment().subtract(7, 'days')\n      }\n    }, {\n      answer: 1,\n      title: 1\n    }).sort({\n      answer: -1\n    }).limit(15);\n  },\n  findByTid: function (id) {\n    return this.findOne({\n      _id: id\n    }).populate({\n      path: 'uid',\n      select: 'name pic isVip _id'\n    });\n  },\n  getListByUid: function (id, page, limit) {\n    return this.find({\n      uid: id\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  countByUid: function (id) {\n    return this.find({\n      uid: id\n    }).countDocuments();\n  }\n};\nconst PostModel = mongoose.model('post', PostSchema); // export default PostModel\n\nmodule.exports = PostModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBvc3QuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiUG9zdFNjaGVtYSIsInVpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJ0aXRsZSIsImNvbnRlbnQiLCJjcmVhdGVkIiwiRGF0ZSIsImNhdGFsb2ciLCJmYXYiLCJkZWZhdWx0IiwiaXNFbmQiLCJyZWFkcyIsIk51bWJlciIsImFuc3dlciIsInN0YXR1cyIsImlzVG9wIiwic29ydCIsInRhZ3MiLCJBcnJheSIsInZpcnR1YWwiLCJsb2NhbEZpZWxkIiwiZm9yZWlnbkZpZWxkIiwicHJlIiwibmV4dCIsImZvcm1hdCIsInN0YXRpY3MiLCJnZXRMaXN0Iiwib3B0aW9ucyIsInBhZ2UiLCJsaW1pdCIsImZpbmQiLCJza2lwIiwicG9wdWxhdGUiLCJwYXRoIiwic2VsZWN0IiwiZ2V0VG9wV2VlayIsIiRndGUiLCJzdWJ0cmFjdCIsImZpbmRCeVRpZCIsImlkIiwiZmluZE9uZSIsIl9pZCIsImdldExpc3RCeVVpZCIsImNvdW50QnlVaWQiLCJjb3VudERvY3VtZW50cyIsIlBvc3RNb2RlbCIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0EsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsb0JBQUQsQ0FBeEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsT0FBRCxDQUF0Qjs7QUFFQSxNQUFNRSxNQUFNLEdBQUdILFFBQVEsQ0FBQ0csTUFBeEI7QUFFQSxNQUFNQyxVQUFVLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQzVCRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEdUI7QUFFNUJDLEVBQUFBLEtBQUssRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FGcUI7QUFHNUJHLEVBQUFBLE9B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SSxDQU9DO0FBQUVILE1BQUFBLE1BQU0sRUFBRSxDQUFDO0FBQVgsS0FQRCxFQVFKZ0IsS0FSSSxDQVFFLEVBUkYsQ0FBUDtBQVNELEdBeENrQjtBQXlDbkJTLEVBQUFBLFNBQVMsRUFBRSxVQUFVQyxFQUFWLEVBQWM7QUFDdkIsV0FBTyxLQUFLQyxPQUFMLENBQWE7QUFBRUMsTUFBQUEsR0FBRyxFQUFFRjtBQUFQLEtBQWIsRUFBMEJQLFFBQTFCLENBQW1DO0FBQ3hDQyxNQUFBQSxJQUFJLEVBQUUsS0FEa0M7QUFFeENDLE1BQUFBLE1BQU0sRUFBRTtBQUZnQyxLQUFuQyxDQUFQO0FBSUQsR0E5Q2tCO0FBK0NuQlEsRUFBQUEsWUFBWSxFQUFFLFVBQVVILEVBQVYsRUFBY1gsSUFBZCxFQUFvQkMsS0FBcEIsRUFBMkI7QUFDdkMsV0FBTyxLQUFLQyxJQUFMLENBQVU7QUFBRS9CLE1BQUFBLEdBQUcsRUFBRXdDO0FBQVAsS0FBVixFQUNKUixJQURJLENBQ0NILElBQUksR0FBR0MsS0FEUixFQUVKQSxLQUZJLENBRUVBLEtBRkYsRUFHSmIsSUFISSxDQUdDO0FBQUVYLE1BQUFBLE9BQU8sRUFBRSxDQUFDO0FBQVosS0FIRCxDQUFQO0FBSUQsR0FwRGtCO0FBcURuQnNDLEVBQUFBLFVBQVUsRUFBRSxVQUFVSixFQUFWLEVBQWM7QUFDeEIsV0FBTyxLQUFLVCxJQUFMLENBQVU7QUFBRS9CLE1BQUFBLEdBQUcsRUFBRXdDO0FBQVAsS0FBVixFQUF1QkssY0FBdkIsRUFBUDtBQUNEO0FBdkRrQixDQUFyQjtBQTBEQSxNQUFNQyxTQUFTLEdBQUduRCxRQUFRLENBQUNvRCxLQUFULENBQWUsTUFBZixFQUF1QmhELFVBQXZCLENBQWxCLEMsQ0FFQTs7QUFDQWlELE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsU0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgbW9uZ29vc2UgZnJvbSAnQC9jb25maWcvREJIZWxwbGVyJ1xuLy8gaW1wb3J0IG1vbWVudCBmcm9tICdkYXlqcydcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnLi4vY29uZmlnL0RCSGVscGVyJylcbmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ2RheWpzJylcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IFBvc3RTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIHRpdGxlOiB7IHR5cGU6IFN0cmluZyB9LFxuICBjb250ZW50OiB7IHR5cGU6IFN0cmluZyB9LFxuICBjcmVhdGVkOiB7IHR5cGU6IERhdGUgfSxcbiAgY2F0YWxvZzogeyB0eXBlOiBTdHJpbmcgfSxcbiAgZmF2OiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDonJyB9LFxuICBpc0VuZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9LFxuICByZWFkczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcbiAgYW5zd2VyOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxuICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfSxcbiAgaXNUb3A6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfSxcbiAgc29ydDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6IDEwMCB9LFxuICB0YWdzOiB7XG4gICAgdHlwZTogQXJyYXksXG4gICAgZGVmYXVsdDogW1xuICAgICAgLy8ge1xuICAgICAgLy8gICBuYW1lOiAnJyxcbiAgICAgIC8vICAgY2xhc3M6ICcnXG4gICAgICAvLyB9XG4gICAgXVxuICB9XG59KVxuXG5Qb3N0U2NoZW1hLnZpcnR1YWwoJ3VzZXInLCB7XG4gIHJlZjogJ3VzZXJzJyxcbiAgbG9jYWxGaWVsZDogJ3VpZCcsXG4gIGZvcmVpZ25GaWVsZDogJ19pZCdcbn0pXG5cblBvc3RTY2hlbWEucHJlKCdzYXZlJywgZnVuY3Rpb24gKG5leHQpIHtcbiAgdGhpcy5jcmVhdGVkID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgbmV4dCgpXG59KVxuXG5Qb3N0U2NoZW1hLnN0YXRpY3MgPSB7XG4gIC8qKlxuICAgKiDojrflj5bmlofnq6DliJfooajmlbDmja5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMg562b6YCJ5p2h5Lu2XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzb3J0IOaOkuW6j+aWueW8j1xuICAgKiBAcGFyYW0ge051bWJlcn0gcGFnZSDliIbpobXpobXmlbBcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGxpbWl0IOWIhumhteadoeaVsFxuICAgKi9cbiAgLy8gZ2V0TGlzdDogZnVuY3Rpb24gKG9wdGlvbnMsIHNvcnQsIHBhZ2UsIGxpbWl0KSB7XG4gIC8vICAgcmV0dXJuIHRoaXMuZmluZChvcHRpb25zKVxuICAvLyAgICAgLnNvcnQoeyBbc29ydF06IC0xIH0pXG4gIC8vICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gIC8vICAgICAubGltaXQobGltaXQpXG4gIC8vICAgICAvLyAucG9wdWxhdGUoe1xuICAvLyAgICAgLy8gICBwYXRoOiAndWlkJyxcbiAgLy8gICAgIC8vICAgc2VsZWN0OiAnbmFtZSBpc1ZpcCBwaWMnXG4gIC8vICAgICAvLyB9KVxuICAvLyB9LFxuXG4gIC8vIOmAmui/hyBzb3J077yMc2tpcO+8jGxpbWl077yMcG9wdWxhdGUg5Y675p+l6K+i5paH56ug77yM5YW25LitIHBvcHVsYXRlIOWPr+S7peafpeivouWIsCB1c2VyIOeahOS/oeaBr1xuICBnZXRMaXN0OiBmdW5jdGlvbiAob3B0aW9ucywgc29ydCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKG9wdGlvbnMpXG4gICAgLnNvcnQoe1tzb3J0XTotMX0pXG4gICAgLnNraXAocGFnZSpsaW1pdClcbiAgICAubGltaXQobGltaXQpXG4gICAgLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6J3VpZCcsICAgICAgICBcbiAgICAgIHNlbGVjdDonbmFtZSBpc1ZpcCBwaWMnXG4gICAgfSlcbiAgfSxcbiAgZ2V0VG9wV2VlazogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoe1xuICAgICAgY3JlYXRlZDoge1xuICAgICAgICAkZ3RlOiBtb21lbnQoKS5zdWJ0cmFjdCg3LCAnZGF5cycpXG4gICAgICB9XG4gICAgfSwge1xuICAgICAgYW5zd2VyOiAxLFxuICAgICAgdGl0bGU6IDFcbiAgICB9KS5zb3J0KHsgYW5zd2VyOiAtMSB9KVxuICAgICAgLmxpbWl0KDE1KVxuICB9LFxuICBmaW5kQnlUaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmRPbmUoeyBfaWQ6IGlkIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICd1aWQnLFxuICAgICAgc2VsZWN0OiAnbmFtZSBwaWMgaXNWaXAgX2lkJ1xuICAgIH0pXG4gIH0sXG4gIGdldExpc3RCeVVpZDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pXG4gICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG4gIGNvdW50QnlVaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pLmNvdW50RG9jdW1lbnRzKClcbiAgfVxufVxuXG5jb25zdCBQb3N0TW9kZWwgPSBtb25nb29zZS5tb2RlbCgncG9zdCcsIFBvc3RTY2hlbWEpXG5cbi8vIGV4cG9ydCBkZWZhdWx0IFBvc3RNb2RlbFxubW9kdWxlLmV4cG9ydHMgPSBQb3N0TW9kZWwiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Post.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "PostSchema",
        "uid",
        "type",
        "String",
        "ref",
        "title",
        "content",
        "created",
        "Date",
        "catalog",
        "fav",
        "default",
        "isEnd",
        "reads",
        "Number",
        "answer",
        "status",
        "isTop",
        "sort",
        "tags",
        "Array",
        "virtual",
        "localField",
        "foreignField",
        "pre",
        "next",
        "format",
        "statics",
        "getList",
        "options",
        "page",
        "limit",
        "find",
        "skip",
        "populate",
        "path",
        "select",
        "getTopWeek",
        "$gte",
        "subtract",
        "findByTid",
        "id",
        "findOne",
        "_id",
        "getListByUid",
        "countByUid",
        "countDocuments",
        "PostModel",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "// import mongoose from '@/config/DBHelpler'\n// import moment from 'dayjs'\nconst mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\n\nconst Schema = mongoose.Schema\n\nconst PostSchema = new Schema({\n  uid: { type: String, ref: 'users' },\n  title: { type: String },\n  content: { type: String },\n  created: { type: Date },\n  catalog: { type: String },\n  fav: { type: String, default:'' },\n  isEnd: { type: String, default: '0' },\n  reads: { type: Number, default: 0 },\n  answer: { type: Number, default: 0 },\n  status: { type: String, default: '0' },\n  isTop: { type: String, default: '0' },\n  sort: { type: String, default: 100 },\n  tags: {\n    type: Array,\n    default: [\n      // {\n      //   name: '',\n      //   class: ''\n      // }\n    ]\n  }\n})\n\nPostSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n})\n\nPostSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss')\n  next()\n})\n\nPostSchema.statics = {\n  /**\n   * 获取文章列表数据\n   * @param {Object} options 筛选条件\n   * @param {String} sort 排序方式\n   * @param {Number} page 分页页数\n   * @param {Number} limit 分页条数\n   */\n  // getList: function (options, sort, page, limit) {\n  //   return this.find(options)\n  //     .sort({ [sort]: -1 })\n  //     .skip(page * limit)\n  //     .limit(limit)\n  //     // .populate({\n  //     //   path: 'uid',\n  //     //   select: 'name isVip pic'\n  //     // })\n  // },\n\n  // 通过 sort，skip，limit，populate 去查询文章，其中 populate 可以查询到 user 的信息\n  getList: function (options, sort, page, limit) {\n    return this.find(options)\n    .sort({[sort]:-1})\n    .skip(page*limit)\n    .limit(limit)\n    .populate({\n      path:'uid',        \n      select:'name isVip pic'\n    })\n  },\n  getTopWeek: function () {\n    return this.find({\n      created: {\n        $gte: moment().subtract(7, 'days')\n      }\n    }, {\n      answer: 1,\n      title: 1\n    }).sort({ answer: -1 })\n      .limit(15)\n  },\n  findByTid: function (id) {\n    return this.findOne({ _id: id }).populate({\n      path: 'uid',\n      select: 'name pic isVip _id'\n    })\n  },\n  getListByUid: function (id, page, limit) {\n    return this.find({ uid: id })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  countByUid: function (id) {\n    return this.find({ uid: id }).countDocuments()\n  }\n}\n\nconst PostModel = mongoose.model('post', PostSchema)\n\n// export default PostModel\nmodule.exports = PostModel"
      ]
    },
    "sourceType": "script",
    "mtime": 1585706466117
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/DBHelper.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/DBHelper.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/DBHelper.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/DBHelper.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
        "sourceFileName": "DBHelper.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('mongoose'); // const config = require('./index')\n\n\nmongoose.set('useCreateIndex', true);\nconst DB_URL = 'mongodb://echo:123456@47.99.202.255:27018/testdb';\nconst REDIS = {\n  host: '47.99.202.255',\n  port: 27017,\n  password: '123456'\n};\nmongoose.connect(DB_URL, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\nmongoose.connection.on('connected', () => {\n  console.log('Mongoose connection open to ' + DB_URL);\n});\nmongoose.connection.on('error', err => {\n  console.log('Mongoose connection error: ' + err);\n});\nmongoose.connection.on('disconnected', () => {\n  console.log('Mongoose connection disconnected');\n});\nmodule.exports = mongoose;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRCSGVscGVyLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsInNldCIsIkRCX1VSTCIsIlJFRElTIiwiaG9zdCIsInBvcnQiLCJwYXNzd29yZCIsImNvbm5lY3QiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJjb25uZWN0aW9uIiwib24iLCJjb25zb2xlIiwibG9nIiwiZXJyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCLEMsQ0FDQTs7O0FBRUFELFFBQVEsQ0FBQ0UsR0FBVCxDQUFhLGdCQUFiLEVBQThCLElBQTlCO0FBRUEsTUFBTUMsTUFBTSxHQUFDLGtEQUFiO0FBQ0EsTUFBTUMsS0FBSyxHQUFHO0FBQ1ZDLEVBQUFBLElBQUksRUFBRSxlQURJO0FBRVZDLEVBQUFBLElBQUksRUFBRSxLQUZJO0FBR1ZDLEVBQUFBLFFBQVEsRUFBRTtBQUhBLENBQWQ7QUFNQVAsUUFBUSxDQUFDUSxPQUFULENBQWlCTCxNQUFqQixFQUF3QjtBQUNwQk0sRUFBQUEsZUFBZSxFQUFFLElBREc7QUFFcEJDLEVBQUFBLGtCQUFrQixFQUFFO0FBRkEsQ0FBeEI7QUFLQVYsUUFBUSxDQUFDVyxVQUFULENBQW9CQyxFQUFwQixDQUF1QixXQUF2QixFQUFvQyxNQUFNO0FBQ3RDQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQ0FBK0JYLE1BQTNDO0FBQ0gsQ0FGRDtBQUlBSCxRQUFRLENBQUNXLFVBQVQsQ0FBb0JDLEVBQXBCLENBQXVCLE9BQXZCLEVBQWlDRyxHQUFELElBQVM7QUFDckNGLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdDQUE4QkMsR0FBMUM7QUFDSCxDQUZEO0FBSUFmLFFBQVEsQ0FBQ1csVUFBVCxDQUFvQkMsRUFBcEIsQ0FBdUIsY0FBdkIsRUFBdUMsTUFBTTtBQUN6Q0MsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksa0NBQVo7QUFDSCxDQUZEO0FBSUFFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlakIsUUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJylcbi8vIGNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4vaW5kZXgnKVxuXG5tb25nb29zZS5zZXQoJ3VzZUNyZWF0ZUluZGV4Jyx0cnVlKVxuXG5jb25zdCBEQl9VUkw9J21vbmdvZGI6Ly9lY2hvOjEyMzQ1NkA0Ny45OS4yMDIuMjU1OjI3MDE4L3Rlc3RkYidcbmNvbnN0IFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAyNzAxNyxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cblxubW9uZ29vc2UuY29ubmVjdChEQl9VUkwse1xuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWVcbn0pXG5cbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oJ2Nvbm5lY3RlZCcsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnTW9uZ29vc2UgY29ubmVjdGlvbiBvcGVuIHRvICcrREJfVVJMKTtcbn0pXG5cbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdNb25nb29zZSBjb25uZWN0aW9uIGVycm9yOiAnK2Vycik7XG59KVxuXG5tb25nb29zZS5jb25uZWN0aW9uLm9uKCdkaXNjb25uZWN0ZWQnLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ01vbmdvb3NlIGNvbm5lY3Rpb24gZGlzY29ubmVjdGVkJylcbn0pXG5cbm1vZHVsZS5leHBvcnRzPW1vbmdvb3NlIl19",
    "map": {
      "version": 3,
      "sources": [
        "DBHelper.js"
      ],
      "names": [
        "mongoose",
        "require",
        "set",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "connect",
        "useNewUrlParser",
        "useUnifiedTopology",
        "connection",
        "on",
        "console",
        "log",
        "err",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB,C,CACA;;;AAEAD,QAAQ,CAACE,GAAT,CAAa,gBAAb,EAA8B,IAA9B;AAEA,MAAMC,MAAM,GAAC,kDAAb;AACA,MAAMC,KAAK,GAAG;AACVC,EAAAA,IAAI,EAAE,eADI;AAEVC,EAAAA,IAAI,EAAE,KAFI;AAGVC,EAAAA,QAAQ,EAAE;AAHA,CAAd;AAMAP,QAAQ,CAACQ,OAAT,CAAiBL,MAAjB,EAAwB;AACpBM,EAAAA,eAAe,EAAE,IADG;AAEpBC,EAAAA,kBAAkB,EAAE;AAFA,CAAxB;AAKAV,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,WAAvB,EAAoC,MAAM;AACtCC,EAAAA,OAAO,CAACC,GAAR,CAAY,iCAA+BX,MAA3C;AACH,CAFD;AAIAH,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAiCG,GAAD,IAAS;AACrCF,EAAAA,OAAO,CAACC,GAAR,CAAY,gCAA8BC,GAA1C;AACH,CAFD;AAIAf,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,cAAvB,EAAuC,MAAM;AACzCC,EAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ;AACH,CAFD;AAIAE,MAAM,CAACC,OAAP,GAAejB,QAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "sourcesContent": [
        "const mongoose = require('mongoose')\n// const config = require('./index')\n\nmongoose.set('useCreateIndex',true)\n\nconst DB_URL='mongodb://echo:123456@47.99.202.255:27018/testdb'\nconst REDIS = {\n    host: '47.99.202.255',\n    port: 27017,\n    password: '123456'\n}\n\nmongoose.connect(DB_URL,{\n    useNewUrlParser: true,\n    useUnifiedTopology: true\n})\n\nmongoose.connection.on('connected', () => {\n    console.log('Mongoose connection open to '+DB_URL);\n})\n\nmongoose.connection.on('error', (err) => {\n    console.log('Mongoose connection error: '+err);\n})\n\nmongoose.connection.on('disconnected', () => {\n    console.log('Mongoose connection disconnected')\n})\n\nmodule.exports=mongoose"
      ]
    },
    "sourceType": "script",
    "mtime": 1583598900525
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/userRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/userRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/userRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/userRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "userRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require(\"koa-router\");\n\nconst {\n  userSign,\n  updateUserInfo,\n  changePassword\n} = require('../../api/UserController');\n\nconst router = new Router();\nrouter.prefix('/user');\nrouter.get('/fav', userSign);\nrouter.post('/basic', updateUserInfo);\nrouter.post('/changePassword', changePassword); // router.get('/account',userController.userAccount)\n// router.get('/permission',userController.userPermission)\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXJSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsInVzZXJTaWduIiwidXBkYXRlVXNlckluZm8iLCJjaGFuZ2VQYXNzd29yZCIsInJvdXRlciIsInByZWZpeCIsImdldCIsInBvc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBR0MsT0FBTyxDQUFDLFlBQUQsQ0FBdEI7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQSxRQUFGO0FBQVlDLEVBQUFBLGNBQVo7QUFBNEJDLEVBQUFBO0FBQTVCLElBQStDSCxPQUFPLENBQUMsMEJBQUQsQ0FBNUQ7O0FBRUEsTUFBTUksTUFBTSxHQUFHLElBQUlMLE1BQUosRUFBZjtBQUNBSyxNQUFNLENBQUNDLE1BQVAsQ0FBYyxPQUFkO0FBQ0FELE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLE1BQVgsRUFBbUJMLFFBQW5CO0FBRUFHLE1BQU0sQ0FBQ0csSUFBUCxDQUFZLFFBQVosRUFBc0JMLGNBQXRCO0FBQ0FFLE1BQU0sQ0FBQ0csSUFBUCxDQUFZLGlCQUFaLEVBQStCSixjQUEvQixFLENBRUE7QUFDQTs7QUFFQUssTUFBTSxDQUFDQyxPQUFQLEdBQWlCTCxNQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlciA9IHJlcXVpcmUoXCJrb2Etcm91dGVyXCIpXG5jb25zdCB7IHVzZXJTaWduLCB1cGRhdGVVc2VySW5mbywgY2hhbmdlUGFzc3dvcmQgfSA9IHJlcXVpcmUoJy4uLy4uL2FwaS9Vc2VyQ29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlciA9IG5ldyBSb3V0ZXIoKVxucm91dGVyLnByZWZpeCgnL3VzZXInKVxucm91dGVyLmdldCgnL2ZhdicsIHVzZXJTaWduKVxuXG5yb3V0ZXIucG9zdCgnL2Jhc2ljJywgdXBkYXRlVXNlckluZm8pXG5yb3V0ZXIucG9zdCgnL2NoYW5nZVBhc3N3b3JkJywgY2hhbmdlUGFzc3dvcmQpXG5cbi8vIHJvdXRlci5nZXQoJy9hY2NvdW50Jyx1c2VyQ29udHJvbGxlci51c2VyQWNjb3VudClcbi8vIHJvdXRlci5nZXQoJy9wZXJtaXNzaW9uJyx1c2VyQ29udHJvbGxlci51c2VyUGVybWlzc2lvbilcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "userRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "userSign",
        "updateUserInfo",
        "changePassword",
        "router",
        "prefix",
        "get",
        "post",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,YAAD,CAAtB;;AACA,MAAM;AAAEC,EAAAA,QAAF;AAAYC,EAAAA,cAAZ;AAA4BC,EAAAA;AAA5B,IAA+CH,OAAO,CAAC,0BAAD,CAA5D;;AAEA,MAAMI,MAAM,GAAG,IAAIL,MAAJ,EAAf;AACAK,MAAM,CAACC,MAAP,CAAc,OAAd;AACAD,MAAM,CAACE,GAAP,CAAW,MAAX,EAAmBL,QAAnB;AAEAG,MAAM,CAACG,IAAP,CAAY,QAAZ,EAAsBL,cAAtB;AACAE,MAAM,CAACG,IAAP,CAAY,iBAAZ,EAA+BJ,cAA/B,E,CAEA;AACA;;AAEAK,MAAM,CAACC,OAAP,GAAiBL,MAAjB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router = require(\"koa-router\")\nconst { userSign, updateUserInfo, changePassword } = require('../../api/UserController')\n\nconst router = new Router()\nrouter.prefix('/user')\nrouter.get('/fav', userSign)\n\nrouter.post('/basic', updateUserInfo)\nrouter.post('/changePassword', changePassword)\n\n// router.get('/account',userController.userAccount)\n// router.get('/permission',userController.userPermission)\n\nmodule.exports = router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585535667031
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/UserController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/UserController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/UserController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/UserController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "UserController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst SignRecord = require('../model/SignRecord');\n\nconst User = require('../model/User');\n\nconst Utils = require('../common/Utils');\n\nconst {\n  setValue\n} = require('../config/RedisConfig');\n\nconst {\n  send\n} = require('../config/MailConfig');\n\nconst config = require('../config/index');\n\nconst moment = require('dayjs');\n\nconst uuid = require('uuid/v4');\n\nconst jwt = require('jsonwebtoken');\n\nconst bcrypt = require('bcrypt');\n\nasync function userSign(ctx) {\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  const record = await SignRecord.findByUid(obj._id);\n  console.log(\"userSign -> record\", record);\n  const user = await User.findByID(obj._id);\n  let newRecord = {};\n  let result = '';\n  record.created = '2020-03-14T02:54:41.000Z';\n\n  if (record !== null) {\n    if (moment(record.created).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD')) {\n      ctx.body = {\n        code: 500,\n        favs: user.favs,\n        count: user.count,\n        lastSign: record.created,\n        msg: '用户已经签到'\n      };\n      return;\n    } else {\n      let count = user.count;\n      console.log(\"userSign -> count\", count);\n      let fav = 0;\n\n      if (moment(record.created).format('YYYY-MM-DD') === moment().subtract(1, 'days').format('YYYY-MM-DD')) {\n        count += 1;\n\n        if (count < 5) {\n          fav = 5;\n        } else if (count >= 5 && count < 15) {\n          fav = 10;\n        } else if (count >= 15 && count < 30) {\n          fav = 15;\n        } else if (count >= 30 && count < 100) {\n          fav = 20;\n        } else if (count >= 100 && count < 365) {\n          fav = 30;\n        } else if (count >= 365) {\n          fav = 50;\n        }\n\n        await User.updateOne({\n          _id: obj._id\n        }, {\n          $inc: {\n            favs: fav,\n            count: 1\n          }\n        });\n        result = {\n          favs: user.favs + fav,\n          count: user.count + 1\n        };\n      } else {\n        fav = 5;\n        await User.updateOne({\n          _id: obj._id\n        }, {\n          $set: {\n            count: 1\n          },\n          $inc: {\n            favs: fav\n          }\n        });\n        result = {\n          favs: user.favs + fav,\n          count: 1\n        };\n      }\n\n      newRecord = new SignRecord({\n        uid: obj._id,\n        favs: fav\n      });\n      await newRecord.save();\n    }\n  } else {\n    await User.updateOne({\n      _id: obj._id\n    }, {\n      $set: {\n        count: 1\n      },\n      $inc: {\n        favs: 5\n      }\n    });\n    newRecord = new SignRecord({\n      uid: obj._id,\n      favs: 5 // lastSign: moment().format('YYYY-MM-DD HH:mm:ss')\n\n    });\n    await newRecord.save();\n    result = {\n      favs: user.favs + 5,\n      count: 1\n    };\n  }\n\n  ctx.body = {\n    code: 200,\n    msg: '请求成功',\n    ...result,\n    lastSign: newRecord.created\n  };\n}\n\nasync function updateUserInfo(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"updateUserInfo -> body\", body);\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  console.log(\"updateUserInfo -> obj\", obj);\n  const user = await User.findOne({\n    _id: obj._id\n  });\n  console.log(\"updateUserInfo -> user\", user);\n  let msg = '';\n\n  if (body.username && body.username !== user.username) {\n    const tmpUser = await User.findOne({\n      username: body.username\n    });\n    console.log(\"updateUserInfo -> tmpUser\", tmpUser);\n\n    if (tmpUser && tmpUser.password) {\n      ctx.body = {\n        code: 501,\n        msg: '邮箱已经注册'\n      };\n      return;\n    }\n\n    const key = uuid();\n    setValue(key, jwt.sign({\n      _id: obj._id\n    }, config.JWT_SECRET, {\n      expiresIn: '30m'\n    }));\n    await send({\n      type: 'email',\n      data: {\n        key: key,\n        username: body.username\n      },\n      code: '',\n      expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n      email: user.username,\n      user: user.name\n    });\n    msg = '更新基本资料成功，账号修改需要邮件确认，请查收邮件';\n  }\n\n  const arr = ['username', 'mobile', 'password'];\n  arr.map(item => {\n    delete body[item];\n  });\n  const result = await User.updateOne({\n    _id: obj._id\n  }, body);\n  console.log(\"result\", result);\n\n  if (result.n === 1 && result.ok === 1) {\n    ctx.body = {\n      code: 200,\n      msg: msg === '' ? '更新成功' : msg\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '更新失败'\n    };\n  }\n}\n\nasync function changePassword(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"changePassword -> body\", body);\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  const user = await User.findOne({\n    _id: obj._id\n  });\n  console.log(\"changePassword -> user\", user);\n  let msg = '';\n\n  if (await bcrypt.compare(body.oldPassword, user.password)) {\n    body.newPassword = await bcrypt.hash(body.newPassword, 5);\n    console.log(\"changePassword ->  body.newPassword\", body.newPassword);\n    const result = await User.updateOne({\n      _id: obj._id\n    }, {\n      password: body.newPassword\n    });\n    console.log(\"result\", result);\n\n    if (result.n === 1 && result.ok === 1) {\n      ctx.body = {\n        code: 200,\n        msg: msg === '' ? '更新成功' : msg\n      };\n    } else {\n      ctx.body = {\n        code: 500,\n        msg: '更新失败'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 501,\n      msg: '原来的密码填写错误'\n    };\n    return;\n  }\n}\n\nmodule.exports = {\n  userSign,\n  updateUserInfo,\n  changePassword\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlNpZ25SZWNvcmQiLCJyZXF1aXJlIiwiVXNlciIsIlV0aWxzIiwic2V0VmFsdWUiLCJzZW5kIiwiY29uZmlnIiwibW9tZW50IiwidXVpZCIsImp3dCIsImJjcnlwdCIsInVzZXJTaWduIiwiY3R4Iiwib2JqIiwiZ2V0SldUUGF5bG9hZCIsImhlYWRlciIsImF1dGhvcml6YXRpb24iLCJyZWNvcmQiLCJmaW5kQnlVaWQiLCJfaWQiLCJjb25zb2xlIiwibG9nIiwidXNlciIsImZpbmRCeUlEIiwibmV3UmVjb3JkIiwicmVzdWx0IiwiY3JlYXRlZCIsImZvcm1hdCIsImJvZHkiLCJjb2RlIiwiZmF2cyIsImNvdW50IiwibGFzdFNpZ24iLCJtc2ciLCJmYXYiLCJzdWJ0cmFjdCIsInVwZGF0ZU9uZSIsIiRpbmMiLCIkc2V0IiwidWlkIiwic2F2ZSIsInVwZGF0ZVVzZXJJbmZvIiwicmVxdWVzdCIsImZpbmRPbmUiLCJ1c2VybmFtZSIsInRtcFVzZXIiLCJwYXNzd29yZCIsImtleSIsInNpZ24iLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwidHlwZSIsImRhdGEiLCJleHBpcmUiLCJhZGQiLCJlbWFpbCIsIm5hbWUiLCJhcnIiLCJtYXAiLCJpdGVtIiwibiIsIm9rIiwiY2hhbmdlUGFzc3dvcmQiLCJjb21wYXJlIiwib2xkUGFzc3dvcmQiLCJuZXdQYXNzd29yZCIsImhhc2giLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFVBQVUsR0FBR0MsT0FBTyxDQUFDLHFCQUFELENBQTFCOztBQUNBLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLGVBQUQsQ0FBcEI7O0FBQ0EsTUFBTUUsS0FBSyxHQUFHRixPQUFPLENBQUMsaUJBQUQsQ0FBckI7O0FBQ0EsTUFBTTtBQUFFRyxFQUFBQTtBQUFGLElBQWVILE9BQU8sQ0FBQyx1QkFBRCxDQUE1Qjs7QUFDQSxNQUFNO0FBQUVJLEVB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QVksUUFBWixFQUFzQkksTUFBdEI7O0FBQ0EsUUFBSUEsTUFBTSxDQUFDbUMsQ0FBUCxLQUFhLENBQWIsSUFBa0JuQyxNQUFNLENBQUNvQyxFQUFQLEtBQWMsQ0FBcEMsRUFBdUM7QUFDbkNqRCxNQUFBQSxHQUFHLENBQUNnQixJQUFKLEdBQVc7QUFDUEMsUUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUEksUUFBQUEsR0FBRyxFQUFFQSxHQUFHLEtBQUssRUFBUixHQUFhLE1BQWIsR0FBc0JBO0FBRnBCLE9BQVg7QUFJSCxLQUxELE1BS087QUFDSHJCLE1BQUFBLEdBQUcsQ0FBQ2dCLElBQUosR0FBVztBQUNQQyxRQUFBQSxJQUFJLEVBQUUsR0FEQztBQUVQSSxRQUFBQSxHQUFHLEVBQUU7QUFGRSxPQUFYO0FBSUg7QUFDSixHQWhCRCxNQWdCTztBQUNIckIsSUFBQUEsR0FBRyxDQUFDZ0IsSUFBSixHQUFXO0FBQ1BDLE1BQUFBLElBQUksRUFBRSxHQURDO0FBRVBJLE1BQUFBLEdBQUcsRUFBRTtBQUZFLEtBQVg7QUFJQTtBQUNIO0FBRUo7O0FBR0RrQyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRXpELEVBQUFBLFFBQUY7QUFBWThCLEVBQUFBLGNBQVo7QUFBNEJxQixFQUFBQTtBQUE1QixDQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9hcGkiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTaWduUmVjb3JkID0gcmVxdWlyZSgnLi4vbW9kZWwvU2lnblJlY29yZCcpXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWwvVXNlcicpXG5jb25zdCBVdGlscyA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG5jb25zdCB7IHNldFZhbHVlIH0gPSByZXF1aXJlKCcuLi9jb25maWcvUmVkaXNDb25maWcnKVxuY29uc3QgeyBzZW5kIH0gPSByZXF1aXJlKCcuLi9jb25maWcvTWFpbENvbmZpZycpXG5jb25zdCBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcvaW5kZXgnKVxuXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCB1dWlkID0gcmVxdWlyZSgndXVpZC92NCcpXG5jb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKVxuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0JylcblxuYXN5bmMgZnVuY3Rpb24gdXNlclNpZ24gKGN0eCkge1xuICAgIGNvbnN0IG9iaiA9IGF3YWl0IFV0aWxzLmdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgIGNvbnN0IHJlY29yZCA9IGF3YWl0IFNpZ25SZWNvcmQuZmluZEJ5VWlkKG9iai5faWQpXG4gICAgY29uc29sZS5sb2coXCJ1c2VyU2lnbiAtPiByZWNvcmRcIiwgcmVjb3JkKVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlEKG9iai5faWQpXG4gICAgbGV0IG5ld1JlY29yZCA9IHt9XG4gICAgbGV0IHJlc3VsdCA9ICcnXG4gICAgcmVjb3JkLmNyZWF0ZWQgPSAnMjAyMC0wMy0xNFQwMjo1NDo0MS4wMDBaJ1xuICAgIGlmIChyZWNvcmQgIT09IG51bGwpIHtcbiAgICAgICAgaWYgKG1vbWVudChyZWNvcmQuY3JlYXRlZCkuZm9ybWF0KCdZWVlZLU1NLUREJykgPT09IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCcpKSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICAgICAgZmF2czogdXNlci5mYXZzLFxuICAgICAgICAgICAgICAgIGNvdW50OiB1c2VyLmNvdW50LFxuICAgICAgICAgICAgICAgIGxhc3RTaWduOiByZWNvcmQuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICBtc2c6ICfnlKjmiLflt7Lnu4/nrb7liLAnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBjb3VudCA9IHVzZXIuY291bnRcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXNlclNpZ24gLT4gY291bnRcIiwgY291bnQpXG4gICAgICAgICAgICBsZXQgZmF2ID0gMFxuICAgICAgICAgICAgaWYgKG1vbWVudChyZWNvcmQuY3JlYXRlZCkuZm9ybWF0KCdZWVlZLU1NLUREJykgPT09IG1vbWVudCgpLnN1YnRyYWN0KDEsICdkYXlzJykuZm9ybWF0KCdZWVlZLU1NLUREJykpIHtcbiAgICAgICAgICAgICAgICBjb3VudCArPSAxXG4gICAgICAgICAgICAgICAgaWYgKGNvdW50IDwgNSkge1xuICAgICAgICAgICAgICAgICAgICBmYXYgPSA1XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSA1ICYmIGNvdW50IDwgMTUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gMTBcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50ID49IDE1ICYmIGNvdW50IDwgMzApIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gMTVcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50ID49IDMwICYmIGNvdW50IDwgMTAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdiA9IDIwXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSAxMDAgJiYgY291bnQgPCAzNjUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gMzBcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50ID49IDM2NSkge1xuICAgICAgICAgICAgICAgICAgICBmYXYgPSA1MFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhd2FpdCBVc2VyLnVwZGF0ZU9uZShcbiAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IG9iai5faWQgfSxcbiAgICAgICAgICAgICAgICAgICAgeyAkaW5jOiB7IGZhdnM6IGZhdiwgY291bnQ6IDEgfSB9XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZmF2czogdXNlci5mYXZzICsgZmF2LFxuICAgICAgICAgICAgICAgICAgICBjb3VudDogdXNlci5jb3VudCArIDFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZhdiA9IDVcbiAgICAgICAgICAgICAgICBhd2FpdCBVc2VyLnVwZGF0ZU9uZShcbiAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IG9iai5faWQgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogeyBjb3VudDogMSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgJGluYzogeyBmYXZzOiBmYXYgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZmF2czogdXNlci5mYXZzICsgZmF2LFxuICAgICAgICAgICAgICAgICAgICBjb3VudDogMVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld1JlY29yZCA9IG5ldyBTaWduUmVjb3JkKHtcbiAgICAgICAgICAgICAgICB1aWQ6IG9iai5faWQsXG4gICAgICAgICAgICAgICAgZmF2czogZmF2XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgYXdhaXQgbmV3UmVjb3JkLnNhdmUoKVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgVXNlci51cGRhdGVPbmUoe1xuICAgICAgICAgICAgX2lkOiBvYmouX2lkXG4gICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJHNldDogeyBjb3VudDogMSB9LFxuICAgICAgICAgICAgICAgICRpbmM6IHsgZmF2czogNSB9XG4gICAgICAgICAgICB9KVxuICAgICAgICBuZXdSZWNvcmQgPSBuZXcgU2lnblJlY29yZCh7XG4gICAgICAgICAgICB1aWQ6IG9iai5faWQsXG4gICAgICAgICAgICBmYXZzOiA1XG4gICAgICAgICAgICAvLyBsYXN0U2lnbjogbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICAgICAgfSlcbiAgICAgICAgYXdhaXQgbmV3UmVjb3JkLnNhdmUoKVxuICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICBmYXZzOiB1c2VyLmZhdnMgKyA1LFxuICAgICAgICAgICAgY291bnQ6IDFcbiAgICAgICAgfVxuICAgIH1cbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICBtc2c6ICfor7fmsYLmiJDlip8nLFxuICAgICAgICAuLi5yZXN1bHQsXG4gICAgICAgIGxhc3RTaWduOiBuZXdSZWNvcmQuY3JlYXRlZFxuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXNlckluZm8gKGN0eCkge1xuICAgIGNvbnN0IHsgYm9keSB9ID0gY3R4LnJlcXVlc3RcbiAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVVzZXJJbmZvIC0+IGJvZHlcIiwgYm9keSlcbiAgICBjb25zdCBvYmogPSBhd2FpdCBVdGlscy5nZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVVzZXJJbmZvIC0+IG9ialwiLCBvYmopXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IF9pZDogb2JqLl9pZCB9KVxuICAgIGNvbnNvbGUubG9nKFwidXBkYXRlVXNlckluZm8gLT4gdXNlclwiLCB1c2VyKVxuICAgIGxldCBtc2cgPSAnJ1xuICAgIGlmIChib2R5LnVzZXJuYW1lICYmIGJvZHkudXNlcm5hbWUgIT09IHVzZXIudXNlcm5hbWUpIHtcbiAgICAgICAgY29uc3QgdG1wVXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lOiBib2R5LnVzZXJuYW1lIH0pXG4gICAgICAgIGNvbnNvbGUubG9nKFwidXBkYXRlVXNlckluZm8gLT4gdG1wVXNlclwiLCB0bXBVc2VyKVxuICAgICAgICBpZiAodG1wVXNlciAmJiB0bXBVc2VyLnBhc3N3b3JkKSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA1MDEsXG4gICAgICAgICAgICAgICAgbXNnOiAn6YKu566x5bey57uP5rOo5YaMJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5ID0gdXVpZCgpXG4gICAgICAgIHNldFZhbHVlKFxuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgand0LnNpZ24oeyBfaWQ6IG9iai5faWQgfSwgY29uZmlnLkpXVF9TRUNSRVQsIHtcbiAgICAgICAgICAgICAgICBleHBpcmVzSW46ICczMG0nXG4gICAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICAgIGF3YWl0IHNlbmQoe1xuICAgICAgICAgICAgdHlwZTogJ2VtYWlsJyxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogYm9keS51c2VybmFtZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvZGU6ICcnLFxuICAgICAgICAgICAgZXhwaXJlOiBtb21lbnQoKS5hZGQoMzAsICdtaW51dGVzJykuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyksXG4gICAgICAgICAgICBlbWFpbDogdXNlci51c2VybmFtZSxcbiAgICAgICAgICAgIHVzZXI6IHVzZXIubmFtZVxuICAgICAgICB9KVxuICAgICAgICBtc2cgPSAn5pu05paw5Z+65pys6LWE5paZ5oiQ5Yqf77yM6LSm5Y+35L+u5pS56ZyA6KaB6YKu5Lu256Gu6K6k77yM6K+35p+l5pS26YKu5Lu2J1xuICAgIH1cbiAgICBjb25zdCBhcnIgPSBbJ3VzZXJuYW1lJywgJ21vYmlsZScsICdwYXNzd29yZCddXG4gICAgYXJyLm1hcChpdGVtID0+IHtcbiAgICAgICAgZGVsZXRlIGJvZHlbaXRlbV1cbiAgICB9KVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFVzZXIudXBkYXRlT25lKHsgX2lkOiBvYmouX2lkIH0sIGJvZHkpXG4gICAgY29uc29sZS5sb2coXCJyZXN1bHRcIiwgcmVzdWx0KVxuICAgIGlmIChyZXN1bHQubiA9PT0gMSAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBtc2c6IG1zZyA9PT0gJycgPyAn5pu05paw5oiQ5YqfJyA6IG1zZ1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmm7TmlrDlpLHotKUnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoYW5nZVBhc3N3b3JkIChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJjaGFuZ2VQYXNzd29yZCAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgb2JqID0gYXdhaXQgVXRpbHMuZ2V0SldUUGF5bG9hZChjdHguaGVhZGVyLmF1dGhvcml6YXRpb24pXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IF9pZDogb2JqLl9pZCB9KVxuICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlUGFzc3dvcmQgLT4gdXNlclwiLCB1c2VyKVxuICAgIGxldCBtc2cgPSAnJ1xuICAgIGlmIChhd2FpdCBiY3J5cHQuY29tcGFyZShib2R5Lm9sZFBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKSkge1xuICAgICAgICBib2R5Lm5ld1Bhc3N3b3JkPWF3YWl0IGJjcnlwdC5oYXNoKGJvZHkubmV3UGFzc3dvcmQsNSlcbiAgICAgICAgY29uc29sZS5sb2coXCJjaGFuZ2VQYXNzd29yZCAtPiAgYm9keS5uZXdQYXNzd29yZFwiLCAgYm9keS5uZXdQYXNzd29yZClcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgVXNlci51cGRhdGVPbmUoeyBfaWQ6IG9iai5faWQgfSwge3Bhc3N3b3JkOmJvZHkubmV3UGFzc3dvcmR9KVxuICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdFwiLCByZXN1bHQpXG4gICAgICAgIGlmIChyZXN1bHQubiA9PT0gMSAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBtc2c6IG1zZyA9PT0gJycgPyAn5pu05paw5oiQ5YqfJyA6IG1zZ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIG1zZzogJ+abtOaWsOWksei0pSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgY29kZTogNTAxLFxuICAgICAgICAgICAgbXNnOiAn5Y6f5p2l55qE5a+G56CB5aGr5YaZ6ZSZ6K+vJ1xuICAgICAgICB9XG4gICAgICAgIHJldHVyblxuICAgIH1cblxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0geyB1c2VyU2lnbiwgdXBkYXRlVXNlckluZm8sIGNoYW5nZVBhc3N3b3JkIH0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "UserController.js"
      ],
      "names": [
        "SignRecord",
        "require",
        "User",
        "Utils",
        "setValue",
        "send",
        "config",
        "moment",
        "uuid",
        "jwt",
        "bcrypt",
        "userSign",
        "ctx",
        "obj",
        "getJWTPayload",
        "header",
        "authorization",
        "record",
        "findByUid",
        "_id",
        "console",
        "log",
        "user",
        "findByID",
        "newRecord",
        "result",
        "created",
        "format",
        "body",
        "code",
        "favs",
        "count",
        "lastSign",
        "msg",
        "fav",
        "subtract",
        "updateOne",
        "$inc",
        "$set",
        "uid",
        "save",
        "updateUserInfo",
        "request",
        "findOne",
        "username",
        "tmpUser",
        "password",
        "key",
        "sign",
        "JWT_SECRET",
        "expiresIn",
        "type",
        "data",
        "expire",
        "add",
        "email",
        "name",
        "arr",
        "map",
        "item",
        "n",
        "ok",
        "changePassword",
        "compare",
        "oldPassword",
        "newPassword",
        "hash",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "const SignRecord = require('../model/SignRecord')\nconst User = require('../model/User')\nconst Utils = require('../common/Utils')\nconst { setValue } = require('../config/RedisConfig')\nconst { send } = require('../config/MailConfig')\nconst config = require('../config/index')\n\nconst moment = require('dayjs')\nconst uuid = require('uuid/v4')\nconst jwt = require('jsonwebtoken')\nconst bcrypt = require('bcrypt')\n\nasync function userSign (ctx) {\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    const record = await SignRecord.findByUid(obj._id)\n    console.log(\"userSign -> record\", record)\n    const user = await User.findByID(obj._id)\n    let newRecord = {}\n    let result = ''\n    record.created = '2020-03-14T02:54:41.000Z'\n    if (record !== null) {\n        if (moment(record.created).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD')) {\n            ctx.body = {\n                code: 500,\n                favs: user.favs,\n                count: user.count,\n                lastSign: record.created,\n                msg: '用户已经签到'\n            }\n            return\n        } else {\n            let count = user.count\n            console.log(\"userSign -> count\", count)\n            let fav = 0\n            if (moment(record.created).format('YYYY-MM-DD') === moment().subtract(1, 'days').format('YYYY-MM-DD')) {\n                count += 1\n                if (count < 5) {\n                    fav = 5\n                } else if (count >= 5 && count < 15) {\n                    fav = 10\n                } else if (count >= 15 && count < 30) {\n                    fav = 15\n                } else if (count >= 30 && count < 100) {\n                    fav = 20\n                } else if (count >= 100 && count < 365) {\n                    fav = 30\n                } else if (count >= 365) {\n                    fav = 50\n                }\n                await User.updateOne(\n                    { _id: obj._id },\n                    { $inc: { favs: fav, count: 1 } }\n                )\n                result = {\n                    favs: user.favs + fav,\n                    count: user.count + 1\n                }\n            } else {\n                fav = 5\n                await User.updateOne(\n                    { _id: obj._id },\n                    {\n                        $set: { count: 1 },\n                        $inc: { favs: fav }\n                    }\n                )\n                result = {\n                    favs: user.favs + fav,\n                    count: 1\n                }\n            }\n            newRecord = new SignRecord({\n                uid: obj._id,\n                favs: fav\n            })\n            await newRecord.save()\n        }\n    } else {\n        await User.updateOne({\n            _id: obj._id\n        },\n            {\n                $set: { count: 1 },\n                $inc: { favs: 5 }\n            })\n        newRecord = new SignRecord({\n            uid: obj._id,\n            favs: 5\n            // lastSign: moment().format('YYYY-MM-DD HH:mm:ss')\n        })\n        await newRecord.save()\n        result = {\n            favs: user.favs + 5,\n            count: 1\n        }\n    }\n    ctx.body = {\n        code: 200,\n        msg: '请求成功',\n        ...result,\n        lastSign: newRecord.created\n    }\n}\n\nasync function updateUserInfo (ctx) {\n    const { body } = ctx.request\n    console.log(\"updateUserInfo -> body\", body)\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    console.log(\"updateUserInfo -> obj\", obj)\n    const user = await User.findOne({ _id: obj._id })\n    console.log(\"updateUserInfo -> user\", user)\n    let msg = ''\n    if (body.username && body.username !== user.username) {\n        const tmpUser = await User.findOne({ username: body.username })\n        console.log(\"updateUserInfo -> tmpUser\", tmpUser)\n        if (tmpUser && tmpUser.password) {\n            ctx.body = {\n                code: 501,\n                msg: '邮箱已经注册'\n            }\n            return\n        }\n        const key = uuid()\n        setValue(\n            key,\n            jwt.sign({ _id: obj._id }, config.JWT_SECRET, {\n                expiresIn: '30m'\n            })\n        )\n        await send({\n            type: 'email',\n            data: {\n                key: key,\n                username: body.username\n            },\n            code: '',\n            expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n            email: user.username,\n            user: user.name\n        })\n        msg = '更新基本资料成功，账号修改需要邮件确认，请查收邮件'\n    }\n    const arr = ['username', 'mobile', 'password']\n    arr.map(item => {\n        delete body[item]\n    })\n    const result = await User.updateOne({ _id: obj._id }, body)\n    console.log(\"result\", result)\n    if (result.n === 1 && result.ok === 1) {\n        ctx.body = {\n            code: 200,\n            msg: msg === '' ? '更新成功' : msg\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '更新失败'\n        }\n    }\n}\n\nasync function changePassword (ctx) {\n    const { body } = ctx.request\n    console.log(\"changePassword -> body\", body)\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    const user = await User.findOne({ _id: obj._id })\n    console.log(\"changePassword -> user\", user)\n    let msg = ''\n    if (await bcrypt.compare(body.oldPassword, user.password)) {\n        body.newPassword=await bcrypt.hash(body.newPassword,5)\n        console.log(\"changePassword ->  body.newPassword\",  body.newPassword)\n        const result = await User.updateOne({ _id: obj._id }, {password:body.newPassword})\n        console.log(\"result\", result)\n        if (result.n === 1 && result.ok === 1) {\n            ctx.body = {\n                code: 200,\n                msg: msg === '' ? '更新成功' : msg\n            }\n        } else {\n            ctx.body = {\n                code: 500,\n                msg: '更新失败'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 501,\n            msg: '原来的密码填写错误'\n        }\n        return\n    }\n\n}\n\n\nmodule.exports = { userSign, updateUserInfo, changePassword }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585539689626
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/SignRecord.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/SignRecord.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/SignRecord.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/SignRecord.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "SignRecord.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst SignRecordSchema = new Schema({\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  created: {\n    type: Date\n  },\n  favs: {\n    type: Number\n  },\n  lastSign: {\n    type: Date\n  }\n});\nSignRecordSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss');\n  next();\n});\nSignRecordSchema.statics = {\n  findByUid: function (uid) {\n    return this.findOne({\n      uid: uid\n    }).sort({\n      created: -1\n    });\n  }\n};\nconst SignRecord = mongoose.model('sign_record', SignRecordSchema);\nmodule.exports = SignRecord;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNpZ25SZWNvcmQuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiU2lnblJlY29yZFNjaGVtYSIsInVpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJjcmVhdGVkIiwiRGF0ZSIsImZhdnMiLCJOdW1iZXIiLCJsYXN0U2lnbiIsInByZSIsIm5leHQiLCJmb3JtYXQiLCJzdGF0aWNzIiwiZmluZEJ5VWlkIiwiZmluZE9uZSIsInNvcnQiLCJTaWduUmVjb3JkIiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFELENBQXhCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLE9BQUQsQ0FBdEI7O0FBRUEsTUFBTUUsTUFBTSxHQUFHSCxRQUFRLENBQUNHLE1BQXhCO0FBRUEsTUFBTUMsZ0JBQWdCLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQ2hDRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEMkI7QUFFaENDLEVBQUFBLE9BQU8sRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVJO0FBQVIsR0FGdUI7QUFHaENDLEVBQUFBLElBQUksRUFBRTtBQUFFTCxJQUFBQSxJQUFJLEVBQUVNO0FBQVIsR0FIMEI7QUFJaENDLEVBQUFBLFFBQVEsRUFBRTtBQUFFUCxJQUFBQSxJQUFJLEVBQUVJO0FBQVI7QUFKc0IsQ0FBWCxDQUF6QjtBQU9BTixnQkFBZ0IsQ0FBQ1UsR0FBakIsQ0FBcUIsTUFBckIsRUFBNkIsVUFBVUMsSUFBVixFQUFnQjtBQUN6QyxPQUFLTixPQUFMLEdBQWVQLE1BQU0sR0FBR2MsTUFBVCxDQUFnQixxQkFBaEIsQ0FBZjtBQUNBRCxFQUFBQSxJQUFJO0FBQ1AsQ0FIRDtBQUtBWCxnQkFBZ0IsQ0FBQ2EsT0FBakIsR0FBMkI7QUFDdkJDLEVBQUFBLFNBQVMsRUFBRSxVQUFVYixHQUFWLEVBQWU7QUFDdEIsV0FBTyxLQUFLYyxPQUFMLENBQWE7QUFBQ2QsTUFBQUEsR0FBRyxFQUFDQTtBQUFMLEtBQWIsRUFBd0JlLElBQXhCLENBQTZCO0FBQUNYLE1BQUFBLE9BQU8sRUFBQyxDQUFDO0FBQVYsS0FBN0IsQ0FBUDtBQUNIO0FBSHNCLENBQTNCO0FBTUEsTUFBTVksVUFBVSxHQUFHckIsUUFBUSxDQUFDc0IsS0FBVCxDQUFlLGFBQWYsRUFBOEJsQixnQkFBOUIsQ0FBbkI7QUFFQW1CLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlSCxVQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL21vZGVsIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCcuLi9jb25maWcvREJIZWxwZXInKVxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWFcblxuY29uc3QgU2lnblJlY29yZFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHVpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3VzZXJzJyB9LFxuICAgIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIGZhdnM6IHsgdHlwZTogTnVtYmVyIH0sXG4gICAgbGFzdFNpZ246IHsgdHlwZTogRGF0ZSB9XG59KVxuXG5TaWduUmVjb3JkU2NoZW1hLnByZSgnc2F2ZScsIGZ1bmN0aW9uIChuZXh0KSB7XG4gICAgdGhpcy5jcmVhdGVkID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICBuZXh0KClcbn0pXG5cblNpZ25SZWNvcmRTY2hlbWEuc3RhdGljcyA9IHtcbiAgICBmaW5kQnlVaWQ6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZE9uZSh7dWlkOnVpZH0pLnNvcnQoe2NyZWF0ZWQ6LTF9KVxuICAgIH1cbn1cblxuY29uc3QgU2lnblJlY29yZCA9IG1vbmdvb3NlLm1vZGVsKCdzaWduX3JlY29yZCcsIFNpZ25SZWNvcmRTY2hlbWEpXG5cbm1vZHVsZS5leHBvcnRzPVNpZ25SZWNvcmQiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "SignRecord.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "SignRecordSchema",
        "uid",
        "type",
        "String",
        "ref",
        "created",
        "Date",
        "favs",
        "Number",
        "lastSign",
        "pre",
        "next",
        "format",
        "statics",
        "findByUid",
        "findOne",
        "sort",
        "SignRecord",
        "model",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,OAAD,CAAtB;;AAEA,MAAME,MAAM,GAAGH,QAAQ,CAACG,MAAxB;AAEA,MAAMC,gBAAgB,GAAG,IAAID,MAAJ,CAAW;AAChCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GAD2B;AAEhCC,EAAAA,OAAO,EAAE;AAAEH,IAAAA,IAAI,EAAEI;AAAR,GAFuB;AAGhCC,EAAAA,IAAI,EAAE;AAAEL,IAAAA,IAAI,EAAEM;AAAR,GAH0B;AAIhCC,EAAAA,QAAQ,EAAE;AAAEP,IAAAA,IAAI,EAAEI;AAAR;AAJsB,CAAX,CAAzB;AAOAN,gBAAgB,CAACU,GAAjB,CAAqB,MAArB,EAA6B,UAAUC,IAAV,EAAgB;AACzC,OAAKN,OAAL,GAAeP,MAAM,GAAGc,MAAT,CAAgB,qBAAhB,CAAf;AACAD,EAAAA,IAAI;AACP,CAHD;AAKAX,gBAAgB,CAACa,OAAjB,GAA2B;AACvBC,EAAAA,SAAS,EAAE,UAAUb,GAAV,EAAe;AACtB,WAAO,KAAKc,OAAL,CAAa;AAACd,MAAAA,GAAG,EAACA;AAAL,KAAb,EAAwBe,IAAxB,CAA6B;AAACX,MAAAA,OAAO,EAAC,CAAC;AAAV,KAA7B,CAAP;AACH;AAHsB,CAA3B;AAMA,MAAMY,UAAU,GAAGrB,QAAQ,CAACsB,KAAT,CAAe,aAAf,EAA8BlB,gBAA9B,CAAnB;AAEAmB,MAAM,CAACC,OAAP,GAAeH,UAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\n\nconst Schema = mongoose.Schema\n\nconst SignRecordSchema = new Schema({\n    uid: { type: String, ref: 'users' },\n    created: { type: Date },\n    favs: { type: Number },\n    lastSign: { type: Date }\n})\n\nSignRecordSchema.pre('save', function (next) {\n    this.created = moment().format('YYYY-MM-DD HH:mm:ss')\n    next()\n})\n\nSignRecordSchema.statics = {\n    findByUid: function (uid) {\n        return this.findOne({uid:uid}).sort({created:-1})\n    }\n}\n\nconst SignRecord = mongoose.model('sign_record', SignRecordSchema)\n\nmodule.exports=SignRecord"
      ]
    },
    "sourceType": "script",
    "mtime": 1584200712828
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/User.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/User.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/User.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/User.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "User.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String,\n    index: {\n      unique: true\n    },\n    sparse: true\n  },\n  name: {\n    type: String\n  },\n  password: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  updated: {\n    type: Date\n  },\n  favs: {\n    type: Number,\n    default: 100\n  },\n  gender: {\n    type: String,\n    default: ''\n  },\n  roles: {\n    type: Array,\n    default: ['user']\n  },\n  pic: {\n    type: String,\n    default: '/img/header.png'\n  },\n  mobile: {\n    type: String,\n    match: /^1[3-9](\\d{9})$/,\n    default: ''\n  },\n  status: {\n    type: String,\n    default: '0'\n  },\n  regmark: {\n    type: String,\n    default: ''\n  },\n  location: {\n    type: String,\n    default: ''\n  },\n  isVip: {\n    type: String,\n    default: '0'\n  },\n  count: {\n    type: Number,\n    default: 0\n  }\n});\nUserSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH-mm:ss');\n  next();\n});\nUserSchema.pre('update', function (next) {\n  this.updated = moment().format('YYYY-MM-DD HH-mm:ss');\n  next();\n});\nUserSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MogoError' && error.code === 11000) {\n    next(new Error('Error:Mongoose has a duplicate key.'));\n  } else {\n    next(error);\n  }\n});\nUserSchema.statics = {\n  findByID: function (id) {\n    return this.findOne({\n      _id: id\n    }, {\n      password: 0,\n      username: 0,\n      mobile: 0\n    });\n  }\n};\nconst UserModel = mongoose.model('users', UserSchema);\nmodule.exports = UserModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiVXNlclNjaGVtYSIsInVzZXJuYW1lIiwidHlwZSIsIlN0cmluZyIsImluZGV4IiwidW5pcXVlIiwic3BhcnNlIiwibmFtZSIsInBhc3N3b3JkIiwiY3JlYXRlZCIsIkRhdGUiLCJ1cGRhdGVkIiwiZmF2cyIsIk51bWJlciIsImRlZmF1bHQiLCJnZW5kZXIiLCJyb2xlcyIsIkFycmF5IiwicGljIiwibW9iaWxlIiwibWF0Y2giLCJzdGF0dXMiLCJyZWdtYXJrIiwibG9jYXRpb24iLCJpc1ZpcCIsImNvdW50IiwicHJlIiwibmV4dCIsImZvcm1hdCIsInBvc3QiLCJlcnJvciIsImRvYyIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJmaW5kQnlJRCIsImlkIiwiZmluZE9uZSIsIl9pZCIsIlVzZXJNb2RlbCIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUF4Qjs7QUFDQSxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxPQUFELENBQXRCOztBQUNBLE1BQU1FLE1BQU0sR0FBQ0gsUUFBUSxDQUFDRyxNQUF0QjtBQUVBLE1BQU1DLFVBQVUsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDMUJFLEVBQUFBLFFBQVEsRUFBQztBQUFDQyxJQUFBQSxJQUFJLEVBQUNDLE1BQU47QUFBYUMsSUFBQUEsS0FBSyxFQUFDO0FBQUVDLE1BQUFBLE1BQU0sRUFBQztBQUFULEtBQW5CO0FBQWtDQyxJQUFBQSxNQUFNLEVBQUM7QUFBekMsR0FEaUI7QUFFMUJDLEVBQUFBLElBQUksRUFBQztBQUFDTCxJQUFBQSxJQUFJLEVBQUNDO0FBQU4sR0FGcUI7QUFHMUJLLEVBQUFBLFFBQVEsRUFBQztBQUFDTixJQUFBQSxJQUFJLEVBQUNDO0FBQU4sR0FIaUI7QUFJMUJNLEVBQUFB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QUF0QixDQUFQO0FBS0g7QUFQZ0IsQ0FBckI7QUFVQSxNQUFNb0IsU0FBUyxHQUFDM0MsUUFBUSxDQUFDNEMsS0FBVCxDQUFlLE9BQWYsRUFBdUJ4QyxVQUF2QixDQUFoQjtBQUNBeUMsTUFBTSxDQUFDQyxPQUFQLEdBQWVILFNBQWYiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9EQkhlbHBlcicpXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCBTY2hlbWE9bW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgICB1c2VybmFtZTp7dHlwZTpTdHJpbmcsaW5kZXg6eyB1bmlxdWU6dHJ1ZX0sc3BhcnNlOnRydWV9LFxuICAgIG5hbWU6e3R5cGU6U3RyaW5nfSxcbiAgICBwYXNzd29yZDp7dHlwZTpTdHJpbmd9LFxuICAgIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIHVwZGF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIGZhdnM6IHsgdHlwZTogTnVtYmVyLGRlZmF1bHQ6MTAwIH0sXG4gICAgZ2VuZGVyOiB7IHR5cGU6IFN0cmluZyxkZWZhdWx0OicnIH0sXG4gICAgcm9sZXM6IHsgdHlwZTogQXJyYXksZGVmYXVsdDpbJ3VzZXInXSB9LFxuICAgIHBpYzogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonL2ltZy9oZWFkZXIucG5nJyB9LFxuICAgIG1vYmlsZTogeyB0eXBlOiBTdHJpbmcsbWF0Y2g6L14xWzMtOV0oXFxkezl9KSQvLGRlZmF1bHQ6JycgfSxcbiAgICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nLGRlZmF1bHQ6JzAnIH0sXG4gICAgcmVnbWFyazogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonJyB9LFxuICAgIGxvY2F0aW9uOiB7IHR5cGU6IFN0cmluZyxkZWZhdWx0OicnIH0sXG4gICAgaXNWaXA6IHsgdHlwZTogU3RyaW5nLGRlZmF1bHQ6JzAnIH0sXG4gICAgY291bnQ6IHsgdHlwZTogTnVtYmVyLGRlZmF1bHQ6MCB9LFxufSlcblxuVXNlclNjaGVtYS5wcmUoJ3NhdmUnLGZ1bmN0aW9uKG5leHQpe1xuICAgIHRoaXMuY3JlYXRlZD1tb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEgtbW06c3MnKVxuICAgIG5leHQoKVxufSlcblxuVXNlclNjaGVtYS5wcmUoJ3VwZGF0ZScsZnVuY3Rpb24obmV4dCl7XG4gICAgdGhpcy51cGRhdGVkPW1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCBISC1tbTpzcycpXG4gICAgbmV4dCgpXG59KVxuXG5Vc2VyU2NoZW1hLnBvc3QoJ3NhdmUnLGZ1bmN0aW9uKGVycm9yLGRvYyxuZXh0KXtcbiAgICBpZihlcnJvci5uYW1lID09PSAnTW9nb0Vycm9yJyAmJiBlcnJvci5jb2RlPT09MTEwMDApe1xuICAgICAgICBuZXh0KG5ldyBFcnJvcignRXJyb3I6TW9uZ29vc2UgaGFzIGEgZHVwbGljYXRlIGtleS4nKSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0KGVycm9yKVxuICAgIH1cbn0pXG5cblVzZXJTY2hlbWEuc3RhdGljcyA9IHtcbiAgICBmaW5kQnlJRDogZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZE9uZSh7X2lkOmlkfSx7XG4gICAgICAgICAgICBwYXNzd29yZDogMCxcbiAgICAgICAgICAgIHVzZXJuYW1lOjAsXG4gICAgICAgICAgICBtb2JpbGU6MFxuICAgICAgICB9KVxuICAgIH1cbn1cblxuY29uc3QgVXNlck1vZGVsPW1vbmdvb3NlLm1vZGVsKCd1c2VycycsVXNlclNjaGVtYSlcbm1vZHVsZS5leHBvcnRzPVVzZXJNb2RlbCJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "User.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "UserSchema",
        "username",
        "type",
        "String",
        "index",
        "unique",
        "sparse",
        "name",
        "password",
        "created",
        "Date",
        "updated",
        "favs",
        "Number",
        "default",
        "gender",
        "roles",
        "Array",
        "pic",
        "mobile",
        "match",
        "status",
        "regmark",
        "location",
        "isVip",
        "count",
        "pre",
        "next",
        "format",
        "post",
        "error",
        "doc",
        "code",
        "Error",
        "statics",
        "findByID",
        "id",
        "findOne",
        "_id",
        "UserModel",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\nconst Schema=mongoose.Schema\n\nconst UserSchema = new Schema({\n    username:{type:String,index:{ unique:true},sparse:true},\n    name:{type:String},\n    password:{type:String},\n    created: { type: Date },\n    updated: { type: Date },\n    favs: { type: Number,default:100 },\n    gender: { type: String,default:'' },\n    roles: { type: Array,default:['user'] },\n    pic: { type: String,default:'/img/header.png' },\n    mobile: { type: String,match:/^1[3-9](\\d{9})$/,default:'' },\n    status: { type: String,default:'0' },\n    regmark: { type: String,default:'' },\n    location: { type: String,default:'' },\n    isVip: { type: String,default:'0' },\n    count: { type: Number,default:0 },\n})\n\nUserSchema.pre('save',function(next){\n    this.created=moment().format('YYYY-MM-DD HH-mm:ss')\n    next()\n})\n\nUserSchema.pre('update',function(next){\n    this.updated=moment().format('YYYY-MM-DD HH-mm:ss')\n    next()\n})\n\nUserSchema.post('save',function(error,doc,next){\n    if(error.name === 'MogoError' && error.code===11000){\n        next(new Error('Error:Mongoose has a duplicate key.'))\n    } else {\n        next(error)\n    }\n})\n\nUserSchema.statics = {\n    findByID: function(id) {\n        return this.findOne({_id:id},{\n            password: 0,\n            username:0,\n            mobile:0\n        })\n    }\n}\n\nconst UserModel=mongoose.model('users',UserSchema)\nmodule.exports=UserModel"
      ]
    },
    "sourceType": "script",
    "mtime": 1584241321797
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/Utils.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/Utils.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/Utils.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/Utils.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
        "sourceFileName": "Utils.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst redisConfig = require('../config/RedisConfig');\n\nconst config = require('../config/index');\n\nconst jwt = require('jsonwebtoken');\n\nvar getJWTPayload = function (token) {\n  console.log(\"secret->secret\", token.split('')[1]);\n  return jwt.verify(token.split(' ')[1], config.JWT_SECRET);\n};\n\nasync function checkCode(key, value) {\n  console.log(\"checkCode -> checkCode\", checkCode);\n  const redisData = await redisConfig.getValue(key);\n  console.log(\"checkCode -> redisData\", redisData);\n\n  if (redisData != null) {\n    debugger;\n\n    if (redisData.toLowerCase() === value.toLowerCase()) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n}\n\nexports.getJWTPayload = getJWTPayload;\nexports.checkCode = checkCode;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlV0aWxzLmpzIl0sIm5hbWVzIjpbInJlZGlzQ29uZmlnIiwicmVxdWlyZSIsImNvbmZpZyIsImp3dCIsImdldEpXVFBheWxvYWQiLCJ0b2tlbiIsImNvbnNvbGUiLCJsb2ciLCJzcGxpdCIsInZlcmlmeSIsIkpXVF9TRUNSRVQiLCJjaGVja0NvZGUiLCJrZXkiLCJ2YWx1ZSIsInJlZGlzRGF0YSIsImdldFZhbHVlIiwidG9Mb3dlckNhc2UiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFdBQVcsR0FBR0MsT0FBTyxDQUFDLHVCQUFELENBQTNCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLGlCQUFELENBQXRCOztBQUNBLE1BQU1FLEdBQUcsR0FBR0YsT0FBTyxDQUFDLGNBQUQsQ0FBbkI7O0FBRUEsSUFBSUcsYUFBYSxHQUFHLFVBQVVDLEtBQVYsRUFBaUI7QUFDakNDLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdCQUFaLEVBQThCRixLQUFLLENBQUNHLEtBQU4sQ0FBWSxFQUFaLEVBQWdCLENBQWhCLENBQTlCO0FBQ0EsU0FBT0wsR0FBRyxDQUFDTSxNQUFKLENBQVdKLEtBQUssQ0FBQ0csS0FBTixDQUFZLEdBQVosRUFBaUIsQ0FBakIsQ0FBWCxFQUFnQ04sTUFBTSxDQUFDUSxVQUF2QyxDQUFQO0FBQ0gsQ0FIRDs7QUFLQSxlQUFlQyxTQUFmLENBQTBCQyxHQUExQixFQUErQkMsS0FBL0IsRUFBc0M7QUFDbENQLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaLEVBQXNDSSxTQUF0QztBQUNBLFFBQU1HLFNBQVMsR0FBRyxNQUFNZCxXQUFXLENBQUNlLFFBQVosQ0FBcUJILEdBQXJCLENBQXhCO0FBQ0FOLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaLEVBQXNDTyxTQUF0Qzs7QUFDQSxNQUFJQSxTQUFTLElBQUksSUFBakIsRUFBdUI7QUFDbkI7O0FBQ0EsUUFBSUEsU0FBUyxDQUFDRSxXQUFWLE9BQTRCSCxLQUFLLENBQUNHLFdBQU4sRUFBaEMsRUFBcUQ7QUFDakQsYUFBTyxJQUFQO0FBQ0gsS0FGRCxNQUVPO0FBQ0gsYUFBTyxLQUFQO0FBQ0g7QUFDSixHQVBELE1BT087QUFDSCxXQUFPLEtBQVA7QUFDSDtBQUNKOztBQUVEQyxPQUFPLENBQUNiLGFBQVIsR0FBd0JBLGFBQXhCO0FBQ0FhLE9BQU8sQ0FBQ04sU0FBUixHQUFvQkEsU0FBcEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvY29tbW9uIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcmVkaXNDb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcvUmVkaXNDb25maWcnKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4JylcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpXG5cbnZhciBnZXRKV1RQYXlsb2FkID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgY29uc29sZS5sb2coXCJzZWNyZXQtPnNlY3JldFwiLCB0b2tlbi5zcGxpdCgnJylbMV0pXG4gICAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4uc3BsaXQoJyAnKVsxXSwgY29uZmlnLkpXVF9TRUNSRVQpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrQ29kZSAoa2V5LCB2YWx1ZSkge1xuICAgIGNvbnNvbGUubG9nKFwiY2hlY2tDb2RlIC0+IGNoZWNrQ29kZVwiLCBjaGVja0NvZGUpXG4gICAgY29uc3QgcmVkaXNEYXRhID0gYXdhaXQgcmVkaXNDb25maWcuZ2V0VmFsdWUoa2V5KVxuICAgIGNvbnNvbGUubG9nKFwiY2hlY2tDb2RlIC0+IHJlZGlzRGF0YVwiLCByZWRpc0RhdGEpXG4gICAgaWYgKHJlZGlzRGF0YSAhPSBudWxsKSB7XG4gICAgICAgIGRlYnVnZ2VyXG4gICAgICAgIGlmIChyZWRpc0RhdGEudG9Mb3dlckNhc2UoKSA9PT0gdmFsdWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxufVxuXG5leHBvcnRzLmdldEpXVFBheWxvYWQgPSBnZXRKV1RQYXlsb2FkO1xuZXhwb3J0cy5jaGVja0NvZGUgPSBjaGVja0NvZGU7Il19",
    "map": {
      "version": 3,
      "sources": [
        "Utils.js"
      ],
      "names": [
        "redisConfig",
        "require",
        "config",
        "jwt",
        "getJWTPayload",
        "token",
        "console",
        "log",
        "split",
        "verify",
        "JWT_SECRET",
        "checkCode",
        "key",
        "value",
        "redisData",
        "getValue",
        "toLowerCase",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,WAAW,GAAGC,OAAO,CAAC,uBAAD,CAA3B;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,iBAAD,CAAtB;;AACA,MAAME,GAAG,GAAGF,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAIG,aAAa,GAAG,UAAUC,KAAV,EAAiB;AACjCC,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,KAAK,CAACG,KAAN,CAAY,EAAZ,EAAgB,CAAhB,CAA9B;AACA,SAAOL,GAAG,CAACM,MAAJ,CAAWJ,KAAK,CAACG,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAX,EAAgCN,MAAM,CAACQ,UAAvC,CAAP;AACH,CAHD;;AAKA,eAAeC,SAAf,CAA0BC,GAA1B,EAA+BC,KAA/B,EAAsC;AAClCP,EAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCI,SAAtC;AACA,QAAMG,SAAS,GAAG,MAAMd,WAAW,CAACe,QAAZ,CAAqBH,GAArB,CAAxB;AACAN,EAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCO,SAAtC;;AACA,MAAIA,SAAS,IAAI,IAAjB,EAAuB;AACnB;;AACA,QAAIA,SAAS,CAACE,WAAV,OAA4BH,KAAK,CAACG,WAAN,EAAhC,EAAqD;AACjD,aAAO,IAAP;AACH,KAFD,MAEO;AACH,aAAO,KAAP;AACH;AACJ,GAPD,MAOO;AACH,WAAO,KAAP;AACH;AACJ;;AAEDC,OAAO,CAACb,aAAR,GAAwBA,aAAxB;AACAa,OAAO,CAACN,SAAR,GAAoBA,SAApB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
      "sourcesContent": [
        "const redisConfig = require('../config/RedisConfig')\nconst config = require('../config/index')\nconst jwt = require('jsonwebtoken')\n\nvar getJWTPayload = function (token) {\n    console.log(\"secret->secret\", token.split('')[1])\n    return jwt.verify(token.split(' ')[1], config.JWT_SECRET)\n}\n\nasync function checkCode (key, value) {\n    console.log(\"checkCode -> checkCode\", checkCode)\n    const redisData = await redisConfig.getValue(key)\n    console.log(\"checkCode -> redisData\", redisData)\n    if (redisData != null) {\n        debugger\n        if (redisData.toLowerCase() === value.toLowerCase()) {\n            return true\n        } else {\n            return false\n        }\n    } else {\n        return false\n    }\n}\n\nexports.getJWTPayload = getJWTPayload;\nexports.checkCode = checkCode;"
      ]
    },
    "sourceType": "script",
    "mtime": 1584589663148
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/index.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst path = require('path');\n\nconst DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb';\nconst REDIS = {\n  host: '47.99.202.255',\n  port: 15001,\n  password: '123456'\n};\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'none' : 'http://localhost:8080';\nconst uploadPath = process.env.NODE_ENV === 'production' ? '/app/public' : path.join(path.resolve(__dirname), '../../public');\nconst JWT_SECRET = 'onedaythisismyfuture'; // 本来是一个编码后的值，这里使用了随机写的字母\n// export default {\n//     DB_URL,\n//     REDIS\n// }\n\nmodule.exports = {\n  DB_URL,\n  REDIS,\n  uploadPath,\n  JWT_SECRET,\n  baseUrl\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInBhdGgiLCJyZXF1aXJlIiwiREJfVVJMIiwiUkVESVMiLCJob3N0IiwicG9ydCIsInBhc3N3b3JkIiwiYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInVwbG9hZFBhdGgiLCJqb2luIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsIkpXVF9TRUNSRVQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBRUEsTUFBTUMsTUFBTSxHQUFHLGtEQUFmO0FBQ0EsTUFBTUMsS0FBSyxHQUFHO0FBQ1ZDLEVBQUFBLElBQUksRUFBRSxlQURJO0FBRVZDLEVBQUFBLElBQUksRUFBRSxLQUZJO0FBR1ZDLEVBQUFBLFFBQVEsRUFBRTtBQUhBLENBQWQ7QUFLQSxNQUFNQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxRQUFaLEtBQXlCLFlBQXpCLEdBQXdDLE1BQXhDLEdBQWlELHVCQUFqRTtBQUNBLE1BQU1DLFVBQVUsR0FBR0gsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFFBQVosS0FBeUIsWUFBekIsR0FBd0MsYUFBeEMsR0FBd0RWLElBQUksQ0FBQ1ksSUFBTCxDQUFVWixJQUFJLENBQUNhLE9BQUwsQ0FBYUMsU0FBYixDQUFWLEVBQW1DLGNBQW5DLENBQTNFO0FBQ0EsTUFBTUMsVUFBVSxHQUFHLHNCQUFuQixDLENBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBOztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRWYsRUFBQUEsTUFBRjtBQUFVQyxFQUFBQSxLQUFWO0FBQWlCUSxFQUFBQSxVQUFqQjtBQUE2QkksRUFBQUEsVUFBN0I7QUFBeUNSLEVBQUFBO0FBQXpDLENBQWpCIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL2NvbmZpZyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJylcblxuY29uc3QgREJfVVJMID0gJ21vbmdvZGI6Ly90ZXN0OjEyMzQ1NkA0Ny45OS4yMDIuMjU1OjE1MDAxL3Rlc3RkYidcbmNvbnN0IFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAxNTAwMSxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cbmNvbnN0IGJhc2VVcmwgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJ25vbmUnIDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MCdcbmNvbnN0IHVwbG9hZFBhdGggPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJy9hcHAvcHVibGljJyA6IHBhdGguam9pbihwYXRoLnJlc29sdmUoX19kaXJuYW1lKSwgJy4uLy4uL3B1YmxpYycpXG5jb25zdCBKV1RfU0VDUkVUID0gJ29uZWRheXRoaXNpc215ZnV0dXJlJyAgLy8g5pys5p2l5piv5LiA5Liq57yW56CB5ZCO55qE5YC877yM6L+Z6YeM5L2/55So5LqG6ZqP5py65YaZ55qE5a2X5q+NXG4vLyBleHBvcnQgZGVmYXVsdCB7XG4vLyAgICAgREJfVVJMLFxuLy8gICAgIFJFRElTXG4vLyB9XG5cbm1vZHVsZS5leHBvcnRzID0geyBEQl9VUkwsIFJFRElTLCB1cGxvYWRQYXRoLCBKV1RfU0VDUkVULCBiYXNlVXJsIH0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "path",
        "require",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "baseUrl",
        "process",
        "env",
        "NODE_ENV",
        "uploadPath",
        "join",
        "resolve",
        "__dirname",
        "JWT_SECRET",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AAEA,MAAMC,MAAM,GAAG,kDAAf;AACA,MAAMC,KAAK,GAAG;AACVC,EAAAA,IAAI,EAAE,eADI;AAEVC,EAAAA,IAAI,EAAE,KAFI;AAGVC,EAAAA,QAAQ,EAAE;AAHA,CAAd;AAKA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,MAAxC,GAAiD,uBAAjE;AACA,MAAMC,UAAU,GAAGH,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,aAAxC,GAAwDV,IAAI,CAACY,IAAL,CAAUZ,IAAI,CAACa,OAAL,CAAaC,SAAb,CAAV,EAAmC,cAAnC,CAA3E;AACA,MAAMC,UAAU,GAAG,sBAAnB,C,CAA2C;AAC3C;AACA;AACA;AACA;;AAEAC,MAAM,CAACC,OAAP,GAAiB;AAAEf,EAAAA,MAAF;AAAUC,EAAAA,KAAV;AAAiBQ,EAAAA,UAAjB;AAA6BI,EAAAA,UAA7B;AAAyCR,EAAAA;AAAzC,CAAjB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "sourcesContent": [
        "const path = require('path')\n\nconst DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb'\nconst REDIS = {\n    host: '47.99.202.255',\n    port: 15001,\n    password: '123456'\n}\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'none' : 'http://localhost:8080'\nconst uploadPath = process.env.NODE_ENV === 'production' ? '/app/public' : path.join(path.resolve(__dirname), '../../public')\nconst JWT_SECRET = 'onedaythisismyfuture'  // 本来是一个编码后的值，这里使用了随机写的字母\n// export default {\n//     DB_URL,\n//     REDIS\n// }\n\nmodule.exports = { DB_URL, REDIS, uploadPath, JWT_SECRET, baseUrl }"
      ]
    },
    "sourceType": "script",
    "mtime": 1584430968349
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/loginRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/loginRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/loginRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/loginRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "loginRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst loginController = require('../../api/LoginController');\n\nconst router = new Router();\nrouter.prefix('/login'); // router.post('/forget',loginController.forget)\n\nrouter.post('/login', loginController.login);\nrouter.post('/reg', loginController.reg);\nrouter.post('/forget', loginController.forget);\nrouter.post('/reset', loginController.reset);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luUm91dGVyLmpzIl0sIm5hbWVzIjpbIlJvdXRlciIsInJlcXVpcmUiLCJsb2dpbkNvbnRyb2xsZXIiLCJyb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibG9naW4iLCJyZWciLCJmb3JnZXQiLCJyZXNldCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsTUFBTSxHQUFDQyxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxlQUFlLEdBQUNELE9BQU8sQ0FBQywyQkFBRCxDQUE3Qjs7QUFFQSxNQUFNRSxNQUFNLEdBQUMsSUFBSUgsTUFBSixFQUFiO0FBRUFHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFFBQWQsRSxDQUNBOztBQUNBRCxNQUFNLENBQUNFLElBQVAsQ0FBWSxRQUFaLEVBQXFCSCxlQUFlLENBQUNJLEtBQXJDO0FBQ0FILE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLE1BQVosRUFBbUJILGVBQWUsQ0FBQ0ssR0FBbkM7QUFDQUosTUFBTSxDQUFDRSxJQUFQLENBQVksU0FBWixFQUFzQkgsZUFBZSxDQUFDTSxNQUF0QztBQUNBTCxNQUFNLENBQUNFLElBQVAsQ0FBWSxRQUFaLEVBQXFCSCxlQUFlLENBQUNPLEtBQXJDO0FBRUFDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFnQlIsTUFBaEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvcm91dGVzL21vZHVsZXMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBSb3V0ZXI9cmVxdWlyZSgna29hLXJvdXRlcicpXG5jb25zdCBsb2dpbkNvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL0xvZ2luQ29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcblxucm91dGVyLnByZWZpeCgnL2xvZ2luJylcbi8vIHJvdXRlci5wb3N0KCcvZm9yZ2V0Jyxsb2dpbkNvbnRyb2xsZXIuZm9yZ2V0KVxucm91dGVyLnBvc3QoJy9sb2dpbicsbG9naW5Db250cm9sbGVyLmxvZ2luKVxucm91dGVyLnBvc3QoJy9yZWcnLGxvZ2luQ29udHJvbGxlci5yZWcpXG5yb3V0ZXIucG9zdCgnL2ZvcmdldCcsbG9naW5Db250cm9sbGVyLmZvcmdldClcbnJvdXRlci5wb3N0KCcvcmVzZXQnLGxvZ2luQ29udHJvbGxlci5yZXNldClcblxubW9kdWxlLmV4cG9ydHM9IHJvdXRlciJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "loginRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "loginController",
        "router",
        "prefix",
        "post",
        "login",
        "reg",
        "forget",
        "reset",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,eAAe,GAACD,OAAO,CAAC,2BAAD,CAA7B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AAEAG,MAAM,CAACC,MAAP,CAAc,QAAd,E,CACA;;AACAD,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,eAAe,CAACI,KAArC;AACAH,MAAM,CAACE,IAAP,CAAY,MAAZ,EAAmBH,eAAe,CAACK,GAAnC;AACAJ,MAAM,CAACE,IAAP,CAAY,SAAZ,EAAsBH,eAAe,CAACM,MAAtC;AACAL,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,eAAe,CAACO,KAArC;AAEAC,MAAM,CAACC,OAAP,GAAgBR,MAAhB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst loginController=require('../../api/LoginController')\n\nconst router=new Router()\n\nrouter.prefix('/login')\n// router.post('/forget',loginController.forget)\nrouter.post('/login',loginController.login)\nrouter.post('/reg',loginController.reg)\nrouter.post('/forget',loginController.forget)\nrouter.post('/reset',loginController.reset)\n\nmodule.exports= router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585404263267
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/LoginController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/LoginController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/LoginController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/LoginController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "LoginController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst send = require('../config/MailConfig.js');\n\nconst bcrypt = require('bcrypt');\n\nconst moment = require('dayjs');\n\nconst jsonwebtoken = require('jsonwebtoken');\n\nconst config = require('../config/index'); // const checkCode=require('../common/Utils')\n\n\nconst Utils = require('../common/Utils');\n\nconst User = require('../model/User');\n\nconst forget = function (ctx) {\n  const {\n    body\n  } = ctx.request;\n\n  if (typeof body.username !== 'undefined') {\n    try {\n      let result = send({\n        code: '1234',\n        expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n        email: body.username,\n        user: 'echo'\n      });\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: '邮件发送成功'\n      };\n    } catch (e) {\n      console.log(e);\n    }\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '服务器异常'\n    };\n  }\n};\n\nasync function login(ctx) {\n  const {\n    body\n  } = ctx.request;\n  let sid = body.sid;\n  let code = body.code;\n  let result = await Utils.checkCode(sid, code);\n  console.log(result);\n\n  if (result) {\n    let checkUserPasswd = false;\n    let user = await User.findOne({\n      username: body.username\n    });\n\n    if (await bcrypt.compare(body.password, user.password)) {\n      checkUserPasswd = true;\n    }\n\n    if (checkUserPasswd) {\n      const userObj = user.toJSON();\n      const arr = ['password']; //和源码有不同，这里没有删除邮箱了。\n\n      arr.map(item => {\n        delete userObj[item];\n      });\n      let token = jsonwebtoken.sign({\n        _id: userObj._id\n      }, config.JWT_SECRET, {\n        expiresIn: '1d'\n      }); //\n\n      ctx.body = {\n        code: 200,\n        data: userObj,\n        token: token\n      };\n    } else {\n      ctx.body = {\n        code: 404,\n        msg: '用户名或密码错误'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 401,\n      msg: '图片验证码不正确，请检查！'\n    };\n  }\n}\n\nasync function reg(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"reg -> body\", body);\n  let sid = body.sid;\n  let code = body.code;\n  let msg = {};\n  let result = await Utils.checkCode(sid, code);\n  console.log(\"result:\" + result);\n  let check = true;\n\n  if (result) {\n    let user1 = await User.findOne({\n      username: body.username\n    });\n\n    if (user1 !== null && typeof user1.username !== 'undefined') {\n      console.log(\"user1\" + user1);\n      msg.username = ['此邮箱已经被注册，可以通过邮箱找回密码'];\n      check = false;\n    }\n\n    check = true;\n    let user2 = await User.findOne({\n      name: body.name\n    });\n\n    if (user2 !== null && typeof user2.name !== 'undefined') {\n      msg.name = ['此昵称已经被注册，请修改'];\n      check = false;\n    }\n\n    if (check) {\n      body.password = await bcrypt.hash(body.password, 5);\n      let user = new User({\n        username: body.username,\n        name: body.name,\n        password: body.password,\n        created: moment().format('YYYY-MM-DD HH:mm:ss')\n      });\n      let result = await user.save();\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: '注册成功'\n      };\n      return;\n    }\n  } else {\n    msg.code = ['验证码已经失效，请重新获取！'];\n  }\n\n  ctx.body = {\n    code: 500,\n    msg: msg\n  };\n}\n\nasync function reset(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"reset -> body\", body, body.username);\n  let sid = body.sid;\n  let code = body.code;\n  let msg = {};\n  const result = await Utils.checkCode(sid, code);\n\n  if (result) {\n    let user = await User.findOne({\n      username: body.username\n    });\n\n    if (user === null && user.username === 'undefined') {\n      msg.username = ['此邮箱未注册，请确认'];\n      ctx.body = {\n        code: 500,\n        msg: msg\n      };\n    } else {\n      user.password = await bcrypt.hash(body.password, 5);\n      user.updated = moment().format('YYYY-MM-DD HH:mm:ss');\n      let result = await user.save();\n      const userObj = result.toJSON();\n      const arr = ['password'];\n      arr.map(item => {\n        delete userObj[item];\n      });\n      let token = jsonwebtoken.sign({\n        _id: userObj._id\n      }, config.JWT_SECRET, {\n        expiresIn: '1d'\n      }); //\n\n      ctx.body = {\n        code: 200,\n        data: userObj,\n        token: token,\n        msg: '更新密码成功！'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 401,\n      msg: '图片验证码不正确，请检查！'\n    };\n  }\n}\n\nmodule.exports = {\n  forget,\n  login,\n  reg,\n  reset\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxvZ2luQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJzZW5kIiwicmVxdWlyZSIsImJjcnlwdCIsIm1vbWVudCIsImpzb253ZWJ0b2tlbiIsImNvbmZpZyIsIlV0aWxzIiwiVXNlciIsImZvcmdldCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwidXNlcm5hbWUiLCJyZXN1bHQiLCJjb2RlIiwiZXhwaXJlIiwiYWRkIiwiZm9ybWF0IiwiZW1haWwiLCJ1c2VyIiwiZGF0YSIsIm1zZyIsImUiLCJjb25zb2xlIiwibG9nIiwibG9naW4iLCJzaWQiLCJjaGVja0NvZGUiLCJjaGVja1VzZXJQYXNzd2QiLCJmaW5kT25lIiwiY29tcGFyZSIsInBhc3N3b3JkIiwidXNlck9iaiIsInRvSlNPTiIsImFyciIsIm1hcCIsIml0ZW0iLCJ0b2tlbiIsInNpZ24iLCJfaWQiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwicmVnIiwiY2hlY2siLCJ1c2VyMSIsInVzZXIyIiwibmFtZSIsImhhc2giLCJjcmVhdGVkIiwic2F2ZSIsInJlc2V0IiwidXBkYXRlZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMseUJBQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxPQUFELENBQXRCOztBQUNBLE1BQU1HLFlBQVksR0FBR0gsT0FBTyxDQUFDLGNBQUQsQ0FBNUI7O0FBQ0EsTUFBTUksTUFBTSxHQUFHSixPQUFPLENBQUMsaUJBQUQsQ0FBdEIsQyxDQUNBOzs7QUFDQSxNQUFNSyxLQUFLLEdBQUdMLE9BQU8sQ0FBQyxpQkFBRCxDQUFyQjs7QUFDQSxNQUFNTSxJQUFJLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQXBCOztBQUVBLE1BQU1PLE1BQU0sR0FBRyxVQUFVQyxHQUFWLEVBQWU7QUFDMUIsUUFBTTtB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R2MsTUFBVCxDQUFnQixxQkFBaEIsQ0FBYjtBQUNBLFVBQUlKLE1BQU0sR0FBRyxNQUFNTSxJQUFJLENBQUM4QixJQUFMLEVBQW5CO0FBQ0EsWUFBTWpCLE9BQU8sR0FBR25CLE1BQU0sQ0FBQ29CLE1BQVAsRUFBaEI7QUFDQSxZQUFNQyxHQUFHLEdBQUcsQ0FBQyxVQUFELENBQVo7QUFDQUEsTUFBQUEsR0FBRyxDQUFDQyxHQUFKLENBQVNDLElBQUQsSUFBVTtBQUNkLGVBQU9KLE9BQU8sQ0FBQ0ksSUFBRCxDQUFkO0FBQ0gsT0FGRDtBQUdBLFVBQUlDLEtBQUssR0FBR2pDLFlBQVksQ0FBQ2tDLElBQWIsQ0FBa0I7QUFBRUMsUUFBQUEsR0FBRyxFQUFFUCxPQUFPLENBQUNPO0FBQWYsT0FBbEIsRUFBd0NsQyxNQUFNLENBQUNtQyxVQUEvQyxFQUEyRDtBQUFFQyxRQUFBQSxTQUFTLEVBQUU7QUFBYixPQUEzRCxDQUFaLENBVEcsQ0FTeUY7O0FBQzVGaEMsTUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEksUUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUE0sUUFBQUEsSUFBSSxFQUFFWSxPQUZDO0FBR1BLLFFBQUFBLEtBQUssRUFBRUEsS0FIQTtBQUlQaEIsUUFBQUEsR0FBRyxFQUFDO0FBSkcsT0FBWDtBQU1IO0FBQ0osR0F6QkQsTUF5Qk87QUFDSFosSUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEksTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUE8sTUFBQUEsR0FBRyxFQUFFO0FBRkUsS0FBWDtBQUlIO0FBQ0o7O0FBRUQrQixNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRTdDLEVBQUFBLE1BQUY7QUFBVWlCLEVBQUFBLEtBQVY7QUFBaUJpQixFQUFBQSxHQUFqQjtBQUFzQlEsRUFBQUE7QUFBdEIsQ0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvYXBpIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2VuZCA9IHJlcXVpcmUoJy4uL2NvbmZpZy9NYWlsQ29uZmlnLmpzJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCBqc29ud2VidG9rZW4gPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4Jylcbi8vIGNvbnN0IGNoZWNrQ29kZT1yZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXRpbHMgPSByZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXInKVxuXG5jb25zdCBmb3JnZXQgPSBmdW5jdGlvbiAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGlmICh0eXBlb2YgYm9keS51c2VybmFtZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBzZW5kKHtcbiAgICAgICAgICAgICAgICBjb2RlOiAnMTIzNCcsXG4gICAgICAgICAgICAgICAgZXhwaXJlOiBtb21lbnQoKS5hZGQoMzAsICdtaW51dGVzJykuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyksXG4gICAgICAgICAgICAgICAgZW1haWw6IGJvZHkudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgdXNlcjogJ2VjaG8nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgbXNnOiAn6YKu5Lu25Y+R6YCB5oiQ5YqfJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmnI3liqHlmajlvILluLgnXG4gICAgICAgIH1cbiAgICB9XG59XG5hc3luYyBmdW5jdGlvbiBsb2dpbiAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGxldCBzaWQgPSBib2R5LnNpZFxuICAgIGxldCBjb2RlID0gYm9keS5jb2RlXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IFV0aWxzLmNoZWNrQ29kZShzaWQsIGNvZGUpXG4gICAgY29uc29sZS5sb2cocmVzdWx0KVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgbGV0IGNoZWNrVXNlclBhc3N3ZCA9IGZhbHNlXG4gICAgICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWUgfSlcbiAgICAgICAgaWYgKGF3YWl0IGJjcnlwdC5jb21wYXJlKGJvZHkucGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpKSB7XG4gICAgICAgICAgICBjaGVja1VzZXJQYXNzd2QgPSB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoZWNrVXNlclBhc3N3ZCkge1xuICAgICAgICAgICAgY29uc3QgdXNlck9iaiA9IHVzZXIudG9KU09OKClcbiAgICAgICAgICAgIGNvbnN0IGFyciA9IFsncGFzc3dvcmQnXSAvL+WSjOa6kOeggeacieS4jeWQjO+8jOi/memHjOayoeacieWIoOmZpOmCrueuseS6huOAglxuICAgICAgICAgICAgYXJyLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB1c2VyT2JqW2l0ZW1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgbGV0IHRva2VuID0ganNvbndlYnRva2VuLnNpZ24oeyBfaWQ6IHVzZXJPYmouX2lkIH0sIGNvbmZpZy5KV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogJzFkJyB9KSAvL1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogMjAwLFxuICAgICAgICAgICAgICAgIGRhdGE6IHVzZXJPYmosXG4gICAgICAgICAgICAgICAgdG9rZW46IHRva2VuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA0MDQsXG4gICAgICAgICAgICAgICAgbXNnOiAn55So5oi35ZCN5oiW5a+G56CB6ZSZ6K+vJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA0MDEsXG4gICAgICAgICAgICBtc2c6ICflm77niYfpqozor4HnoIHkuI3mraPnoa7vvIzor7fmo4Dmn6XvvIEnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlZyAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwicmVnIC0+IGJvZHlcIiwgYm9keSlcbiAgICBsZXQgc2lkID0gYm9keS5zaWRcbiAgICBsZXQgY29kZSA9IGJvZHkuY29kZVxuICAgIGxldCBtc2cgPSB7fVxuICAgIGxldCByZXN1bHQgPSBhd2FpdCBVdGlscy5jaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGNvbnNvbGUubG9nKFwicmVzdWx0OlwiICsgcmVzdWx0KVxuICAgIGxldCBjaGVjayA9IHRydWVcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGxldCB1c2VyMSA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lOiBib2R5LnVzZXJuYW1lIH0pXG4gICAgICAgIGlmICh1c2VyMSAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjEudXNlcm5hbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIxXCIgKyB1c2VyMSlcbiAgICAgICAgICAgIG1zZy51c2VybmFtZSA9IFsn5q2k6YKu566x5bey57uP6KKr5rOo5YaM77yM5Y+v5Lul6YCa6L+H6YKu566x5om+5Zue5a+G56CBJ11cbiAgICAgICAgICAgIGNoZWNrID0gZmFsc2VcbiAgICAgICAgfVxuICAgICAgICBjaGVjayA9IHRydWVcbiAgICAgICAgbGV0IHVzZXIyID0gYXdhaXQgVXNlci5maW5kT25lKHsgbmFtZTogYm9keS5uYW1lIH0pXG4gICAgICAgIGlmICh1c2VyMiAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjIubmFtZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIG1zZy5uYW1lID0gWyfmraTmmLXnp7Dlt7Lnu4/ooqvms6jlhozvvIzor7fkv67mlLknXVxuICAgICAgICAgICAgY2hlY2sgPSBmYWxzZVxuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgICAgYm9keS5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKGJvZHkucGFzc3dvcmQsIDUpXG4gICAgICAgICAgICBsZXQgdXNlciA9IG5ldyBVc2VyKHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogYm9keS51c2VybmFtZSxcbiAgICAgICAgICAgICAgICBuYW1lOiBib2R5Lm5hbWUsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGJvZHkucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgY3JlYXRlZDogbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdXNlci5zYXZlKClcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgbXNnOiAn5rOo5YaM5oiQ5YqfJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBtc2cuY29kZSA9IFsn6aqM6K+B56CB5bey57uP5aSx5pWI77yM6K+36YeN5paw6I635Y+W77yBJ11cbiAgICB9XG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgbXNnOiBtc2dcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlc2V0IChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJyZXNldCAtPiBib2R5XCIsIGJvZHksIGJvZHkudXNlcm5hbWUpXG4gICAgbGV0IHNpZCA9IGJvZHkuc2lkXG4gICAgbGV0IGNvZGUgPSBib2R5LmNvZGVcbiAgICBsZXQgbXNnID0ge31cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBVdGlscy5jaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogYm9keS51c2VybmFtZSB9KVxuICAgICAgICBpZiAodXNlciA9PT0gbnVsbCAmJiB1c2VyLnVzZXJuYW1lID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgbXNnLnVzZXJuYW1lID0gWyfmraTpgq7nrrHmnKrms6jlhozvvIzor7fnoa7orqQnXVxuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIG1zZzogbXNnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1c2VyLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2goYm9keS5wYXNzd29yZCwgNSlcbiAgICAgICAgICAgIHVzZXIudXBkYXRlZD1tb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKVxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHVzZXIuc2F2ZSgpXG4gICAgICAgICAgICBjb25zdCB1c2VyT2JqID0gcmVzdWx0LnRvSlNPTigpXG4gICAgICAgICAgICBjb25zdCBhcnIgPSBbJ3Bhc3N3b3JkJ10gXG4gICAgICAgICAgICBhcnIubWFwKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHVzZXJPYmpbaXRlbV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBsZXQgdG9rZW4gPSBqc29ud2VidG9rZW4uc2lnbih7IF9pZDogdXNlck9iai5faWQgfSwgY29uZmlnLkpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnMWQnIH0pIC8vXG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICAgICAgZGF0YTogdXNlck9iaixcbiAgICAgICAgICAgICAgICB0b2tlbjogdG9rZW4sXG4gICAgICAgICAgICAgICAgbXNnOifmm7TmlrDlr4bnoIHmiJDlip/vvIEnXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDQwMSxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggeS4jeato+ehru+8jOivt+ajgOafpe+8gSdcbiAgICAgICAgfVxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IGZvcmdldCwgbG9naW4sIHJlZywgcmVzZXQgfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "LoginController.js"
      ],
      "names": [
        "send",
        "require",
        "bcrypt",
        "moment",
        "jsonwebtoken",
        "config",
        "Utils",
        "User",
        "forget",
        "ctx",
        "body",
        "request",
        "username",
        "result",
        "code",
        "expire",
        "add",
        "format",
        "email",
        "user",
        "data",
        "msg",
        "e",
        "console",
        "log",
        "login",
        "sid",
        "checkCode",
        "checkUserPasswd",
        "findOne",
        "compare",
        "password",
        "userObj",
        "toJSON",
        "arr",
        "map",
        "item",
        "token",
        "sign",
        "_id",
        "JWT_SECRET",
        "expiresIn",
        "reg",
        "check",
        "user1",
        "user2",
        "name",
        "hash",
        "created",
        "save",
        "reset",
        "updated",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "const send = require('../config/MailConfig.js')\nconst bcrypt = require('bcrypt')\nconst moment = require('dayjs')\nconst jsonwebtoken = require('jsonwebtoken')\nconst config = require('../config/index')\n// const checkCode=require('../common/Utils')\nconst Utils = require('../common/Utils')\nconst User = require('../model/User')\n\nconst forget = function (ctx) {\n    const { body } = ctx.request\n    if (typeof body.username !== 'undefined') {\n        try {\n            let result = send({\n                code: '1234',\n                expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n                email: body.username,\n                user: 'echo',\n            })\n            ctx.body = {\n                code: 200,\n                data: result,\n                msg: '邮件发送成功'\n            }\n        } catch (e) {\n            console.log(e)\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '服务器异常'\n        }\n    }\n}\nasync function login (ctx) {\n    const { body } = ctx.request\n    let sid = body.sid\n    let code = body.code\n    let result = await Utils.checkCode(sid, code)\n    console.log(result)\n    if (result) {\n        let checkUserPasswd = false\n        let user = await User.findOne({ username: body.username })\n        if (await bcrypt.compare(body.password, user.password)) {\n            checkUserPasswd = true\n        }\n        if (checkUserPasswd) {\n            const userObj = user.toJSON()\n            const arr = ['password'] //和源码有不同，这里没有删除邮箱了。\n            arr.map((item) => {\n                delete userObj[item]\n            })\n            let token = jsonwebtoken.sign({ _id: userObj._id }, config.JWT_SECRET, { expiresIn: '1d' }) //\n            ctx.body = {\n                code: 200,\n                data: userObj,\n                token: token\n            }\n        } else {\n            ctx.body = {\n                code: 404,\n                msg: '用户名或密码错误'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 401,\n            msg: '图片验证码不正确，请检查！'\n        }\n    }\n}\n\nasync function reg (ctx) {\n    const { body } = ctx.request\n    console.log(\"reg -> body\", body)\n    let sid = body.sid\n    let code = body.code\n    let msg = {}\n    let result = await Utils.checkCode(sid, code)\n    console.log(\"result:\" + result)\n    let check = true\n    if (result) {\n        let user1 = await User.findOne({ username: body.username })\n        if (user1 !== null && typeof user1.username !== 'undefined') {\n            console.log(\"user1\" + user1)\n            msg.username = ['此邮箱已经被注册，可以通过邮箱找回密码']\n            check = false\n        }\n        check = true\n        let user2 = await User.findOne({ name: body.name })\n        if (user2 !== null && typeof user2.name !== 'undefined') {\n            msg.name = ['此昵称已经被注册，请修改']\n            check = false\n        }\n        if (check) {\n            body.password = await bcrypt.hash(body.password, 5)\n            let user = new User({\n                username: body.username,\n                name: body.name,\n                password: body.password,\n                created: moment().format('YYYY-MM-DD HH:mm:ss')\n            })\n            let result = await user.save()\n            ctx.body = {\n                code: 200,\n                data: result,\n                msg: '注册成功'\n            }\n            return\n        }\n    } else {\n        msg.code = ['验证码已经失效，请重新获取！']\n    }\n    ctx.body = {\n        code: 500,\n        msg: msg\n    }\n}\n\nasync function reset (ctx) {\n    const { body } = ctx.request\n    console.log(\"reset -> body\", body, body.username)\n    let sid = body.sid\n    let code = body.code\n    let msg = {}\n    const result = await Utils.checkCode(sid, code)\n    if (result) {\n        let user = await User.findOne({ username: body.username })\n        if (user === null && user.username === 'undefined') {\n            msg.username = ['此邮箱未注册，请确认']\n            ctx.body = {\n                code: 500,\n                msg: msg\n            }\n        } else {\n            user.password = await bcrypt.hash(body.password, 5)\n            user.updated=moment().format('YYYY-MM-DD HH:mm:ss')\n            let result = await user.save()\n            const userObj = result.toJSON()\n            const arr = ['password'] \n            arr.map((item) => {\n                delete userObj[item]\n            })\n            let token = jsonwebtoken.sign({ _id: userObj._id }, config.JWT_SECRET, { expiresIn: '1d' }) //\n            ctx.body = {\n                code: 200,\n                data: userObj,\n                token: token,\n                msg:'更新密码成功！'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 401,\n            msg: '图片验证码不正确，请检查！'\n        }\n    }\n}\n\nmodule.exports = { forget, login, reg, reset }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585409595258
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/MailConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/MailConfig.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/MailConfig.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/MailConfig.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
        "sourceFileName": "MailConfig.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst nodemailer = require('nodemailer');\n\nconst config = require('./index');\n\nconst qs = require('qs'); // async..await is not allowed in global scope, must use a wrapper\n\n\nasync function send(sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount()\n  // create reusable transporter object using the default SMTP transport\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.163.com',\n    port: 465,\n    secure: true,\n    // true for 465, false for other ports\n    auth: {\n      user: 'leedawnm@163.com',\n      // generated ethereal user\n      pass: '93thing51' // generated ethereal password\n\n    }\n  }); // let sendInfo = {\n  //   code: '1234',\n  //   expire: '2019-10-01',\n  //   email: 'imoocbrian@qq.com',\n  //   user: 'Brian',\n  // }\n\n  const baseUrl = config.baseUrl;\n  const route = sendInfo.type === 'email' ? '/confirm' : '/reset';\n  const url = `${baseUrl}/#${route}?` + qs.stringify(sendInfo.data); // send mail with defined transport object\n\n  const info = await transporter.sendMail({\n    from: '\"认证邮件\" <leedawnm@163.com>',\n    // sender address\n    to: sendInfo.email,\n    // list of receivers\n    subject: sendInfo.user !== '' && sendInfo.type !== 'email' ? `你好开发者，${sendInfo.user}！《慕课网前端全栈实践》注册码` : '论坛系统密码确认修改链接',\n    // Subject line\n    text: `您在《慕课网前端全栈实践》课程中注册，您的邀请码是${sendInfo.code},邀请码的过期时间: ${sendInfo.expire}`,\n    // plain text body\n    html: `\n  \n        <div style=\"border: 1px solid #dcdcdc;color: #676767;width: 600px; margin: 0 auto; padding-bottom: 50px;position: relative;\">\n        <div style=\"height: 60px; background: #393d49; line-height: 60px; color: #58a36f; font-size: 18px;padding-left: 10px;\">Imooc社区——欢迎来到官方社区</div>\n        <div style=\"padding: 25px\">\n          <div>您好，${sendInfo.user}童鞋，重置链接有效时间30分钟，请在${sendInfo.expire}之前${sendInfo.code ? '重置您的密码' : '修改您的邮箱为：' + sendInfo.data.username}：</div>\n          <a href=\"${url}\" style=\"padding: 10px 20px; color: #fff; background: #009e94; display: inline-block;margin: 15px 0;\">${sendInfo.code ? '立即重置密码' : '确认设置邮箱'}</a>\n          <div style=\"padding: 5px; background: #f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定。</div>\n        </div>\n        <div style=\"background: #fafafa; color: #b4b4b4;text-align: center; line-height: 45px; height: 45px; position: absolute; left: 0; bottom: 0;width: 100%;\">系统邮件，请勿直接回复</div>\n    </div>\n    ` // html body\n\n  });\n  return `Message sent: %s, ${info.messageId}`; // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n  // Preview only available when sending through an Ethereal account\n  // console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n} // main().catch(console.error)\n\n\nmodule.exports = send;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1haWxDb25maWcuanMiXSwibmFtZXMiOlsibm9kZW1haWxlciIsInJlcXVpcmUiLCJjb25maWciLCJxcyIsInNlbmQiLCJzZW5kSW5mbyIsInRyYW5zcG9ydGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwidXNlciIsInBhc3MiLCJiYXNlVXJsIiwicm91dGUiLCJ0eXBlIiwidXJsIiwic3RyaW5naWZ5IiwiZGF0YSIsImluZm8iLCJzZW5kTWFpbCIsImZyb20iLCJ0byIsImVtYWlsIiwic3ViamVjdCIsInRleHQiLCJjb2RlIiwiZXhwaXJlIiwiaHRtbCIsInVzZXJuYW1lIiwibWVzc2FnZUlkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxVQUFVLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXhCOztBQUNBLE1BQU1DLE1BQU0sR0FBQ0QsT0FBTyxDQUFDLFNBQUQsQ0FBcEI7O0FBQ0EsTUFBTUUsRUFBRSxHQUFDRixPQUFPLENBQUMsSUFBRCxDQUFoQixDLENBRUE7OztBQUNBLGVBQWVHLElBQWYsQ0FBcUJDLFFBQXJCLEVBQStCO0FBQzdCO0FBQ0E7QUFDQTtBQUVBO0FBQ0EsUUFBTUMsV0FBVyxHQUFHTixVQUFVLENBQUNPLGVBQVgsQ0FBMkI7QUFDN0NDLElBQUFBLElBQUksRUFBRSxjQUR1QztBQUU3Q0MsSUFBQUEsSUFBSSxFQUFFLEdBRnVDO0FBRzdDQyxJQUFBQSxNQUFNLEVBQUUsSUFIcUM7QUFHL0I7QUFDZEMsSUFBQUEsSUFBSSxFQUFFO0FBQ0pDLE1BQUFBLElBQUksRUFBRSxrQkFERjtBQUNzQjtBQUMxQkMsTUFBQUEsSUFBSSxFQUFFLFdBRkYsQ0FFYzs7QUFGZDtBQUp1QyxHQUEzQixDQUFwQixDQU42QixDQWdCN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFFBQU1DLE9BQU8sR0FBR1osTUFBTSxDQUFDWSxPQUF2QjtBQUNBLFFBQU1DLEtBQUssR0FBR1YsUUFBUSxDQUFDVyxJQUFULEtBQWtCLE9BQWxCLEdBQTRCLFVBQTVCLEdBQXlDLFFBQXZEO0FBQ0EsUUFBTUMsR0FBRyxHQUFJLEdBQUVILE9BQVEsS0FBSUMsS0FBTSxHQUFyQixHQUEwQlosRUFBRSxDQUFDZSxTQUFILENBQWFiLFFBQVEsQ0FBQ2MsSUFBdEIsQ0FBdEMsQ0F4QjZCLENBMEI3Qjs7QUFDQSxRQUFNQyxJQUFJLEdBQUcsTUFBTWQsV0FBVyxDQUFDZSxRQUFaLENBQXFCO0FBQ3RDQyxJQUFBQSxJQUFJLEVBQUUsMkJBRGdDO0FBQ0g7QUFDbkNDLElBQUFBLEVBQUUsRUFBRWxCLFFBQVEsQ0FBQ21CLEtBRnlCO0FBRWxCO0FBQ3BCQyxJQUFBQSxPQUFPLEVBQ0xwQixRQUFRLENBQUNPLElBQVQsS0FBa0IsRUFBbEIsSUFBd0JQLFFBQVEsQ0FBQ1csSUFBVCxLQUFpQixPQUF6QyxHQUNLLFNBQVFYLFFBQVEsQ0FBQ08sSUFBSyxpQkFEM0IsR0FFSSxjQU5nQztBQU1oQjtBQUN0QmMsSUFBQUEsSUFBSSxFQUFHLDRCQUNMckIsUUFBUSxDQUFDc0IsSUFDUixjQUFhdEIsUUFBUSxDQUFDdUIsTUFBTyxFQVRNO0FBU0g7QUFDbkNDLElBQUFBLElBQUksRUFBRzs7Ozs7b0JBS1N4QixRQUFRLENBQUNPLElBQUsscUJBQzVCUCxRQUFRLENBQUN1QixNQUNSLEtBQUl2QixRQUFRLENBQUNzQixJQUFULEdBQWdCLFFBQWhCLEdBQTJCLGFBQWF0QixRQUFRLENBQUNjLElBQVQsQ0FBY1csUUFBUztxQkFDckRiLEdBQUkseUdBQXdHWixRQUFRLENBQUNzQixJQUFULEdBQWdCLFFBQWhCLEdBQTJCLFFBQVM7Ozs7O0tBbEIzSCxDQXVCcEM7O0FBdkJvQyxHQUFyQixDQUFuQjtBQTBCQSxTQUFRLHFCQUFvQlAsSUFBSSxDQUFDVyxTQUFVLEVBQTNDLENBckQ2QixDQXNEN0I7QUFFQTtBQUNBO0FBQ0E7QUFDRCxDLENBRUQ7OztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBZ0I3QixJQUFoQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBub2RlbWFpbGVyPXJlcXVpcmUoJ25vZGVtYWlsZXInKVxuY29uc3QgY29uZmlnPXJlcXVpcmUoJy4vaW5kZXgnKVxuY29uc3QgcXM9cmVxdWlyZSgncXMnKVxuXG4vLyBhc3luYy4uYXdhaXQgaXMgbm90IGFsbG93ZWQgaW4gZ2xvYmFsIHNjb3BlLCBtdXN0IHVzZSBhIHdyYXBwZXJcbmFzeW5jIGZ1bmN0aW9uIHNlbmQgKHNlbmRJbmZvKSB7XG4gIC8vIEdlbmVyYXRlIHRlc3QgU01UUCBzZXJ2aWNlIGFjY291bnQgZnJvbSBldGhlcmVhbC5lbWFpbFxuICAvLyBPbmx5IG5lZWRlZCBpZiB5b3UgZG9uJ3QgaGF2ZSBhIHJlYWwgbWFpbCBhY2NvdW50IGZvciB0ZXN0aW5nXG4gIC8vIGxldCB0ZXN0QWNjb3VudCA9IGF3YWl0IG5vZGVtYWlsZXIuY3JlYXRlVGVzdEFjY291bnQoKVxuXG4gIC8vIGNyZWF0ZSByZXVzYWJsZSB0cmFuc3BvcnRlciBvYmplY3QgdXNpbmcgdGhlIGRlZmF1bHQgU01UUCB0cmFuc3BvcnRcbiAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgaG9zdDogJ3NtdHAuMTYzLmNvbScsXG4gICAgcG9ydDogNDY1LFxuICAgIHNlY3VyZTogdHJ1ZSwgLy8gdHJ1ZSBmb3IgNDY1LCBmYWxzZSBmb3Igb3RoZXIgcG9ydHNcbiAgICBhdXRoOiB7XG4gICAgICB1c2VyOiAnbGVlZGF3bm1AMTYzLmNvbScsIC8vIGdlbmVyYXRlZCBldGhlcmVhbCB1c2VyXG4gICAgICBwYXNzOiAnOTN0aGluZzUxJyAvLyBnZW5lcmF0ZWQgZXRoZXJlYWwgcGFzc3dvcmRcbiAgICB9XG4gIH0pXG5cbiAgLy8gbGV0IHNlbmRJbmZvID0ge1xuICAvLyAgIGNvZGU6ICcxMjM0JyxcbiAgLy8gICBleHBpcmU6ICcyMDE5LTEwLTAxJyxcbiAgLy8gICBlbWFpbDogJ2ltb29jYnJpYW5AcXEuY29tJyxcbiAgLy8gICB1c2VyOiAnQnJpYW4nLFxuICAvLyB9XG4gIGNvbnN0IGJhc2VVcmwgPSBjb25maWcuYmFzZVVybFxuICBjb25zdCByb3V0ZSA9IHNlbmRJbmZvLnR5cGUgPT09ICdlbWFpbCcgPyAnL2NvbmZpcm0nIDogJy9yZXNldCdcbiAgY29uc3QgdXJsID0gYCR7YmFzZVVybH0vIyR7cm91dGV9P2AgKyBxcy5zdHJpbmdpZnkoc2VuZEluZm8uZGF0YSlcblxuICAvLyBzZW5kIG1haWwgd2l0aCBkZWZpbmVkIHRyYW5zcG9ydCBvYmplY3RcbiAgY29uc3QgaW5mbyA9IGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKHtcbiAgICBmcm9tOiAnXCLorqTor4Hpgq7ku7ZcIiA8bGVlZGF3bm1AMTYzLmNvbT4nLCAvLyBzZW5kZXIgYWRkcmVzc1xuICAgIHRvOiBzZW5kSW5mby5lbWFpbCwgLy8gbGlzdCBvZiByZWNlaXZlcnNcbiAgICBzdWJqZWN0OlxuICAgICAgc2VuZEluZm8udXNlciAhPT0gJycgJiYgc2VuZEluZm8udHlwZSAhPT0nZW1haWwnXG4gICAgICAgID8gYOS9oOWlveW8gOWPkeiAhe+8jCR7c2VuZEluZm8udXNlcn3vvIHjgIrmhZXor77nvZHliY3nq6/lhajmoIjlrp7ot7XjgIvms6jlhoznoIFgXG4gICAgICAgIDogJ+iuuuWdm+ezu+e7n+WvhueggeehruiupOS/ruaUuemTvuaOpScsIC8vIFN1YmplY3QgbGluZVxuICAgIHRleHQ6IGDmgqjlnKjjgIrmhZXor77nvZHliY3nq6/lhajmoIjlrp7ot7XjgIvor77nqIvkuK3ms6jlhozvvIzmgqjnmoTpgoDor7fnoIHmmK8ke1xuICAgICAgc2VuZEluZm8uY29kZVxuICAgICAgfSzpgoDor7fnoIHnmoTov4fmnJ/ml7bpl7Q6ICR7c2VuZEluZm8uZXhwaXJlfWAsIC8vIHBsYWluIHRleHQgYm9keVxuICAgIGh0bWw6IGBcbiAgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJib3JkZXI6IDFweCBzb2xpZCAjZGNkY2RjO2NvbG9yOiAjNjc2NzY3O3dpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmctYm90dG9tOiA1MHB4O3Bvc2l0aW9uOiByZWxhdGl2ZTtcIj5cbiAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogNjBweDsgYmFja2dyb3VuZDogIzM5M2Q0OTsgbGluZS1oZWlnaHQ6IDYwcHg7IGNvbG9yOiAjNThhMzZmOyBmb250LXNpemU6IDE4cHg7cGFkZGluZy1sZWZ0OiAxMHB4O1wiPkltb29j56S+5Yy64oCU4oCU5qyi6L+O5p2l5Yiw5a6Y5pa556S+5Yy6PC9kaXY+XG4gICAgICAgIDxkaXYgc3R5bGU9XCJwYWRkaW5nOiAyNXB4XCI+XG4gICAgICAgICAgPGRpdj7mgqjlpb3vvIwke3NlbmRJbmZvLnVzZXJ956ul6Z6L77yM6YeN572u6ZO+5o6l5pyJ5pWI5pe26Ze0MzDliIbpkp/vvIzor7flnKgke1xuICAgICAgc2VuZEluZm8uZXhwaXJlXG4gICAgICB95LmL5YmNJHtzZW5kSW5mby5jb2RlID8gJ+mHjee9ruaCqOeahOWvhueggScgOiAn5L+u5pS55oKo55qE6YKu566x5Li677yaJyArIHNlbmRJbmZvLmRhdGEudXNlcm5hbWV977yaPC9kaXY+XG4gICAgICAgICAgPGEgaHJlZj1cIiR7dXJsfVwiIHN0eWxlPVwicGFkZGluZzogMTBweCAyMHB4OyBjb2xvcjogI2ZmZjsgYmFja2dyb3VuZDogIzAwOWU5NDsgZGlzcGxheTogaW5saW5lLWJsb2NrO21hcmdpbjogMTVweCAwO1wiPiR7c2VuZEluZm8uY29kZSA/ICfnq4vljbPph43nva7lr4bnoIEnIDogJ+ehruiupOiuvue9rumCrueusSd9PC9hPlxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJwYWRkaW5nOiA1cHg7IGJhY2tncm91bmQ6ICNmMmYyZjI7XCI+5aaC5p6c6K+l6YKu5Lu25LiN5piv55Sx5L2g5pys5Lq65pON5L2c77yM6K+35Yu/6L+b6KGM5r+A5rS777yB5ZCm5YiZ5L2g55qE6YKu566x5bCG5Lya6KKr5LuW5Lq657uR5a6a44CCPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogI2ZhZmFmYTsgY29sb3I6ICNiNGI0YjQ7dGV4dC1hbGlnbjogY2VudGVyOyBsaW5lLWhlaWdodDogNDVweDsgaGVpZ2h0OiA0NXB4OyBwb3NpdGlvbjogYWJzb2x1dGU7IGxlZnQ6IDA7IGJvdHRvbTogMDt3aWR0aDogMTAwJTtcIj7ns7vnu5/pgq7ku7bvvIzor7fli7/nm7TmjqXlm57lpI08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICBgIC8vIGh0bWwgYm9keVxuICB9KVxuXG4gIHJldHVybiBgTWVzc2FnZSBzZW50OiAlcywgJHtpbmZvLm1lc3NhZ2VJZH1gXG4gIC8vIE1lc3NhZ2Ugc2VudDogPGI2NThmOGNhLTYyOTYtY2NmNC04MzA2LTg3ZDU3YTBiNDMyMUBleGFtcGxlLmNvbT5cblxuICAvLyBQcmV2aWV3IG9ubHkgYXZhaWxhYmxlIHdoZW4gc2VuZGluZyB0aHJvdWdoIGFuIEV0aGVyZWFsIGFjY291bnRcbiAgLy8gY29uc29sZS5sb2coJ1ByZXZpZXcgVVJMOiAlcycsIG5vZGVtYWlsZXIuZ2V0VGVzdE1lc3NhZ2VVcmwoaW5mbykpXG4gIC8vIFByZXZpZXcgVVJMOiBodHRwczovL2V0aGVyZWFsLmVtYWlsL21lc3NhZ2UvV2FRS01nS2RkeFFEb291Li4uXG59XG5cbi8vIG1haW4oKS5jYXRjaChjb25zb2xlLmVycm9yKVxuXG5tb2R1bGUuZXhwb3J0cz0gc2VuZFxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "MailConfig.js"
      ],
      "names": [
        "nodemailer",
        "require",
        "config",
        "qs",
        "send",
        "sendInfo",
        "transporter",
        "createTransport",
        "host",
        "port",
        "secure",
        "auth",
        "user",
        "pass",
        "baseUrl",
        "route",
        "type",
        "url",
        "stringify",
        "data",
        "info",
        "sendMail",
        "from",
        "to",
        "email",
        "subject",
        "text",
        "code",
        "expire",
        "html",
        "username",
        "messageId",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,UAAU,GAACC,OAAO,CAAC,YAAD,CAAxB;;AACA,MAAMC,MAAM,GAACD,OAAO,CAAC,SAAD,CAApB;;AACA,MAAME,EAAE,GAACF,OAAO,CAAC,IAAD,CAAhB,C,CAEA;;;AACA,eAAeG,IAAf,CAAqBC,QAArB,EAA+B;AAC7B;AACA;AACA;AAEA;AACA,QAAMC,WAAW,GAAGN,UAAU,CAACO,eAAX,CAA2B;AAC7CC,IAAAA,IAAI,EAAE,cADuC;AAE7CC,IAAAA,IAAI,EAAE,GAFuC;AAG7CC,IAAAA,MAAM,EAAE,IAHqC;AAG/B;AACdC,IAAAA,IAAI,EAAE;AACJC,MAAAA,IAAI,EAAE,kBADF;AACsB;AAC1BC,MAAAA,IAAI,EAAE,WAFF,CAEc;;AAFd;AAJuC,GAA3B,CAApB,CAN6B,CAgB7B;AACA;AACA;AACA;AACA;AACA;;AACA,QAAMC,OAAO,GAAGZ,MAAM,CAACY,OAAvB;AACA,QAAMC,KAAK,GAAGV,QAAQ,CAACW,IAAT,KAAkB,OAAlB,GAA4B,UAA5B,GAAyC,QAAvD;AACA,QAAMC,GAAG,GAAI,GAAEH,OAAQ,KAAIC,KAAM,GAArB,GAA0BZ,EAAE,CAACe,SAAH,CAAab,QAAQ,CAACc,IAAtB,CAAtC,CAxB6B,CA0B7B;;AACA,QAAMC,IAAI,GAAG,MAAMd,WAAW,CAACe,QAAZ,CAAqB;AACtCC,IAAAA,IAAI,EAAE,2BADgC;AACH;AACnCC,IAAAA,EAAE,EAAElB,QAAQ,CAACmB,KAFyB;AAElB;AACpBC,IAAAA,OAAO,EACLpB,QAAQ,CAACO,IAAT,KAAkB,EAAlB,IAAwBP,QAAQ,CAACW,IAAT,KAAiB,OAAzC,GACK,SAAQX,QAAQ,CAACO,IAAK,iBAD3B,GAEI,cANgC;AAMhB;AACtBc,IAAAA,IAAI,EAAG,4BACLrB,QAAQ,CAACsB,IACR,cAAatB,QAAQ,CAACuB,MAAO,EATM;AASH;AACnCC,IAAAA,IAAI,EAAG;;;;;oBAKSxB,QAAQ,CAACO,IAAK,qBAC5BP,QAAQ,CAACuB,MACR,KAAIvB,QAAQ,CAACsB,IAAT,GAAgB,QAAhB,GAA2B,aAAatB,QAAQ,CAACc,IAAT,CAAcW,QAAS;qBACrDb,GAAI,yGAAwGZ,QAAQ,CAACsB,IAAT,GAAgB,QAAhB,GAA2B,QAAS;;;;;KAlB3H,CAuBpC;;AAvBoC,GAArB,CAAnB;AA0BA,SAAQ,qBAAoBP,IAAI,CAACW,SAAU,EAA3C,CArD6B,CAsD7B;AAEA;AACA;AACA;AACD,C,CAED;;;AAEAC,MAAM,CAACC,OAAP,GAAgB7B,IAAhB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "sourcesContent": [
        "const nodemailer=require('nodemailer')\nconst config=require('./index')\nconst qs=require('qs')\n\n// async..await is not allowed in global scope, must use a wrapper\nasync function send (sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount()\n\n  // create reusable transporter object using the default SMTP transport\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.163.com',\n    port: 465,\n    secure: true, // true for 465, false for other ports\n    auth: {\n      user: 'leedawnm@163.com', // generated ethereal user\n      pass: '93thing51' // generated ethereal password\n    }\n  })\n\n  // let sendInfo = {\n  //   code: '1234',\n  //   expire: '2019-10-01',\n  //   email: 'imoocbrian@qq.com',\n  //   user: 'Brian',\n  // }\n  const baseUrl = config.baseUrl\n  const route = sendInfo.type === 'email' ? '/confirm' : '/reset'\n  const url = `${baseUrl}/#${route}?` + qs.stringify(sendInfo.data)\n\n  // send mail with defined transport object\n  const info = await transporter.sendMail({\n    from: '\"认证邮件\" <leedawnm@163.com>', // sender address\n    to: sendInfo.email, // list of receivers\n    subject:\n      sendInfo.user !== '' && sendInfo.type !=='email'\n        ? `你好开发者，${sendInfo.user}！《慕课网前端全栈实践》注册码`\n        : '论坛系统密码确认修改链接', // Subject line\n    text: `您在《慕课网前端全栈实践》课程中注册，您的邀请码是${\n      sendInfo.code\n      },邀请码的过期时间: ${sendInfo.expire}`, // plain text body\n    html: `\n  \n        <div style=\"border: 1px solid #dcdcdc;color: #676767;width: 600px; margin: 0 auto; padding-bottom: 50px;position: relative;\">\n        <div style=\"height: 60px; background: #393d49; line-height: 60px; color: #58a36f; font-size: 18px;padding-left: 10px;\">Imooc社区——欢迎来到官方社区</div>\n        <div style=\"padding: 25px\">\n          <div>您好，${sendInfo.user}童鞋，重置链接有效时间30分钟，请在${\n      sendInfo.expire\n      }之前${sendInfo.code ? '重置您的密码' : '修改您的邮箱为：' + sendInfo.data.username}：</div>\n          <a href=\"${url}\" style=\"padding: 10px 20px; color: #fff; background: #009e94; display: inline-block;margin: 15px 0;\">${sendInfo.code ? '立即重置密码' : '确认设置邮箱'}</a>\n          <div style=\"padding: 5px; background: #f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定。</div>\n        </div>\n        <div style=\"background: #fafafa; color: #b4b4b4;text-align: center; line-height: 45px; height: 45px; position: absolute; left: 0; bottom: 0;width: 100%;\">系统邮件，请勿直接回复</div>\n    </div>\n    ` // html body\n  })\n\n  return `Message sent: %s, ${info.messageId}`\n  // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n\n  // Preview only available when sending through an Ethereal account\n  // console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n}\n\n// main().catch(console.error)\n\nmodule.exports= send\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1585366695740
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/ErrorHandle.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/ErrorHandle.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/ErrorHandle.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/ErrorHandle.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
        "sourceFileName": "ErrorHandle.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nmodule.exports = (ctx, next) => {\n  return next().catch(err => {\n    if (401 == err.status) {\n      ctx.status = 401;\n      ctx.body = {\n        code: 401,\n        msg: 'Protected resource,use Authorization header to get access\\n'\n      };\n    } else {\n      ctx.status = err.status || 500;\n      ctx.body = Object.assign({\n        code: 500,\n        msg: err.message\n      }, process.env.NODE_ENV === 'development' ? {\n        stack: err.statck\n      } : {});\n    }\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkVycm9ySGFuZGxlLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJjdHgiLCJuZXh0IiwiY2F0Y2giLCJlcnIiLCJzdGF0dXMiLCJib2R5IiwiY29kZSIsIm1zZyIsIk9iamVjdCIsImFzc2lnbiIsIm1lc3NhZ2UiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJzdGFjayIsInN0YXRjayJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsTUFBTSxDQUFDQyxPQUFQLEdBQWdCLENBQUNDLEdBQUQsRUFBS0MsSUFBTCxLQUFjO0FBQzFCLFNBQU9BLElBQUksR0FBR0MsS0FBUCxDQUFjQyxHQUFELElBQU87QUFDdkIsUUFBRyxPQUFLQSxHQUFHLENBQUNDLE1BQVosRUFBb0I7QUFDaEJKLE1BQUFBLEdBQUcsQ0FBQ0ksTUFBSixHQUFXLEdBQVg7QUFDQUosTUFBQUEsR0FBRyxDQUFDSyxJQUFKLEdBQVM7QUFDTEMsUUFBQUEsSUFBSSxFQUFDLEdBREE7QUFFTEMsUUFBQUEsR0FBRyxFQUFDO0FBRkMsT0FBVDtBQUlILEtBTkQsTUFNTztBQUNIUCxNQUFBQSxHQUFHLENBQUNJLE1BQUosR0FBYUQsR0FBRyxDQUFDQyxNQUFKLElBQWMsR0FBM0I7QUFDQUosTUFBQUEsR0FBRyxDQUFDSyxJQUFKLEdBQVdHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjO0FBQ3JCSCxRQUFBQSxJQUFJLEVBQUUsR0FEZTtBQUVyQkMsUUFBQUEsR0FBRyxFQUFFSixHQUFHLENBQUNPO0FBRlksT0FBZCxFQUdUQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsUUFBWixLQUF1QixhQUF2QixHQUFxQztBQUFDQyxRQUFBQSxLQUFLLEVBQUNYLEdBQUcsQ0FBQ1k7QUFBWCxPQUFyQyxHQUF3RCxFQUgvQyxDQUFYO0FBSUg7QUFDSixHQWRNLENBQVA7QUFlSCxDQWhCRCIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9jb21tb24iLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cz0gKGN0eCxuZXh0KSA9PiB7XG4gICAgcmV0dXJuIG5leHQoKS5jYXRjaCgoZXJyKT0+e1xuICAgICAgICBpZig0MDE9PWVyci5zdGF0dXMpIHtcbiAgICAgICAgICAgIGN0eC5zdGF0dXM9NDAxO1xuICAgICAgICAgICAgY3R4LmJvZHk9e1xuICAgICAgICAgICAgICAgIGNvZGU6NDAxLFxuICAgICAgICAgICAgICAgIG1zZzonUHJvdGVjdGVkIHJlc291cmNlLHVzZSBBdXRob3JpemF0aW9uIGhlYWRlciB0byBnZXQgYWNjZXNzXFxuJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgNTAwXG4gICAgICAgICAgICBjdHguYm9keSA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgICAgICBtc2c6IGVyci5tZXNzYWdlXG4gICAgICAgICAgICB9LHByb2Nlc3MuZW52Lk5PREVfRU5WPT09J2RldmVsb3BtZW50Jz97c3RhY2s6ZXJyLnN0YXRja306e30pXG4gICAgICAgIH1cbiAgICB9KTtcbn0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "ErrorHandle.js"
      ],
      "names": [
        "module",
        "exports",
        "ctx",
        "next",
        "catch",
        "err",
        "status",
        "body",
        "code",
        "msg",
        "Object",
        "assign",
        "message",
        "process",
        "env",
        "NODE_ENV",
        "stack",
        "statck"
      ],
      "mappings": ";;AAAAA,MAAM,CAACC,OAAP,GAAgB,CAACC,GAAD,EAAKC,IAAL,KAAc;AAC1B,SAAOA,IAAI,GAAGC,KAAP,CAAcC,GAAD,IAAO;AACvB,QAAG,OAAKA,GAAG,CAACC,MAAZ,EAAoB;AAChBJ,MAAAA,GAAG,CAACI,MAAJ,GAAW,GAAX;AACAJ,MAAAA,GAAG,CAACK,IAAJ,GAAS;AACLC,QAAAA,IAAI,EAAC,GADA;AAELC,QAAAA,GAAG,EAAC;AAFC,OAAT;AAIH,KAND,MAMO;AACHP,MAAAA,GAAG,CAACI,MAAJ,GAAaD,GAAG,CAACC,MAAJ,IAAc,GAA3B;AACAJ,MAAAA,GAAG,CAACK,IAAJ,GAAWG,MAAM,CAACC,MAAP,CAAc;AACrBH,QAAAA,IAAI,EAAE,GADe;AAErBC,QAAAA,GAAG,EAAEJ,GAAG,CAACO;AAFY,OAAd,EAGTC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAuB,aAAvB,GAAqC;AAACC,QAAAA,KAAK,EAACX,GAAG,CAACY;AAAX,OAArC,GAAwD,EAH/C,CAAX;AAIH;AACJ,GAdM,CAAP;AAeH,CAhBD",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
      "sourcesContent": [
        "module.exports= (ctx,next) => {\n    return next().catch((err)=>{\n        if(401==err.status) {\n            ctx.status=401;\n            ctx.body={\n                code:401,\n                msg:'Protected resource,use Authorization header to get access\\n'\n            }\n        } else {\n            ctx.status = err.status || 500\n            ctx.body = Object.assign({\n                code: 500,\n                msg: err.message\n            },process.env.NODE_ENV==='development'?{stack:err.statck}:{})\n        }\n    });\n}"
      ]
    },
    "sourceType": "script",
    "mtime": 1581480640837
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/routes.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/routes.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/routes.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/routes.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes",
        "sourceFileName": "routes.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import combineRoutes from 'koa-combine-routers'\n// const moduleFiles = require.context('./modules', true, /\\.js$/)\n// const modules = moduleFiles.keys().reduce((items, path) => {\n//     const value = moduleFiles(path)\n//     items.push(value.default)\n//     return items\n// }, [])\n// export default combineRoutes(modules)\nconst combineRoutes = require('koa-combine-routers');\n\nconst publicRoutes = require('./modules/publicRouter');\n\nconst userRoutes = require('./modules/userRouter');\n\nconst loginRoutes = require('./modules/loginRouter');\n\nconst contentRouter = require('./modules/contentRouter');\n\nconst commentRouter = require('./modules/commentRouter');\n\nmodule.exports = combineRoutes(publicRoutes, loginRoutes, userRoutes, contentRouter, commentRouter);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy5qcyJdLCJuYW1lcyI6WyJjb21iaW5lUm91dGVzIiwicmVxdWlyZSIsInB1YmxpY1JvdXRlcyIsInVzZXJSb3V0ZXMiLCJsb2dpblJvdXRlcyIsImNvbnRlbnRSb3V0ZXIiLCJjb21tZW50Um91dGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0EsTUFBTUEsYUFBYSxHQUFDQyxPQUFPLENBQUMscUJBQUQsQ0FBM0I7O0FBQ0EsTUFBTUMsWUFBWSxHQUFDRCxPQUFPLENBQUMsd0JBQUQsQ0FBMUI7O0FBQ0EsTUFBTUUsVUFBVSxHQUFDRixPQUFPLENBQUMsc0JBQUQsQ0FBeEI7O0FBQ0EsTUFBTUcsV0FBVyxHQUFDSCxPQUFPLENBQUMsdUJBQUQsQ0FBekI7O0FBQ0EsTUFBTUksYUFBYSxHQUFDSixPQUFPLENBQUMseUJBQUQsQ0FBM0I7O0FBQ0EsTUFBTUssYUFBYSxHQUFDTCxPQUFPLENBQUMseUJBQUQsQ0FBM0I7O0FBRUFNLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlUixhQUFhLENBQ3hCRSxZQUR3QixFQUV4QkUsV0FGd0IsRUFHeEJELFVBSHdCLEVBSXhCRSxhQUp3QixFQUt4QkMsYUFMd0IsQ0FBNUIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvcm91dGVzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IGNvbWJpbmVSb3V0ZXMgZnJvbSAna29hLWNvbWJpbmUtcm91dGVycydcblxuLy8gY29uc3QgbW9kdWxlRmlsZXMgPSByZXF1aXJlLmNvbnRleHQoJy4vbW9kdWxlcycsIHRydWUsIC9cXC5qcyQvKVxuXG4vLyBjb25zdCBtb2R1bGVzID0gbW9kdWxlRmlsZXMua2V5cygpLnJlZHVjZSgoaXRlbXMsIHBhdGgpID0+IHtcbi8vICAgICBjb25zdCB2YWx1ZSA9IG1vZHVsZUZpbGVzKHBhdGgpXG4vLyAgICAgaXRlbXMucHVzaCh2YWx1ZS5kZWZhdWx0KVxuLy8gICAgIHJldHVybiBpdGVtc1xuLy8gfSwgW10pXG5cbi8vIGV4cG9ydCBkZWZhdWx0IGNvbWJpbmVSb3V0ZXMobW9kdWxlcylcblxuXG5jb25zdCBjb21iaW5lUm91dGVzPXJlcXVpcmUoJ2tvYS1jb21iaW5lLXJvdXRlcnMnKVxuY29uc3QgcHVibGljUm91dGVzPXJlcXVpcmUoJy4vbW9kdWxlcy9wdWJsaWNSb3V0ZXInKVxuY29uc3QgdXNlclJvdXRlcz1yZXF1aXJlKCcuL21vZHVsZXMvdXNlclJvdXRlcicpXG5jb25zdCBsb2dpblJvdXRlcz1yZXF1aXJlKCcuL21vZHVsZXMvbG9naW5Sb3V0ZXInKVxuY29uc3QgY29udGVudFJvdXRlcj1yZXF1aXJlKCcuL21vZHVsZXMvY29udGVudFJvdXRlcicpXG5jb25zdCBjb21tZW50Um91dGVyPXJlcXVpcmUoJy4vbW9kdWxlcy9jb21tZW50Um91dGVyJylcblxubW9kdWxlLmV4cG9ydHM9Y29tYmluZVJvdXRlcyhcbiAgICBwdWJsaWNSb3V0ZXMsXG4gICAgbG9naW5Sb3V0ZXMsXG4gICAgdXNlclJvdXRlcyxcbiAgICBjb250ZW50Um91dGVyLFxuICAgIGNvbW1lbnRSb3V0ZXJcbikiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "routes.js"
      ],
      "names": [
        "combineRoutes",
        "require",
        "publicRoutes",
        "userRoutes",
        "loginRoutes",
        "contentRouter",
        "commentRouter",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAGA,MAAMA,aAAa,GAACC,OAAO,CAAC,qBAAD,CAA3B;;AACA,MAAMC,YAAY,GAACD,OAAO,CAAC,wBAAD,CAA1B;;AACA,MAAME,UAAU,GAACF,OAAO,CAAC,sBAAD,CAAxB;;AACA,MAAMG,WAAW,GAACH,OAAO,CAAC,uBAAD,CAAzB;;AACA,MAAMI,aAAa,GAACJ,OAAO,CAAC,yBAAD,CAA3B;;AACA,MAAMK,aAAa,GAACL,OAAO,CAAC,yBAAD,CAA3B;;AAEAM,MAAM,CAACC,OAAP,GAAeR,aAAa,CACxBE,YADwB,EAExBE,WAFwB,EAGxBD,UAHwB,EAIxBE,aAJwB,EAKxBC,aALwB,CAA5B",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes",
      "sourcesContent": [
        "// import combineRoutes from 'koa-combine-routers'\n\n// const moduleFiles = require.context('./modules', true, /\\.js$/)\n\n// const modules = moduleFiles.keys().reduce((items, path) => {\n//     const value = moduleFiles(path)\n//     items.push(value.default)\n//     return items\n// }, [])\n\n// export default combineRoutes(modules)\n\n\nconst combineRoutes=require('koa-combine-routers')\nconst publicRoutes=require('./modules/publicRouter')\nconst userRoutes=require('./modules/userRouter')\nconst loginRoutes=require('./modules/loginRouter')\nconst contentRouter=require('./modules/contentRouter')\nconst commentRouter=require('./modules/commentRouter')\n\nmodule.exports=combineRoutes(\n    publicRoutes,\n    loginRoutes,\n    userRoutes,\n    contentRouter,\n    commentRouter\n)"
      ]
    },
    "sourceType": "script",
    "mtime": 1585709511114
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/publicRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/publicRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/publicRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/publicRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "publicRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst publicController = require('../../api/PublicController');\n\nconst contentController = require('../../api/ContentController');\n\nconst commentController = require('../../api/CommentController');\n\nconst router = new Router();\nrouter.prefix('/public');\nrouter.get('/getCaptcha', publicController);\nrouter.get('/list', contentController.getPostList);\nrouter.get('/content/detail', contentController.getPostDetail);\nrouter.get('/comments', commentController.getComments);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1YmxpY1JvdXRlci5qcyJdLCJuYW1lcyI6WyJSb3V0ZXIiLCJyZXF1aXJlIiwicHVibGljQ29udHJvbGxlciIsImNvbnRlbnRDb250cm9sbGVyIiwiY29tbWVudENvbnRyb2xsZXIiLCJyb3V0ZXIiLCJwcmVmaXgiLCJnZXQiLCJnZXRQb3N0TGlzdCIsImdldFBvc3REZXRhaWwiLCJnZXRDb21tZW50cyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsTUFBTSxHQUFDQyxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxnQkFBZ0IsR0FBQ0QsT0FBTyxDQUFDLDRCQUFELENBQTlCOztBQUNBLE1BQU1FLGlCQUFpQixHQUFDRixPQUFPLENBQUMsNkJBQUQsQ0FBL0I7O0FBQ0EsTUFBTUcsaUJBQWlCLEdBQUNILE9BQU8sQ0FBQyw2QkFBRCxDQUEvQjs7QUFFQSxNQUFNSSxNQUFNLEdBQUMsSUFBSUwsTUFBSixFQUFiO0FBRUFLLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFNBQWQ7QUFDQUQsTUFBTSxDQUFDRSxHQUFQLENBQVcsYUFBWCxFQUF5QkwsZ0JBQXpCO0FBRUFHLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLE9BQVgsRUFBb0JKLGlCQUFpQixDQUFDSyxXQUF0QztBQUVBSCxNQUFNLENBQUNFLEdBQVAsQ0FBVyxpQkFBWCxFQUE2QkosaUJBQWlCLENBQUNNLGFBQS9DO0FBRUFKLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLFdBQVgsRUFBdUJILGlCQUFpQixDQUFDTSxXQUF6QztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBZVAsTUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlcj1yZXF1aXJlKCdrb2Etcm91dGVyJylcbmNvbnN0IHB1YmxpY0NvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL1B1YmxpY0NvbnRyb2xsZXInKVxuY29uc3QgY29udGVudENvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL0NvbnRlbnRDb250cm9sbGVyJylcbmNvbnN0IGNvbW1lbnRDb250cm9sbGVyPXJlcXVpcmUoJy4uLy4uL2FwaS9Db21tZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcblxucm91dGVyLnByZWZpeCgnL3B1YmxpYycpXG5yb3V0ZXIuZ2V0KCcvZ2V0Q2FwdGNoYScscHVibGljQ29udHJvbGxlcilcblxucm91dGVyLmdldCgnL2xpc3QnLCBjb250ZW50Q29udHJvbGxlci5nZXRQb3N0TGlzdClcblxucm91dGVyLmdldCgnL2NvbnRlbnQvZGV0YWlsJyxjb250ZW50Q29udHJvbGxlci5nZXRQb3N0RGV0YWlsKVxuXG5yb3V0ZXIuZ2V0KCcvY29tbWVudHMnLGNvbW1lbnRDb250cm9sbGVyLmdldENvbW1lbnRzKVxuXG5tb2R1bGUuZXhwb3J0cz1yb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "publicRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "publicController",
        "contentController",
        "commentController",
        "router",
        "prefix",
        "get",
        "getPostList",
        "getPostDetail",
        "getComments",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,gBAAgB,GAACD,OAAO,CAAC,4BAAD,CAA9B;;AACA,MAAME,iBAAiB,GAACF,OAAO,CAAC,6BAAD,CAA/B;;AACA,MAAMG,iBAAiB,GAACH,OAAO,CAAC,6BAAD,CAA/B;;AAEA,MAAMI,MAAM,GAAC,IAAIL,MAAJ,EAAb;AAEAK,MAAM,CAACC,MAAP,CAAc,SAAd;AACAD,MAAM,CAACE,GAAP,CAAW,aAAX,EAAyBL,gBAAzB;AAEAG,MAAM,CAACE,GAAP,CAAW,OAAX,EAAoBJ,iBAAiB,CAACK,WAAtC;AAEAH,MAAM,CAACE,GAAP,CAAW,iBAAX,EAA6BJ,iBAAiB,CAACM,aAA/C;AAEAJ,MAAM,CAACE,GAAP,CAAW,WAAX,EAAuBH,iBAAiB,CAACM,WAAzC;AAEAC,MAAM,CAACC,OAAP,GAAeP,MAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst publicController=require('../../api/PublicController')\nconst contentController=require('../../api/ContentController')\nconst commentController=require('../../api/CommentController')\n\nconst router=new Router()\n\nrouter.prefix('/public')\nrouter.get('/getCaptcha',publicController)\n\nrouter.get('/list', contentController.getPostList)\n\nrouter.get('/content/detail',contentController.getPostDetail)\n\nrouter.get('/comments',commentController.getComments)\n\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585714190541
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/PublicController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/PublicController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/PublicController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/PublicController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "PublicController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst svgCaptcha = require('svg-captcha');\n\nconst redisConfig = require('../config/RedisConfig'); // const redisConfig=require('@/config/RedisConfig')\n// import svgCaptcha from 'svg-captcha'     es6\n// class PublicController{\n//     constructor() {}\n//     async getCaptcha(ctx) {\n//         const body = ctx.request.query\n//         console.log(body.sid)\n//         const newCaptcha=svgCaptcha.create({\n//             size: 4,\n//             ignoreChars: '0olil',\n//             color: true,\n//             noise: Math.floor(Math.random() * 5),\n//             width: 150,\n//             height: 50\n//         })\n//         // console.log(newCaptcha)\n//         ctx.body={\n//             code: 200,\n//             data: newCaptcha.data,\n//         }\n//     }\n// }\n\n\nmodule.exports = function (ctx) {\n  const body = ctx.request.query;\n  console.log(body.sid);\n  const newCaptcha = svgCaptcha.create({\n    size: 4,\n    ignoreChars: '0olil',\n    color: true,\n    noise: Math.floor(Math.random() * 5),\n    width: 150,\n    height: 50\n  }); // console.log(newCaptcha)\n\n  redisConfig.setValue(body.sid, newCaptcha.text, 10 * 60); //save for 10m\n  // redisConfig.getValue(body.sid).then((res) => {\n  //     console.log(res)\n  // })\n\n  ctx.body = {\n    code: 200,\n    data: newCaptcha.data\n  };\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlB1YmxpY0NvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsic3ZnQ2FwdGNoYSIsInJlcXVpcmUiLCJyZWRpc0NvbmZpZyIsIm1vZHVsZSIsImV4cG9ydHMiLCJjdHgiLCJib2R5IiwicmVxdWVzdCIsInF1ZXJ5IiwiY29uc29sZSIsImxvZyIsInNpZCIsIm5ld0NhcHRjaGEiLCJjcmVhdGUiLCJzaXplIiwiaWdub3JlQ2hhcnMiLCJjb2xvciIsIm5vaXNlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwid2lkdGgiLCJoZWlnaHQiLCJzZXRWYWx1ZSIsInRleHQiLCJjb2RlIiwiZGF0YSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxVQUFVLEdBQUNDLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLE1BQU1DLFdBQVcsR0FBQ0QsT0FBTyxDQUFDLHVCQUFELENBQXpCLEMsQ0FDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0FFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlLFVBQVNDLEdBQVQsRUFBYTtBQUN4QixRQUFNQyxJQUFJLEdBQUdELEdBQUcsQ0FBQ0UsT0FBSixDQUFZQyxLQUF6QjtBQUNBQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUosSUFBSSxDQUFDSyxHQUFqQjtBQUNBLFFBQU1DLFVBQVUsR0FBQ1osVUFBVSxDQUFDYSxNQUFYLENBQWtCO0FBQy9CQyxJQUFBQSxJQUFJLEVBQUUsQ0FEeUI7QUFFL0JDLElBQUFBLFdBQVcsRUFBRSxPQUZrQjtBQUcvQkMsSUFBQUEsS0FBSyxFQUFFLElBSHdCO0FBSS9CQyxJQUFBQSxLQUFLLEVBQUVDLElBQUksQ0FBQ0MsS0FBTCxDQUFXRCxJQUFJLENBQUNFLE1BQUwsS0FBZ0IsQ0FBM0IsQ0FKd0I7QUFLL0JDLElBQUFBLEtBQUssRUFBRSxHQUx3QjtBQU0vQkMsSUFBQUEsTUFBTSxFQUFFO0FBTnVCLEdBQWxCLENBQWpCLENBSHdCLENBV3hCOztBQUNBcEIsRUFBQUEsV0FBVyxDQUFDcUIsUUFBWixDQUFxQmpCLElBQUksQ0FBQ0ssR0FBMUIsRUFBK0JDLFVBQVUsQ0FBQ1ksSUFBMUMsRUFBK0MsS0FBSyxFQUFwRCxFQVp3QixDQVlnQztBQUN4RDtBQUNBO0FBQ0E7O0FBQ0FuQixFQUFBQSxHQUFHLENBQUNDLElBQUosR0FBUztBQUNMbUIsSUFBQUEsSUFBSSxFQUFDLEdBREE7QUFFTEMsSUFBQUEsSUFBSSxFQUFDZCxVQUFVLENBQUNjO0FBRlgsR0FBVDtBQUlILENBcEJEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL2FwaSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHN2Z0NhcHRjaGE9cmVxdWlyZSgnc3ZnLWNhcHRjaGEnKVxuY29uc3QgcmVkaXNDb25maWc9cmVxdWlyZSgnLi4vY29uZmlnL1JlZGlzQ29uZmlnJylcbi8vIGNvbnN0IHJlZGlzQ29uZmlnPXJlcXVpcmUoJ0AvY29uZmlnL1JlZGlzQ29uZmlnJylcbi8vIGltcG9ydCBzdmdDYXB0Y2hhIGZyb20gJ3N2Zy1jYXB0Y2hhJyAgICAgZXM2XG5cblxuLy8gY2xhc3MgUHVibGljQ29udHJvbGxlcntcbi8vICAgICBjb25zdHJ1Y3RvcigpIHt9XG4vLyAgICAgYXN5bmMgZ2V0Q2FwdGNoYShjdHgpIHtcbi8vICAgICAgICAgY29uc3QgYm9keSA9IGN0eC5yZXF1ZXN0LnF1ZXJ5XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKGJvZHkuc2lkKVxuLy8gICAgICAgICBjb25zdCBuZXdDYXB0Y2hhPXN2Z0NhcHRjaGEuY3JlYXRlKHtcbi8vICAgICAgICAgICAgIHNpemU6IDQsXG4vLyAgICAgICAgICAgICBpZ25vcmVDaGFyczogJzBvbGlsJyxcbi8vICAgICAgICAgICAgIGNvbG9yOiB0cnVlLFxuLy8gICAgICAgICAgICAgbm9pc2U6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpLFxuLy8gICAgICAgICAgICAgd2lkdGg6IDE1MCxcbi8vICAgICAgICAgICAgIGhlaWdodDogNTBcbi8vICAgICAgICAgfSlcbi8vICAgICAgICAgLy8gY29uc29sZS5sb2cobmV3Q2FwdGNoYSlcbi8vICAgICAgICAgY3R4LmJvZHk9e1xuLy8gICAgICAgICAgICAgY29kZTogMjAwLFxuLy8gICAgICAgICAgICAgZGF0YTogbmV3Q2FwdGNoYS5kYXRhLFxuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxubW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oY3R4KXtcbiAgICBjb25zdCBib2R5ID0gY3R4LnJlcXVlc3QucXVlcnlcbiAgICBjb25zb2xlLmxvZyhib2R5LnNpZClcbiAgICBjb25zdCBuZXdDYXB0Y2hhPXN2Z0NhcHRjaGEuY3JlYXRlKHtcbiAgICAgICAgc2l6ZTogNCxcbiAgICAgICAgaWdub3JlQ2hhcnM6ICcwb2xpbCcsXG4gICAgICAgIGNvbG9yOiB0cnVlLFxuICAgICAgICBub2lzZTogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSksXG4gICAgICAgIHdpZHRoOiAxNTAsXG4gICAgICAgIGhlaWdodDogNTBcbiAgICB9KVxuICAgIC8vIGNvbnNvbGUubG9nKG5ld0NhcHRjaGEpXG4gICAgcmVkaXNDb25maWcuc2V0VmFsdWUoYm9keS5zaWQsIG5ld0NhcHRjaGEudGV4dCwxMCAqIDYwKSAvL3NhdmUgZm9yIDEwbVxuICAgIC8vIHJlZGlzQ29uZmlnLmdldFZhbHVlKGJvZHkuc2lkKS50aGVuKChyZXMpID0+IHtcbiAgICAvLyAgICAgY29uc29sZS5sb2cocmVzKVxuICAgIC8vIH0pXG4gICAgY3R4LmJvZHk9e1xuICAgICAgICBjb2RlOjIwMCxcbiAgICAgICAgZGF0YTpuZXdDYXB0Y2hhLmRhdGEsXG4gICAgfVxufSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "PublicController.js"
      ],
      "names": [
        "svgCaptcha",
        "require",
        "redisConfig",
        "module",
        "exports",
        "ctx",
        "body",
        "request",
        "query",
        "console",
        "log",
        "sid",
        "newCaptcha",
        "create",
        "size",
        "ignoreChars",
        "color",
        "noise",
        "Math",
        "floor",
        "random",
        "width",
        "height",
        "setValue",
        "text",
        "code",
        "data"
      ],
      "mappings": ";;AAAA,MAAMA,UAAU,GAACC,OAAO,CAAC,aAAD,CAAxB;;AACA,MAAMC,WAAW,GAACD,OAAO,CAAC,uBAAD,CAAzB,C,CACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAE,MAAM,CAACC,OAAP,GAAe,UAASC,GAAT,EAAa;AACxB,QAAMC,IAAI,GAAGD,GAAG,CAACE,OAAJ,CAAYC,KAAzB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYJ,IAAI,CAACK,GAAjB;AACA,QAAMC,UAAU,GAACZ,UAAU,CAACa,MAAX,CAAkB;AAC/BC,IAAAA,IAAI,EAAE,CADyB;AAE/BC,IAAAA,WAAW,EAAE,OAFkB;AAG/BC,IAAAA,KAAK,EAAE,IAHwB;AAI/BC,IAAAA,KAAK,EAAEC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,CAA3B,CAJwB;AAK/BC,IAAAA,KAAK,EAAE,GALwB;AAM/BC,IAAAA,MAAM,EAAE;AANuB,GAAlB,CAAjB,CAHwB,CAWxB;;AACApB,EAAAA,WAAW,CAACqB,QAAZ,CAAqBjB,IAAI,CAACK,GAA1B,EAA+BC,UAAU,CAACY,IAA1C,EAA+C,KAAK,EAApD,EAZwB,CAYgC;AACxD;AACA;AACA;;AACAnB,EAAAA,GAAG,CAACC,IAAJ,GAAS;AACLmB,IAAAA,IAAI,EAAC,GADA;AAELC,IAAAA,IAAI,EAACd,UAAU,CAACc;AAFX,GAAT;AAIH,CApBD",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "const svgCaptcha=require('svg-captcha')\nconst redisConfig=require('../config/RedisConfig')\n// const redisConfig=require('@/config/RedisConfig')\n// import svgCaptcha from 'svg-captcha'     es6\n\n\n// class PublicController{\n//     constructor() {}\n//     async getCaptcha(ctx) {\n//         const body = ctx.request.query\n//         console.log(body.sid)\n//         const newCaptcha=svgCaptcha.create({\n//             size: 4,\n//             ignoreChars: '0olil',\n//             color: true,\n//             noise: Math.floor(Math.random() * 5),\n//             width: 150,\n//             height: 50\n//         })\n//         // console.log(newCaptcha)\n//         ctx.body={\n//             code: 200,\n//             data: newCaptcha.data,\n//         }\n//     }\n// }\nmodule.exports=function(ctx){\n    const body = ctx.request.query\n    console.log(body.sid)\n    const newCaptcha=svgCaptcha.create({\n        size: 4,\n        ignoreChars: '0olil',\n        color: true,\n        noise: Math.floor(Math.random() * 5),\n        width: 150,\n        height: 50\n    })\n    // console.log(newCaptcha)\n    redisConfig.setValue(body.sid, newCaptcha.text,10 * 60) //save for 10m\n    // redisConfig.getValue(body.sid).then((res) => {\n    //     console.log(res)\n    // })\n    ctx.body={\n        code:200,\n        data:newCaptcha.data,\n    }\n}"
      ]
    },
    "sourceType": "script",
    "mtime": 1584437157098
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/RedisConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/RedisConfig.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/RedisConfig.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/RedisConfig.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
        "sourceFileName": "RedisConfig.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// for es5: const => var\nconst redis = require(\"redis\"); // import redis from 'redis'\n// const config = require(\"./index\")\n\n\nvar Promise = require('bluebird');\n\nvar DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb';\nvar REDIS = {\n  host: '47.99.202.255',\n  port: 15001,\n  password: '123456'\n};\nvar options = {\n  host: REDIS.host,\n  port: REDIS.port,\n  password: REDIS.password,\n  detect_buffers: true,\n  retry_strategy: function (options) {\n    if (options.error && options.error.code === 'ECONNREFUSED') {\n      return new Error('The server refused the connection');\n    }\n\n    if (options.total_retry_time > 1000 * 60 * 60) {\n      return new Error('Retry time exhausted');\n    }\n\n    if (options.attempt > 10) {\n      return undefined;\n    }\n\n    return Math.min(options.attempt * 100, 3000);\n  }\n};\nconst client = Promise.promisifyAll(redis.createClient(options)); // const client = redis.createClient(options)\n\nclient.on('error', function (err) {\n  console.log('Redis Client Error:' + err);\n});\n\nfunction setValue(key, value, time) {\n  if (typeof value === 'undefined' || value == null || value === '') {\n    return;\n  }\n\n  if (typeof value === 'string') {\n    if (typeof time !== 'undefined') {\n      client.set(key, value, 'EX', time);\n    } else {\n      client.set(key, value);\n    }\n  } else if (typeof value === 'object') {\n    Object.keys(value).forEach(item => {\n      client.hset(key, item, value[item], redis.print);\n    });\n  }\n} // setValue('id','24')\n\n\nfunction getValue(key) {\n  return client.getAsync(key);\n}\n\nvar getHValue = key => {\n  return client.hgetallAsync(key);\n};\n\nvar delValue = key => {\n  client.del(key, (err, res) => {\n    if (res === 1) {\n      console.log('delete successfully');\n    } else {\n      console.log('delete redis key error:' + err);\n    }\n  });\n}; // export {\n//     client,\n//     setValue,\n//     getValue,\n//     getHValue,\n//     delValue\n// }\n\n\nmodule.exports = {\n  client,\n  setValue,\n  getValue,\n  getHValue,\n  delValue\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlZGlzQ29uZmlnLmpzIl0sIm5hbWVzIjpbInJlZGlzIiwicmVxdWlyZSIsIlByb21pc2UiLCJEQl9VUkwiLCJSRURJUyIsImhvc3QiLCJwb3J0IiwicGFzc3dvcmQiLCJvcHRpb25zIiwiZGV0ZWN0X2J1ZmZlcnMiLCJyZXRyeV9zdHJhdGVneSIsImVycm9yIiwiY29kZSIsIkVycm9yIiwidG90YWxfcmV0cnlfdGltZSIsImF0dGVtcHQiLCJ1bmRlZmluZWQiLCJNYXRoIiwibWluIiwiY2xpZW50IiwicHJvbWlzaWZ5QWxsIiwiY3JlYXRlQ2xpZW50Iiwib24iLCJlcnIiLCJjb25zb2xlIiwibG9nIiwic2V0VmFsdWUiLCJrZXkiLCJ2YWx1ZSIsInRpbWUiLCJzZXQiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsIml0ZW0iLCJoc2V0IiwicHJpbnQiLCJnZXRWYWx1ZSIsImdldEFzeW5jIiwiZ2V0SFZhbHVlIiwiaGdldGFsbEFzeW5jIiwiZGVsVmFsdWUiLCJkZWwiLCJyZXMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFyQixDLENBQ0E7QUFDQTs7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFFQSxJQUFJRSxNQUFNLEdBQUMsa0RBQVg7QUFDQSxJQUFJQyxLQUFLLEdBQUc7QUFDUkMsRUFBQUEsSUFBSSxFQUFFLGVBREU7QUFFUkMsRUFBQUEsSUFBSSxFQUFFLEtBRkU7QUFHUkMsRUFBQUEsUUFBUSxFQUFFO0FBSEYsQ0FBWjtBQU1BLElBQUlDLE9BQU8sR0FBRztBQUNWSCxFQUFBQSxJQUFJLEVBQUVELEtBQUssQ0FBQ0MsSUFERjtBQUVWQyxFQUFBQSxJQUFJLEVBQUVGLEtBQUssQ0FBQ0UsSUFGRjtBQUdWQyxFQUFBQSxRQUFRLEVBQUVILEtBQUssQ0FBQ0csUUFITjtBQUlWRSxFQUFBQSxjQUFjLEVBQUUs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QUMxQixFQUFBQSxNQUFEO0FBQVFPLEVBQUFBLFFBQVI7QUFBaUJXLEVBQUFBLFFBQWpCO0FBQTBCRSxFQUFBQSxTQUExQjtBQUFvQ0UsRUFBQUE7QUFBcEMsQ0FBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyIvLyBmb3IgZXM1OiBjb25zdCA9PiB2YXJcblxuY29uc3QgcmVkaXMgPSByZXF1aXJlKFwicmVkaXNcIilcbi8vIGltcG9ydCByZWRpcyBmcm9tICdyZWRpcydcbi8vIGNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoXCIuL2luZGV4XCIpXG52YXIgUHJvbWlzZSA9IHJlcXVpcmUoJ2JsdWViaXJkJylcblxudmFyIERCX1VSTD0nbW9uZ29kYjovL3Rlc3Q6MTIzNDU2QDQ3Ljk5LjIwMi4yNTU6MTUwMDEvdGVzdGRiJ1xudmFyIFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAxNTAwMSxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cblxudmFyIG9wdGlvbnMgPSB7XG4gICAgaG9zdDogUkVESVMuaG9zdCxcbiAgICBwb3J0OiBSRURJUy5wb3J0LFxuICAgIHBhc3N3b3JkOiBSRURJUy5wYXNzd29yZCxcbiAgICBkZXRlY3RfYnVmZmVyczogdHJ1ZSxcbiAgICByZXRyeV9zdHJhdGVneTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuZXJyb3IgJiYgb3B0aW9ucy5lcnJvci5jb2RlID09PSAnRUNPTk5SRUZVU0VEJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignVGhlIHNlcnZlciByZWZ1c2VkIHRoZSBjb25uZWN0aW9uJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMudG90YWxfcmV0cnlfdGltZSA+IDEwMDAgKiA2MCAqIDYwKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdSZXRyeSB0aW1lIGV4aGF1c3RlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmF0dGVtcHQgPiAxMCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTWF0aC5taW4ob3B0aW9ucy5hdHRlbXB0ICogMTAwLCAzMDAwKTtcbiAgICB9XG59XG5cbmNvbnN0IGNsaWVudCA9IFByb21pc2UucHJvbWlzaWZ5QWxsKHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKSlcbi8vIGNvbnN0IGNsaWVudCA9IHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKVxuXG5jbGllbnQub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycikge1xuICAgIGNvbnNvbGUubG9nKCdSZWRpcyBDbGllbnQgRXJyb3I6JyArIGVycilcbn0pXG5cbmZ1bmN0aW9uIHNldFZhbHVlIChrZXksIHZhbHVlLCB0aW1lKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgdmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycpe1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYodHlwZW9mIHRpbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjbGllbnQuc2V0KGtleSx2YWx1ZSwnRVgnLHRpbWUpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjbGllbnQuc2V0KGtleSx2YWx1ZSlcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jyl7XG4gICAgICAgIE9iamVjdC5rZXlzKHZhbHVlKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICBjbGllbnQuaHNldChrZXksIGl0ZW0sIHZhbHVlW2l0ZW1dLCByZWRpcy5wcmludClcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbi8vIHNldFZhbHVlKCdpZCcsJzI0JylcblxuZnVuY3Rpb24gZ2V0VmFsdWUgKGtleSkge1xuICAgIHJldHVybiBjbGllbnQuZ2V0QXN5bmMoa2V5KVxufVxuXG52YXIgZ2V0SFZhbHVlID0gKGtleSkgPT4ge1xuICAgIHJldHVybiBjbGllbnQuaGdldGFsbEFzeW5jKGtleSlcbn1cblxudmFyIGRlbFZhbHVlID0gKGtleSkgPT4ge1xuICAgIGNsaWVudC5kZWwoa2V5LCAoZXJyLCByZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcz09PTEpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0ZSBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGUgcmVkaXMga2V5IGVycm9yOicgKyBlcnIpXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG4vLyBleHBvcnQge1xuLy8gICAgIGNsaWVudCxcbi8vICAgICBzZXRWYWx1ZSxcbi8vICAgICBnZXRWYWx1ZSxcbi8vICAgICBnZXRIVmFsdWUsXG4vLyAgICAgZGVsVmFsdWVcbi8vIH1cbm1vZHVsZS5leHBvcnRzPXtjbGllbnQsc2V0VmFsdWUsZ2V0VmFsdWUsZ2V0SFZhbHVlLGRlbFZhbHVlfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "RedisConfig.js"
      ],
      "names": [
        "redis",
        "require",
        "Promise",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "options",
        "detect_buffers",
        "retry_strategy",
        "error",
        "code",
        "Error",
        "total_retry_time",
        "attempt",
        "undefined",
        "Math",
        "min",
        "client",
        "promisifyAll",
        "createClient",
        "on",
        "err",
        "console",
        "log",
        "setValue",
        "key",
        "value",
        "time",
        "set",
        "Object",
        "keys",
        "forEach",
        "item",
        "hset",
        "print",
        "getValue",
        "getAsync",
        "getHValue",
        "hgetallAsync",
        "delValue",
        "del",
        "res",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "sourcesContent": [
        "// for es5: const => var\n\nconst redis = require(\"redis\")\n// import redis from 'redis'\n// const config = require(\"./index\")\nvar Promise = require('bluebird')\n\nvar DB_URL='mongodb://test:123456@47.99.202.255:15001/testdb'\nvar REDIS = {\n    host: '47.99.202.255',\n    port: 15001,\n    password: '123456'\n}\n\nvar options = {\n    host: REDIS.host,\n    port: REDIS.port,\n    password: REDIS.password,\n    detect_buffers: true,\n    retry_strategy: function (options) {\n        if (options.error && options.error.code === 'ECONNREFUSED') {\n            return new Error('The server refused the connection');\n        }\n        if (options.total_retry_time > 1000 * 60 * 60) {\n            return new Error('Retry time exhausted');\n        }\n        if (options.attempt > 10) {\n            return undefined;\n        }\n        return Math.min(options.attempt * 100, 3000);\n    }\n}\n\nconst client = Promise.promisifyAll(redis.createClient(options))\n// const client = redis.createClient(options)\n\nclient.on('error', function (err) {\n    console.log('Redis Client Error:' + err)\n})\n\nfunction setValue (key, value, time) {\n    if (typeof value === 'undefined' || value == null || value === ''){\n        return\n    }\n    if (typeof value === 'string') {\n        if(typeof time !== 'undefined') {\n            client.set(key,value,'EX',time)\n        } else {\n            client.set(key,value)\n        }\n    } else if (typeof value === 'object'){\n        Object.keys(value).forEach((item) => {\n            client.hset(key, item, value[item], redis.print)\n        })\n    }\n}\n\n// setValue('id','24')\n\nfunction getValue (key) {\n    return client.getAsync(key)\n}\n\nvar getHValue = (key) => {\n    return client.hgetallAsync(key)\n}\n\nvar delValue = (key) => {\n    client.del(key, (err, res) => {\n        if (res===1){\n            console.log('delete successfully');\n        } else {\n            console.log('delete redis key error:' + err)\n        }\n    })\n}\n\n// export {\n//     client,\n//     setValue,\n//     getValue,\n//     getHValue,\n//     delValue\n// }\nmodule.exports={client,setValue,getValue,getHValue,delValue}"
      ]
    },
    "sourceType": "script",
    "mtime": 1582788906050
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/ContentController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/ContentController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/ContentController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/ContentController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "ContentController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import Post from '../model/Post'\nconst Post = require('../model/Post');\n\nconst config = require('../config/index');\n\nconst User = require('../model/User'); // const Comments = require('../model/Comments')\n\n\nconst {\n  checkCode,\n  getJWTPayload\n} = require('../common/Utils');\n\nconst UserCollect = require('../model/UserCollect');\n\nconst moment = require('dayjs');\n\nconst mkdir = require('make-dir');\n\nconst uuid = require(\"uuid/v4\");\n\nconst fs = require('fs');\n\nasync function getPostList(ctx) {\n  // const post = new Post({\n  //     uid:'5e6db4551418c95ecec41ac8',  //现在插入需要 uid ，之前不知道是怎么插入成功的\n  //     title:'test title5',\n  //     content:'test content 1',\n  //     catalog:'share',\n  //     fav:20,\n  //     isEnd:'0',\n  //     reads:'0',\n  //     answer:'0',\n  //     status:'0',\n  //     isTop:'0',\n  //     sort:'0',\n  //     tags:[{\n  //         name:'精华',\n  //         class: ''\n  //     }]\n  // })\n  // const tmp=await post.save()\n  // console.log(\"module.exports -> tmp\", tmp)\n  const body = ctx.query;\n  const sort = body.sort ? body.sort : 'created';\n  const page = body.page ? parseInt(body.page) : 0;\n  const limit = body.limit ? parseInt(body.limit) : 20;\n  const options = {};\n\n  if (typeof body.catalog !== 'undefined' && body.catalog !== '') {\n    options.catalog = body.catalog;\n  }\n\n  if (typeof body.isTop !== 'undefined') {\n    options.isTop = body.isTop;\n  }\n\n  if (typeof body.status !== 'undefined' && body.status !== '') {\n    options.isEnd = body.status;\n  }\n\n  if (typeof body.tag !== 'undefined' && body.tag !== '') {\n    options.tags = {\n      $elemMatch: {\n        name: body.tag\n      }\n    };\n  } // const result = await Post.getList(options, sort, page, limit)\n  // const result = Post.getList(options, sort, page, limit)\n\n\n  const result = await Post.getList(options, sort, page, limit);\n  console.log(result);\n  ctx.body = {\n    code: 200,\n    data: result,\n    msg: '获取文章列表成功'\n  };\n}\n\nasync function uploadImg(ctx) {\n  const file = ctx.request.files.file;\n  console.log(\"uploadImg -> file\", file);\n  const ext = file.name.split('.').pop(); //删除并返回最后一个元素\n\n  const dir = `${config.uploadPath}/${moment().format('YYYYMMDD')}`;\n  await mkdir(dir);\n  const picname = uuid();\n  const destPath = `${dir}/${picname}.${ext}`;\n  const reader = fs.createReadStream(file.path); //文件路径\n\n  const upStream = fs.createWriteStream(destPath); //目标路径\n\n  const filePath = `/${moment().format('YYYYMMDD')}/${picname}.${ext}`; //日期/uuid.png\n\n  reader.pipe(upStream);\n  ctx.body = {\n    code: 200,\n    msg: '图片上传成功',\n    data: filePath\n  };\n}\n\nasync function addPost(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"addPost -> body\", body);\n  const sid = body.sid;\n  const code = body.code;\n  const result = await checkCode(sid, code);\n\n  if (result) {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const user = await User.findById({\n      _id: obj._id\n    });\n    console.log(\"addPost -> user\", user);\n\n    if (user.favs < body.fav) {\n      ctx.body = {\n        code: 501,\n        msg: '积分不足'\n      };\n      return;\n    } else {\n      await User.updateOne({\n        _id: obj._id\n      }, {\n        $inc: {\n          favs: -body.fav\n        }\n      });\n    }\n\n    const newPost = new Post(body);\n    newPost.uid = obj._id;\n    const result = await newPost.save();\n    ctx.body = {\n      code: 200,\n      msg: '成功保存的文章',\n      date: result\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '图片验证码验证失败'\n    };\n  }\n}\n\nasync function getPostDetail(ctx) {\n  const params = ctx.query;\n\n  if (!params.tid) {\n    ctx.body = {\n      code: 500,\n      msg: '文章id为空'\n    };\n    return;\n  }\n\n  const post = await Post.findByTid(params.tid);\n  let isFav = 0;\n\n  if (typeof ctx.header.authorization !== 'undefined' && ctx.header.authorization !== '') {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const userCollect = await UserCollect.findOne({\n      uid: obj._id,\n      tid: params.tid\n    });\n\n    if (userCollect && userCollect.tid) {\n      isFav = 1;\n    }\n  }\n\n  const newPost = post.toJSON();\n  newPost.isFav = isFav;\n  const result = await Post.updateOne({\n    _id: params.tid\n  }, {\n    $inc: {\n      reads: 1\n    }\n  });\n\n  if (post._id && result.ok === 1) {\n    ctx.body = {\n      code: 200,\n      data: newPost,\n      msg: '查询文章详情成功'\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '获取文章详情失败'\n    };\n  }\n}\n\nmodule.exports = {\n  getPostList,\n  uploadImg,\n  addPost,\n  getPostDetail\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbnRlbnRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlBvc3QiLCJyZXF1aXJlIiwiY29uZmlnIiwiVXNlciIsImNoZWNrQ29kZSIsImdldEpXVFBheWxvYWQiLCJVc2VyQ29sbGVjdCIsIm1vbWVudCIsIm1rZGlyIiwidXVpZCIsImZzIiwiZ2V0UG9zdExpc3QiLCJjdHgiLCJib2R5IiwicXVlcnkiLCJzb3J0IiwicGFnZSIsInBhcnNlSW50IiwibGltaXQiLCJvcHRpb25zIiwiY2F0YWxvZyIsImlzVG9wIiwic3RhdHVzIiwiaXNFbmQiLCJ0YWciLCJ0YWdzIiwiJGVsZW1NYXRjaCIsIm5hbWUiLCJyZXN1bHQiLCJnZXRMaXN0IiwiY29uc29sZSIsImxvZyIsImNvZGUiLCJkYXRhIiwibXNnIiwidXBsb2FkSW1nIiwiZmlsZSIsInJlcXVlc3QiLCJmaWxlcyIsImV4dCIsInNwbGl0IiwicG9wIiwiZGlyIiwidXBsb2FkUGF0aCIsImZvcm1hdCIsInBpY25hbWUiLCJkZXN0UGF0aCIsInJlYWRlciIsImNyZWF0ZVJlYWRTdHJlYW0iLCJwYXRoIiwidXBTdHJlYW0iLCJjcmVhdGVXcml0ZVN0cmVhbSIsImZpbGVQYXRoIiwicGlwZSIsImFkZFBvc3QiLCJzaWQiLCJvYmoiLCJoZWFkZXIiLCJhdXRob3JpemF0aW9uIiwidXNlciIsImZpbmRCeUlkIiwiX2lkIiwiZmF2cyIsImZhdiIsInVwZGF0ZU9uZSIsIiRpbmMiLCJuZXdQb3N0IiwidWlkIiwic2F2ZSIsImRhdGUiLCJnZXRQb3N0RGV0YWlsIiwicGFyYW1zIiwidGlkIiwicG9zdCIsImZpbmRCeVRpZCIsImlzRmF2IiwidXNlckNvbGxlY3QiLCJmaW5kT25lIiwidG9KU09OIiwicmVhZHMiLCJvayIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxlQUFELENBQXBCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxD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QUVELE1BQU0sQ0FBQ0M7QUFGOEIsS0FBcEIsQ0FBMUI7O0FBSUEsUUFBSUksV0FBVyxJQUFJQSxXQUFXLENBQUNKLEdBQS9CLEVBQW9DO0FBQ2hDRyxNQUFBQSxLQUFLLEdBQUcsQ0FBUjtBQUNIO0FBQ0o7O0FBQ0QsUUFBTVQsT0FBTyxHQUFHTyxJQUFJLENBQUNLLE1BQUwsRUFBaEI7QUFDQVosRUFBQUEsT0FBTyxDQUFDUyxLQUFSLEdBQWdCQSxLQUFoQjtBQUNBLFFBQU0vQyxNQUFNLEdBQUcsTUFBTTVCLElBQUksQ0FBQ2dFLFNBQUwsQ0FDakI7QUFBRUgsSUFBQUEsR0FBRyxFQUFFVSxNQUFNLENBQUNDO0FBQWQsR0FEaUIsRUFFakI7QUFBRVAsSUFBQUEsSUFBSSxFQUFFO0FBQUVjLE1BQUFBLEtBQUssRUFBRTtBQUFUO0FBQVIsR0FGaUIsQ0FBckI7O0FBSUEsTUFBSU4sSUFBSSxDQUFDWixHQUFMLElBQVlqQyxNQUFNLENBQUNvRCxFQUFQLEtBQWMsQ0FBOUIsRUFBaUM7QUFDN0JwRSxJQUFBQSxHQUFHLENBQUNDLElBQUosR0FBVztBQUNQbUIsTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUEMsTUFBQUEsSUFBSSxFQUFFaUMsT0FGQztBQUdQaEMsTUFBQUEsR0FBRyxFQUFFO0FBSEUsS0FBWDtBQUtILEdBTkQsTUFNTztBQUNIdEIsSUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUG1CLE1BQUFBLElBQUksRUFBRSxHQURDO0FBRVBFLE1BQUFBLEdBQUcsRUFBRTtBQUZFLEtBQVg7QUFJSDtBQUNKOztBQUdEK0MsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQUV2RSxFQUFBQSxXQUFGO0FBQWV3QixFQUFBQSxTQUFmO0FBQTBCbUIsRUFBQUEsT0FBMUI7QUFBbUNnQixFQUFBQTtBQUFuQyxDQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9hcGkiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgUG9zdCBmcm9tICcuLi9tb2RlbC9Qb3N0J1xuY29uc3QgUG9zdCA9IHJlcXVpcmUoJy4uL21vZGVsL1Bvc3QnKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4JylcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbC9Vc2VyJylcbi8vIGNvbnN0IENvbW1lbnRzID0gcmVxdWlyZSgnLi4vbW9kZWwvQ29tbWVudHMnKVxuY29uc3QgeyBjaGVja0NvZGUsIGdldEpXVFBheWxvYWQgfSA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG5jb25zdCBVc2VyQ29sbGVjdCA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXJDb2xsZWN0JylcblxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuY29uc3QgbWtkaXIgPSByZXF1aXJlKCdtYWtlLWRpcicpXG5jb25zdCB1dWlkID0gcmVxdWlyZShcInV1aWQvdjRcIilcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0TGlzdCAoY3R4KSB7XG4gICAgLy8gY29uc3QgcG9zdCA9IG5ldyBQb3N0KHtcbiAgICAvLyAgICAgdWlkOic1ZTZkYjQ1NTE0MThjOTVlY2VjNDFhYzgnLCAgLy/njrDlnKjmj5LlhaXpnIDopoEgdWlkIO+8jOS5i+WJjeS4jeefpemBk+aYr+aAjuS5iOaPkuWFpeaIkOWKn+eahFxuICAgIC8vICAgICB0aXRsZTondGVzdCB0aXRsZTUnLFxuICAgIC8vICAgICBjb250ZW50Oid0ZXN0IGNvbnRlbnQgMScsXG4gICAgLy8gICAgIGNhdGFsb2c6J3NoYXJlJyxcbiAgICAvLyAgICAgZmF2OjIwLFxuICAgIC8vICAgICBpc0VuZDonMCcsXG4gICAgLy8gICAgIHJlYWRzOicwJyxcbiAgICAvLyAgICAgYW5zd2VyOicwJyxcbiAgICAvLyAgICAgc3RhdHVzOicwJyxcbiAgICAvLyAgICAgaXNUb3A6JzAnLFxuICAgIC8vICAgICBzb3J0OicwJyxcbiAgICAvLyAgICAgdGFnczpbe1xuICAgIC8vICAgICAgICAgbmFtZTon57K+5Y2OJyxcbiAgICAvLyAgICAgICAgIGNsYXNzOiAnJ1xuICAgIC8vICAgICB9XVxuICAgIC8vIH0pXG4gICAgLy8gY29uc3QgdG1wPWF3YWl0IHBvc3Quc2F2ZSgpXG4gICAgLy8gY29uc29sZS5sb2coXCJtb2R1bGUuZXhwb3J0cyAtPiB0bXBcIiwgdG1wKVxuXG5cbiAgICBjb25zdCBib2R5ID0gY3R4LnF1ZXJ5XG4gICAgY29uc3Qgc29ydCA9IGJvZHkuc29ydCA/IGJvZHkuc29ydCA6ICdjcmVhdGVkJ1xuICAgIGNvbnN0IHBhZ2UgPSBib2R5LnBhZ2UgPyBwYXJzZUludChib2R5LnBhZ2UpIDogMFxuICAgIGNvbnN0IGxpbWl0ID0gYm9keS5saW1pdCA/IHBhcnNlSW50KGJvZHkubGltaXQpIDogMjBcbiAgICBjb25zdCBvcHRpb25zID0ge31cblxuICAgIGlmICh0eXBlb2YgYm9keS5jYXRhbG9nICE9PSAndW5kZWZpbmVkJyAmJiBib2R5LmNhdGFsb2cgIT09ICcnKSB7XG4gICAgICAgIG9wdGlvbnMuY2F0YWxvZyA9IGJvZHkuY2F0YWxvZ1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGJvZHkuaXNUb3AgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIG9wdGlvbnMuaXNUb3AgPSBib2R5LmlzVG9wXG4gICAgfVxuICAgIGlmICh0eXBlb2YgYm9keS5zdGF0dXMgIT09ICd1bmRlZmluZWQnICYmIGJvZHkuc3RhdHVzICE9PSAnJykge1xuICAgICAgICBvcHRpb25zLmlzRW5kID0gYm9keS5zdGF0dXNcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBib2R5LnRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYm9keS50YWcgIT09ICcnKSB7XG4gICAgICAgIG9wdGlvbnMudGFncyA9IHsgJGVsZW1NYXRjaDogeyBuYW1lOiBib2R5LnRhZyB9IH1cbiAgICB9XG4gICAgLy8gY29uc3QgcmVzdWx0ID0gYXdhaXQgUG9zdC5nZXRMaXN0KG9wdGlvbnMsIHNvcnQsIHBhZ2UsIGxpbWl0KVxuICAgIC8vIGNvbnN0IHJlc3VsdCA9IFBvc3QuZ2V0TGlzdChvcHRpb25zLCBzb3J0LCBwYWdlLCBsaW1pdClcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBQb3N0LmdldExpc3Qob3B0aW9ucywgc29ydCwgcGFnZSwgbGltaXQpXG4gICAgY29uc29sZS5sb2cocmVzdWx0KVxuXG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICBtc2c6ICfojrflj5bmlofnq6DliJfooajmiJDlip8nXG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiB1cGxvYWRJbWcgKGN0eCkge1xuICAgIGNvbnN0IGZpbGUgPSBjdHgucmVxdWVzdC5maWxlcy5maWxlXG4gICAgY29uc29sZS5sb2coXCJ1cGxvYWRJbWcgLT4gZmlsZVwiLCBmaWxlKVxuICAgIGNvbnN0IGV4dCA9IGZpbGUubmFtZS5zcGxpdCgnLicpLnBvcCgpIC8v5Yig6Zmk5bm26L+U5Zue5pyA5ZCO5LiA5Liq5YWD57SgXG4gICAgY29uc3QgZGlyID0gYCR7Y29uZmlnLnVwbG9hZFBhdGh9LyR7bW9tZW50KCkuZm9ybWF0KCdZWVlZTU1ERCcpfWBcbiAgICBhd2FpdCBta2RpcihkaXIpXG4gICAgY29uc3QgcGljbmFtZSA9IHV1aWQoKVxuICAgIGNvbnN0IGRlc3RQYXRoID0gYCR7ZGlyfS8ke3BpY25hbWV9LiR7ZXh0fWBcbiAgICBjb25zdCByZWFkZXIgPSBmcy5jcmVhdGVSZWFkU3RyZWFtKGZpbGUucGF0aCkgIC8v5paH5Lu26Lev5b6EXG4gICAgY29uc3QgdXBTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShkZXN0UGF0aCkgLy/nm67moIfot6/lvoRcbiAgICBjb25zdCBmaWxlUGF0aCA9IGAvJHttb21lbnQoKS5mb3JtYXQoJ1lZWVlNTUREJyl9LyR7cGljbmFtZX0uJHtleHR9YCAgLy/ml6XmnJ8vdXVpZC5wbmdcbiAgICByZWFkZXIucGlwZSh1cFN0cmVhbSlcbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICBtc2c6ICflm77niYfkuIrkvKDmiJDlip8nLFxuICAgICAgICBkYXRhOiBmaWxlUGF0aFxuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gYWRkUG9zdCAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwiYWRkUG9zdCAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgc2lkID0gYm9keS5zaWRcbiAgICBjb25zdCBjb2RlID0gYm9keS5jb2RlXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tDb2RlKHNpZCwgY29kZSlcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh7IF9pZDogb2JqLl9pZCB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcImFkZFBvc3QgLT4gdXNlclwiLCB1c2VyKVxuICAgICAgICBpZiAodXNlci5mYXZzIDwgYm9keS5mYXYpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDUwMSxcbiAgICAgICAgICAgICAgICBtc2c6ICfnp6/liIbkuI3otrMnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IFVzZXIudXBkYXRlT25lKHsgX2lkOiBvYmouX2lkIH0sIHsgJGluYzogeyBmYXZzOiAtYm9keS5mYXYgfSB9KVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld1Bvc3QgPSBuZXcgUG9zdChib2R5KVxuICAgICAgICBuZXdQb3N0LnVpZCA9IG9iai5faWRcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3UG9zdC5zYXZlKClcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBtc2c6ICfmiJDlip/kv53lrZjnmoTmlofnq6AnLFxuICAgICAgICAgICAgZGF0ZTogcmVzdWx0XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggemqjOivgeWksei0pSdcblxuICAgICAgICB9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0RGV0YWlsIChjdHgpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBjdHgucXVlcnlcbiAgICBpZiAoIXBhcmFtcy50aWQpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmlofnq6BpZOS4uuepuidcbiAgICAgICAgfVxuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5VGlkKHBhcmFtcy50aWQpXG4gICAgbGV0IGlzRmF2ID0gMFxuICAgIGlmIChcbiAgICAgICAgdHlwZW9mIGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbiAhPT0gJ3VuZGVmaW5lZCcgJiYgY3R4LmhlYWRlci5hdXRob3JpemF0aW9uICE9PSAnJ1xuICAgICkge1xuICAgICAgICBjb25zdCBvYmogPSBhd2FpdCBnZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICAgICAgY29uc3QgdXNlckNvbGxlY3QgPSBhd2FpdCBVc2VyQ29sbGVjdC5maW5kT25lKHtcbiAgICAgICAgICAgIHVpZDogb2JqLl9pZCxcbiAgICAgICAgICAgIHRpZDogcGFyYW1zLnRpZFxuICAgICAgICB9KVxuICAgICAgICBpZiAodXNlckNvbGxlY3QgJiYgdXNlckNvbGxlY3QudGlkKSB7XG4gICAgICAgICAgICBpc0ZhdiA9IDFcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBuZXdQb3N0ID0gcG9zdC50b0pTT04oKVxuICAgIG5ld1Bvc3QuaXNGYXYgPSBpc0ZhdlxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFBvc3QudXBkYXRlT25lKFxuICAgICAgICB7IF9pZDogcGFyYW1zLnRpZCB9LFxuICAgICAgICB7ICRpbmM6IHsgcmVhZHM6IDEgfSB9XG4gICAgKVxuICAgIGlmIChwb3N0Ll9pZCAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBkYXRhOiBuZXdQb3N0LFxuICAgICAgICAgICAgbXNnOiAn5p+l6K+i5paH56ug6K+m5oOF5oiQ5YqfJ1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfojrflj5bmlofnq6Dor6bmg4XlpLHotKUnXG4gICAgICAgIH1cbiAgICB9XG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7IGdldFBvc3RMaXN0LCB1cGxvYWRJbWcsIGFkZFBvc3QsIGdldFBvc3REZXRhaWwgfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "ContentController.js"
      ],
      "names": [
        "Post",
        "require",
        "config",
        "User",
        "checkCode",
        "getJWTPayload",
        "UserCollect",
        "moment",
        "mkdir",
        "uuid",
        "fs",
        "getPostList",
        "ctx",
        "body",
        "query",
        "sort",
        "page",
        "parseInt",
        "limit",
        "options",
        "catalog",
        "isTop",
        "status",
        "isEnd",
        "tag",
        "tags",
        "$elemMatch",
        "name",
        "result",
        "getList",
        "console",
        "log",
        "code",
        "data",
        "msg",
        "uploadImg",
        "file",
        "request",
        "files",
        "ext",
        "split",
        "pop",
        "dir",
        "uploadPath",
        "format",
        "picname",
        "destPath",
        "reader",
        "createReadStream",
        "path",
        "upStream",
        "createWriteStream",
        "filePath",
        "pipe",
        "addPost",
        "sid",
        "obj",
        "header",
        "authorization",
        "user",
        "findById",
        "_id",
        "favs",
        "fav",
        "updateOne",
        "$inc",
        "newPost",
        "uid",
        "save",
        "date",
        "getPostDetail",
        "params",
        "tid",
        "post",
        "findByTid",
        "isFav",
        "userCollect",
        "findOne",
        "toJSON",
        "reads",
        "ok",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "// import Post from '../model/Post'\nconst Post = require('../model/Post')\nconst config = require('../config/index')\nconst User = require('../model/User')\n// const Comments = require('../model/Comments')\nconst { checkCode, getJWTPayload } = require('../common/Utils')\nconst UserCollect = require('../model/UserCollect')\n\nconst moment = require('dayjs')\nconst mkdir = require('make-dir')\nconst uuid = require(\"uuid/v4\")\nconst fs = require('fs')\n\nasync function getPostList (ctx) {\n    // const post = new Post({\n    //     uid:'5e6db4551418c95ecec41ac8',  //现在插入需要 uid ，之前不知道是怎么插入成功的\n    //     title:'test title5',\n    //     content:'test content 1',\n    //     catalog:'share',\n    //     fav:20,\n    //     isEnd:'0',\n    //     reads:'0',\n    //     answer:'0',\n    //     status:'0',\n    //     isTop:'0',\n    //     sort:'0',\n    //     tags:[{\n    //         name:'精华',\n    //         class: ''\n    //     }]\n    // })\n    // const tmp=await post.save()\n    // console.log(\"module.exports -> tmp\", tmp)\n\n\n    const body = ctx.query\n    const sort = body.sort ? body.sort : 'created'\n    const page = body.page ? parseInt(body.page) : 0\n    const limit = body.limit ? parseInt(body.limit) : 20\n    const options = {}\n\n    if (typeof body.catalog !== 'undefined' && body.catalog !== '') {\n        options.catalog = body.catalog\n    }\n    if (typeof body.isTop !== 'undefined') {\n        options.isTop = body.isTop\n    }\n    if (typeof body.status !== 'undefined' && body.status !== '') {\n        options.isEnd = body.status\n    }\n    if (typeof body.tag !== 'undefined' && body.tag !== '') {\n        options.tags = { $elemMatch: { name: body.tag } }\n    }\n    // const result = await Post.getList(options, sort, page, limit)\n    // const result = Post.getList(options, sort, page, limit)\n    const result = await Post.getList(options, sort, page, limit)\n    console.log(result)\n\n    ctx.body = {\n        code: 200,\n        data: result,\n        msg: '获取文章列表成功'\n    }\n}\n\nasync function uploadImg (ctx) {\n    const file = ctx.request.files.file\n    console.log(\"uploadImg -> file\", file)\n    const ext = file.name.split('.').pop() //删除并返回最后一个元素\n    const dir = `${config.uploadPath}/${moment().format('YYYYMMDD')}`\n    await mkdir(dir)\n    const picname = uuid()\n    const destPath = `${dir}/${picname}.${ext}`\n    const reader = fs.createReadStream(file.path)  //文件路径\n    const upStream = fs.createWriteStream(destPath) //目标路径\n    const filePath = `/${moment().format('YYYYMMDD')}/${picname}.${ext}`  //日期/uuid.png\n    reader.pipe(upStream)\n    ctx.body = {\n        code: 200,\n        msg: '图片上传成功',\n        data: filePath\n    }\n}\n\nasync function addPost (ctx) {\n    const { body } = ctx.request\n    console.log(\"addPost -> body\", body)\n    const sid = body.sid\n    const code = body.code\n    const result = await checkCode(sid, code)\n    if (result) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const user = await User.findById({ _id: obj._id })\n        console.log(\"addPost -> user\", user)\n        if (user.favs < body.fav) {\n            ctx.body = {\n                code: 501,\n                msg: '积分不足'\n            }\n            return\n        } else {\n            await User.updateOne({ _id: obj._id }, { $inc: { favs: -body.fav } })\n        }\n        const newPost = new Post(body)\n        newPost.uid = obj._id\n        const result = await newPost.save()\n        ctx.body = {\n            code: 200,\n            msg: '成功保存的文章',\n            date: result\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '图片验证码验证失败'\n\n        }\n    }\n}\n\nasync function getPostDetail (ctx) {\n    const params = ctx.query\n    if (!params.tid) {\n        ctx.body = {\n            code: 500,\n            msg: '文章id为空'\n        }\n        return\n    }\n    const post = await Post.findByTid(params.tid)\n    let isFav = 0\n    if (\n        typeof ctx.header.authorization !== 'undefined' && ctx.header.authorization !== ''\n    ) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const userCollect = await UserCollect.findOne({\n            uid: obj._id,\n            tid: params.tid\n        })\n        if (userCollect && userCollect.tid) {\n            isFav = 1\n        }\n    }\n    const newPost = post.toJSON()\n    newPost.isFav = isFav\n    const result = await Post.updateOne(\n        { _id: params.tid },\n        { $inc: { reads: 1 } }\n    )\n    if (post._id && result.ok === 1) {\n        ctx.body = {\n            code: 200,\n            data: newPost,\n            msg: '查询文章详情成功'\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '获取文章详情失败'\n        }\n    }\n}\n\n\nmodule.exports = { getPostList, uploadImg, addPost, getPostDetail }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585748600733
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Post.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Post.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Post.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Post.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "Post.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import mongoose from '@/config/DBHelpler'\n// import moment from 'dayjs'\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst PostSchema = new Schema({\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  title: {\n    type: String\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  catalog: {\n    type: String\n  },\n  fav: {\n    type: String,\n    default: ''\n  },\n  isEnd: {\n    type: String,\n    default: '0'\n  },\n  reads: {\n    type: Number,\n    default: 0\n  },\n  answer: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '0'\n  },\n  isTop: {\n    type: String,\n    default: '0'\n  },\n  sort: {\n    type: String,\n    default: 100\n  },\n  tags: {\n    type: Array,\n    default: [// {\n      //   name: '',\n      //   class: ''\n      // }\n    ]\n  }\n});\nPostSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n});\nPostSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss');\n  next();\n});\nPostSchema.statics = {\n  /**\n   * 获取文章列表数据\n   * @param {Object} options 筛选条件\n   * @param {String} sort 排序方式\n   * @param {Number} page 分页页数\n   * @param {Number} limit 分页条数\n   */\n  // getList: function (options, sort, page, limit) {\n  //   return this.find(options)\n  //     .sort({ [sort]: -1 })\n  //     .skip(page * limit)\n  //     .limit(limit)\n  //     // .populate({\n  //     //   path: 'uid',\n  //     //   select: 'name isVip pic'\n  //     // })\n  // },\n  // 通过 sort，skip，limit，populate 去查询文章，其中 populate 可以查询到 user 的信息\n  getList: function (options, sort, page, limit) {\n    return this.find(options).sort({\n      [sort]: -1\n    }).skip(page * limit).limit(limit).populate({\n      path: 'uid',\n      select: 'name isVip pic'\n    });\n  },\n  getTopWeek: function () {\n    return this.find({\n      created: {\n        $gte: moment().subtract(7, 'days')\n      }\n    }, {\n      answer: 1,\n      title: 1\n    }).sort({\n      answer: -1\n    }).limit(15);\n  },\n  findByTid: function (id) {\n    return this.findOne({\n      _id: id\n    }).populate({\n      path: 'uid',\n      select: 'name pic isVip _id'\n    });\n  },\n  getListByUid: function (id, page, limit) {\n    return this.find({\n      uid: id\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  countByUid: function (id) {\n    return this.find({\n      uid: id\n    }).countDocuments();\n  }\n};\nconst PostModel = mongoose.model('post', PostSchema); // export default PostModel\n\nmodule.exports = PostModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBvc3QuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiUG9zdFNjaGVtYSIsInVpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJ0aXRsZSIsImNvbnRlbnQiLCJjcmVhdGVkIiwiRGF0ZSIsImNhdGFsb2ciLCJmYXYiLCJkZWZhdWx0IiwiaXNFbmQiLCJyZWFkcyIsIk51bWJlciIsImFuc3dlciIsInN0YXR1cyIsImlzVG9wIiwic29ydCIsInRhZ3MiLCJBcnJheSIsInZpcnR1YWwiLCJsb2NhbEZpZWxkIiwiZm9yZWlnbkZpZWxkIiwicHJlIiwibmV4dCIsImZvcm1hdCIsInN0YXRpY3MiLCJnZXRMaXN0Iiwib3B0aW9ucyIsInBhZ2UiLCJsaW1pdCIsImZpbmQiLCJza2lwIiwicG9wdWxhdGUiLCJwYXRoIiwic2VsZWN0IiwiZ2V0VG9wV2VlayIsIiRndGUiLCJzdWJ0cmFjdCIsImZpbmRCeVRpZCIsImlkIiwiZmluZE9uZSIsIl9pZCIsImdldExpc3RCeVVpZCIsImNvdW50QnlVaWQiLCJjb3VudERvY3VtZW50cyIsIlBvc3RNb2RlbCIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0EsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsb0JBQUQsQ0FBeEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsT0FBRCxDQUF0Qjs7QUFFQSxNQUFNRSxNQUFNLEdBQUdILFFBQVEsQ0FBQ0csTUFBeEI7QUFFQSxNQUFNQyxVQUFVLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQzVCRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEdUI7QUFFNUJDLEVBQUFBLEtBQUssRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FGcUI7QUFHNUJHLEVBQUFBLE9BQU8sRUFBRTtBQUFFSixJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FIbUI7QUFJNUJJLEVBQUFBLE9BQU8sRUFBRTtBQUFFTCxJQUFBQSxJQUFJLEVBQUVNO0FBQVIsR0FKbUI7QUFLNUJDLEVBQUFBLE9BQU8sRUFBRTtBQUFFUCxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FMbUI7QUFNNUJPLEVBQUFBLEdBQUcsRUFBRTtBQUFFUixJQUFBQSxJQUFJLEVBQUVDLE1BQVI7QUFBZ0JRLElBQUFBLE9BQU8sRUFBQztBQUF4QixHQU51QjtBQU81QkMsRUFBQUEsS0FBSyxFQUFFO0FBQUVWLElBQUFBLElBQUksRUFBRUMsTUFBUjtBQUFnQlEsSUFBQUEsT0FBTyxFQUFFO0FBQXpCLEdBUHFCO0FBUTVCRSxFQUFBQSxLQUFLLEVBQUU7QUFBRVgsSUFBQUEsSUFBSSxFQUFFWSxNQUFSO0FBQWdCSCxJQUFBQSxPQUFPLEVBQUU7QUFBekIsR0FScUI7QUFTNUJJLEVBQUFBLE1BQU0sRUFBRTtBQUFFYixJQUFBQSxJQUFJLEVBQUVZLE1BQVI7QUFBZ0JILElBQUFBLE9BQU8sRUFBRTtBQUF6QixHQVRvQjtBQVU1QkssRUFBQUEsTUFBTSxFQUFFO0FBQUVkLElBQUFBLElBQUksRUFBRUMsTUFBUjtBQUFnQlEsSUFBQUEsT0FBTyxFQUFFO0FBQXpCLEdBVm9CO0FBVzVCTSxFQUFBQSxLQUFLLEVBQUU7QUFBRWYsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCUSxJQUFBQSxPQUFPLEVBQUU7QUFBekIsR0FYcUI7QUFZNUJPLEVBQUFBLElBQUksRUFBRTtBQUFFaEIsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCUSxJQUFBQSxPQUFPLEVBQUU7QUFBekIsR0Fac0I7QUFhNUJRLEVBQUFBLElBQUksRUFBRTtBQUNKakIsSUFBQUEsSUFBSSxFQUFFa0IsS0FERjtBQUVKVCxJQUFBQSxPQUFPLEVBQUUsQ0FDUDtBQUNBO0FBQ0E7QUFDQTtBQUpPO0FBRkw7QUFic0IsQ0FBWCxDQUFuQjtBQXdCQVgsVUFBVSxDQUFDcUIsT0FBWCxDQUFtQixNQUFuQixFQUEyQjtBQUN6QmpCLEVBQUFBLEdBQUcsRUFBRSxPQURvQjtBQUV6QmtCLEVBQUFBLFVBQVUsRUFBRSxLQUZhO0FBR3pCQyxFQUFBQSxZQUFZLEVBQUU7QUFIVyxDQUEzQjtBQU1BdkIsVUFBVSxDQUFDd0IsR0FBWCxDQUFlLE1BQWYsRUFBdUIsVUFBVUMsSUFBVixFQUFnQjtBQUNyQyxPQUFLbEIsT0FBTCxHQUFlVCxNQUFNLEdBQUc0QixNQUFULENBQWdCLHFCQUFoQixDQUFmO0FBQ0FELEVBQUFBLElBQUk7QUFDTCxDQUhEO0FBS0F6QixVQUFVLENBQUMyQixPQUFYLEdBQXFCO0FBQ25COzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBQyxFQUFBQSxPQUFPLEVBQUUsVUFBVUMsT0FBVixFQUFtQlgsSUFBbkIsRUFBeUJZLElBQXpCLEVBQStCQyxLQUEvQixFQUFzQztBQUM3QyxXQUFPLEtBQUtDLElBQUwsQ0FBVUgsT0FBVixFQUNOWCxJQURNLENBQ0Q7QUFBQyxPQUFDQSxJQUFELEdBQU8sQ0FBQztBQUFULEtBREMsRUFFTmUsSUFGTSxDQUVESCxJQUFJLEdBQUNDLEtBRkosRUFHTkEsS0FITSxDQUdBQSxLQUhBLEVBSU5HLFFBSk0sQ0FJRztBQUNSQyxNQUFBQSxJQUFJLEVBQUMsS0FERztBQUVSQyxNQUFBQSxNQUFNLEVBQUM7QUFGQyxLQUpILENBQVA7QUFRRCxHQTdCa0I7QUE4Qm5CQyxFQUFBQSxVQUFVLEVBQUUsWUFBWTtBQUN0QixXQUFPLEtBQUtMLElBQUwsQ0FBVTtBQUNmekIsTUFBQUEsT0FBTyxFQUFFO0FBQ1ArQixRQUFBQSxJQUFJLEVBQUV4QyxNQUFNLEdBQUd5QyxRQUFULENBQWtCLENBQWxCLEVBQXFCLE1BQXJCO0FBREM7QUFETSxLQUFWLEVBSUo7QUFDRHhCLE1BQUFBLE1BQU0sRUFBRSxDQURQO0FBRURWLE1BQUFBLEtBQUssRUFBRTtBQUZOLEtBSkksRUFPSmEsSUFQSSxDQU9DO0FBQUVILE1BQUFBLE1BQU0sRUFBRSxDQUFDO0FBQVgsS0FQRCxFQVFKZ0IsS0FSSSxDQVFFLEVBUkYsQ0FBUDtBQVNELEdBeENrQjtBQXlDbkJTLEVBQUFBLFNBQVMsRUFBRSxVQUFVQyxFQUFWLEVBQWM7QUFDdkIsV0FBTyxLQUFLQyxPQUFMLENBQWE7QUFBRUMsTUFBQUEsR0FBRyxFQUFFRjtBQUFQLEtBQWIsRUFBMEJQLFFBQTFCLENBQW1DO0FBQ3hDQyxNQUFBQSxJQUFJLEVBQUUsS0FEa0M7QUFFeENDLE1BQUFBLE1BQU0sRUFBRTtBQUZnQyxLQUFuQyxDQUFQO0FBSUQsR0E5Q2tCO0FBK0NuQlEsRUFBQUEsWUFBWSxFQUFFLFVBQVVILEVBQVYsRUFBY1gsSUFBZCxFQUFvQkMsS0FBcEIsRUFBMkI7QUFDdkMsV0FBTyxLQUFLQyxJQUFMLENBQVU7QUFBRS9CLE1BQUFBLEdBQUcsRUFBRXdDO0FBQVAsS0FBVixFQUNKUixJQURJLENBQ0NILElBQUksR0FBR0MsS0FEUixFQUVKQSxLQUZJLENBRUVBLEtBRkYsRUFHSmIsSUFISSxDQUdDO0FBQUVYLE1BQUFBLE9BQU8sRUFBRSxDQUFDO0FBQVosS0FIRCxDQUFQO0FBSUQsR0FwRGtCO0FBcURuQnNDLEVBQUFBLFVBQVUsRUFBRSxVQUFVSixFQUFWLEVBQWM7QUFDeEIsV0FBTyxLQUFLVCxJQUFMLENBQVU7QUFBRS9CLE1BQUFBLEdBQUcsRUFBRXdDO0FBQVAsS0FBVixFQUF1QkssY0FBdkIsRUFBUDtBQUNEO0FBdkRrQixDQUFyQjtBQTBEQSxNQUFNQyxTQUFTLEdBQUduRCxRQUFRLENBQUNvRCxLQUFULENBQWUsTUFBZixFQUF1QmhELFVBQXZCLENBQWxCLEMsQ0FFQTs7QUFDQWlELE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsU0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgbW9uZ29vc2UgZnJvbSAnQC9jb25maWcvREJIZWxwbGVyJ1xuLy8gaW1wb3J0IG1vbWVudCBmcm9tICdkYXlqcydcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnLi4vY29uZmlnL0RCSGVscGVyJylcbmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ2RheWpzJylcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IFBvc3RTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIHRpdGxlOiB7IHR5cGU6IFN0cmluZyB9LFxuICBjb250ZW50OiB7IHR5cGU6IFN0cmluZyB9LFxuICBjcmVhdGVkOiB7IHR5cGU6IERhdGUgfSxcbiAgY2F0YWxvZzogeyB0eXBlOiBTdHJpbmcgfSxcbiAgZmF2OiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDonJyB9LFxuICBpc0VuZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9LFxuICByZWFkczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcbiAgYW5zd2VyOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxuICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfSxcbiAgaXNUb3A6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfSxcbiAgc29ydDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6IDEwMCB9LFxuICB0YWdzOiB7XG4gICAgdHlwZTogQXJyYXksXG4gICAgZGVmYXVsdDogW1xuICAgICAgLy8ge1xuICAgICAgLy8gICBuYW1lOiAnJyxcbiAgICAgIC8vICAgY2xhc3M6ICcnXG4gICAgICAvLyB9XG4gICAgXVxuICB9XG59KVxuXG5Qb3N0U2NoZW1hLnZpcnR1YWwoJ3VzZXInLCB7XG4gIHJlZjogJ3VzZXJzJyxcbiAgbG9jYWxGaWVsZDogJ3VpZCcsXG4gIGZvcmVpZ25GaWVsZDogJ19pZCdcbn0pXG5cblBvc3RTY2hlbWEucHJlKCdzYXZlJywgZnVuY3Rpb24gKG5leHQpIHtcbiAgdGhpcy5jcmVhdGVkID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgbmV4dCgpXG59KVxuXG5Qb3N0U2NoZW1hLnN0YXRpY3MgPSB7XG4gIC8qKlxuICAgKiDojrflj5bmlofnq6DliJfooajmlbDmja5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMg562b6YCJ5p2h5Lu2XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzb3J0IOaOkuW6j+aWueW8j1xuICAgKiBAcGFyYW0ge051bWJlcn0gcGFnZSDliIbpobXpobXmlbBcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGxpbWl0IOWIhumhteadoeaVsFxuICAgKi9cbiAgLy8gZ2V0TGlzdDogZnVuY3Rpb24gKG9wdGlvbnMsIHNvcnQsIHBhZ2UsIGxpbWl0KSB7XG4gIC8vICAgcmV0dXJuIHRoaXMuZmluZChvcHRpb25zKVxuICAvLyAgICAgLnNvcnQoeyBbc29ydF06IC0xIH0pXG4gIC8vICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gIC8vICAgICAubGltaXQobGltaXQpXG4gIC8vICAgICAvLyAucG9wdWxhdGUoe1xuICAvLyAgICAgLy8gICBwYXRoOiAndWlkJyxcbiAgLy8gICAgIC8vICAgc2VsZWN0OiAnbmFtZSBpc1ZpcCBwaWMnXG4gIC8vICAgICAvLyB9KVxuICAvLyB9LFxuXG4gIC8vIOmAmui/hyBzb3J077yMc2tpcO+8jGxpbWl077yMcG9wdWxhdGUg5Y675p+l6K+i5paH56ug77yM5YW25LitIHBvcHVsYXRlIOWPr+S7peafpeivouWIsCB1c2VyIOeahOS/oeaBr1xuICBnZXRMaXN0OiBmdW5jdGlvbiAob3B0aW9ucywgc29ydCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKG9wdGlvbnMpXG4gICAgLnNvcnQoe1tzb3J0XTotMX0pXG4gICAgLnNraXAocGFnZSpsaW1pdClcbiAgICAubGltaXQobGltaXQpXG4gICAgLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6J3VpZCcsICAgICAgICBcbiAgICAgIHNlbGVjdDonbmFtZSBpc1ZpcCBwaWMnXG4gICAgfSlcbiAgfSxcbiAgZ2V0VG9wV2VlazogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoe1xuICAgICAgY3JlYXRlZDoge1xuICAgICAgICAkZ3RlOiBtb21lbnQoKS5zdWJ0cmFjdCg3LCAnZGF5cycpXG4gICAgICB9XG4gICAgfSwge1xuICAgICAgYW5zd2VyOiAxLFxuICAgICAgdGl0bGU6IDFcbiAgICB9KS5zb3J0KHsgYW5zd2VyOiAtMSB9KVxuICAgICAgLmxpbWl0KDE1KVxuICB9LFxuICBmaW5kQnlUaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmRPbmUoeyBfaWQ6IGlkIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICd1aWQnLFxuICAgICAgc2VsZWN0OiAnbmFtZSBwaWMgaXNWaXAgX2lkJ1xuICAgIH0pXG4gIH0sXG4gIGdldExpc3RCeVVpZDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pXG4gICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG4gIGNvdW50QnlVaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pLmNvdW50RG9jdW1lbnRzKClcbiAgfVxufVxuXG5jb25zdCBQb3N0TW9kZWwgPSBtb25nb29zZS5tb2RlbCgncG9zdCcsIFBvc3RTY2hlbWEpXG5cbi8vIGV4cG9ydCBkZWZhdWx0IFBvc3RNb2RlbFxubW9kdWxlLmV4cG9ydHMgPSBQb3N0TW9kZWwiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Post.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "PostSchema",
        "uid",
        "type",
        "String",
        "ref",
        "title",
        "content",
        "created",
        "Date",
        "catalog",
        "fav",
        "default",
        "isEnd",
        "reads",
        "Number",
        "answer",
        "status",
        "isTop",
        "sort",
        "tags",
        "Array",
        "virtual",
        "localField",
        "foreignField",
        "pre",
        "next",
        "format",
        "statics",
        "getList",
        "options",
        "page",
        "limit",
        "find",
        "skip",
        "populate",
        "path",
        "select",
        "getTopWeek",
        "$gte",
        "subtract",
        "findByTid",
        "id",
        "findOne",
        "_id",
        "getListByUid",
        "countByUid",
        "countDocuments",
        "PostModel",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "// import mongoose from '@/config/DBHelpler'\n// import moment from 'dayjs'\nconst mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\n\nconst Schema = mongoose.Schema\n\nconst PostSchema = new Schema({\n  uid: { type: String, ref: 'users' },\n  title: { type: String },\n  content: { type: String },\n  created: { type: Date },\n  catalog: { type: String },\n  fav: { type: String, default:'' },\n  isEnd: { type: String, default: '0' },\n  reads: { type: Number, default: 0 },\n  answer: { type: Number, default: 0 },\n  status: { type: String, default: '0' },\n  isTop: { type: String, default: '0' },\n  sort: { type: String, default: 100 },\n  tags: {\n    type: Array,\n    default: [\n      // {\n      //   name: '',\n      //   class: ''\n      // }\n    ]\n  }\n})\n\nPostSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n})\n\nPostSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss')\n  next()\n})\n\nPostSchema.statics = {\n  /**\n   * 获取文章列表数据\n   * @param {Object} options 筛选条件\n   * @param {String} sort 排序方式\n   * @param {Number} page 分页页数\n   * @param {Number} limit 分页条数\n   */\n  // getList: function (options, sort, page, limit) {\n  //   return this.find(options)\n  //     .sort({ [sort]: -1 })\n  //     .skip(page * limit)\n  //     .limit(limit)\n  //     // .populate({\n  //     //   path: 'uid',\n  //     //   select: 'name isVip pic'\n  //     // })\n  // },\n\n  // 通过 sort，skip，limit，populate 去查询文章，其中 populate 可以查询到 user 的信息\n  getList: function (options, sort, page, limit) {\n    return this.find(options)\n    .sort({[sort]:-1})\n    .skip(page*limit)\n    .limit(limit)\n    .populate({\n      path:'uid',        \n      select:'name isVip pic'\n    })\n  },\n  getTopWeek: function () {\n    return this.find({\n      created: {\n        $gte: moment().subtract(7, 'days')\n      }\n    }, {\n      answer: 1,\n      title: 1\n    }).sort({ answer: -1 })\n      .limit(15)\n  },\n  findByTid: function (id) {\n    return this.findOne({ _id: id }).populate({\n      path: 'uid',\n      select: 'name pic isVip _id'\n    })\n  },\n  getListByUid: function (id, page, limit) {\n    return this.find({ uid: id })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  countByUid: function (id) {\n    return this.find({ uid: id }).countDocuments()\n  }\n}\n\nconst PostModel = mongoose.model('post', PostSchema)\n\n// export default PostModel\nmodule.exports = PostModel"
      ]
    },
    "sourceType": "script",
    "mtime": 1585706466117
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/DBHelper.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/DBHelper.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/DBHelper.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/DBHelper.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
        "sourceFileName": "DBHelper.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('mongoose'); // const config = require('./index')\n\n\nmongoose.set('useCreateIndex', true);\nconst DB_URL = 'mongodb://echo:123456@47.99.202.255:27018/testdb';\nconst REDIS = {\n  host: '47.99.202.255',\n  port: 27017,\n  password: '123456'\n};\nmongoose.connect(DB_URL, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\nmongoose.connection.on('connected', () => {\n  console.log('Mongoose connection open to ' + DB_URL);\n});\nmongoose.connection.on('error', err => {\n  console.log('Mongoose connection error: ' + err);\n});\nmongoose.connection.on('disconnected', () => {\n  console.log('Mongoose connection disconnected');\n});\nmodule.exports = mongoose;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRCSGVscGVyLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsInNldCIsIkRCX1VSTCIsIlJFRElTIiwiaG9zdCIsInBvcnQiLCJwYXNzd29yZCIsImNvbm5lY3QiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJjb25uZWN0aW9uIiwib24iLCJjb25zb2xlIiwibG9nIiwiZXJyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCLEMsQ0FDQTs7O0FBRUFELFFBQVEsQ0FBQ0UsR0FBVCxDQUFhLGdCQUFiLEVBQThCLElBQTlCO0FBRUEsTUFBTUMsTUFBTSxHQUFDLGtEQUFiO0FBQ0EsTUFBTUMsS0FBSyxHQUFHO0FBQ1ZDLEVBQUFBLElBQUksRUFBRSxlQURJO0FBRVZDLEVBQUFBLElBQUksRUFBRSxLQUZJO0FBR1ZDLEVBQUFBLFFBQVEsRUFBRTtBQUhBLENBQWQ7QUFNQVAsUUFBUSxDQUFDUSxPQUFULENBQWlCTCxNQUFqQixFQUF3QjtBQUNwQk0sRUFBQUEsZUFBZSxFQUFFLElBREc7QUFFcEJDLEVBQUFBLGtCQUFrQixFQUFFO0FBRkEsQ0FBeEI7QUFLQVYsUUFBUSxDQUFDVyxVQUFULENBQW9CQyxFQUFwQixDQUF1QixXQUF2QixFQUFvQyxNQUFNO0FBQ3RDQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQ0FBK0JYLE1BQTNDO0FBQ0gsQ0FGRDtBQUlBSCxRQUFRLENBQUNXLFVBQVQsQ0FBb0JDLEVBQXBCLENBQXVCLE9BQXZCLEVBQWlDRyxHQUFELElBQVM7QUFDckNGLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdDQUE4QkMsR0FBMUM7QUFDSCxDQUZEO0FBSUFmLFFBQVEsQ0FBQ1csVUFBVCxDQUFvQkMsRUFBcEIsQ0FBdUIsY0FBdkIsRUFBdUMsTUFBTTtBQUN6Q0MsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksa0NBQVo7QUFDSCxDQUZEO0FBSUFFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlakIsUUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJylcbi8vIGNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4vaW5kZXgnKVxuXG5tb25nb29zZS5zZXQoJ3VzZUNyZWF0ZUluZGV4Jyx0cnVlKVxuXG5jb25zdCBEQl9VUkw9J21vbmdvZGI6Ly9lY2hvOjEyMzQ1NkA0Ny45OS4yMDIuMjU1OjI3MDE4L3Rlc3RkYidcbmNvbnN0IFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAyNzAxNyxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cblxubW9uZ29vc2UuY29ubmVjdChEQl9VUkwse1xuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWVcbn0pXG5cbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oJ2Nvbm5lY3RlZCcsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnTW9uZ29vc2UgY29ubmVjdGlvbiBvcGVuIHRvICcrREJfVVJMKTtcbn0pXG5cbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdNb25nb29zZSBjb25uZWN0aW9uIGVycm9yOiAnK2Vycik7XG59KVxuXG5tb25nb29zZS5jb25uZWN0aW9uLm9uKCdkaXNjb25uZWN0ZWQnLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ01vbmdvb3NlIGNvbm5lY3Rpb24gZGlzY29ubmVjdGVkJylcbn0pXG5cbm1vZHVsZS5leHBvcnRzPW1vbmdvb3NlIl19",
    "map": {
      "version": 3,
      "sources": [
        "DBHelper.js"
      ],
      "names": [
        "mongoose",
        "require",
        "set",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "connect",
        "useNewUrlParser",
        "useUnifiedTopology",
        "connection",
        "on",
        "console",
        "log",
        "err",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB,C,CACA;;;AAEAD,QAAQ,CAACE,GAAT,CAAa,gBAAb,EAA8B,IAA9B;AAEA,MAAMC,MAAM,GAAC,kDAAb;AACA,MAAMC,KAAK,GAAG;AACVC,EAAAA,IAAI,EAAE,eADI;AAEVC,EAAAA,IAAI,EAAE,KAFI;AAGVC,EAAAA,QAAQ,EAAE;AAHA,CAAd;AAMAP,QAAQ,CAACQ,OAAT,CAAiBL,MAAjB,EAAwB;AACpBM,EAAAA,eAAe,EAAE,IADG;AAEpBC,EAAAA,kBAAkB,EAAE;AAFA,CAAxB;AAKAV,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,WAAvB,EAAoC,MAAM;AACtCC,EAAAA,OAAO,CAACC,GAAR,CAAY,iCAA+BX,MAA3C;AACH,CAFD;AAIAH,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAiCG,GAAD,IAAS;AACrCF,EAAAA,OAAO,CAACC,GAAR,CAAY,gCAA8BC,GAA1C;AACH,CAFD;AAIAf,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,cAAvB,EAAuC,MAAM;AACzCC,EAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ;AACH,CAFD;AAIAE,MAAM,CAACC,OAAP,GAAejB,QAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "sourcesContent": [
        "const mongoose = require('mongoose')\n// const config = require('./index')\n\nmongoose.set('useCreateIndex',true)\n\nconst DB_URL='mongodb://echo:123456@47.99.202.255:27018/testdb'\nconst REDIS = {\n    host: '47.99.202.255',\n    port: 27017,\n    password: '123456'\n}\n\nmongoose.connect(DB_URL,{\n    useNewUrlParser: true,\n    useUnifiedTopology: true\n})\n\nmongoose.connection.on('connected', () => {\n    console.log('Mongoose connection open to '+DB_URL);\n})\n\nmongoose.connection.on('error', (err) => {\n    console.log('Mongoose connection error: '+err);\n})\n\nmongoose.connection.on('disconnected', () => {\n    console.log('Mongoose connection disconnected')\n})\n\nmodule.exports=mongoose"
      ]
    },
    "sourceType": "script",
    "mtime": 1583598900525
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/userRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/userRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/userRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/userRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "userRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require(\"koa-router\");\n\nconst {\n  userSign,\n  updateUserInfo,\n  changePassword\n} = require('../../api/UserController');\n\nconst router = new Router();\nrouter.prefix('/user');\nrouter.get('/fav', userSign);\nrouter.post('/basic', updateUserInfo);\nrouter.post('/changePassword', changePassword); // router.get('/account',userController.userAccount)\n// router.get('/permission',userController.userPermission)\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXJSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsInVzZXJTaWduIiwidXBkYXRlVXNlckluZm8iLCJjaGFuZ2VQYXNzd29yZCIsInJvdXRlciIsInByZWZpeCIsImdldCIsInBvc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBR0MsT0FBTyxDQUFDLFlBQUQsQ0FBdEI7O0FBQ0EsTUFBTTtBQUFFQyxFQUFBQSxRQUFGO0FBQVlDLEVBQUFBLGNBQVo7QUFBNEJDLEVBQUFBO0FBQTVCLElBQStDSCxPQUFPLENBQUMsMEJBQUQsQ0FBNUQ7O0FBRUEsTUFBTUksTUFBTSxHQUFHLElBQUlMLE1BQUosRUFBZjtBQUNBSyxNQUFNLENBQUNDLE1BQVAsQ0FBYyxPQUFkO0FBQ0FELE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLE1BQVgsRUFBbUJMLFFBQW5CO0FBRUFHLE1BQU0sQ0FBQ0csSUFBUCxDQUFZLFFBQVosRUFBc0JMLGNBQXRCO0FBQ0FFLE1BQU0sQ0FBQ0csSUFBUCxDQUFZLGlCQUFaLEVBQStCSixjQUEvQixFLENBRUE7QUFDQTs7QUFFQUssTUFBTSxDQUFDQyxPQUFQLEdBQWlCTCxNQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlciA9IHJlcXVpcmUoXCJrb2Etcm91dGVyXCIpXG5jb25zdCB7IHVzZXJTaWduLCB1cGRhdGVVc2VySW5mbywgY2hhbmdlUGFzc3dvcmQgfSA9IHJlcXVpcmUoJy4uLy4uL2FwaS9Vc2VyQ29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlciA9IG5ldyBSb3V0ZXIoKVxucm91dGVyLnByZWZpeCgnL3VzZXInKVxucm91dGVyLmdldCgnL2ZhdicsIHVzZXJTaWduKVxuXG5yb3V0ZXIucG9zdCgnL2Jhc2ljJywgdXBkYXRlVXNlckluZm8pXG5yb3V0ZXIucG9zdCgnL2NoYW5nZVBhc3N3b3JkJywgY2hhbmdlUGFzc3dvcmQpXG5cbi8vIHJvdXRlci5nZXQoJy9hY2NvdW50Jyx1c2VyQ29udHJvbGxlci51c2VyQWNjb3VudClcbi8vIHJvdXRlci5nZXQoJy9wZXJtaXNzaW9uJyx1c2VyQ29udHJvbGxlci51c2VyUGVybWlzc2lvbilcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "userRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "userSign",
        "updateUserInfo",
        "changePassword",
        "router",
        "prefix",
        "get",
        "post",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,YAAD,CAAtB;;AACA,MAAM;AAAEC,EAAAA,QAAF;AAAYC,EAAAA,cAAZ;AAA4BC,EAAAA;AAA5B,IAA+CH,OAAO,CAAC,0BAAD,CAA5D;;AAEA,MAAMI,MAAM,GAAG,IAAIL,MAAJ,EAAf;AACAK,MAAM,CAACC,MAAP,CAAc,OAAd;AACAD,MAAM,CAACE,GAAP,CAAW,MAAX,EAAmBL,QAAnB;AAEAG,MAAM,CAACG,IAAP,CAAY,QAAZ,EAAsBL,cAAtB;AACAE,MAAM,CAACG,IAAP,CAAY,iBAAZ,EAA+BJ,cAA/B,E,CAEA;AACA;;AAEAK,MAAM,CAACC,OAAP,GAAiBL,MAAjB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router = require(\"koa-router\")\nconst { userSign, updateUserInfo, changePassword } = require('../../api/UserController')\n\nconst router = new Router()\nrouter.prefix('/user')\nrouter.get('/fav', userSign)\n\nrouter.post('/basic', updateUserInfo)\nrouter.post('/changePassword', changePassword)\n\n// router.get('/account',userController.userAccount)\n// router.get('/permission',userController.userPermission)\n\nmodule.exports = router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585535667031
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/UserController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/UserController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/UserController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/UserController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "UserController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst SignRecord = require('../model/SignRecord');\n\nconst User = require('../model/User');\n\nconst Utils = require('../common/Utils');\n\nconst {\n  setValue\n} = require('../config/RedisConfig');\n\nconst {\n  send\n} = require('../config/MailConfig');\n\nconst config = require('../config/index');\n\nconst moment = require('dayjs');\n\nconst uuid = require('uuid/v4');\n\nconst jwt = require('jsonwebtoken');\n\nconst bcrypt = require('bcrypt');\n\nasync function userSign(ctx) {\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  const record = await SignRecord.findByUid(obj._id);\n  console.log(\"userSign -> record\", record);\n  const user = await User.findByID(obj._id);\n  let newRecord = {};\n  let result = '';\n  record.created = '2020-03-14T02:54:41.000Z';\n\n  if (record !== null) {\n    if (moment(record.created).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD')) {\n      ctx.body = {\n        code: 500,\n        favs: user.favs,\n        count: user.count,\n        lastSign: record.created,\n        msg: '用户已经签到'\n      };\n      return;\n    } else {\n      let count = user.count;\n      console.log(\"userSign -> count\", count);\n      let fav = 0;\n\n      if (moment(record.created).format('YYYY-MM-DD') === moment().subtract(1, 'days').format('YYYY-MM-DD')) {\n        count += 1;\n\n        if (count < 5) {\n          fav = 5;\n        } else if (count >= 5 && count < 15) {\n          fav = 10;\n        } else if (count >= 15 && count < 30) {\n          fav = 15;\n        } else if (count >= 30 && count < 100) {\n          fav = 20;\n        } else if (count >= 100 && count < 365) {\n          fav = 30;\n        } else if (count >= 365) {\n          fav = 50;\n        }\n\n        await User.updateOne({\n          _id: obj._id\n        }, {\n          $inc: {\n            favs: fav,\n            count: 1\n          }\n        });\n        result = {\n          favs: user.favs + fav,\n          count: user.count + 1\n        };\n      } else {\n        fav = 5;\n        await User.updateOne({\n          _id: obj._id\n        }, {\n          $set: {\n            count: 1\n          },\n          $inc: {\n            favs: fav\n          }\n        });\n        result = {\n          favs: user.favs + fav,\n          count: 1\n        };\n      }\n\n      newRecord = new SignRecord({\n        uid: obj._id,\n        favs: fav\n      });\n      await newRecord.save();\n    }\n  } else {\n    await User.updateOne({\n      _id: obj._id\n    }, {\n      $set: {\n        count: 1\n      },\n      $inc: {\n        favs: 5\n      }\n    });\n    newRecord = new SignRecord({\n      uid: obj._id,\n      favs: 5 // lastSign: moment().format('YYYY-MM-DD HH:mm:ss')\n\n    });\n    await newRecord.save();\n    result = {\n      favs: user.favs + 5,\n      count: 1\n    };\n  }\n\n  ctx.body = {\n    code: 200,\n    msg: '请求成功',\n    ...result,\n    lastSign: newRecord.created\n  };\n}\n\nasync function updateUserInfo(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"updateUserInfo -> body\", body);\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  console.log(\"updateUserInfo -> obj\", obj);\n  const user = await User.findOne({\n    _id: obj._id\n  });\n  console.log(\"updateUserInfo -> user\", user);\n  let msg = '';\n\n  if (body.username && body.username !== user.username) {\n    const tmpUser = await User.findOne({\n      username: body.username\n    });\n    console.log(\"updateUserInfo -> tmpUser\", tmpUser);\n\n    if (tmpUser && tmpUser.password) {\n      ctx.body = {\n        code: 501,\n        msg: '邮箱已经注册'\n      };\n      return;\n    }\n\n    const key = uuid();\n    setValue(key, jwt.sign({\n      _id: obj._id\n    }, config.JWT_SECRET, {\n      expiresIn: '30m'\n    }));\n    await send({\n      type: 'email',\n      data: {\n        key: key,\n        username: body.username\n      },\n      code: '',\n      expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n      email: user.username,\n      user: user.name\n    });\n    msg = '更新基本资料成功，账号修改需要邮件确认，请查收邮件';\n  }\n\n  const arr = ['username', 'mobile', 'password'];\n  arr.map(item => {\n    delete body[item];\n  });\n  const result = await User.updateOne({\n    _id: obj._id\n  }, body);\n  console.log(\"result\", result);\n\n  if (result.n === 1 && result.ok === 1) {\n    ctx.body = {\n      code: 200,\n      msg: msg === '' ? '更新成功' : msg\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '更新失败'\n    };\n  }\n}\n\nasync function changePassword(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"changePassword -> body\", body);\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  const user = await User.findOne({\n    _id: obj._id\n  });\n  console.log(\"changePassword -> user\", user);\n  let msg = '';\n\n  if (await bcrypt.compare(body.oldPassword, user.password)) {\n    body.newPassword = await bcrypt.hash(body.newPassword, 5);\n    console.log(\"changePassword ->  body.newPassword\", body.newPassword);\n    const result = await User.updateOne({\n      _id: obj._id\n    }, {\n      password: body.newPassword\n    });\n    console.log(\"result\", result);\n\n    if (result.n === 1 && result.ok === 1) {\n      ctx.body = {\n        code: 200,\n        msg: msg === '' ? '更新成功' : msg\n      };\n    } else {\n      ctx.body = {\n        code: 500,\n        msg: '更新失败'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 501,\n      msg: '原来的密码填写错误'\n    };\n    return;\n  }\n}\n\nmodule.exports = {\n  userSign,\n  updateUserInfo,\n  changePassword\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlNpZ25SZWNvcmQiLCJyZXF1aXJlIiwiVXNlciIsIlV0aWxzIiwic2V0VmFsdWUiLCJzZW5kIiwiY29uZmlnIiwibW9tZW50IiwidXVpZCIsImp3dCIsImJjcnlwdCIsInVzZXJTaWduIiwiY3R4Iiwib2JqIiwiZ2V0SldUUGF5bG9hZCIsImhlYWRlciIsImF1dGhvcml6YXRpb24iLCJyZWNvcmQiLCJmaW5kQnlVaWQiLCJfaWQiLCJjb25zb2xlIiwibG9nIiwidXNlciIsImZpbmRCeUlEIiwibmV3UmVjb3JkIiwicmVzdWx0IiwiY3JlYXRlZCIsImZvcm1hdCIsImJvZHkiLCJjb2RlIiwiZmF2cyIsImNvdW50IiwibGFzdFNpZ24iLCJtc2ciLCJmYXYiLCJzdWJ0cmFjdCIsInVwZGF0ZU9uZSIsIiRpbmMiLCIkc2V0IiwidWlkIiwic2F2ZSIsInVwZGF0ZVVzZXJJbmZvIiwicmVxdWVzdCIsImZpbmRPbmUiLCJ1c2VybmFtZSIsInRtcFVzZXIiLCJwYXNzd29yZCIsImtleSIsInNpZ24iLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwidHlwZSIsImRhdGEiLCJleHBpcmUiLCJhZGQiLCJlbWFpbCIsIm5hbWUiLCJhcnIiLCJtYXAiLCJpdGVtIiwibiIsIm9rIiwiY2hhbmdlUGFzc3dvcmQiLCJjb21wYXJlIiwib2xkUGFzc3dvcmQiLCJuZXdQYXNzd29yZCIsImhhc2giLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFVBQVUsR0FBR0MsT0FBTyxDQUFDLHFCQUFELENBQTFCOztBQUNBLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLGVBQUQsQ0FBcEI7O0FBQ0EsTUFBTUUsS0FBSyxHQUFHRixPQUFPLENBQUMsaUJBQUQsQ0FBckI7O0FBQ0EsTUFBTTtBQUFFRyxFQUFBQTtBQUFGLElBQWVILE9BQU8sQ0FBQyx1QkFBRCxDQUE1Qjs7QUFDQSxNQUFNO0FBQUVJLEVB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QVksUUFBWixFQUFzQkksTUFBdEI7O0FBQ0EsUUFBSUEsTUFBTSxDQUFDbUMsQ0FBUCxLQUFhLENBQWIsSUFBa0JuQyxNQUFNLENBQUNvQyxFQUFQLEtBQWMsQ0FBcEMsRUFBdUM7QUFDbkNqRCxNQUFBQSxHQUFHLENBQUNnQixJQUFKLEdBQVc7QUFDUEMsUUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUEksUUFBQUEsR0FBRyxFQUFFQSxHQUFHLEtBQUssRUFBUixHQUFhLE1BQWIsR0FBc0JBO0FBRnBCLE9BQVg7QUFJSCxLQUxELE1BS087QUFDSHJCLE1BQUFBLEdBQUcsQ0FBQ2dCLElBQUosR0FBVztBQUNQQyxRQUFBQSxJQUFJLEVBQUUsR0FEQztBQUVQSSxRQUFBQSxHQUFHLEVBQUU7QUFGRSxPQUFYO0FBSUg7QUFDSixHQWhCRCxNQWdCTztBQUNIckIsSUFBQUEsR0FBRyxDQUFDZ0IsSUFBSixHQUFXO0FBQ1BDLE1BQUFBLElBQUksRUFBRSxHQURDO0FBRVBJLE1BQUFBLEdBQUcsRUFBRTtBQUZFLEtBQVg7QUFJQTtBQUNIO0FBRUo7O0FBR0RrQyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRXpELEVBQUFBLFFBQUY7QUFBWThCLEVBQUFBLGNBQVo7QUFBNEJxQixFQUFBQTtBQUE1QixDQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9hcGkiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBTaWduUmVjb3JkID0gcmVxdWlyZSgnLi4vbW9kZWwvU2lnblJlY29yZCcpXG5jb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWwvVXNlcicpXG5jb25zdCBVdGlscyA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG5jb25zdCB7IHNldFZhbHVlIH0gPSByZXF1aXJlKCcuLi9jb25maWcvUmVkaXNDb25maWcnKVxuY29uc3QgeyBzZW5kIH0gPSByZXF1aXJlKCcuLi9jb25maWcvTWFpbENvbmZpZycpXG5jb25zdCBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcvaW5kZXgnKVxuXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCB1dWlkID0gcmVxdWlyZSgndXVpZC92NCcpXG5jb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKVxuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0JylcblxuYXN5bmMgZnVuY3Rpb24gdXNlclNpZ24gKGN0eCkge1xuICAgIGNvbnN0IG9iaiA9IGF3YWl0IFV0aWxzLmdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgIGNvbnN0IHJlY29yZCA9IGF3YWl0IFNpZ25SZWNvcmQuZmluZEJ5VWlkKG9iai5faWQpXG4gICAgY29uc29sZS5sb2coXCJ1c2VyU2lnbiAtPiByZWNvcmRcIiwgcmVjb3JkKVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlEKG9iai5faWQpXG4gICAgbGV0IG5ld1JlY29yZCA9IHt9XG4gICAgbGV0IHJlc3VsdCA9ICcnXG4gICAgcmVjb3JkLmNyZWF0ZWQgPSAnMjAyMC0wMy0xNFQwMjo1NDo0MS4wMDBaJ1xuICAgIGlmIChyZWNvcmQgIT09IG51bGwpIHtcbiAgICAgICAgaWYgKG1vbWVudChyZWNvcmQuY3JlYXRlZCkuZm9ybWF0KCdZWVlZLU1NLUREJykgPT09IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCcpKSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICAgICAgZmF2czogdXNlci5mYXZzLFxuICAgICAgICAgICAgICAgIGNvdW50OiB1c2VyLmNvdW50LFxuICAgICAgICAgICAgICAgIGxhc3RTaWduOiByZWNvcmQuY3JlYXRlZCxcbiAgICAgICAgICAgICAgICBtc2c6ICfnlKjmiLflt7Lnu4/nrb7liLAnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBjb3VudCA9IHVzZXIuY291bnRcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXNlclNpZ24gLT4gY291bnRcIiwgY291bnQpXG4gICAgICAgICAgICBsZXQgZmF2ID0gMFxuICAgICAgICAgICAgaWYgKG1vbWVudChyZWNvcmQuY3JlYXRlZCkuZm9ybWF0KCdZWVlZLU1NLUREJykgPT09IG1vbWVudCgpLnN1YnRyYWN0KDEsICdkYXlzJykuZm9ybWF0KCdZWVlZLU1NLUREJykpIHtcbiAgICAgICAgICAgICAgICBjb3VudCArPSAxXG4gICAgICAgICAgICAgICAgaWYgKGNvdW50IDwgNSkge1xuICAgICAgICAgICAgICAgICAgICBmYXYgPSA1XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSA1ICYmIGNvdW50IDwgMTUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gMTBcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50ID49IDE1ICYmIGNvdW50IDwgMzApIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gMTVcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50ID49IDMwICYmIGNvdW50IDwgMTAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdiA9IDIwXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSAxMDAgJiYgY291bnQgPCAzNjUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gMzBcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvdW50ID49IDM2NSkge1xuICAgICAgICAgICAgICAgICAgICBmYXYgPSA1MFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhd2FpdCBVc2VyLnVwZGF0ZU9uZShcbiAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IG9iai5faWQgfSxcbiAgICAgICAgICAgICAgICAgICAgeyAkaW5jOiB7IGZhdnM6IGZhdiwgY291bnQ6IDEgfSB9XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZmF2czogdXNlci5mYXZzICsgZmF2LFxuICAgICAgICAgICAgICAgICAgICBjb3VudDogdXNlci5jb3VudCArIDFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZhdiA9IDVcbiAgICAgICAgICAgICAgICBhd2FpdCBVc2VyLnVwZGF0ZU9uZShcbiAgICAgICAgICAgICAgICAgICAgeyBfaWQ6IG9iai5faWQgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNldDogeyBjb3VudDogMSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgJGluYzogeyBmYXZzOiBmYXYgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgZmF2czogdXNlci5mYXZzICsgZmF2LFxuICAgICAgICAgICAgICAgICAgICBjb3VudDogMVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld1JlY29yZCA9IG5ldyBTaWduUmVjb3JkKHtcbiAgICAgICAgICAgICAgICB1aWQ6IG9iai5faWQsXG4gICAgICAgICAgICAgICAgZmF2czogZmF2XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgYXdhaXQgbmV3UmVjb3JkLnNhdmUoKVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgYXdhaXQgVXNlci51cGRhdGVPbmUoe1xuICAgICAgICAgICAgX2lkOiBvYmouX2lkXG4gICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJHNldDogeyBjb3VudDogMSB9LFxuICAgICAgICAgICAgICAgICRpbmM6IHsgZmF2czogNSB9XG4gICAgICAgICAgICB9KVxuICAgICAgICBuZXdSZWNvcmQgPSBuZXcgU2lnblJlY29yZCh7XG4gICAgICAgICAgICB1aWQ6IG9iai5faWQsXG4gICAgICAgICAgICBmYXZzOiA1XG4gICAgICAgICAgICAvLyBsYXN0U2lnbjogbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICAgICAgfSlcbiAgICAgICAgYXdhaXQgbmV3UmVjb3JkLnNhdmUoKVxuICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICBmYXZzOiB1c2VyLmZhdnMgKyA1LFxuICAgICAgICAgICAgY291bnQ6IDFcbiAgICAgICAgfVxuICAgIH1cbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICBtc2c6ICfor7fmsYLmiJDlip8nLFxuICAgICAgICAuLi5yZXN1bHQsXG4gICAgICAgIGxhc3RTaWduOiBuZXdSZWNvcmQuY3JlYXRlZFxuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXNlckluZm8gKGN0eCkge1xuICAgIGNvbnN0IHsgYm9keSB9ID0gY3R4LnJlcXVlc3RcbiAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVVzZXJJbmZvIC0+IGJvZHlcIiwgYm9keSlcbiAgICBjb25zdCBvYmogPSBhd2FpdCBVdGlscy5nZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVVzZXJJbmZvIC0+IG9ialwiLCBvYmopXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IF9pZDogb2JqLl9pZCB9KVxuICAgIGNvbnNvbGUubG9nKFwidXBkYXRlVXNlckluZm8gLT4gdXNlclwiLCB1c2VyKVxuICAgIGxldCBtc2cgPSAnJ1xuICAgIGlmIChib2R5LnVzZXJuYW1lICYmIGJvZHkudXNlcm5hbWUgIT09IHVzZXIudXNlcm5hbWUpIHtcbiAgICAgICAgY29uc3QgdG1wVXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lOiBib2R5LnVzZXJuYW1lIH0pXG4gICAgICAgIGNvbnNvbGUubG9nKFwidXBkYXRlVXNlckluZm8gLT4gdG1wVXNlclwiLCB0bXBVc2VyKVxuICAgICAgICBpZiAodG1wVXNlciAmJiB0bXBVc2VyLnBhc3N3b3JkKSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA1MDEsXG4gICAgICAgICAgICAgICAgbXNnOiAn6YKu566x5bey57uP5rOo5YaMJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5ID0gdXVpZCgpXG4gICAgICAgIHNldFZhbHVlKFxuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgand0LnNpZ24oeyBfaWQ6IG9iai5faWQgfSwgY29uZmlnLkpXVF9TRUNSRVQsIHtcbiAgICAgICAgICAgICAgICBleHBpcmVzSW46ICczMG0nXG4gICAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICAgIGF3YWl0IHNlbmQoe1xuICAgICAgICAgICAgdHlwZTogJ2VtYWlsJyxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBrZXk6IGtleSxcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogYm9keS51c2VybmFtZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvZGU6ICcnLFxuICAgICAgICAgICAgZXhwaXJlOiBtb21lbnQoKS5hZGQoMzAsICdtaW51dGVzJykuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyksXG4gICAgICAgICAgICBlbWFpbDogdXNlci51c2VybmFtZSxcbiAgICAgICAgICAgIHVzZXI6IHVzZXIubmFtZVxuICAgICAgICB9KVxuICAgICAgICBtc2cgPSAn5pu05paw5Z+65pys6LWE5paZ5oiQ5Yqf77yM6LSm5Y+35L+u5pS56ZyA6KaB6YKu5Lu256Gu6K6k77yM6K+35p+l5pS26YKu5Lu2J1xuICAgIH1cbiAgICBjb25zdCBhcnIgPSBbJ3VzZXJuYW1lJywgJ21vYmlsZScsICdwYXNzd29yZCddXG4gICAgYXJyLm1hcChpdGVtID0+IHtcbiAgICAgICAgZGVsZXRlIGJvZHlbaXRlbV1cbiAgICB9KVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFVzZXIudXBkYXRlT25lKHsgX2lkOiBvYmouX2lkIH0sIGJvZHkpXG4gICAgY29uc29sZS5sb2coXCJyZXN1bHRcIiwgcmVzdWx0KVxuICAgIGlmIChyZXN1bHQubiA9PT0gMSAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBtc2c6IG1zZyA9PT0gJycgPyAn5pu05paw5oiQ5YqfJyA6IG1zZ1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmm7TmlrDlpLHotKUnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoYW5nZVBhc3N3b3JkIChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJjaGFuZ2VQYXNzd29yZCAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgb2JqID0gYXdhaXQgVXRpbHMuZ2V0SldUUGF5bG9hZChjdHguaGVhZGVyLmF1dGhvcml6YXRpb24pXG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IF9pZDogb2JqLl9pZCB9KVxuICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlUGFzc3dvcmQgLT4gdXNlclwiLCB1c2VyKVxuICAgIGxldCBtc2cgPSAnJ1xuICAgIGlmIChhd2FpdCBiY3J5cHQuY29tcGFyZShib2R5Lm9sZFBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKSkge1xuICAgICAgICBib2R5Lm5ld1Bhc3N3b3JkPWF3YWl0IGJjcnlwdC5oYXNoKGJvZHkubmV3UGFzc3dvcmQsNSlcbiAgICAgICAgY29uc29sZS5sb2coXCJjaGFuZ2VQYXNzd29yZCAtPiAgYm9keS5uZXdQYXNzd29yZFwiLCAgYm9keS5uZXdQYXNzd29yZClcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgVXNlci51cGRhdGVPbmUoeyBfaWQ6IG9iai5faWQgfSwge3Bhc3N3b3JkOmJvZHkubmV3UGFzc3dvcmR9KVxuICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdFwiLCByZXN1bHQpXG4gICAgICAgIGlmIChyZXN1bHQubiA9PT0gMSAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBtc2c6IG1zZyA9PT0gJycgPyAn5pu05paw5oiQ5YqfJyA6IG1zZ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIG1zZzogJ+abtOaWsOWksei0pSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgY29kZTogNTAxLFxuICAgICAgICAgICAgbXNnOiAn5Y6f5p2l55qE5a+G56CB5aGr5YaZ6ZSZ6K+vJ1xuICAgICAgICB9XG4gICAgICAgIHJldHVyblxuICAgIH1cblxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0geyB1c2VyU2lnbiwgdXBkYXRlVXNlckluZm8sIGNoYW5nZVBhc3N3b3JkIH0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "UserController.js"
      ],
      "names": [
        "SignRecord",
        "require",
        "User",
        "Utils",
        "setValue",
        "send",
        "config",
        "moment",
        "uuid",
        "jwt",
        "bcrypt",
        "userSign",
        "ctx",
        "obj",
        "getJWTPayload",
        "header",
        "authorization",
        "record",
        "findByUid",
        "_id",
        "console",
        "log",
        "user",
        "findByID",
        "newRecord",
        "result",
        "created",
        "format",
        "body",
        "code",
        "favs",
        "count",
        "lastSign",
        "msg",
        "fav",
        "subtract",
        "updateOne",
        "$inc",
        "$set",
        "uid",
        "save",
        "updateUserInfo",
        "request",
        "findOne",
        "username",
        "tmpUser",
        "password",
        "key",
        "sign",
        "JWT_SECRET",
        "expiresIn",
        "type",
        "data",
        "expire",
        "add",
        "email",
        "name",
        "arr",
        "map",
        "item",
        "n",
        "ok",
        "changePassword",
        "compare",
        "oldPassword",
        "newPassword",
        "hash",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "const SignRecord = require('../model/SignRecord')\nconst User = require('../model/User')\nconst Utils = require('../common/Utils')\nconst { setValue } = require('../config/RedisConfig')\nconst { send } = require('../config/MailConfig')\nconst config = require('../config/index')\n\nconst moment = require('dayjs')\nconst uuid = require('uuid/v4')\nconst jwt = require('jsonwebtoken')\nconst bcrypt = require('bcrypt')\n\nasync function userSign (ctx) {\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    const record = await SignRecord.findByUid(obj._id)\n    console.log(\"userSign -> record\", record)\n    const user = await User.findByID(obj._id)\n    let newRecord = {}\n    let result = ''\n    record.created = '2020-03-14T02:54:41.000Z'\n    if (record !== null) {\n        if (moment(record.created).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD')) {\n            ctx.body = {\n                code: 500,\n                favs: user.favs,\n                count: user.count,\n                lastSign: record.created,\n                msg: '用户已经签到'\n            }\n            return\n        } else {\n            let count = user.count\n            console.log(\"userSign -> count\", count)\n            let fav = 0\n            if (moment(record.created).format('YYYY-MM-DD') === moment().subtract(1, 'days').format('YYYY-MM-DD')) {\n                count += 1\n                if (count < 5) {\n                    fav = 5\n                } else if (count >= 5 && count < 15) {\n                    fav = 10\n                } else if (count >= 15 && count < 30) {\n                    fav = 15\n                } else if (count >= 30 && count < 100) {\n                    fav = 20\n                } else if (count >= 100 && count < 365) {\n                    fav = 30\n                } else if (count >= 365) {\n                    fav = 50\n                }\n                await User.updateOne(\n                    { _id: obj._id },\n                    { $inc: { favs: fav, count: 1 } }\n                )\n                result = {\n                    favs: user.favs + fav,\n                    count: user.count + 1\n                }\n            } else {\n                fav = 5\n                await User.updateOne(\n                    { _id: obj._id },\n                    {\n                        $set: { count: 1 },\n                        $inc: { favs: fav }\n                    }\n                )\n                result = {\n                    favs: user.favs + fav,\n                    count: 1\n                }\n            }\n            newRecord = new SignRecord({\n                uid: obj._id,\n                favs: fav\n            })\n            await newRecord.save()\n        }\n    } else {\n        await User.updateOne({\n            _id: obj._id\n        },\n            {\n                $set: { count: 1 },\n                $inc: { favs: 5 }\n            })\n        newRecord = new SignRecord({\n            uid: obj._id,\n            favs: 5\n            // lastSign: moment().format('YYYY-MM-DD HH:mm:ss')\n        })\n        await newRecord.save()\n        result = {\n            favs: user.favs + 5,\n            count: 1\n        }\n    }\n    ctx.body = {\n        code: 200,\n        msg: '请求成功',\n        ...result,\n        lastSign: newRecord.created\n    }\n}\n\nasync function updateUserInfo (ctx) {\n    const { body } = ctx.request\n    console.log(\"updateUserInfo -> body\", body)\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    console.log(\"updateUserInfo -> obj\", obj)\n    const user = await User.findOne({ _id: obj._id })\n    console.log(\"updateUserInfo -> user\", user)\n    let msg = ''\n    if (body.username && body.username !== user.username) {\n        const tmpUser = await User.findOne({ username: body.username })\n        console.log(\"updateUserInfo -> tmpUser\", tmpUser)\n        if (tmpUser && tmpUser.password) {\n            ctx.body = {\n                code: 501,\n                msg: '邮箱已经注册'\n            }\n            return\n        }\n        const key = uuid()\n        setValue(\n            key,\n            jwt.sign({ _id: obj._id }, config.JWT_SECRET, {\n                expiresIn: '30m'\n            })\n        )\n        await send({\n            type: 'email',\n            data: {\n                key: key,\n                username: body.username\n            },\n            code: '',\n            expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n            email: user.username,\n            user: user.name\n        })\n        msg = '更新基本资料成功，账号修改需要邮件确认，请查收邮件'\n    }\n    const arr = ['username', 'mobile', 'password']\n    arr.map(item => {\n        delete body[item]\n    })\n    const result = await User.updateOne({ _id: obj._id }, body)\n    console.log(\"result\", result)\n    if (result.n === 1 && result.ok === 1) {\n        ctx.body = {\n            code: 200,\n            msg: msg === '' ? '更新成功' : msg\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '更新失败'\n        }\n    }\n}\n\nasync function changePassword (ctx) {\n    const { body } = ctx.request\n    console.log(\"changePassword -> body\", body)\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    const user = await User.findOne({ _id: obj._id })\n    console.log(\"changePassword -> user\", user)\n    let msg = ''\n    if (await bcrypt.compare(body.oldPassword, user.password)) {\n        body.newPassword=await bcrypt.hash(body.newPassword,5)\n        console.log(\"changePassword ->  body.newPassword\",  body.newPassword)\n        const result = await User.updateOne({ _id: obj._id }, {password:body.newPassword})\n        console.log(\"result\", result)\n        if (result.n === 1 && result.ok === 1) {\n            ctx.body = {\n                code: 200,\n                msg: msg === '' ? '更新成功' : msg\n            }\n        } else {\n            ctx.body = {\n                code: 500,\n                msg: '更新失败'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 501,\n            msg: '原来的密码填写错误'\n        }\n        return\n    }\n\n}\n\n\nmodule.exports = { userSign, updateUserInfo, changePassword }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585539689626
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/SignRecord.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/SignRecord.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/SignRecord.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/SignRecord.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "SignRecord.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst SignRecordSchema = new Schema({\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  created: {\n    type: Date\n  },\n  favs: {\n    type: Number\n  },\n  lastSign: {\n    type: Date\n  }\n});\nSignRecordSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss');\n  next();\n});\nSignRecordSchema.statics = {\n  findByUid: function (uid) {\n    return this.findOne({\n      uid: uid\n    }).sort({\n      created: -1\n    });\n  }\n};\nconst SignRecord = mongoose.model('sign_record', SignRecordSchema);\nmodule.exports = SignRecord;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNpZ25SZWNvcmQuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiU2lnblJlY29yZFNjaGVtYSIsInVpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJjcmVhdGVkIiwiRGF0ZSIsImZhdnMiLCJOdW1iZXIiLCJsYXN0U2lnbiIsInByZSIsIm5leHQiLCJmb3JtYXQiLCJzdGF0aWNzIiwiZmluZEJ5VWlkIiwiZmluZE9uZSIsInNvcnQiLCJTaWduUmVjb3JkIiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFELENBQXhCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLE9BQUQsQ0FBdEI7O0FBRUEsTUFBTUUsTUFBTSxHQUFHSCxRQUFRLENBQUNHLE1BQXhCO0FBRUEsTUFBTUMsZ0JBQWdCLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQ2hDRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEMkI7QUFFaENDLEVBQUFBLE9BQU8sRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVJO0FBQVIsR0FGdUI7QUFHaENDLEVBQUFBLElBQUksRUFBRTtBQUFFTCxJQUFBQSxJQUFJLEVBQUVNO0FBQVIsR0FIMEI7QUFJaENDLEVBQUFBLFFBQVEsRUFBRTtBQUFFUCxJQUFBQSxJQUFJLEVBQUVJO0FBQVI7QUFKc0IsQ0FBWCxDQUF6QjtBQU9BTixnQkFBZ0IsQ0FBQ1UsR0FBakIsQ0FBcUIsTUFBckIsRUFBNkIsVUFBVUMsSUFBVixFQUFnQjtBQUN6QyxPQUFLTixPQUFMLEdBQWVQLE1BQU0sR0FBR2MsTUFBVCxDQUFnQixxQkFBaEIsQ0FBZjtBQUNBRCxFQUFBQSxJQUFJO0FBQ1AsQ0FIRDtBQUtBWCxnQkFBZ0IsQ0FBQ2EsT0FBakIsR0FBMkI7QUFDdkJDLEVBQUFBLFNBQVMsRUFBRSxVQUFVYixHQUFWLEVBQWU7QUFDdEIsV0FBTyxLQUFLYyxPQUFMLENBQWE7QUFBQ2QsTUFBQUEsR0FBRyxFQUFDQTtBQUFMLEtBQWIsRUFBd0JlLElBQXhCLENBQTZCO0FBQUNYLE1BQUFBLE9BQU8sRUFBQyxDQUFDO0FBQVYsS0FBN0IsQ0FBUDtBQUNIO0FBSHNCLENBQTNCO0FBTUEsTUFBTVksVUFBVSxHQUFHckIsUUFBUSxDQUFDc0IsS0FBVCxDQUFlLGFBQWYsRUFBOEJsQixnQkFBOUIsQ0FBbkI7QUFFQW1CLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlSCxVQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL21vZGVsIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCcuLi9jb25maWcvREJIZWxwZXInKVxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWFcblxuY29uc3QgU2lnblJlY29yZFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHVpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3VzZXJzJyB9LFxuICAgIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIGZhdnM6IHsgdHlwZTogTnVtYmVyIH0sXG4gICAgbGFzdFNpZ246IHsgdHlwZTogRGF0ZSB9XG59KVxuXG5TaWduUmVjb3JkU2NoZW1hLnByZSgnc2F2ZScsIGZ1bmN0aW9uIChuZXh0KSB7XG4gICAgdGhpcy5jcmVhdGVkID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICBuZXh0KClcbn0pXG5cblNpZ25SZWNvcmRTY2hlbWEuc3RhdGljcyA9IHtcbiAgICBmaW5kQnlVaWQ6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZE9uZSh7dWlkOnVpZH0pLnNvcnQoe2NyZWF0ZWQ6LTF9KVxuICAgIH1cbn1cblxuY29uc3QgU2lnblJlY29yZCA9IG1vbmdvb3NlLm1vZGVsKCdzaWduX3JlY29yZCcsIFNpZ25SZWNvcmRTY2hlbWEpXG5cbm1vZHVsZS5leHBvcnRzPVNpZ25SZWNvcmQiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "SignRecord.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "SignRecordSchema",
        "uid",
        "type",
        "String",
        "ref",
        "created",
        "Date",
        "favs",
        "Number",
        "lastSign",
        "pre",
        "next",
        "format",
        "statics",
        "findByUid",
        "findOne",
        "sort",
        "SignRecord",
        "model",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,OAAD,CAAtB;;AAEA,MAAME,MAAM,GAAGH,QAAQ,CAACG,MAAxB;AAEA,MAAMC,gBAAgB,GAAG,IAAID,MAAJ,CAAW;AAChCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GAD2B;AAEhCC,EAAAA,OAAO,EAAE;AAAEH,IAAAA,IAAI,EAAEI;AAAR,GAFuB;AAGhCC,EAAAA,IAAI,EAAE;AAAEL,IAAAA,IAAI,EAAEM;AAAR,GAH0B;AAIhCC,EAAAA,QAAQ,EAAE;AAAEP,IAAAA,IAAI,EAAEI;AAAR;AAJsB,CAAX,CAAzB;AAOAN,gBAAgB,CAACU,GAAjB,CAAqB,MAArB,EAA6B,UAAUC,IAAV,EAAgB;AACzC,OAAKN,OAAL,GAAeP,MAAM,GAAGc,MAAT,CAAgB,qBAAhB,CAAf;AACAD,EAAAA,IAAI;AACP,CAHD;AAKAX,gBAAgB,CAACa,OAAjB,GAA2B;AACvBC,EAAAA,SAAS,EAAE,UAAUb,GAAV,EAAe;AACtB,WAAO,KAAKc,OAAL,CAAa;AAACd,MAAAA,GAAG,EAACA;AAAL,KAAb,EAAwBe,IAAxB,CAA6B;AAACX,MAAAA,OAAO,EAAC,CAAC;AAAV,KAA7B,CAAP;AACH;AAHsB,CAA3B;AAMA,MAAMY,UAAU,GAAGrB,QAAQ,CAACsB,KAAT,CAAe,aAAf,EAA8BlB,gBAA9B,CAAnB;AAEAmB,MAAM,CAACC,OAAP,GAAeH,UAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\n\nconst Schema = mongoose.Schema\n\nconst SignRecordSchema = new Schema({\n    uid: { type: String, ref: 'users' },\n    created: { type: Date },\n    favs: { type: Number },\n    lastSign: { type: Date }\n})\n\nSignRecordSchema.pre('save', function (next) {\n    this.created = moment().format('YYYY-MM-DD HH:mm:ss')\n    next()\n})\n\nSignRecordSchema.statics = {\n    findByUid: function (uid) {\n        return this.findOne({uid:uid}).sort({created:-1})\n    }\n}\n\nconst SignRecord = mongoose.model('sign_record', SignRecordSchema)\n\nmodule.exports=SignRecord"
      ]
    },
    "sourceType": "script",
    "mtime": 1584200712828
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/User.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/User.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/User.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/User.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "User.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String,\n    index: {\n      unique: true\n    },\n    sparse: true\n  },\n  name: {\n    type: String\n  },\n  password: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  updated: {\n    type: Date\n  },\n  favs: {\n    type: Number,\n    default: 100\n  },\n  gender: {\n    type: String,\n    default: ''\n  },\n  roles: {\n    type: Array,\n    default: ['user']\n  },\n  pic: {\n    type: String,\n    default: '/img/header.png'\n  },\n  mobile: {\n    type: String,\n    match: /^1[3-9](\\d{9})$/,\n    default: ''\n  },\n  status: {\n    type: String,\n    default: '0'\n  },\n  regmark: {\n    type: String,\n    default: ''\n  },\n  location: {\n    type: String,\n    default: ''\n  },\n  isVip: {\n    type: String,\n    default: '0'\n  },\n  count: {\n    type: Number,\n    default: 0\n  }\n});\nUserSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH-mm:ss');\n  next();\n});\nUserSchema.pre('update', function (next) {\n  this.updated = moment().format('YYYY-MM-DD HH-mm:ss');\n  next();\n});\nUserSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MogoError' && error.code === 11000) {\n    next(new Error('Error:Mongoose has a duplicate key.'));\n  } else {\n    next(error);\n  }\n});\nUserSchema.statics = {\n  findByID: function (id) {\n    return this.findOne({\n      _id: id\n    }, {\n      password: 0,\n      username: 0,\n      mobile: 0\n    });\n  }\n};\nconst UserModel = mongoose.model('users', UserSchema);\nmodule.exports = UserModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiVXNlclNjaGVtYSIsInVzZXJuYW1lIiwidHlwZSIsIlN0cmluZyIsImluZGV4IiwidW5pcXVlIiwic3BhcnNlIiwibmFtZSIsInBhc3N3b3JkIiwiY3JlYXRlZCIsIkRhdGUiLCJ1cGRhdGVkIiwiZmF2cyIsIk51bWJlciIsImRlZmF1bHQiLCJnZW5kZXIiLCJyb2xlcyIsIkFycmF5IiwicGljIiwibW9iaWxlIiwibWF0Y2giLCJzdGF0dXMiLCJyZWdtYXJrIiwibG9jYXRpb24iLCJpc1ZpcCIsImNvdW50IiwicHJlIiwibmV4dCIsImZvcm1hdCIsInBvc3QiLCJlcnJvciIsImRvYyIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJmaW5kQnlJRCIsImlkIiwiZmluZE9uZSIsIl9pZCIsIlVzZXJNb2RlbCIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUF4Qjs7QUFDQSxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxPQUFELENBQXRCOztBQUNBLE1BQU1FLE1BQU0sR0FBQ0gsUUFBUSxDQUFDRyxNQUF0QjtBQUVBLE1BQU1DLFVBQVUsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDMUJFLEVBQUFBLFFBQVEsRUFBQztBQUFDQyxJQUFBQSxJQUFJLEVBQUNDLE1BQU47QUFBYUMsSUFBQUEsS0FBSyxFQUFDO0FBQUVDLE1BQUFBLE1BQU0sRUFBQztBQUFULEtBQW5CO0FBQWtDQyxJQUFBQSxNQUFNLEVBQUM7QUFBekMsR0FEaUI7QUFFMUJDLEVBQUFBLElBQUksRUFBQztBQUFDTCxJQUFBQSxJQUFJLEVBQUNDO0FBQU4sR0FGcUI7QUFHMUJLLEVBQUFBLFFBQVEsRUFBQztBQUFDTixJQUFBQSxJQUFJLEVBQUNDO0FBQU4sR0FIaUI7QUFJMUJNLEVBQUFB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QUF0QixDQUFQO0FBS0g7QUFQZ0IsQ0FBckI7QUFVQSxNQUFNb0IsU0FBUyxHQUFDM0MsUUFBUSxDQUFDNEMsS0FBVCxDQUFlLE9BQWYsRUFBdUJ4QyxVQUF2QixDQUFoQjtBQUNBeUMsTUFBTSxDQUFDQyxPQUFQLEdBQWVILFNBQWYiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9EQkhlbHBlcicpXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCBTY2hlbWE9bW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgICB1c2VybmFtZTp7dHlwZTpTdHJpbmcsaW5kZXg6eyB1bmlxdWU6dHJ1ZX0sc3BhcnNlOnRydWV9LFxuICAgIG5hbWU6e3R5cGU6U3RyaW5nfSxcbiAgICBwYXNzd29yZDp7dHlwZTpTdHJpbmd9LFxuICAgIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIHVwZGF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIGZhdnM6IHsgdHlwZTogTnVtYmVyLGRlZmF1bHQ6MTAwIH0sXG4gICAgZ2VuZGVyOiB7IHR5cGU6IFN0cmluZyxkZWZhdWx0OicnIH0sXG4gICAgcm9sZXM6IHsgdHlwZTogQXJyYXksZGVmYXVsdDpbJ3VzZXInXSB9LFxuICAgIHBpYzogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonL2ltZy9oZWFkZXIucG5nJyB9LFxuICAgIG1vYmlsZTogeyB0eXBlOiBTdHJpbmcsbWF0Y2g6L14xWzMtOV0oXFxkezl9KSQvLGRlZmF1bHQ6JycgfSxcbiAgICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nLGRlZmF1bHQ6JzAnIH0sXG4gICAgcmVnbWFyazogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonJyB9LFxuICAgIGxvY2F0aW9uOiB7IHR5cGU6IFN0cmluZyxkZWZhdWx0OicnIH0sXG4gICAgaXNWaXA6IHsgdHlwZTogU3RyaW5nLGRlZmF1bHQ6JzAnIH0sXG4gICAgY291bnQ6IHsgdHlwZTogTnVtYmVyLGRlZmF1bHQ6MCB9LFxufSlcblxuVXNlclNjaGVtYS5wcmUoJ3NhdmUnLGZ1bmN0aW9uKG5leHQpe1xuICAgIHRoaXMuY3JlYXRlZD1tb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEgtbW06c3MnKVxuICAgIG5leHQoKVxufSlcblxuVXNlclNjaGVtYS5wcmUoJ3VwZGF0ZScsZnVuY3Rpb24obmV4dCl7XG4gICAgdGhpcy51cGRhdGVkPW1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCBISC1tbTpzcycpXG4gICAgbmV4dCgpXG59KVxuXG5Vc2VyU2NoZW1hLnBvc3QoJ3NhdmUnLGZ1bmN0aW9uKGVycm9yLGRvYyxuZXh0KXtcbiAgICBpZihlcnJvci5uYW1lID09PSAnTW9nb0Vycm9yJyAmJiBlcnJvci5jb2RlPT09MTEwMDApe1xuICAgICAgICBuZXh0KG5ldyBFcnJvcignRXJyb3I6TW9uZ29vc2UgaGFzIGEgZHVwbGljYXRlIGtleS4nKSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0KGVycm9yKVxuICAgIH1cbn0pXG5cblVzZXJTY2hlbWEuc3RhdGljcyA9IHtcbiAgICBmaW5kQnlJRDogZnVuY3Rpb24oaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZE9uZSh7X2lkOmlkfSx7XG4gICAgICAgICAgICBwYXNzd29yZDogMCxcbiAgICAgICAgICAgIHVzZXJuYW1lOjAsXG4gICAgICAgICAgICBtb2JpbGU6MFxuICAgICAgICB9KVxuICAgIH1cbn1cblxuY29uc3QgVXNlck1vZGVsPW1vbmdvb3NlLm1vZGVsKCd1c2VycycsVXNlclNjaGVtYSlcbm1vZHVsZS5leHBvcnRzPVVzZXJNb2RlbCJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "User.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "UserSchema",
        "username",
        "type",
        "String",
        "index",
        "unique",
        "sparse",
        "name",
        "password",
        "created",
        "Date",
        "updated",
        "favs",
        "Number",
        "default",
        "gender",
        "roles",
        "Array",
        "pic",
        "mobile",
        "match",
        "status",
        "regmark",
        "location",
        "isVip",
        "count",
        "pre",
        "next",
        "format",
        "post",
        "error",
        "doc",
        "code",
        "Error",
        "statics",
        "findByID",
        "id",
        "findOne",
        "_id",
        "UserModel",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\nconst Schema=mongoose.Schema\n\nconst UserSchema = new Schema({\n    username:{type:String,index:{ unique:true},sparse:true},\n    name:{type:String},\n    password:{type:String},\n    created: { type: Date },\n    updated: { type: Date },\n    favs: { type: Number,default:100 },\n    gender: { type: String,default:'' },\n    roles: { type: Array,default:['user'] },\n    pic: { type: String,default:'/img/header.png' },\n    mobile: { type: String,match:/^1[3-9](\\d{9})$/,default:'' },\n    status: { type: String,default:'0' },\n    regmark: { type: String,default:'' },\n    location: { type: String,default:'' },\n    isVip: { type: String,default:'0' },\n    count: { type: Number,default:0 },\n})\n\nUserSchema.pre('save',function(next){\n    this.created=moment().format('YYYY-MM-DD HH-mm:ss')\n    next()\n})\n\nUserSchema.pre('update',function(next){\n    this.updated=moment().format('YYYY-MM-DD HH-mm:ss')\n    next()\n})\n\nUserSchema.post('save',function(error,doc,next){\n    if(error.name === 'MogoError' && error.code===11000){\n        next(new Error('Error:Mongoose has a duplicate key.'))\n    } else {\n        next(error)\n    }\n})\n\nUserSchema.statics = {\n    findByID: function(id) {\n        return this.findOne({_id:id},{\n            password: 0,\n            username:0,\n            mobile:0\n        })\n    }\n}\n\nconst UserModel=mongoose.model('users',UserSchema)\nmodule.exports=UserModel"
      ]
    },
    "sourceType": "script",
    "mtime": 1584241321797
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/Utils.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/Utils.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/Utils.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/Utils.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
        "sourceFileName": "Utils.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst redisConfig = require('../config/RedisConfig');\n\nconst config = require('../config/index');\n\nconst jwt = require('jsonwebtoken');\n\nvar getJWTPayload = function (token) {\n  console.log(\"secret->secret\", token.split('')[1]);\n  return jwt.verify(token.split(' ')[1], config.JWT_SECRET);\n};\n\nasync function checkCode(key, value) {\n  console.log(\"checkCode -> checkCode\", checkCode);\n  const redisData = await redisConfig.getValue(key);\n  console.log(\"checkCode -> redisData\", redisData);\n\n  if (redisData != null) {\n    debugger;\n\n    if (redisData.toLowerCase() === value.toLowerCase()) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n}\n\nexports.getJWTPayload = getJWTPayload;\nexports.checkCode = checkCode;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlV0aWxzLmpzIl0sIm5hbWVzIjpbInJlZGlzQ29uZmlnIiwicmVxdWlyZSIsImNvbmZpZyIsImp3dCIsImdldEpXVFBheWxvYWQiLCJ0b2tlbiIsImNvbnNvbGUiLCJsb2ciLCJzcGxpdCIsInZlcmlmeSIsIkpXVF9TRUNSRVQiLCJjaGVja0NvZGUiLCJrZXkiLCJ2YWx1ZSIsInJlZGlzRGF0YSIsImdldFZhbHVlIiwidG9Mb3dlckNhc2UiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFdBQVcsR0FBR0MsT0FBTyxDQUFDLHVCQUFELENBQTNCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLGlCQUFELENBQXRCOztBQUNBLE1BQU1FLEdBQUcsR0FBR0YsT0FBTyxDQUFDLGNBQUQsQ0FBbkI7O0FBRUEsSUFBSUcsYUFBYSxHQUFHLFVBQVVDLEtBQVYsRUFBaUI7QUFDakNDLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdCQUFaLEVBQThCRixLQUFLLENBQUNHLEtBQU4sQ0FBWSxFQUFaLEVBQWdCLENBQWhCLENBQTlCO0FBQ0EsU0FBT0wsR0FBRyxDQUFDTSxNQUFKLENBQVdKLEtBQUssQ0FBQ0csS0FBTixDQUFZLEdBQVosRUFBaUIsQ0FBakIsQ0FBWCxFQUFnQ04sTUFBTSxDQUFDUSxVQUF2QyxDQUFQO0FBQ0gsQ0FIRDs7QUFLQSxlQUFlQyxTQUFmLENBQTBCQyxHQUExQixFQUErQkMsS0FBL0IsRUFBc0M7QUFDbENQLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaLEVBQXNDSSxTQUF0QztBQUNBLFFBQU1HLFNBQVMsR0FBRyxNQUFNZCxXQUFXLENBQUNlLFFBQVosQ0FBcUJILEdBQXJCLENBQXhCO0FBQ0FOLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaLEVBQXNDTyxTQUF0Qzs7QUFDQSxNQUFJQSxTQUFTLElBQUksSUFBakIsRUFBdUI7QUFDbkI7O0FBQ0EsUUFBSUEsU0FBUyxDQUFDRSxXQUFWLE9BQTRCSCxLQUFLLENBQUNHLFdBQU4sRUFBaEMsRUFBcUQ7QUFDakQsYUFBTyxJQUFQO0FBQ0gsS0FGRCxNQUVPO0FBQ0gsYUFBTyxLQUFQO0FBQ0g7QUFDSixHQVBELE1BT087QUFDSCxXQUFPLEtBQVA7QUFDSDtBQUNKOztBQUVEQyxPQUFPLENBQUNiLGFBQVIsR0FBd0JBLGFBQXhCO0FBQ0FhLE9BQU8sQ0FBQ04sU0FBUixHQUFvQkEsU0FBcEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvY29tbW9uIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcmVkaXNDb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcvUmVkaXNDb25maWcnKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4JylcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpXG5cbnZhciBnZXRKV1RQYXlsb2FkID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgY29uc29sZS5sb2coXCJzZWNyZXQtPnNlY3JldFwiLCB0b2tlbi5zcGxpdCgnJylbMV0pXG4gICAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4uc3BsaXQoJyAnKVsxXSwgY29uZmlnLkpXVF9TRUNSRVQpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrQ29kZSAoa2V5LCB2YWx1ZSkge1xuICAgIGNvbnNvbGUubG9nKFwiY2hlY2tDb2RlIC0+IGNoZWNrQ29kZVwiLCBjaGVja0NvZGUpXG4gICAgY29uc3QgcmVkaXNEYXRhID0gYXdhaXQgcmVkaXNDb25maWcuZ2V0VmFsdWUoa2V5KVxuICAgIGNvbnNvbGUubG9nKFwiY2hlY2tDb2RlIC0+IHJlZGlzRGF0YVwiLCByZWRpc0RhdGEpXG4gICAgaWYgKHJlZGlzRGF0YSAhPSBudWxsKSB7XG4gICAgICAgIGRlYnVnZ2VyXG4gICAgICAgIGlmIChyZWRpc0RhdGEudG9Mb3dlckNhc2UoKSA9PT0gdmFsdWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxufVxuXG5leHBvcnRzLmdldEpXVFBheWxvYWQgPSBnZXRKV1RQYXlsb2FkO1xuZXhwb3J0cy5jaGVja0NvZGUgPSBjaGVja0NvZGU7Il19",
    "map": {
      "version": 3,
      "sources": [
        "Utils.js"
      ],
      "names": [
        "redisConfig",
        "require",
        "config",
        "jwt",
        "getJWTPayload",
        "token",
        "console",
        "log",
        "split",
        "verify",
        "JWT_SECRET",
        "checkCode",
        "key",
        "value",
        "redisData",
        "getValue",
        "toLowerCase",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,WAAW,GAAGC,OAAO,CAAC,uBAAD,CAA3B;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,iBAAD,CAAtB;;AACA,MAAME,GAAG,GAAGF,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAIG,aAAa,GAAG,UAAUC,KAAV,EAAiB;AACjCC,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,KAAK,CAACG,KAAN,CAAY,EAAZ,EAAgB,CAAhB,CAA9B;AACA,SAAOL,GAAG,CAACM,MAAJ,CAAWJ,KAAK,CAACG,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAX,EAAgCN,MAAM,CAACQ,UAAvC,CAAP;AACH,CAHD;;AAKA,eAAeC,SAAf,CAA0BC,GAA1B,EAA+BC,KAA/B,EAAsC;AAClCP,EAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCI,SAAtC;AACA,QAAMG,SAAS,GAAG,MAAMd,WAAW,CAACe,QAAZ,CAAqBH,GAArB,CAAxB;AACAN,EAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCO,SAAtC;;AACA,MAAIA,SAAS,IAAI,IAAjB,EAAuB;AACnB;;AACA,QAAIA,SAAS,CAACE,WAAV,OAA4BH,KAAK,CAACG,WAAN,EAAhC,EAAqD;AACjD,aAAO,IAAP;AACH,KAFD,MAEO;AACH,aAAO,KAAP;AACH;AACJ,GAPD,MAOO;AACH,WAAO,KAAP;AACH;AACJ;;AAEDC,OAAO,CAACb,aAAR,GAAwBA,aAAxB;AACAa,OAAO,CAACN,SAAR,GAAoBA,SAApB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
      "sourcesContent": [
        "const redisConfig = require('../config/RedisConfig')\nconst config = require('../config/index')\nconst jwt = require('jsonwebtoken')\n\nvar getJWTPayload = function (token) {\n    console.log(\"secret->secret\", token.split('')[1])\n    return jwt.verify(token.split(' ')[1], config.JWT_SECRET)\n}\n\nasync function checkCode (key, value) {\n    console.log(\"checkCode -> checkCode\", checkCode)\n    const redisData = await redisConfig.getValue(key)\n    console.log(\"checkCode -> redisData\", redisData)\n    if (redisData != null) {\n        debugger\n        if (redisData.toLowerCase() === value.toLowerCase()) {\n            return true\n        } else {\n            return false\n        }\n    } else {\n        return false\n    }\n}\n\nexports.getJWTPayload = getJWTPayload;\nexports.checkCode = checkCode;"
      ]
    },
    "sourceType": "script",
    "mtime": 1584589663148
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/index.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst path = require('path');\n\nconst DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb';\nconst REDIS = {\n  host: '47.99.202.255',\n  port: 15001,\n  password: '123456'\n};\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'none' : 'http://localhost:8080';\nconst uploadPath = process.env.NODE_ENV === 'production' ? '/app/public' : path.join(path.resolve(__dirname), '../../public');\nconst JWT_SECRET = 'onedaythisismyfuture'; // 本来是一个编码后的值，这里使用了随机写的字母\n// export default {\n//     DB_URL,\n//     REDIS\n// }\n\nmodule.exports = {\n  DB_URL,\n  REDIS,\n  uploadPath,\n  JWT_SECRET,\n  baseUrl\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInBhdGgiLCJyZXF1aXJlIiwiREJfVVJMIiwiUkVESVMiLCJob3N0IiwicG9ydCIsInBhc3N3b3JkIiwiYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInVwbG9hZFBhdGgiLCJqb2luIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsIkpXVF9TRUNSRVQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBRUEsTUFBTUMsTUFBTSxHQUFHLGtEQUFmO0FBQ0EsTUFBTUMsS0FBSyxHQUFHO0FBQ1ZDLEVBQUFBLElBQUksRUFBRSxlQURJO0FBRVZDLEVBQUFBLElBQUksRUFBRSxLQUZJO0FBR1ZDLEVBQUFBLFFBQVEsRUFBRTtBQUhBLENBQWQ7QUFLQSxNQUFNQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxRQUFaLEtBQXlCLFlBQXpCLEdBQXdDLE1BQXhDLEdBQWlELHVCQUFqRTtBQUNBLE1BQU1DLFVBQVUsR0FBR0gsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFFBQVosS0FBeUIsWUFBekIsR0FBd0MsYUFBeEMsR0FBd0RWLElBQUksQ0FBQ1ksSUFBTCxDQUFVWixJQUFJLENBQUNhLE9BQUwsQ0FBYUMsU0FBYixDQUFWLEVBQW1DLGNBQW5DLENBQTNFO0FBQ0EsTUFBTUMsVUFBVSxHQUFHLHNCQUFuQixDLENBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBOztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRWYsRUFBQUEsTUFBRjtBQUFVQyxFQUFBQSxLQUFWO0FBQWlCUSxFQUFBQSxVQUFqQjtBQUE2QkksRUFBQUEsVUFBN0I7QUFBeUNSLEVBQUFBO0FBQXpDLENBQWpCIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL2NvbmZpZyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJylcblxuY29uc3QgREJfVVJMID0gJ21vbmdvZGI6Ly90ZXN0OjEyMzQ1NkA0Ny45OS4yMDIuMjU1OjE1MDAxL3Rlc3RkYidcbmNvbnN0IFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAxNTAwMSxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cbmNvbnN0IGJhc2VVcmwgPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJ25vbmUnIDogJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MCdcbmNvbnN0IHVwbG9hZFBhdGggPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nID8gJy9hcHAvcHVibGljJyA6IHBhdGguam9pbihwYXRoLnJlc29sdmUoX19kaXJuYW1lKSwgJy4uLy4uL3B1YmxpYycpXG5jb25zdCBKV1RfU0VDUkVUID0gJ29uZWRheXRoaXNpc215ZnV0dXJlJyAgLy8g5pys5p2l5piv5LiA5Liq57yW56CB5ZCO55qE5YC877yM6L+Z6YeM5L2/55So5LqG6ZqP5py65YaZ55qE5a2X5q+NXG4vLyBleHBvcnQgZGVmYXVsdCB7XG4vLyAgICAgREJfVVJMLFxuLy8gICAgIFJFRElTXG4vLyB9XG5cbm1vZHVsZS5leHBvcnRzID0geyBEQl9VUkwsIFJFRElTLCB1cGxvYWRQYXRoLCBKV1RfU0VDUkVULCBiYXNlVXJsIH0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "path",
        "require",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "baseUrl",
        "process",
        "env",
        "NODE_ENV",
        "uploadPath",
        "join",
        "resolve",
        "__dirname",
        "JWT_SECRET",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AAEA,MAAMC,MAAM,GAAG,kDAAf;AACA,MAAMC,KAAK,GAAG;AACVC,EAAAA,IAAI,EAAE,eADI;AAEVC,EAAAA,IAAI,EAAE,KAFI;AAGVC,EAAAA,QAAQ,EAAE;AAHA,CAAd;AAKA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,MAAxC,GAAiD,uBAAjE;AACA,MAAMC,UAAU,GAAGH,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,aAAxC,GAAwDV,IAAI,CAACY,IAAL,CAAUZ,IAAI,CAACa,OAAL,CAAaC,SAAb,CAAV,EAAmC,cAAnC,CAA3E;AACA,MAAMC,UAAU,GAAG,sBAAnB,C,CAA2C;AAC3C;AACA;AACA;AACA;;AAEAC,MAAM,CAACC,OAAP,GAAiB;AAAEf,EAAAA,MAAF;AAAUC,EAAAA,KAAV;AAAiBQ,EAAAA,UAAjB;AAA6BI,EAAAA,UAA7B;AAAyCR,EAAAA;AAAzC,CAAjB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "sourcesContent": [
        "const path = require('path')\n\nconst DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb'\nconst REDIS = {\n    host: '47.99.202.255',\n    port: 15001,\n    password: '123456'\n}\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'none' : 'http://localhost:8080'\nconst uploadPath = process.env.NODE_ENV === 'production' ? '/app/public' : path.join(path.resolve(__dirname), '../../public')\nconst JWT_SECRET = 'onedaythisismyfuture'  // 本来是一个编码后的值，这里使用了随机写的字母\n// export default {\n//     DB_URL,\n//     REDIS\n// }\n\nmodule.exports = { DB_URL, REDIS, uploadPath, JWT_SECRET, baseUrl }"
      ]
    },
    "sourceType": "script",
    "mtime": 1584430968349
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/loginRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/loginRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/loginRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/loginRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "loginRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst loginController = require('../../api/LoginController');\n\nconst router = new Router();\nrouter.prefix('/login'); // router.post('/forget',loginController.forget)\n\nrouter.post('/login', loginController.login);\nrouter.post('/reg', loginController.reg);\nrouter.post('/forget', loginController.forget);\nrouter.post('/reset', loginController.reset);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luUm91dGVyLmpzIl0sIm5hbWVzIjpbIlJvdXRlciIsInJlcXVpcmUiLCJsb2dpbkNvbnRyb2xsZXIiLCJyb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibG9naW4iLCJyZWciLCJmb3JnZXQiLCJyZXNldCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsTUFBTSxHQUFDQyxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxlQUFlLEdBQUNELE9BQU8sQ0FBQywyQkFBRCxDQUE3Qjs7QUFFQSxNQUFNRSxNQUFNLEdBQUMsSUFBSUgsTUFBSixFQUFiO0FBRUFHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFFBQWQsRSxDQUNBOztBQUNBRCxNQUFNLENBQUNFLElBQVAsQ0FBWSxRQUFaLEVBQXFCSCxlQUFlLENBQUNJLEtBQXJDO0FBQ0FILE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLE1BQVosRUFBbUJILGVBQWUsQ0FBQ0ssR0FBbkM7QUFDQUosTUFBTSxDQUFDRSxJQUFQLENBQVksU0FBWixFQUFzQkgsZUFBZSxDQUFDTSxNQUF0QztBQUNBTCxNQUFNLENBQUNFLElBQVAsQ0FBWSxRQUFaLEVBQXFCSCxlQUFlLENBQUNPLEtBQXJDO0FBRUFDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFnQlIsTUFBaEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvcm91dGVzL21vZHVsZXMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBSb3V0ZXI9cmVxdWlyZSgna29hLXJvdXRlcicpXG5jb25zdCBsb2dpbkNvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL0xvZ2luQ29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcblxucm91dGVyLnByZWZpeCgnL2xvZ2luJylcbi8vIHJvdXRlci5wb3N0KCcvZm9yZ2V0Jyxsb2dpbkNvbnRyb2xsZXIuZm9yZ2V0KVxucm91dGVyLnBvc3QoJy9sb2dpbicsbG9naW5Db250cm9sbGVyLmxvZ2luKVxucm91dGVyLnBvc3QoJy9yZWcnLGxvZ2luQ29udHJvbGxlci5yZWcpXG5yb3V0ZXIucG9zdCgnL2ZvcmdldCcsbG9naW5Db250cm9sbGVyLmZvcmdldClcbnJvdXRlci5wb3N0KCcvcmVzZXQnLGxvZ2luQ29udHJvbGxlci5yZXNldClcblxubW9kdWxlLmV4cG9ydHM9IHJvdXRlciJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "loginRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "loginController",
        "router",
        "prefix",
        "post",
        "login",
        "reg",
        "forget",
        "reset",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,eAAe,GAACD,OAAO,CAAC,2BAAD,CAA7B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AAEAG,MAAM,CAACC,MAAP,CAAc,QAAd,E,CACA;;AACAD,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,eAAe,CAACI,KAArC;AACAH,MAAM,CAACE,IAAP,CAAY,MAAZ,EAAmBH,eAAe,CAACK,GAAnC;AACAJ,MAAM,CAACE,IAAP,CAAY,SAAZ,EAAsBH,eAAe,CAACM,MAAtC;AACAL,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,eAAe,CAACO,KAArC;AAEAC,MAAM,CAACC,OAAP,GAAgBR,MAAhB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst loginController=require('../../api/LoginController')\n\nconst router=new Router()\n\nrouter.prefix('/login')\n// router.post('/forget',loginController.forget)\nrouter.post('/login',loginController.login)\nrouter.post('/reg',loginController.reg)\nrouter.post('/forget',loginController.forget)\nrouter.post('/reset',loginController.reset)\n\nmodule.exports= router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585404263267
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/LoginController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/LoginController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/LoginController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/LoginController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "LoginController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst send = require('../config/MailConfig.js');\n\nconst bcrypt = require('bcrypt');\n\nconst moment = require('dayjs');\n\nconst jsonwebtoken = require('jsonwebtoken');\n\nconst config = require('../config/index'); // const checkCode=require('../common/Utils')\n\n\nconst Utils = require('../common/Utils');\n\nconst User = require('../model/User');\n\nconst forget = function (ctx) {\n  const {\n    body\n  } = ctx.request;\n\n  if (typeof body.username !== 'undefined') {\n    try {\n      let result = send({\n        code: '1234',\n        expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n        email: body.username,\n        user: 'echo'\n      });\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: '邮件发送成功'\n      };\n    } catch (e) {\n      console.log(e);\n    }\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '服务器异常'\n    };\n  }\n};\n\nasync function login(ctx) {\n  const {\n    body\n  } = ctx.request;\n  let sid = body.sid;\n  let code = body.code;\n  let result = await Utils.checkCode(sid, code);\n  console.log(result);\n\n  if (result) {\n    let checkUserPasswd = false;\n    let user = await User.findOne({\n      username: body.username\n    });\n\n    if (await bcrypt.compare(body.password, user.password)) {\n      checkUserPasswd = true;\n    }\n\n    if (checkUserPasswd) {\n      const userObj = user.toJSON();\n      const arr = ['password']; //和源码有不同，这里没有删除邮箱了。\n\n      arr.map(item => {\n        delete userObj[item];\n      });\n      let token = jsonwebtoken.sign({\n        _id: userObj._id\n      }, config.JWT_SECRET, {\n        expiresIn: '1d'\n      }); //\n\n      ctx.body = {\n        code: 200,\n        data: userObj,\n        token: token\n      };\n    } else {\n      ctx.body = {\n        code: 404,\n        msg: '用户名或密码错误'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 401,\n      msg: '图片验证码不正确，请检查！'\n    };\n  }\n}\n\nasync function reg(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"reg -> body\", body);\n  let sid = body.sid;\n  let code = body.code;\n  let msg = {};\n  let result = await Utils.checkCode(sid, code);\n  console.log(\"result:\" + result);\n  let check = true;\n\n  if (result) {\n    let user1 = await User.findOne({\n      username: body.username\n    });\n\n    if (user1 !== null && typeof user1.username !== 'undefined') {\n      console.log(\"user1\" + user1);\n      msg.username = ['此邮箱已经被注册，可以通过邮箱找回密码'];\n      check = false;\n    }\n\n    check = true;\n    let user2 = await User.findOne({\n      name: body.name\n    });\n\n    if (user2 !== null && typeof user2.name !== 'undefined') {\n      msg.name = ['此昵称已经被注册，请修改'];\n      check = false;\n    }\n\n    if (check) {\n      body.password = await bcrypt.hash(body.password, 5);\n      let user = new User({\n        username: body.username,\n        name: body.name,\n        password: body.password,\n        created: moment().format('YYYY-MM-DD HH:mm:ss')\n      });\n      let result = await user.save();\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: '注册成功'\n      };\n      return;\n    }\n  } else {\n    msg.code = ['验证码已经失效，请重新获取！'];\n  }\n\n  ctx.body = {\n    code: 500,\n    msg: msg\n  };\n}\n\nasync function reset(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"reset -> body\", body, body.username);\n  let sid = body.sid;\n  let code = body.code;\n  let msg = {};\n  const result = await Utils.checkCode(sid, code);\n\n  if (result) {\n    let user = await User.findOne({\n      username: body.username\n    });\n\n    if (user === null && user.username === 'undefined') {\n      msg.username = ['此邮箱未注册，请确认'];\n      ctx.body = {\n        code: 500,\n        msg: msg\n      };\n    } else {\n      user.password = await bcrypt.hash(body.password, 5);\n      user.updated = moment().format('YYYY-MM-DD HH:mm:ss');\n      let result = await user.save();\n      const userObj = result.toJSON();\n      const arr = ['password'];\n      arr.map(item => {\n        delete userObj[item];\n      });\n      let token = jsonwebtoken.sign({\n        _id: userObj._id\n      }, config.JWT_SECRET, {\n        expiresIn: '1d'\n      }); //\n\n      ctx.body = {\n        code: 200,\n        data: userObj,\n        token: token,\n        msg: '更新密码成功！'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 401,\n      msg: '图片验证码不正确，请检查！'\n    };\n  }\n}\n\nmodule.exports = {\n  forget,\n  login,\n  reg,\n  reset\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxvZ2luQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJzZW5kIiwicmVxdWlyZSIsImJjcnlwdCIsIm1vbWVudCIsImpzb253ZWJ0b2tlbiIsImNvbmZpZyIsIlV0aWxzIiwiVXNlciIsImZvcmdldCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwidXNlcm5hbWUiLCJyZXN1bHQiLCJjb2RlIiwiZXhwaXJlIiwiYWRkIiwiZm9ybWF0IiwiZW1haWwiLCJ1c2VyIiwiZGF0YSIsIm1zZyIsImUiLCJjb25zb2xlIiwibG9nIiwibG9naW4iLCJzaWQiLCJjaGVja0NvZGUiLCJjaGVja1VzZXJQYXNzd2QiLCJmaW5kT25lIiwiY29tcGFyZSIsInBhc3N3b3JkIiwidXNlck9iaiIsInRvSlNPTiIsImFyciIsIm1hcCIsIml0ZW0iLCJ0b2tlbiIsInNpZ24iLCJfaWQiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwicmVnIiwiY2hlY2siLCJ1c2VyMSIsInVzZXIyIiwibmFtZSIsImhhc2giLCJjcmVhdGVkIiwic2F2ZSIsInJlc2V0IiwidXBkYXRlZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMseUJBQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxPQUFELENBQXRCOztBQUNBLE1BQU1HLFlBQVksR0FBR0gsT0FBTyxDQUFDLGNBQUQsQ0FBNUI7O0FBQ0EsTUFBTUksTUFBTSxHQUFHSixPQUFPLENBQUMsaUJBQUQsQ0FBdEIsQyxDQUNBOzs7QUFDQSxNQUFNSyxLQUFLLEdBQUdMLE9BQU8sQ0FBQyxpQkFBRCxDQUFyQjs7QUFDQSxNQUFNTSxJQUFJLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQXBCOztBQUVBLE1BQU1PLE1BQU0sR0FBRyxVQUFVQyxHQUFWLEVBQWU7QUFDMUIsUUFBTTtB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R2MsTUFBVCxDQUFnQixxQkFBaEIsQ0FBYjtBQUNBLFVBQUlKLE1BQU0sR0FBRyxNQUFNTSxJQUFJLENBQUM4QixJQUFMLEVBQW5CO0FBQ0EsWUFBTWpCLE9BQU8sR0FBR25CLE1BQU0sQ0FBQ29CLE1BQVAsRUFBaEI7QUFDQSxZQUFNQyxHQUFHLEdBQUcsQ0FBQyxVQUFELENBQVo7QUFDQUEsTUFBQUEsR0FBRyxDQUFDQyxHQUFKLENBQVNDLElBQUQsSUFBVTtBQUNkLGVBQU9KLE9BQU8sQ0FBQ0ksSUFBRCxDQUFkO0FBQ0gsT0FGRDtBQUdBLFVBQUlDLEtBQUssR0FBR2pDLFlBQVksQ0FBQ2tDLElBQWIsQ0FBa0I7QUFBRUMsUUFBQUEsR0FBRyxFQUFFUCxPQUFPLENBQUNPO0FBQWYsT0FBbEIsRUFBd0NsQyxNQUFNLENBQUNtQyxVQUEvQyxFQUEyRDtBQUFFQyxRQUFBQSxTQUFTLEVBQUU7QUFBYixPQUEzRCxDQUFaLENBVEcsQ0FTeUY7O0FBQzVGaEMsTUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEksUUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUE0sUUFBQUEsSUFBSSxFQUFFWSxPQUZDO0FBR1BLLFFBQUFBLEtBQUssRUFBRUEsS0FIQTtBQUlQaEIsUUFBQUEsR0FBRyxFQUFDO0FBSkcsT0FBWDtBQU1IO0FBQ0osR0F6QkQsTUF5Qk87QUFDSFosSUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEksTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUE8sTUFBQUEsR0FBRyxFQUFFO0FBRkUsS0FBWDtBQUlIO0FBQ0o7O0FBRUQrQixNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRTdDLEVBQUFBLE1BQUY7QUFBVWlCLEVBQUFBLEtBQVY7QUFBaUJpQixFQUFBQSxHQUFqQjtBQUFzQlEsRUFBQUE7QUFBdEIsQ0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvYXBpIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2VuZCA9IHJlcXVpcmUoJy4uL2NvbmZpZy9NYWlsQ29uZmlnLmpzJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCBqc29ud2VidG9rZW4gPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4Jylcbi8vIGNvbnN0IGNoZWNrQ29kZT1yZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXRpbHMgPSByZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXInKVxuXG5jb25zdCBmb3JnZXQgPSBmdW5jdGlvbiAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGlmICh0eXBlb2YgYm9keS51c2VybmFtZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBzZW5kKHtcbiAgICAgICAgICAgICAgICBjb2RlOiAnMTIzNCcsXG4gICAgICAgICAgICAgICAgZXhwaXJlOiBtb21lbnQoKS5hZGQoMzAsICdtaW51dGVzJykuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyksXG4gICAgICAgICAgICAgICAgZW1haWw6IGJvZHkudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgdXNlcjogJ2VjaG8nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgbXNnOiAn6YKu5Lu25Y+R6YCB5oiQ5YqfJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmnI3liqHlmajlvILluLgnXG4gICAgICAgIH1cbiAgICB9XG59XG5hc3luYyBmdW5jdGlvbiBsb2dpbiAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGxldCBzaWQgPSBib2R5LnNpZFxuICAgIGxldCBjb2RlID0gYm9keS5jb2RlXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IFV0aWxzLmNoZWNrQ29kZShzaWQsIGNvZGUpXG4gICAgY29uc29sZS5sb2cocmVzdWx0KVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgbGV0IGNoZWNrVXNlclBhc3N3ZCA9IGZhbHNlXG4gICAgICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWUgfSlcbiAgICAgICAgaWYgKGF3YWl0IGJjcnlwdC5jb21wYXJlKGJvZHkucGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpKSB7XG4gICAgICAgICAgICBjaGVja1VzZXJQYXNzd2QgPSB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoZWNrVXNlclBhc3N3ZCkge1xuICAgICAgICAgICAgY29uc3QgdXNlck9iaiA9IHVzZXIudG9KU09OKClcbiAgICAgICAgICAgIGNvbnN0IGFyciA9IFsncGFzc3dvcmQnXSAvL+WSjOa6kOeggeacieS4jeWQjO+8jOi/memHjOayoeacieWIoOmZpOmCrueuseS6huOAglxuICAgICAgICAgICAgYXJyLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB1c2VyT2JqW2l0ZW1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgbGV0IHRva2VuID0ganNvbndlYnRva2VuLnNpZ24oeyBfaWQ6IHVzZXJPYmouX2lkIH0sIGNvbmZpZy5KV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogJzFkJyB9KSAvL1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogMjAwLFxuICAgICAgICAgICAgICAgIGRhdGE6IHVzZXJPYmosXG4gICAgICAgICAgICAgICAgdG9rZW46IHRva2VuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA0MDQsXG4gICAgICAgICAgICAgICAgbXNnOiAn55So5oi35ZCN5oiW5a+G56CB6ZSZ6K+vJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA0MDEsXG4gICAgICAgICAgICBtc2c6ICflm77niYfpqozor4HnoIHkuI3mraPnoa7vvIzor7fmo4Dmn6XvvIEnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlZyAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwicmVnIC0+IGJvZHlcIiwgYm9keSlcbiAgICBsZXQgc2lkID0gYm9keS5zaWRcbiAgICBsZXQgY29kZSA9IGJvZHkuY29kZVxuICAgIGxldCBtc2cgPSB7fVxuICAgIGxldCByZXN1bHQgPSBhd2FpdCBVdGlscy5jaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGNvbnNvbGUubG9nKFwicmVzdWx0OlwiICsgcmVzdWx0KVxuICAgIGxldCBjaGVjayA9IHRydWVcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGxldCB1c2VyMSA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lOiBib2R5LnVzZXJuYW1lIH0pXG4gICAgICAgIGlmICh1c2VyMSAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjEudXNlcm5hbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIxXCIgKyB1c2VyMSlcbiAgICAgICAgICAgIG1zZy51c2VybmFtZSA9IFsn5q2k6YKu566x5bey57uP6KKr5rOo5YaM77yM5Y+v5Lul6YCa6L+H6YKu566x5om+5Zue5a+G56CBJ11cbiAgICAgICAgICAgIGNoZWNrID0gZmFsc2VcbiAgICAgICAgfVxuICAgICAgICBjaGVjayA9IHRydWVcbiAgICAgICAgbGV0IHVzZXIyID0gYXdhaXQgVXNlci5maW5kT25lKHsgbmFtZTogYm9keS5uYW1lIH0pXG4gICAgICAgIGlmICh1c2VyMiAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjIubmFtZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIG1zZy5uYW1lID0gWyfmraTmmLXnp7Dlt7Lnu4/ooqvms6jlhozvvIzor7fkv67mlLknXVxuICAgICAgICAgICAgY2hlY2sgPSBmYWxzZVxuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgICAgYm9keS5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKGJvZHkucGFzc3dvcmQsIDUpXG4gICAgICAgICAgICBsZXQgdXNlciA9IG5ldyBVc2VyKHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogYm9keS51c2VybmFtZSxcbiAgICAgICAgICAgICAgICBuYW1lOiBib2R5Lm5hbWUsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGJvZHkucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgY3JlYXRlZDogbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdXNlci5zYXZlKClcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgbXNnOiAn5rOo5YaM5oiQ5YqfJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBtc2cuY29kZSA9IFsn6aqM6K+B56CB5bey57uP5aSx5pWI77yM6K+36YeN5paw6I635Y+W77yBJ11cbiAgICB9XG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgbXNnOiBtc2dcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlc2V0IChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJyZXNldCAtPiBib2R5XCIsIGJvZHksIGJvZHkudXNlcm5hbWUpXG4gICAgbGV0IHNpZCA9IGJvZHkuc2lkXG4gICAgbGV0IGNvZGUgPSBib2R5LmNvZGVcbiAgICBsZXQgbXNnID0ge31cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBVdGlscy5jaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogYm9keS51c2VybmFtZSB9KVxuICAgICAgICBpZiAodXNlciA9PT0gbnVsbCAmJiB1c2VyLnVzZXJuYW1lID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgbXNnLnVzZXJuYW1lID0gWyfmraTpgq7nrrHmnKrms6jlhozvvIzor7fnoa7orqQnXVxuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIG1zZzogbXNnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1c2VyLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2goYm9keS5wYXNzd29yZCwgNSlcbiAgICAgICAgICAgIHVzZXIudXBkYXRlZD1tb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKVxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHVzZXIuc2F2ZSgpXG4gICAgICAgICAgICBjb25zdCB1c2VyT2JqID0gcmVzdWx0LnRvSlNPTigpXG4gICAgICAgICAgICBjb25zdCBhcnIgPSBbJ3Bhc3N3b3JkJ10gXG4gICAgICAgICAgICBhcnIubWFwKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHVzZXJPYmpbaXRlbV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBsZXQgdG9rZW4gPSBqc29ud2VidG9rZW4uc2lnbih7IF9pZDogdXNlck9iai5faWQgfSwgY29uZmlnLkpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnMWQnIH0pIC8vXG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICAgICAgZGF0YTogdXNlck9iaixcbiAgICAgICAgICAgICAgICB0b2tlbjogdG9rZW4sXG4gICAgICAgICAgICAgICAgbXNnOifmm7TmlrDlr4bnoIHmiJDlip/vvIEnXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDQwMSxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggeS4jeato+ehru+8jOivt+ajgOafpe+8gSdcbiAgICAgICAgfVxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IGZvcmdldCwgbG9naW4sIHJlZywgcmVzZXQgfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "LoginController.js"
      ],
      "names": [
        "send",
        "require",
        "bcrypt",
        "moment",
        "jsonwebtoken",
        "config",
        "Utils",
        "User",
        "forget",
        "ctx",
        "body",
        "request",
        "username",
        "result",
        "code",
        "expire",
        "add",
        "format",
        "email",
        "user",
        "data",
        "msg",
        "e",
        "console",
        "log",
        "login",
        "sid",
        "checkCode",
        "checkUserPasswd",
        "findOne",
        "compare",
        "password",
        "userObj",
        "toJSON",
        "arr",
        "map",
        "item",
        "token",
        "sign",
        "_id",
        "JWT_SECRET",
        "expiresIn",
        "reg",
        "check",
        "user1",
        "user2",
        "name",
        "hash",
        "created",
        "save",
        "reset",
        "updated",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "const send = require('../config/MailConfig.js')\nconst bcrypt = require('bcrypt')\nconst moment = require('dayjs')\nconst jsonwebtoken = require('jsonwebtoken')\nconst config = require('../config/index')\n// const checkCode=require('../common/Utils')\nconst Utils = require('../common/Utils')\nconst User = require('../model/User')\n\nconst forget = function (ctx) {\n    const { body } = ctx.request\n    if (typeof body.username !== 'undefined') {\n        try {\n            let result = send({\n                code: '1234',\n                expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n                email: body.username,\n                user: 'echo',\n            })\n            ctx.body = {\n                code: 200,\n                data: result,\n                msg: '邮件发送成功'\n            }\n        } catch (e) {\n            console.log(e)\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '服务器异常'\n        }\n    }\n}\nasync function login (ctx) {\n    const { body } = ctx.request\n    let sid = body.sid\n    let code = body.code\n    let result = await Utils.checkCode(sid, code)\n    console.log(result)\n    if (result) {\n        let checkUserPasswd = false\n        let user = await User.findOne({ username: body.username })\n        if (await bcrypt.compare(body.password, user.password)) {\n            checkUserPasswd = true\n        }\n        if (checkUserPasswd) {\n            const userObj = user.toJSON()\n            const arr = ['password'] //和源码有不同，这里没有删除邮箱了。\n            arr.map((item) => {\n                delete userObj[item]\n            })\n            let token = jsonwebtoken.sign({ _id: userObj._id }, config.JWT_SECRET, { expiresIn: '1d' }) //\n            ctx.body = {\n                code: 200,\n                data: userObj,\n                token: token\n            }\n        } else {\n            ctx.body = {\n                code: 404,\n                msg: '用户名或密码错误'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 401,\n            msg: '图片验证码不正确，请检查！'\n        }\n    }\n}\n\nasync function reg (ctx) {\n    const { body } = ctx.request\n    console.log(\"reg -> body\", body)\n    let sid = body.sid\n    let code = body.code\n    let msg = {}\n    let result = await Utils.checkCode(sid, code)\n    console.log(\"result:\" + result)\n    let check = true\n    if (result) {\n        let user1 = await User.findOne({ username: body.username })\n        if (user1 !== null && typeof user1.username !== 'undefined') {\n            console.log(\"user1\" + user1)\n            msg.username = ['此邮箱已经被注册，可以通过邮箱找回密码']\n            check = false\n        }\n        check = true\n        let user2 = await User.findOne({ name: body.name })\n        if (user2 !== null && typeof user2.name !== 'undefined') {\n            msg.name = ['此昵称已经被注册，请修改']\n            check = false\n        }\n        if (check) {\n            body.password = await bcrypt.hash(body.password, 5)\n            let user = new User({\n                username: body.username,\n                name: body.name,\n                password: body.password,\n                created: moment().format('YYYY-MM-DD HH:mm:ss')\n            })\n            let result = await user.save()\n            ctx.body = {\n                code: 200,\n                data: result,\n                msg: '注册成功'\n            }\n            return\n        }\n    } else {\n        msg.code = ['验证码已经失效，请重新获取！']\n    }\n    ctx.body = {\n        code: 500,\n        msg: msg\n    }\n}\n\nasync function reset (ctx) {\n    const { body } = ctx.request\n    console.log(\"reset -> body\", body, body.username)\n    let sid = body.sid\n    let code = body.code\n    let msg = {}\n    const result = await Utils.checkCode(sid, code)\n    if (result) {\n        let user = await User.findOne({ username: body.username })\n        if (user === null && user.username === 'undefined') {\n            msg.username = ['此邮箱未注册，请确认']\n            ctx.body = {\n                code: 500,\n                msg: msg\n            }\n        } else {\n            user.password = await bcrypt.hash(body.password, 5)\n            user.updated=moment().format('YYYY-MM-DD HH:mm:ss')\n            let result = await user.save()\n            const userObj = result.toJSON()\n            const arr = ['password'] \n            arr.map((item) => {\n                delete userObj[item]\n            })\n            let token = jsonwebtoken.sign({ _id: userObj._id }, config.JWT_SECRET, { expiresIn: '1d' }) //\n            ctx.body = {\n                code: 200,\n                data: userObj,\n                token: token,\n                msg:'更新密码成功！'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 401,\n            msg: '图片验证码不正确，请检查！'\n        }\n    }\n}\n\nmodule.exports = { forget, login, reg, reset }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585409595258
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/MailConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/MailConfig.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/MailConfig.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config/MailConfig.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
        "sourceFileName": "MailConfig.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst nodemailer = require('nodemailer');\n\nconst config = require('./index');\n\nconst qs = require('qs'); // async..await is not allowed in global scope, must use a wrapper\n\n\nasync function send(sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount()\n  // create reusable transporter object using the default SMTP transport\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.163.com',\n    port: 465,\n    secure: true,\n    // true for 465, false for other ports\n    auth: {\n      user: 'leedawnm@163.com',\n      // generated ethereal user\n      pass: '93thing51' // generated ethereal password\n\n    }\n  }); // let sendInfo = {\n  //   code: '1234',\n  //   expire: '2019-10-01',\n  //   email: 'imoocbrian@qq.com',\n  //   user: 'Brian',\n  // }\n\n  const baseUrl = config.baseUrl;\n  const route = sendInfo.type === 'email' ? '/confirm' : '/reset';\n  const url = `${baseUrl}/#${route}?` + qs.stringify(sendInfo.data); // send mail with defined transport object\n\n  const info = await transporter.sendMail({\n    from: '\"认证邮件\" <leedawnm@163.com>',\n    // sender address\n    to: sendInfo.email,\n    // list of receivers\n    subject: sendInfo.user !== '' && sendInfo.type !== 'email' ? `你好开发者，${sendInfo.user}！《慕课网前端全栈实践》注册码` : '论坛系统密码确认修改链接',\n    // Subject line\n    text: `您在《慕课网前端全栈实践》课程中注册，您的邀请码是${sendInfo.code},邀请码的过期时间: ${sendInfo.expire}`,\n    // plain text body\n    html: `\n  \n        <div style=\"border: 1px solid #dcdcdc;color: #676767;width: 600px; margin: 0 auto; padding-bottom: 50px;position: relative;\">\n        <div style=\"height: 60px; background: #393d49; line-height: 60px; color: #58a36f; font-size: 18px;padding-left: 10px;\">Imooc社区——欢迎来到官方社区</div>\n        <div style=\"padding: 25px\">\n          <div>您好，${sendInfo.user}童鞋，重置链接有效时间30分钟，请在${sendInfo.expire}之前${sendInfo.code ? '重置您的密码' : '修改您的邮箱为：' + sendInfo.data.username}：</div>\n          <a href=\"${url}\" style=\"padding: 10px 20px; color: #fff; background: #009e94; display: inline-block;margin: 15px 0;\">${sendInfo.code ? '立即重置密码' : '确认设置邮箱'}</a>\n          <div style=\"padding: 5px; background: #f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定。</div>\n        </div>\n        <div style=\"background: #fafafa; color: #b4b4b4;text-align: center; line-height: 45px; height: 45px; position: absolute; left: 0; bottom: 0;width: 100%;\">系统邮件，请勿直接回复</div>\n    </div>\n    ` // html body\n\n  });\n  return `Message sent: %s, ${info.messageId}`; // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n  // Preview only available when sending through an Ethereal account\n  // console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n} // main().catch(console.error)\n\n\nmodule.exports = send;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1haWxDb25maWcuanMiXSwibmFtZXMiOlsibm9kZW1haWxlciIsInJlcXVpcmUiLCJjb25maWciLCJxcyIsInNlbmQiLCJzZW5kSW5mbyIsInRyYW5zcG9ydGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwidXNlciIsInBhc3MiLCJiYXNlVXJsIiwicm91dGUiLCJ0eXBlIiwidXJsIiwic3RyaW5naWZ5IiwiZGF0YSIsImluZm8iLCJzZW5kTWFpbCIsImZyb20iLCJ0byIsImVtYWlsIiwic3ViamVjdCIsInRleHQiLCJjb2RlIiwiZXhwaXJlIiwiaHRtbCIsInVzZXJuYW1lIiwibWVzc2FnZUlkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxVQUFVLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXhCOztBQUNBLE1BQU1DLE1BQU0sR0FBQ0QsT0FBTyxDQUFDLFNBQUQsQ0FBcEI7O0FBQ0EsTUFBTUUsRUFBRSxHQUFDRixPQUFPLENBQUMsSUFBRCxDQUFoQixDLENBRUE7OztBQUNBLGVBQWVHLElBQWYsQ0FBcUJDLFFBQXJCLEVBQStCO0FBQzdCO0FBQ0E7QUFDQTtBQUVBO0FBQ0EsUUFBTUMsV0FBVyxHQUFHTixVQUFVLENBQUNPLGVBQVgsQ0FBMkI7QUFDN0NDLElBQUFBLElBQUksRUFBRSxjQUR1QztBQUU3Q0MsSUFBQUEsSUFBSSxFQUFFLEdBRnVDO0FBRzdDQyxJQUFBQSxNQUFNLEVBQUUsSUFIcUM7QUFHL0I7QUFDZEMsSUFBQUEsSUFBSSxFQUFFO0FBQ0pDLE1BQUFBLElBQUksRUFBRSxrQkFERjtBQUNzQjtBQUMxQkMsTUFBQUEsSUFBSSxFQUFFLFdBRkYsQ0FFYzs7QUFGZDtBQUp1QyxHQUEzQixDQUFwQixDQU42QixDQWdCN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFFBQU1DLE9BQU8sR0FBR1osTUFBTSxDQUFDWSxPQUF2QjtBQUNBLFFBQU1DLEtBQUssR0FBR1YsUUFBUSxDQUFDVyxJQUFULEtBQWtCLE9BQWxCLEdBQTRCLFVBQTVCLEdBQXlDLFFBQXZEO0FBQ0EsUUFBTUMsR0FBRyxHQUFJLEdBQUVILE9BQVEsS0FBSUMsS0FBTSxHQUFyQixHQUEwQlosRUFBRSxDQUFDZSxTQUFILENBQWFiLFFBQVEsQ0FBQ2MsSUFBdEIsQ0FBdEMsQ0F4QjZCLENBMEI3Qjs7QUFDQSxRQUFNQyxJQUFJLEdBQUcsTUFBTWQsV0FBVyxDQUFDZSxRQUFaLENBQXFCO0FBQ3RDQyxJQUFBQSxJQUFJLEVBQUUsMkJBRGdDO0FBQ0g7QUFDbkNDLElBQUFBLEVBQUUsRUFBRWxCLFFBQVEsQ0FBQ21CLEtBRnlCO0FBRWxCO0FBQ3BCQyxJQUFBQSxPQUFPLEVBQ0xwQixRQUFRLENBQUNPLElBQVQsS0FBa0IsRUFBbEIsSUFBd0JQLFFBQVEsQ0FBQ1csSUFBVCxLQUFpQixPQUF6QyxHQUNLLFNBQVFYLFFBQVEsQ0FBQ08sSUFBSyxpQkFEM0IsR0FFSSxjQU5nQztBQU1oQjtBQUN0QmMsSUFBQUEsSUFBSSxFQUFHLDRCQUNMckIsUUFBUSxDQUFDc0IsSUFDUixjQUFhdEIsUUFBUSxDQUFDdUIsTUFBTyxFQVRNO0FBU0g7QUFDbkNDLElBQUFBLElBQUksRUFBRzs7Ozs7b0JBS1N4QixRQUFRLENBQUNPLElBQUsscUJBQzVCUCxRQUFRLENBQUN1QixNQUNSLEtBQUl2QixRQUFRLENBQUNzQixJQUFULEdBQWdCLFFBQWhCLEdBQTJCLGFBQWF0QixRQUFRLENBQUNjLElBQVQsQ0FBY1csUUFBUztxQkFDckRiLEdBQUkseUdBQXdHWixRQUFRLENBQUNzQixJQUFULEdBQWdCLFFBQWhCLEdBQTJCLFFBQVM7Ozs7O0tBbEIzSCxDQXVCcEM7O0FBdkJvQyxHQUFyQixDQUFuQjtBQTBCQSxTQUFRLHFCQUFvQlAsSUFBSSxDQUFDVyxTQUFVLEVBQTNDLENBckQ2QixDQXNEN0I7QUFFQTtBQUNBO0FBQ0E7QUFDRCxDLENBRUQ7OztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBZ0I3QixJQUFoQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBub2RlbWFpbGVyPXJlcXVpcmUoJ25vZGVtYWlsZXInKVxuY29uc3QgY29uZmlnPXJlcXVpcmUoJy4vaW5kZXgnKVxuY29uc3QgcXM9cmVxdWlyZSgncXMnKVxuXG4vLyBhc3luYy4uYXdhaXQgaXMgbm90IGFsbG93ZWQgaW4gZ2xvYmFsIHNjb3BlLCBtdXN0IHVzZSBhIHdyYXBwZXJcbmFzeW5jIGZ1bmN0aW9uIHNlbmQgKHNlbmRJbmZvKSB7XG4gIC8vIEdlbmVyYXRlIHRlc3QgU01UUCBzZXJ2aWNlIGFjY291bnQgZnJvbSBldGhlcmVhbC5lbWFpbFxuICAvLyBPbmx5IG5lZWRlZCBpZiB5b3UgZG9uJ3QgaGF2ZSBhIHJlYWwgbWFpbCBhY2NvdW50IGZvciB0ZXN0aW5nXG4gIC8vIGxldCB0ZXN0QWNjb3VudCA9IGF3YWl0IG5vZGVtYWlsZXIuY3JlYXRlVGVzdEFjY291bnQoKVxuXG4gIC8vIGNyZWF0ZSByZXVzYWJsZSB0cmFuc3BvcnRlciBvYmplY3QgdXNpbmcgdGhlIGRlZmF1bHQgU01UUCB0cmFuc3BvcnRcbiAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgaG9zdDogJ3NtdHAuMTYzLmNvbScsXG4gICAgcG9ydDogNDY1LFxuICAgIHNlY3VyZTogdHJ1ZSwgLy8gdHJ1ZSBmb3IgNDY1LCBmYWxzZSBmb3Igb3RoZXIgcG9ydHNcbiAgICBhdXRoOiB7XG4gICAgICB1c2VyOiAnbGVlZGF3bm1AMTYzLmNvbScsIC8vIGdlbmVyYXRlZCBldGhlcmVhbCB1c2VyXG4gICAgICBwYXNzOiAnOTN0aGluZzUxJyAvLyBnZW5lcmF0ZWQgZXRoZXJlYWwgcGFzc3dvcmRcbiAgICB9XG4gIH0pXG5cbiAgLy8gbGV0IHNlbmRJbmZvID0ge1xuICAvLyAgIGNvZGU6ICcxMjM0JyxcbiAgLy8gICBleHBpcmU6ICcyMDE5LTEwLTAxJyxcbiAgLy8gICBlbWFpbDogJ2ltb29jYnJpYW5AcXEuY29tJyxcbiAgLy8gICB1c2VyOiAnQnJpYW4nLFxuICAvLyB9XG4gIGNvbnN0IGJhc2VVcmwgPSBjb25maWcuYmFzZVVybFxuICBjb25zdCByb3V0ZSA9IHNlbmRJbmZvLnR5cGUgPT09ICdlbWFpbCcgPyAnL2NvbmZpcm0nIDogJy9yZXNldCdcbiAgY29uc3QgdXJsID0gYCR7YmFzZVVybH0vIyR7cm91dGV9P2AgKyBxcy5zdHJpbmdpZnkoc2VuZEluZm8uZGF0YSlcblxuICAvLyBzZW5kIG1haWwgd2l0aCBkZWZpbmVkIHRyYW5zcG9ydCBvYmplY3RcbiAgY29uc3QgaW5mbyA9IGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKHtcbiAgICBmcm9tOiAnXCLorqTor4Hpgq7ku7ZcIiA8bGVlZGF3bm1AMTYzLmNvbT4nLCAvLyBzZW5kZXIgYWRkcmVzc1xuICAgIHRvOiBzZW5kSW5mby5lbWFpbCwgLy8gbGlzdCBvZiByZWNlaXZlcnNcbiAgICBzdWJqZWN0OlxuICAgICAgc2VuZEluZm8udXNlciAhPT0gJycgJiYgc2VuZEluZm8udHlwZSAhPT0nZW1haWwnXG4gICAgICAgID8gYOS9oOWlveW8gOWPkeiAhe+8jCR7c2VuZEluZm8udXNlcn3vvIHjgIrmhZXor77nvZHliY3nq6/lhajmoIjlrp7ot7XjgIvms6jlhoznoIFgXG4gICAgICAgIDogJ+iuuuWdm+ezu+e7n+WvhueggeehruiupOS/ruaUuemTvuaOpScsIC8vIFN1YmplY3QgbGluZVxuICAgIHRleHQ6IGDmgqjlnKjjgIrmhZXor77nvZHliY3nq6/lhajmoIjlrp7ot7XjgIvor77nqIvkuK3ms6jlhozvvIzmgqjnmoTpgoDor7fnoIHmmK8ke1xuICAgICAgc2VuZEluZm8uY29kZVxuICAgICAgfSzpgoDor7fnoIHnmoTov4fmnJ/ml7bpl7Q6ICR7c2VuZEluZm8uZXhwaXJlfWAsIC8vIHBsYWluIHRleHQgYm9keVxuICAgIGh0bWw6IGBcbiAgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJib3JkZXI6IDFweCBzb2xpZCAjZGNkY2RjO2NvbG9yOiAjNjc2NzY3O3dpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmctYm90dG9tOiA1MHB4O3Bvc2l0aW9uOiByZWxhdGl2ZTtcIj5cbiAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogNjBweDsgYmFja2dyb3VuZDogIzM5M2Q0OTsgbGluZS1oZWlnaHQ6IDYwcHg7IGNvbG9yOiAjNThhMzZmOyBmb250LXNpemU6IDE4cHg7cGFkZGluZy1sZWZ0OiAxMHB4O1wiPkltb29j56S+5Yy64oCU4oCU5qyi6L+O5p2l5Yiw5a6Y5pa556S+5Yy6PC9kaXY+XG4gICAgICAgIDxkaXYgc3R5bGU9XCJwYWRkaW5nOiAyNXB4XCI+XG4gICAgICAgICAgPGRpdj7mgqjlpb3vvIwke3NlbmRJbmZvLnVzZXJ956ul6Z6L77yM6YeN572u6ZO+5o6l5pyJ5pWI5pe26Ze0MzDliIbpkp/vvIzor7flnKgke1xuICAgICAgc2VuZEluZm8uZXhwaXJlXG4gICAgICB95LmL5YmNJHtzZW5kSW5mby5jb2RlID8gJ+mHjee9ruaCqOeahOWvhueggScgOiAn5L+u5pS55oKo55qE6YKu566x5Li677yaJyArIHNlbmRJbmZvLmRhdGEudXNlcm5hbWV977yaPC9kaXY+XG4gICAgICAgICAgPGEgaHJlZj1cIiR7dXJsfVwiIHN0eWxlPVwicGFkZGluZzogMTBweCAyMHB4OyBjb2xvcjogI2ZmZjsgYmFja2dyb3VuZDogIzAwOWU5NDsgZGlzcGxheTogaW5saW5lLWJsb2NrO21hcmdpbjogMTVweCAwO1wiPiR7c2VuZEluZm8uY29kZSA/ICfnq4vljbPph43nva7lr4bnoIEnIDogJ+ehruiupOiuvue9rumCrueusSd9PC9hPlxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJwYWRkaW5nOiA1cHg7IGJhY2tncm91bmQ6ICNmMmYyZjI7XCI+5aaC5p6c6K+l6YKu5Lu25LiN5piv55Sx5L2g5pys5Lq65pON5L2c77yM6K+35Yu/6L+b6KGM5r+A5rS777yB5ZCm5YiZ5L2g55qE6YKu566x5bCG5Lya6KKr5LuW5Lq657uR5a6a44CCPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogI2ZhZmFmYTsgY29sb3I6ICNiNGI0YjQ7dGV4dC1hbGlnbjogY2VudGVyOyBsaW5lLWhlaWdodDogNDVweDsgaGVpZ2h0OiA0NXB4OyBwb3NpdGlvbjogYWJzb2x1dGU7IGxlZnQ6IDA7IGJvdHRvbTogMDt3aWR0aDogMTAwJTtcIj7ns7vnu5/pgq7ku7bvvIzor7fli7/nm7TmjqXlm57lpI08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICBgIC8vIGh0bWwgYm9keVxuICB9KVxuXG4gIHJldHVybiBgTWVzc2FnZSBzZW50OiAlcywgJHtpbmZvLm1lc3NhZ2VJZH1gXG4gIC8vIE1lc3NhZ2Ugc2VudDogPGI2NThmOGNhLTYyOTYtY2NmNC04MzA2LTg3ZDU3YTBiNDMyMUBleGFtcGxlLmNvbT5cblxuICAvLyBQcmV2aWV3IG9ubHkgYXZhaWxhYmxlIHdoZW4gc2VuZGluZyB0aHJvdWdoIGFuIEV0aGVyZWFsIGFjY291bnRcbiAgLy8gY29uc29sZS5sb2coJ1ByZXZpZXcgVVJMOiAlcycsIG5vZGVtYWlsZXIuZ2V0VGVzdE1lc3NhZ2VVcmwoaW5mbykpXG4gIC8vIFByZXZpZXcgVVJMOiBodHRwczovL2V0aGVyZWFsLmVtYWlsL21lc3NhZ2UvV2FRS01nS2RkeFFEb291Li4uXG59XG5cbi8vIG1haW4oKS5jYXRjaChjb25zb2xlLmVycm9yKVxuXG5tb2R1bGUuZXhwb3J0cz0gc2VuZFxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "MailConfig.js"
      ],
      "names": [
        "nodemailer",
        "require",
        "config",
        "qs",
        "send",
        "sendInfo",
        "transporter",
        "createTransport",
        "host",
        "port",
        "secure",
        "auth",
        "user",
        "pass",
        "baseUrl",
        "route",
        "type",
        "url",
        "stringify",
        "data",
        "info",
        "sendMail",
        "from",
        "to",
        "email",
        "subject",
        "text",
        "code",
        "expire",
        "html",
        "username",
        "messageId",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,UAAU,GAACC,OAAO,CAAC,YAAD,CAAxB;;AACA,MAAMC,MAAM,GAACD,OAAO,CAAC,SAAD,CAApB;;AACA,MAAME,EAAE,GAACF,OAAO,CAAC,IAAD,CAAhB,C,CAEA;;;AACA,eAAeG,IAAf,CAAqBC,QAArB,EAA+B;AAC7B;AACA;AACA;AAEA;AACA,QAAMC,WAAW,GAAGN,UAAU,CAACO,eAAX,CAA2B;AAC7CC,IAAAA,IAAI,EAAE,cADuC;AAE7CC,IAAAA,IAAI,EAAE,GAFuC;AAG7CC,IAAAA,MAAM,EAAE,IAHqC;AAG/B;AACdC,IAAAA,IAAI,EAAE;AACJC,MAAAA,IAAI,EAAE,kBADF;AACsB;AAC1BC,MAAAA,IAAI,EAAE,WAFF,CAEc;;AAFd;AAJuC,GAA3B,CAApB,CAN6B,CAgB7B;AACA;AACA;AACA;AACA;AACA;;AACA,QAAMC,OAAO,GAAGZ,MAAM,CAACY,OAAvB;AACA,QAAMC,KAAK,GAAGV,QAAQ,CAACW,IAAT,KAAkB,OAAlB,GAA4B,UAA5B,GAAyC,QAAvD;AACA,QAAMC,GAAG,GAAI,GAAEH,OAAQ,KAAIC,KAAM,GAArB,GAA0BZ,EAAE,CAACe,SAAH,CAAab,QAAQ,CAACc,IAAtB,CAAtC,CAxB6B,CA0B7B;;AACA,QAAMC,IAAI,GAAG,MAAMd,WAAW,CAACe,QAAZ,CAAqB;AACtCC,IAAAA,IAAI,EAAE,2BADgC;AACH;AACnCC,IAAAA,EAAE,EAAElB,QAAQ,CAACmB,KAFyB;AAElB;AACpBC,IAAAA,OAAO,EACLpB,QAAQ,CAACO,IAAT,KAAkB,EAAlB,IAAwBP,QAAQ,CAACW,IAAT,KAAiB,OAAzC,GACK,SAAQX,QAAQ,CAACO,IAAK,iBAD3B,GAEI,cANgC;AAMhB;AACtBc,IAAAA,IAAI,EAAG,4BACLrB,QAAQ,CAACsB,IACR,cAAatB,QAAQ,CAACuB,MAAO,EATM;AASH;AACnCC,IAAAA,IAAI,EAAG;;;;;oBAKSxB,QAAQ,CAACO,IAAK,qBAC5BP,QAAQ,CAACuB,MACR,KAAIvB,QAAQ,CAACsB,IAAT,GAAgB,QAAhB,GAA2B,aAAatB,QAAQ,CAACc,IAAT,CAAcW,QAAS;qBACrDb,GAAI,yGAAwGZ,QAAQ,CAACsB,IAAT,GAAgB,QAAhB,GAA2B,QAAS;;;;;KAlB3H,CAuBpC;;AAvBoC,GAArB,CAAnB;AA0BA,SAAQ,qBAAoBP,IAAI,CAACW,SAAU,EAA3C,CArD6B,CAsD7B;AAEA;AACA;AACA;AACD,C,CAED;;;AAEAC,MAAM,CAACC,OAAP,GAAgB7B,IAAhB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/config",
      "sourcesContent": [
        "const nodemailer=require('nodemailer')\nconst config=require('./index')\nconst qs=require('qs')\n\n// async..await is not allowed in global scope, must use a wrapper\nasync function send (sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount()\n\n  // create reusable transporter object using the default SMTP transport\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.163.com',\n    port: 465,\n    secure: true, // true for 465, false for other ports\n    auth: {\n      user: 'leedawnm@163.com', // generated ethereal user\n      pass: '93thing51' // generated ethereal password\n    }\n  })\n\n  // let sendInfo = {\n  //   code: '1234',\n  //   expire: '2019-10-01',\n  //   email: 'imoocbrian@qq.com',\n  //   user: 'Brian',\n  // }\n  const baseUrl = config.baseUrl\n  const route = sendInfo.type === 'email' ? '/confirm' : '/reset'\n  const url = `${baseUrl}/#${route}?` + qs.stringify(sendInfo.data)\n\n  // send mail with defined transport object\n  const info = await transporter.sendMail({\n    from: '\"认证邮件\" <leedawnm@163.com>', // sender address\n    to: sendInfo.email, // list of receivers\n    subject:\n      sendInfo.user !== '' && sendInfo.type !=='email'\n        ? `你好开发者，${sendInfo.user}！《慕课网前端全栈实践》注册码`\n        : '论坛系统密码确认修改链接', // Subject line\n    text: `您在《慕课网前端全栈实践》课程中注册，您的邀请码是${\n      sendInfo.code\n      },邀请码的过期时间: ${sendInfo.expire}`, // plain text body\n    html: `\n  \n        <div style=\"border: 1px solid #dcdcdc;color: #676767;width: 600px; margin: 0 auto; padding-bottom: 50px;position: relative;\">\n        <div style=\"height: 60px; background: #393d49; line-height: 60px; color: #58a36f; font-size: 18px;padding-left: 10px;\">Imooc社区——欢迎来到官方社区</div>\n        <div style=\"padding: 25px\">\n          <div>您好，${sendInfo.user}童鞋，重置链接有效时间30分钟，请在${\n      sendInfo.expire\n      }之前${sendInfo.code ? '重置您的密码' : '修改您的邮箱为：' + sendInfo.data.username}：</div>\n          <a href=\"${url}\" style=\"padding: 10px 20px; color: #fff; background: #009e94; display: inline-block;margin: 15px 0;\">${sendInfo.code ? '立即重置密码' : '确认设置邮箱'}</a>\n          <div style=\"padding: 5px; background: #f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定。</div>\n        </div>\n        <div style=\"background: #fafafa; color: #b4b4b4;text-align: center; line-height: 45px; height: 45px; position: absolute; left: 0; bottom: 0;width: 100%;\">系统邮件，请勿直接回复</div>\n    </div>\n    ` // html body\n  })\n\n  return `Message sent: %s, ${info.messageId}`\n  // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n\n  // Preview only available when sending through an Ethereal account\n  // console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n}\n\n// main().catch(console.error)\n\nmodule.exports= send\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1585366695740
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/ErrorHandle.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/ErrorHandle.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/ErrorHandle.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common/ErrorHandle.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
        "sourceFileName": "ErrorHandle.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nmodule.exports = (ctx, next) => {\n  return next().catch(err => {\n    if (401 == err.status) {\n      ctx.status = 401;\n      ctx.body = {\n        code: 401,\n        msg: 'Protected resource,use Authorization header to get access\\n'\n      };\n    } else {\n      ctx.status = err.status || 500;\n      ctx.body = Object.assign({\n        code: 500,\n        msg: err.message\n      }, process.env.NODE_ENV === 'development' ? {\n        stack: err.statck\n      } : {});\n    }\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkVycm9ySGFuZGxlLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJjdHgiLCJuZXh0IiwiY2F0Y2giLCJlcnIiLCJzdGF0dXMiLCJib2R5IiwiY29kZSIsIm1zZyIsIk9iamVjdCIsImFzc2lnbiIsIm1lc3NhZ2UiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJzdGFjayIsInN0YXRjayJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsTUFBTSxDQUFDQyxPQUFQLEdBQWdCLENBQUNDLEdBQUQsRUFBS0MsSUFBTCxLQUFjO0FBQzFCLFNBQU9BLElBQUksR0FBR0MsS0FBUCxDQUFjQyxHQUFELElBQU87QUFDdkIsUUFBRyxPQUFLQSxHQUFHLENBQUNDLE1BQVosRUFBb0I7QUFDaEJKLE1BQUFBLEdBQUcsQ0FBQ0ksTUFBSixHQUFXLEdBQVg7QUFDQUosTUFBQUEsR0FBRyxDQUFDSyxJQUFKLEdBQVM7QUFDTEMsUUFBQUEsSUFBSSxFQUFDLEdBREE7QUFFTEMsUUFBQUEsR0FBRyxFQUFDO0FBRkMsT0FBVDtBQUlILEtBTkQsTUFNTztBQUNIUCxNQUFBQSxHQUFHLENBQUNJLE1BQUosR0FBYUQsR0FBRyxDQUFDQyxNQUFKLElBQWMsR0FBM0I7QUFDQUosTUFBQUEsR0FBRyxDQUFDSyxJQUFKLEdBQVdHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjO0FBQ3JCSCxRQUFBQSxJQUFJLEVBQUUsR0FEZTtBQUVyQkMsUUFBQUEsR0FBRyxFQUFFSixHQUFHLENBQUNPO0FBRlksT0FBZCxFQUdUQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsUUFBWixLQUF1QixhQUF2QixHQUFxQztBQUFDQyxRQUFBQSxLQUFLLEVBQUNYLEdBQUcsQ0FBQ1k7QUFBWCxPQUFyQyxHQUF3RCxFQUgvQyxDQUFYO0FBSUg7QUFDSixHQWRNLENBQVA7QUFlSCxDQWhCRCIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9jb21tb24iLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cz0gKGN0eCxuZXh0KSA9PiB7XG4gICAgcmV0dXJuIG5leHQoKS5jYXRjaCgoZXJyKT0+e1xuICAgICAgICBpZig0MDE9PWVyci5zdGF0dXMpIHtcbiAgICAgICAgICAgIGN0eC5zdGF0dXM9NDAxO1xuICAgICAgICAgICAgY3R4LmJvZHk9e1xuICAgICAgICAgICAgICAgIGNvZGU6NDAxLFxuICAgICAgICAgICAgICAgIG1zZzonUHJvdGVjdGVkIHJlc291cmNlLHVzZSBBdXRob3JpemF0aW9uIGhlYWRlciB0byBnZXQgYWNjZXNzXFxuJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgNTAwXG4gICAgICAgICAgICBjdHguYm9keSA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgICAgICBtc2c6IGVyci5tZXNzYWdlXG4gICAgICAgICAgICB9LHByb2Nlc3MuZW52Lk5PREVfRU5WPT09J2RldmVsb3BtZW50Jz97c3RhY2s6ZXJyLnN0YXRja306e30pXG4gICAgICAgIH1cbiAgICB9KTtcbn0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "ErrorHandle.js"
      ],
      "names": [
        "module",
        "exports",
        "ctx",
        "next",
        "catch",
        "err",
        "status",
        "body",
        "code",
        "msg",
        "Object",
        "assign",
        "message",
        "process",
        "env",
        "NODE_ENV",
        "stack",
        "statck"
      ],
      "mappings": ";;AAAAA,MAAM,CAACC,OAAP,GAAgB,CAACC,GAAD,EAAKC,IAAL,KAAc;AAC1B,SAAOA,IAAI,GAAGC,KAAP,CAAcC,GAAD,IAAO;AACvB,QAAG,OAAKA,GAAG,CAACC,MAAZ,EAAoB;AAChBJ,MAAAA,GAAG,CAACI,MAAJ,GAAW,GAAX;AACAJ,MAAAA,GAAG,CAACK,IAAJ,GAAS;AACLC,QAAAA,IAAI,EAAC,GADA;AAELC,QAAAA,GAAG,EAAC;AAFC,OAAT;AAIH,KAND,MAMO;AACHP,MAAAA,GAAG,CAACI,MAAJ,GAAaD,GAAG,CAACC,MAAJ,IAAc,GAA3B;AACAJ,MAAAA,GAAG,CAACK,IAAJ,GAAWG,MAAM,CAACC,MAAP,CAAc;AACrBH,QAAAA,IAAI,EAAE,GADe;AAErBC,QAAAA,GAAG,EAAEJ,GAAG,CAACO;AAFY,OAAd,EAGTC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAuB,aAAvB,GAAqC;AAACC,QAAAA,KAAK,EAACX,GAAG,CAACY;AAAX,OAArC,GAAwD,EAH/C,CAAX;AAIH;AACJ,GAdM,CAAP;AAeH,CAhBD",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/common",
      "sourcesContent": [
        "module.exports= (ctx,next) => {\n    return next().catch((err)=>{\n        if(401==err.status) {\n            ctx.status=401;\n            ctx.body={\n                code:401,\n                msg:'Protected resource,use Authorization header to get access\\n'\n            }\n        } else {\n            ctx.status = err.status || 500\n            ctx.body = Object.assign({\n                code: 500,\n                msg: err.message\n            },process.env.NODE_ENV==='development'?{stack:err.statck}:{})\n        }\n    });\n}"
      ]
    },
    "sourceType": "script",
    "mtime": 1581480640837
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/contentRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/contentRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/contentRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/contentRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "contentRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst contentController = require('../../api/ContentController');\n\nconst router = new Router();\nrouter.prefix('/content');\nrouter.post('/upload', contentController.uploadImg);\nrouter.post('/add', contentController.addPost);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRlbnRSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsImNvbnRlbnRDb250cm9sbGVyIiwicm91dGVyIiwicHJlZml4IiwicG9zdCIsInVwbG9hZEltZyIsImFkZFBvc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBQ0MsT0FBTyxDQUFDLFlBQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsaUJBQWlCLEdBQUNELE9BQU8sQ0FBQyw2QkFBRCxDQUEvQjs7QUFFQSxNQUFNRSxNQUFNLEdBQUMsSUFBSUgsTUFBSixFQUFiO0FBQ0FHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFVBQWQ7QUFFQUQsTUFBTSxDQUFDRSxJQUFQLENBQVksU0FBWixFQUFzQkgsaUJBQWlCLENBQUNJLFNBQXhDO0FBRUFILE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLE1BQVosRUFBbUJILGlCQUFpQixDQUFDSyxPQUFyQztBQUNBQyxNQUFNLENBQUNDLE9BQVAsR0FBZU4sTUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlcj1yZXF1aXJlKCdrb2Etcm91dGVyJylcbmNvbnN0IGNvbnRlbnRDb250cm9sbGVyPXJlcXVpcmUoJy4uLy4uL2FwaS9Db250ZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcbnJvdXRlci5wcmVmaXgoJy9jb250ZW50Jylcblxucm91dGVyLnBvc3QoJy91cGxvYWQnLGNvbnRlbnRDb250cm9sbGVyLnVwbG9hZEltZylcblxucm91dGVyLnBvc3QoJy9hZGQnLGNvbnRlbnRDb250cm9sbGVyLmFkZFBvc3QpXG5tb2R1bGUuZXhwb3J0cz1yb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "contentRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "contentController",
        "router",
        "prefix",
        "post",
        "uploadImg",
        "addPost",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,iBAAiB,GAACD,OAAO,CAAC,6BAAD,CAA/B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AACAG,MAAM,CAACC,MAAP,CAAc,UAAd;AAEAD,MAAM,CAACE,IAAP,CAAY,SAAZ,EAAsBH,iBAAiB,CAACI,SAAxC;AAEAH,MAAM,CAACE,IAAP,CAAY,MAAZ,EAAmBH,iBAAiB,CAACK,OAArC;AACAC,MAAM,CAACC,OAAP,GAAeN,MAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst contentController=require('../../api/ContentController')\n\nconst router=new Router()\nrouter.prefix('/content')\n\nrouter.post('/upload',contentController.uploadImg)\n\nrouter.post('/add',contentController.addPost)\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1584971949775
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/contentRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/contentRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/contentRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/contentRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "contentRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst contentController = require('../../api/ContentController');\n\nconst router = new Router();\nrouter.prefix('/content');\nrouter.post('/upload', contentController.uploadImg);\nrouter.post('/add', contentController.addPost);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRlbnRSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsImNvbnRlbnRDb250cm9sbGVyIiwicm91dGVyIiwicHJlZml4IiwicG9zdCIsInVwbG9hZEltZyIsImFkZFBvc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBQ0MsT0FBTyxDQUFDLFlBQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsaUJBQWlCLEdBQUNELE9BQU8sQ0FBQyw2QkFBRCxDQUEvQjs7QUFFQSxNQUFNRSxNQUFNLEdBQUMsSUFBSUgsTUFBSixFQUFiO0FBQ0FHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFVBQWQ7QUFFQUQsTUFBTSxDQUFDRSxJQUFQLENBQVksU0FBWixFQUFzQkgsaUJBQWlCLENBQUNJLFNBQXhDO0FBRUFILE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLE1BQVosRUFBbUJILGlCQUFpQixDQUFDSyxPQUFyQztBQUNBQyxNQUFNLENBQUNDLE9BQVAsR0FBZU4sTUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlcj1yZXF1aXJlKCdrb2Etcm91dGVyJylcbmNvbnN0IGNvbnRlbnRDb250cm9sbGVyPXJlcXVpcmUoJy4uLy4uL2FwaS9Db250ZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcbnJvdXRlci5wcmVmaXgoJy9jb250ZW50Jylcblxucm91dGVyLnBvc3QoJy91cGxvYWQnLGNvbnRlbnRDb250cm9sbGVyLnVwbG9hZEltZylcblxucm91dGVyLnBvc3QoJy9hZGQnLGNvbnRlbnRDb250cm9sbGVyLmFkZFBvc3QpXG5tb2R1bGUuZXhwb3J0cz1yb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "contentRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "contentController",
        "router",
        "prefix",
        "post",
        "uploadImg",
        "addPost",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,iBAAiB,GAACD,OAAO,CAAC,6BAAD,CAA/B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AACAG,MAAM,CAACC,MAAP,CAAc,UAAd;AAEAD,MAAM,CAACE,IAAP,CAAY,SAAZ,EAAsBH,iBAAiB,CAACI,SAAxC;AAEAH,MAAM,CAACE,IAAP,CAAY,MAAZ,EAAmBH,iBAAiB,CAACK,OAArC;AACAC,MAAM,CAACC,OAAP,GAAeN,MAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst contentController=require('../../api/ContentController')\n\nconst router=new Router()\nrouter.prefix('/content')\n\nrouter.post('/upload',contentController.uploadImg)\n\nrouter.post('/add',contentController.addPost)\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1584971949775
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/UserCollect.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/UserCollect.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/UserCollect.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/UserCollect.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "UserCollect.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nconst moogoose = require('../config/DBHelper');\n\nconst Schema = moogoose.Schema;\nconst UserCollectSchema = new Schema({\n  uid: {\n    type: String\n  },\n  tid: {\n    type: String\n  },\n  title: {\n    type: String\n  },\n  created: {\n    type: Date\n  }\n});\nUserCollectSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nUserCollectSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nUserCollectSchema.statics = {\n  getListByUid: function (id, page, limit) {\n    return this.find({\n      uid: id\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  countByUid: function (id) {\n    return this.find({\n      uid: id\n    }).countDocuments();\n  }\n};\nconst UserCollect = moogoose.model('user_collect', UserCollectSchema);\nvar _default = UserCollect;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb2xsZWN0LmpzIl0sIm5hbWVzIjpbIm1vb2dvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIlVzZXJDb2xsZWN0U2NoZW1hIiwidWlkIiwidHlwZSIsIlN0cmluZyIsInRpZCIsInRpdGxlIiwiY3JlYXRlZCIsIkRhdGUiLCJwcmUiLCJuZXh0IiwicG9zdCIsImVycm9yIiwiZG9jIiwibmFtZSIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJnZXRMaXN0QnlVaWQiLCJpZCIsInBhZ2UiLCJsaW1pdCIsImZpbmQiLCJza2lwIiwic29ydCIsImNvdW50QnlVaWQiLCJjb3VudERvY3VtZW50cyIsIlVzZXJDb2xsZWN0IiwibW9kZWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUF4Qjs7QUFFQSxNQUFNQyxNQUFNLEdBQUdGLFFBQVEsQ0FBQ0UsTUFBeEI7QUFFQSxNQUFNQyxpQkFBaUIsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDakNFLEVBQUFBLEdBQUcsRUFBRTtBQUFFQyxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FENEI7QUFFakNDLEVBQUFBLEdBQUcsRUFBRTtBQUFFRixJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FGNEI7QUFHakNFLEVBQUFBLEtBQUssRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FIMEI7QUFJakNHLEVBQUFBLE9BQU8sRUFBRTtBQUFFSixJQUFBQSxJQUFJLEVBQUVLO0FBQVI7QUFKd0IsQ0FBWCxDQUExQjtBQU9BUCxpQkFBaUIsQ0FBQ1EsR0FBbEIsQ0FBc0IsTUFBdEIsRUFBOEIsVUFBVUMsSUFBVixFQUFnQjtBQUMxQyxPQUFLSCxPQUFMLEdBQWUsSUFBSUMsSUFBSixFQUFmO0FBQ0FFLEVBQUFBLElBQUk7QUFDUCxDQUhEO0FBS0FULGlCQUFpQixDQUFDVSxJQUFsQixDQUF1QixNQUF2QixFQUErQixVQUFVQyxLQUFWLEVBQWlCQyxHQUFqQixFQUFzQkgsSUFBdEIsRUFBNEI7QUFDdkQsTUFBSUUsS0FBSyxDQUFDRSxJQUFOLEtBQWUsWUFBZixJQUErQkYsS0FBSyxDQUFDRyxJQUFOLEtBQWUsS0FBbEQsRUFBeUQ7QUFDckRMLElBQUFBLElBQUksQ0FBQyxJQUFJTSxLQUFKLENBQVUsaUNBQVYsQ0FBRCxDQUFKO0FBQ0gsR0FGRCxNQUVPO0FBQ0hOLElBQUFBLElBQUksQ0FBQ0UsS0FBRCxDQUFKO0FBQ0g7QUFDSixDQU5EO0FBUUFYLGlCQUFpQixDQUFDZ0IsT0FBbEIsR0FBNEI7QUFDeEJDLEVBQUFBLFlBQVksRUFBRSxVQUFVQyxFQUFWLEVBQWNDLElBQWQsRUFBb0JDLEtBQXBCLEVBQTJCO0FBQ3JDLFdBQU8sS0FBS0MsSUFBTCxDQUFVO0FBQUVwQixNQUFBQSxHQUFHLEVBQUVpQjtBQUFQLEtBQVYsRUFDRkksSUFERSxDQUNHRixLQUFLLEdBQUdELElBRFgsRUFFRkMsS0FGRSxDQUVJQSxLQUZKLEVBR0ZHLElBSEUsQ0FHRztBQUFFakIsTUFBQUEsT0FBTyxFQUFFLENBQUM7QUFBWixLQUhILENBQVA7QUFJSCxHQU51QjtBQU94QmtCLEVBQUFBLFVBQVUsRUFBRSxVQUFVTixFQUFWLEVBQWM7QUFDdEIsV0FBTyxLQUFLRyxJQUFMLENBQVU7QUFBRXBCLE1BQUFBLEdBQUcsRUFBRWlCO0FBQVAsS0FBVixFQUF1Qk8sY0FBdkIsRUFBUDtBQUNIO0FBVHVCLENBQTVCO0FBV0EsTUFBTUMsV0FBVyxHQUFHN0IsUUFBUSxDQUFDOEIsS0FBVCxDQUFlLGNBQWYsRUFBK0IzQixpQkFBL0IsQ0FBcEI7ZUFFZTBCLFciLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb29nb29zZSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9EQkhlbHBlcicpXG5cbmNvbnN0IFNjaGVtYSA9IG1vb2dvb3NlLlNjaGVtYVxuXG5jb25zdCBVc2VyQ29sbGVjdFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHVpZDogeyB0eXBlOiBTdHJpbmcgfSxcbiAgICB0aWQ6IHsgdHlwZTogU3RyaW5nIH0sXG4gICAgdGl0bGU6IHsgdHlwZTogU3RyaW5nIH0sXG4gICAgY3JlYXRlZDogeyB0eXBlOiBEYXRlIH0sXG59KVxuXG5Vc2VyQ29sbGVjdFNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICAgIHRoaXMuY3JlYXRlZCA9IG5ldyBEYXRlKClcbiAgICBuZXh0KClcbn0pXG5cblVzZXJDb2xsZWN0U2NoZW1hLnBvc3QoJ3NhdmUnLCBmdW5jdGlvbiAoZXJyb3IsIGRvYywgbmV4dCkge1xuICAgIGlmIChlcnJvci5uYW1lID09PSAnTW9uZ29FcnJvcicgJiYgZXJyb3IuY29kZSA9PT0gMTEwMDApIHtcbiAgICAgICAgbmV4dChuZXcgRXJyb3IoJ1RoZXJlIHdhcyBhIGR1cGxpY2F0ZSBrZXkgZXJyb3InKSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0KGVycm9yKVxuICAgIH1cbn0pXG5cblVzZXJDb2xsZWN0U2NoZW1hLnN0YXRpY3MgPSB7XG4gICAgZ2V0TGlzdEJ5VWlkOiBmdW5jdGlvbiAoaWQsIHBhZ2UsIGxpbWl0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pXG4gICAgICAgICAgICAuc2tpcChsaW1pdCAqIHBhZ2UpXG4gICAgICAgICAgICAubGltaXQobGltaXQpXG4gICAgICAgICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gICAgfSxcbiAgICBjb3VudEJ5VWlkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZCh7IHVpZDogaWQgfSkuY291bnREb2N1bWVudHMoKVxuICAgIH1cbn1cbmNvbnN0IFVzZXJDb2xsZWN0ID0gbW9vZ29vc2UubW9kZWwoJ3VzZXJfY29sbGVjdCcsIFVzZXJDb2xsZWN0U2NoZW1hKVxuXG5leHBvcnQgZGVmYXVsdCBVc2VyQ29sbGVjdCJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "UserCollect.js"
      ],
      "names": [
        "moogoose",
        "require",
        "Schema",
        "UserCollectSchema",
        "uid",
        "type",
        "String",
        "tid",
        "title",
        "created",
        "Date",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "getListByUid",
        "id",
        "page",
        "limit",
        "find",
        "skip",
        "sort",
        "countByUid",
        "countDocuments",
        "UserCollect",
        "model"
      ],
      "mappings": ";;;;;;;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AAEA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AAEA,MAAMC,iBAAiB,GAAG,IAAID,MAAJ,CAAW;AACjCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC;AAAR,GAD4B;AAEjCC,EAAAA,GAAG,EAAE;AAAEF,IAAAA,IAAI,EAAEC;AAAR,GAF4B;AAGjCE,EAAAA,KAAK,EAAE;AAAEH,IAAAA,IAAI,EAAEC;AAAR,GAH0B;AAIjCG,EAAAA,OAAO,EAAE;AAAEJ,IAAAA,IAAI,EAAEK;AAAR;AAJwB,CAAX,CAA1B;AAOAP,iBAAiB,CAACQ,GAAlB,CAAsB,MAAtB,EAA8B,UAAUC,IAAV,EAAgB;AAC1C,OAAKH,OAAL,GAAe,IAAIC,IAAJ,EAAf;AACAE,EAAAA,IAAI;AACP,CAHD;AAKAT,iBAAiB,CAACU,IAAlB,CAAuB,MAAvB,EAA+B,UAAUC,KAAV,EAAiBC,GAAjB,EAAsBH,IAAtB,EAA4B;AACvD,MAAIE,KAAK,CAACE,IAAN,KAAe,YAAf,IAA+BF,KAAK,CAACG,IAAN,KAAe,KAAlD,EAAyD;AACrDL,IAAAA,IAAI,CAAC,IAAIM,KAAJ,CAAU,iCAAV,CAAD,CAAJ;AACH,GAFD,MAEO;AACHN,IAAAA,IAAI,CAACE,KAAD,CAAJ;AACH;AACJ,CAND;AAQAX,iBAAiB,CAACgB,OAAlB,GAA4B;AACxBC,EAAAA,YAAY,EAAE,UAAUC,EAAV,EAAcC,IAAd,EAAoBC,KAApB,EAA2B;AACrC,WAAO,KAAKC,IAAL,CAAU;AAAEpB,MAAAA,GAAG,EAAEiB;AAAP,KAAV,EACFI,IADE,CACGF,KAAK,GAAGD,IADX,EAEFC,KAFE,CAEIA,KAFJ,EAGFG,IAHE,CAGG;AAAEjB,MAAAA,OAAO,EAAE,CAAC;AAAZ,KAHH,CAAP;AAIH,GANuB;AAOxBkB,EAAAA,UAAU,EAAE,UAAUN,EAAV,EAAc;AACtB,WAAO,KAAKG,IAAL,CAAU;AAAEpB,MAAAA,GAAG,EAAEiB;AAAP,KAAV,EAAuBO,cAAvB,EAAP;AACH;AATuB,CAA5B;AAWA,MAAMC,WAAW,GAAG7B,QAAQ,CAAC8B,KAAT,CAAe,cAAf,EAA+B3B,iBAA/B,CAApB;eAEe0B,W",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "const moogoose = require('../config/DBHelper')\n\nconst Schema = moogoose.Schema\n\nconst UserCollectSchema = new Schema({\n    uid: { type: String },\n    tid: { type: String },\n    title: { type: String },\n    created: { type: Date },\n})\n\nUserCollectSchema.pre('save', function (next) {\n    this.created = new Date()\n    next()\n})\n\nUserCollectSchema.post('save', function (error, doc, next) {\n    if (error.name === 'MongoError' && error.code === 11000) {\n        next(new Error('There was a duplicate key error'))\n    } else {\n        next(error)\n    }\n})\n\nUserCollectSchema.statics = {\n    getListByUid: function (id, page, limit) {\n        return this.find({ uid: id })\n            .skip(limit * page)\n            .limit(limit)\n            .sort({ created: -1 })\n    },\n    countByUid: function (id) {\n        return this.find({ uid: id }).countDocuments()\n    }\n}\nconst UserCollect = moogoose.model('user_collect', UserCollectSchema)\n\nexport default UserCollect"
      ]
    },
    "sourceType": "script",
    "mtime": 1585036026949
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/UserCollect.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/UserCollect.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/UserCollect.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/UserCollect.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "UserCollect.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nconst moogoose = require('../config/DBHelper');\n\nconst Schema = moogoose.Schema;\nconst UserCollectSchema = new Schema({\n  uid: {\n    type: String\n  },\n  tid: {\n    type: String\n  },\n  title: {\n    type: String\n  },\n  created: {\n    type: Date\n  }\n});\nUserCollectSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nUserCollectSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nUserCollectSchema.statics = {\n  getListByUid: function (id, page, limit) {\n    return this.find({\n      uid: id\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  countByUid: function (id) {\n    return this.find({\n      uid: id\n    }).countDocuments();\n  }\n};\nconst UserCollect = moogoose.model('user_collect', UserCollectSchema);\nvar _default = UserCollect;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb2xsZWN0LmpzIl0sIm5hbWVzIjpbIm1vb2dvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIlVzZXJDb2xsZWN0U2NoZW1hIiwidWlkIiwidHlwZSIsIlN0cmluZyIsInRpZCIsInRpdGxlIiwiY3JlYXRlZCIsIkRhdGUiLCJwcmUiLCJuZXh0IiwicG9zdCIsImVycm9yIiwiZG9jIiwibmFtZSIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJnZXRMaXN0QnlVaWQiLCJpZCIsInBhZ2UiLCJsaW1pdCIsImZpbmQiLCJza2lwIiwic29ydCIsImNvdW50QnlVaWQiLCJjb3VudERvY3VtZW50cyIsIlVzZXJDb2xsZWN0IiwibW9kZWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUF4Qjs7QUFFQSxNQUFNQyxNQUFNLEdBQUdGLFFBQVEsQ0FBQ0UsTUFBeEI7QUFFQSxNQUFNQyxpQkFBaUIsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDakNFLEVBQUFBLEdBQUcsRUFBRTtBQUFFQyxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FENEI7QUFFakNDLEVBQUFBLEdBQUcsRUFBRTtBQUFFRixJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FGNEI7QUFHakNFLEVBQUFBLEtBQUssRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FIMEI7QUFJakNHLEVBQUFBLE9BQU8sRUFBRTtBQUFFSixJQUFBQSxJQUFJLEVBQUVLO0FBQVI7QUFKd0IsQ0FBWCxDQUExQjtBQU9BUCxpQkFBaUIsQ0FBQ1EsR0FBbEIsQ0FBc0IsTUFBdEIsRUFBOEIsVUFBVUMsSUFBVixFQUFnQjtBQUMxQyxPQUFLSCxPQUFMLEdBQWUsSUFBSUMsSUFBSixFQUFmO0FBQ0FFLEVBQUFBLElBQUk7QUFDUCxDQUhEO0FBS0FULGlCQUFpQixDQUFDVSxJQUFsQixDQUF1QixNQUF2QixFQUErQixVQUFVQyxLQUFWLEVBQWlCQyxHQUFqQixFQUFzQkgsSUFBdEIsRUFBNEI7QUFDdkQsTUFBSUUsS0FBSyxDQUFDRSxJQUFOLEtBQWUsWUFBZixJQUErQkYsS0FBSyxDQUFDRyxJQUFOLEtBQWUsS0FBbEQsRUFBeUQ7QUFDckRMLElBQUFBLElBQUksQ0FBQyxJQUFJTSxLQUFKLENBQVUsaUNBQVYsQ0FBRCxDQUFKO0FBQ0gsR0FGRCxNQUVPO0FBQ0hOLElBQUFBLElBQUksQ0FBQ0UsS0FBRCxDQUFKO0FBQ0g7QUFDSixDQU5EO0FBUUFYLGlCQUFpQixDQUFDZ0IsT0FBbEIsR0FBNEI7QUFDeEJDLEVBQUFBLFlBQVksRUFBRSxVQUFVQyxFQUFWLEVBQWNDLElBQWQsRUFBb0JDLEtBQXBCLEVBQTJCO0FBQ3JDLFdBQU8sS0FBS0MsSUFBTCxDQUFVO0FBQUVwQixNQUFBQSxHQUFHLEVBQUVpQjtBQUFQLEtBQVYsRUFDRkksSUFERSxDQUNHRixLQUFLLEdBQUdELElBRFgsRUFFRkMsS0FGRSxDQUVJQSxLQUZKLEVBR0ZHLElBSEUsQ0FHRztBQUFFakIsTUFBQUEsT0FBTyxFQUFFLENBQUM7QUFBWixLQUhILENBQVA7QUFJSCxHQU51QjtBQU94QmtCLEVBQUFBLFVBQVUsRUFBRSxVQUFVTixFQUFWLEVBQWM7QUFDdEIsV0FBTyxLQUFLRyxJQUFMLENBQVU7QUFBRXBCLE1BQUFBLEdBQUcsRUFBRWlCO0FBQVAsS0FBVixFQUF1Qk8sY0FBdkIsRUFBUDtBQUNIO0FBVHVCLENBQTVCO0FBV0EsTUFBTUMsV0FBVyxHQUFHN0IsUUFBUSxDQUFDOEIsS0FBVCxDQUFlLGNBQWYsRUFBK0IzQixpQkFBL0IsQ0FBcEI7ZUFFZTBCLFciLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9sZWFybmluZ1dvcmxkL2xlYXJuLWZyb250LWVuZC9rb2EtZGVtby9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb29nb29zZSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9EQkhlbHBlcicpXG5cbmNvbnN0IFNjaGVtYSA9IG1vb2dvb3NlLlNjaGVtYVxuXG5jb25zdCBVc2VyQ29sbGVjdFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHVpZDogeyB0eXBlOiBTdHJpbmcgfSxcbiAgICB0aWQ6IHsgdHlwZTogU3RyaW5nIH0sXG4gICAgdGl0bGU6IHsgdHlwZTogU3RyaW5nIH0sXG4gICAgY3JlYXRlZDogeyB0eXBlOiBEYXRlIH0sXG59KVxuXG5Vc2VyQ29sbGVjdFNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICAgIHRoaXMuY3JlYXRlZCA9IG5ldyBEYXRlKClcbiAgICBuZXh0KClcbn0pXG5cblVzZXJDb2xsZWN0U2NoZW1hLnBvc3QoJ3NhdmUnLCBmdW5jdGlvbiAoZXJyb3IsIGRvYywgbmV4dCkge1xuICAgIGlmIChlcnJvci5uYW1lID09PSAnTW9uZ29FcnJvcicgJiYgZXJyb3IuY29kZSA9PT0gMTEwMDApIHtcbiAgICAgICAgbmV4dChuZXcgRXJyb3IoJ1RoZXJlIHdhcyBhIGR1cGxpY2F0ZSBrZXkgZXJyb3InKSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0KGVycm9yKVxuICAgIH1cbn0pXG5cblVzZXJDb2xsZWN0U2NoZW1hLnN0YXRpY3MgPSB7XG4gICAgZ2V0TGlzdEJ5VWlkOiBmdW5jdGlvbiAoaWQsIHBhZ2UsIGxpbWl0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pXG4gICAgICAgICAgICAuc2tpcChsaW1pdCAqIHBhZ2UpXG4gICAgICAgICAgICAubGltaXQobGltaXQpXG4gICAgICAgICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gICAgfSxcbiAgICBjb3VudEJ5VWlkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZCh7IHVpZDogaWQgfSkuY291bnREb2N1bWVudHMoKVxuICAgIH1cbn1cbmNvbnN0IFVzZXJDb2xsZWN0ID0gbW9vZ29vc2UubW9kZWwoJ3VzZXJfY29sbGVjdCcsIFVzZXJDb2xsZWN0U2NoZW1hKVxuXG5leHBvcnQgZGVmYXVsdCBVc2VyQ29sbGVjdCJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "UserCollect.js"
      ],
      "names": [
        "moogoose",
        "require",
        "Schema",
        "UserCollectSchema",
        "uid",
        "type",
        "String",
        "tid",
        "title",
        "created",
        "Date",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "getListByUid",
        "id",
        "page",
        "limit",
        "find",
        "skip",
        "sort",
        "countByUid",
        "countDocuments",
        "UserCollect",
        "model"
      ],
      "mappings": ";;;;;;;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AAEA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AAEA,MAAMC,iBAAiB,GAAG,IAAID,MAAJ,CAAW;AACjCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC;AAAR,GAD4B;AAEjCC,EAAAA,GAAG,EAAE;AAAEF,IAAAA,IAAI,EAAEC;AAAR,GAF4B;AAGjCE,EAAAA,KAAK,EAAE;AAAEH,IAAAA,IAAI,EAAEC;AAAR,GAH0B;AAIjCG,EAAAA,OAAO,EAAE;AAAEJ,IAAAA,IAAI,EAAEK;AAAR;AAJwB,CAAX,CAA1B;AAOAP,iBAAiB,CAACQ,GAAlB,CAAsB,MAAtB,EAA8B,UAAUC,IAAV,EAAgB;AAC1C,OAAKH,OAAL,GAAe,IAAIC,IAAJ,EAAf;AACAE,EAAAA,IAAI;AACP,CAHD;AAKAT,iBAAiB,CAACU,IAAlB,CAAuB,MAAvB,EAA+B,UAAUC,KAAV,EAAiBC,GAAjB,EAAsBH,IAAtB,EAA4B;AACvD,MAAIE,KAAK,CAACE,IAAN,KAAe,YAAf,IAA+BF,KAAK,CAACG,IAAN,KAAe,KAAlD,EAAyD;AACrDL,IAAAA,IAAI,CAAC,IAAIM,KAAJ,CAAU,iCAAV,CAAD,CAAJ;AACH,GAFD,MAEO;AACHN,IAAAA,IAAI,CAACE,KAAD,CAAJ;AACH;AACJ,CAND;AAQAX,iBAAiB,CAACgB,OAAlB,GAA4B;AACxBC,EAAAA,YAAY,EAAE,UAAUC,EAAV,EAAcC,IAAd,EAAoBC,KAApB,EAA2B;AACrC,WAAO,KAAKC,IAAL,CAAU;AAAEpB,MAAAA,GAAG,EAAEiB;AAAP,KAAV,EACFI,IADE,CACGF,KAAK,GAAGD,IADX,EAEFC,KAFE,CAEIA,KAFJ,EAGFG,IAHE,CAGG;AAAEjB,MAAAA,OAAO,EAAE,CAAC;AAAZ,KAHH,CAAP;AAIH,GANuB;AAOxBkB,EAAAA,UAAU,EAAE,UAAUN,EAAV,EAAc;AACtB,WAAO,KAAKG,IAAL,CAAU;AAAEpB,MAAAA,GAAG,EAAEiB;AAAP,KAAV,EAAuBO,cAAvB,EAAP;AACH;AATuB,CAA5B;AAWA,MAAMC,WAAW,GAAG7B,QAAQ,CAAC8B,KAAT,CAAe,cAAf,EAA+B3B,iBAA/B,CAApB;eAEe0B,W",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "const moogoose = require('../config/DBHelper')\n\nconst Schema = moogoose.Schema\n\nconst UserCollectSchema = new Schema({\n    uid: { type: String },\n    tid: { type: String },\n    title: { type: String },\n    created: { type: Date },\n})\n\nUserCollectSchema.pre('save', function (next) {\n    this.created = new Date()\n    next()\n})\n\nUserCollectSchema.post('save', function (error, doc, next) {\n    if (error.name === 'MongoError' && error.code === 11000) {\n        next(new Error('There was a duplicate key error'))\n    } else {\n        next(error)\n    }\n})\n\nUserCollectSchema.statics = {\n    getListByUid: function (id, page, limit) {\n        return this.find({ uid: id })\n            .skip(limit * page)\n            .limit(limit)\n            .sort({ created: -1 })\n    },\n    countByUid: function (id) {\n        return this.find({ uid: id }).countDocuments()\n    }\n}\nconst UserCollect = moogoose.model('user_collect', UserCollectSchema)\n\nexport default UserCollect"
      ]
    },
    "sourceType": "script",
    "mtime": 1585036026949
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/commentRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/commentRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/commentRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/commentRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "commentRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst {\n  addComment\n} = require('../../api/CommentController');\n\nconst router = new Router();\nrouter.prefix('/comments');\nrouter.post('/reply', addComment);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1lbnRSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsImFkZENvbW1lbnQiLCJyb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxNQUFNLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXBCOztBQUNBLE1BQU07QUFBRUMsRUFBQUE7QUFBRixJQUFlRCxPQUFPLENBQUMsNkJBQUQsQ0FBNUI7O0FBRUEsTUFBTUUsTUFBTSxHQUFDLElBQUlILE1BQUosRUFBYjtBQUVBRyxNQUFNLENBQUNDLE1BQVAsQ0FBYyxXQUFkO0FBQ0FELE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLFFBQVosRUFBcUJILFVBQXJCO0FBRUFJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlSixNQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL3JvdXRlcy9tb2R1bGVzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUm91dGVyPXJlcXVpcmUoJ2tvYS1yb3V0ZXInKVxuY29uc3QgeyBhZGRDb21tZW50IH09cmVxdWlyZSgnLi4vLi4vYXBpL0NvbW1lbnRDb250cm9sbGVyJylcblxuY29uc3Qgcm91dGVyPW5ldyBSb3V0ZXIoKVxuXG5yb3V0ZXIucHJlZml4KCcvY29tbWVudHMnKVxucm91dGVyLnBvc3QoJy9yZXBseScsYWRkQ29tbWVudClcblxubW9kdWxlLmV4cG9ydHM9cm91dGVyIl19",
    "map": {
      "version": 3,
      "sources": [
        "commentRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "addComment",
        "router",
        "prefix",
        "post",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAeD,OAAO,CAAC,6BAAD,CAA5B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AAEAG,MAAM,CAACC,MAAP,CAAc,WAAd;AACAD,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,UAArB;AAEAI,MAAM,CAACC,OAAP,GAAeJ,MAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst { addComment }=require('../../api/CommentController')\n\nconst router=new Router()\n\nrouter.prefix('/comments')\nrouter.post('/reply',addComment)\n\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585712631350
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/CommentController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/CommentController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/CommentController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/CommentController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "CommentController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst {\n  checkCode,\n  getJWTPayload\n} = require('../common/Utils');\n\nconst User = require('../model/User');\n\nconst Comments = require('../model/Comments');\n\nasync function addComment(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"addComment -> body\", body);\n  const sid = body.sid;\n  const code = body.code;\n  const result = await checkCode(sid, code);\n\n  if (result) {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const user = await User.findById({\n      _id: obj._id\n    });\n    console.log(\"addPost -> user\", user); // if(user.favs<body.fav) {\n    //     ctx.body = {\n    //         code:501,\n    //         msg:'积分不足'\n    //     }\n    //     return \n    // } else {\n    //     await User.updateOne({_id:obj._id},{$inc:{favs:-body.fav}})\n    // }\n\n    const newComment = new Comment(body);\n    newComment.uid = obj._id;\n    const result = await newComment.save();\n    ctx.body = {\n      code: 200,\n      msg: '成功发表评论',\n      date: result\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '图片验证码验证失败'\n    };\n  }\n} // 获取评论列表\n\n\nasync function getComments(ctx) {\n  const params = ctx.query;\n  const tid = params.tid;\n  const page = params.page ? params.page : 0;\n  const limit = params.limit ? parseInt(params.limit) : 10;\n  let result = await Comments.getCommentsList(tid, page, limit);\n  console.log(\"getComments -> result\", result); // 判断用户是否登录，已登录的用户才去判断点赞信息\n  // let obj = {}\n  // if (typeof ctx.header.authorization !== 'undefined') {\n  //     obj = await getJWTPayload(ctx.header.authorization)\n  // }\n  // if (typeof obj._id !== 'undefined') {\n  //     result = result.map(item => item.toJSON())\n  //     for (let i = 0; i < result.length; i++) {\n  //         let item = result[i]\n  //         item.handed = '0'\n  //         const commentsHands = await CommentsHands.findOne({ cid: item._id, uid: obj._id })\n  //         if (commentsHands && commentsHands.cid) {\n  //             if (commentsHands.uid === obj._id) {\n  //                 item.handed = '1'\n  //             }\n  //         }\n  //     }\n  // }\n\n  const total = await Comment.queryCount(tid);\n  console.log(\"getComments -> total\", total);\n  ctx.body = {\n    code: 200,\n    total,\n    data: result,\n    msg: '查询成功'\n  };\n}\n\nmodule.exports = {\n  addComment,\n  getComments\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImNoZWNrQ29kZSIsImdldEpXVFBheWxvYWQiLCJyZXF1aXJlIiwiVXNlciIsIkNvbW1lbnRzIiwiYWRkQ29tbWVudCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsInNpZCIsImNvZGUiLCJyZXN1bHQiLCJvYmoiLCJoZWFkZXIiLCJhdXRob3JpemF0aW9uIiwidXNlciIsImZpbmRCeUlkIiwiX2lkIiwibmV3Q29tbWVudCIsIkNvbW1lbnQiLCJ1aWQiLCJzYXZlIiwibXNnIiwiZGF0ZSIsImdldENvbW1lbnRzIiwicGFyYW1zIiwicXVlcnkiLCJ0aWQiLCJwYWdlIiwibGltaXQiLCJwYXJzZUludCIsImdldENvbW1lbnRzTGlzdCIsInRvdGFsIiwicXVlcnlDb3VudCIsImRhdGEiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU07QUFBRUEsRUFBQUEsU0FBRjtBQUFhQyxFQUFBQTtBQUFiLElBQStCQyxPQUFPLENBQUMsaUJBQUQsQ0FBNUM7O0FBQ0EsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsZUFBRCxDQUFwQjs7QUFDQSxNQUFNRSxRQUFRLEdBQUdGLE9BQU8sQ0FBQyxtQkFBRCxDQUF4Qjs7QUFFQSxlQUFlRyxVQUFmLENBQTJCQyxHQUEzQixFQUFnQztBQUM1QixRQUFNO0FBQUVDLElBQUFBO0FBQUYsTUFBV0QsR0FBRyxDQUFDRSxPQUFyQjtBQUNBQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxvQkFBWixFQUFrQ0gsSUFBbEM7QUFDQSxRQUFNSSxHQUFHLEdBQUdKLElBQUksQ0FBQ0ksR0FBakI7QUFDQSxRQUFNQyxJQUFJLEdBQUdMLElBQUksQ0FBQ0ssSUFBbEI7QUFDQSxRQUFNQyxNQUFNLEdBQUcsTUFBTWIsU0FBUyxDQUFDVyxHQUFELEVBQU1DLElBQU4sQ0FBOUI7O0FBQ0EsTUFBSUMsTUFBSixFQUFZO0FBQ1IsVUFBTUMsR0FBRyxHQUFHLE1BQU1iLGFBQWEsQ0FBQ0ssR0FBRyxDQUFDUyxNQUFKLENBQVdDLGFBQVosQ0FBL0I7QUFDQSxVQUFNQyxJQUFJLEdBQUcsTUFBTWQsSUFBSSxDQUFDZSxRQUFMLENBQWM7QUFBRUMsTUFBQUEsR0FBRyxFQUFFTCxHQUFHLENBQUNLO0FBQVgsS0FBZCxDQUFuQjtBQUNBVixJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQkFBWixFQUErQk8sSUFBL0IsRUFIUSxDQUlSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQSxVQUFNRyxVQUFVLEdBQUcsSUFBSUMsT0FBSixDQUFZZCxJQUFaLENBQW5CO0FBQ0FhLElBQUFBLFVBQVUsQ0FBQ0UsR0FBWCxHQUFpQlIsR0FBRyxDQUFDSyxHQUFyQjtBQUNBLFVBQU1OLE1BQU0sR0FBRyxNQUFNTyxVQUFVLENBQUNHLElBQVgsRUFBckI7QUFDQWpCLElBQUFBLEdBQUcsQ0FBQ0MsSUFBSixHQUFXO0FBQ1BLLE1BQUFBLElBQUksRUFBRSxHQURDO0FBRVBZLE1BQUFBLEdBQUcsRUFBRSxRQUZFO0FBR1BDLE1BQUFBLElBQUksRUFBRVo7QUFIQyxLQUFYO0FBS0gsR0FyQkQsTUFxQk87QUFDSFAsSUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEssTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUFksTUFBQUEsR0FBRyxFQUFFO0FBRkUsS0FBWDtBQUtIO0FBQ0osQyxDQUVEOzs7QUFDQSxlQUFlRSxXQUFmLENBQTRCcEIsR0FBNUIsRUFBaUM7QUFDN0IsUUFBTXFCLE1BQU0sR0FBR3JCLEdBQUcsQ0FBQ3NCLEtBQW5CO0FBQ0EsUUFBTUMsR0FBRyxHQUFHRixNQUFNLENBQUNFLEdBQW5CO0FBQ0EsUUFBTUMsSUFBSSxHQUFHSCxNQUFNLENBQUNHLElBQVAsR0FBY0gsTUFBTSxDQUFDRyxJQUFyQixHQUE0QixDQUF6QztBQUNBLFFBQU1DLEtBQUssR0FBR0osTUFBTSxDQUFDSSxLQUFQLEdBQWVDLFFBQVEsQ0FBQ0wsTUFBTSxDQUFDSSxLQUFSLENBQXZCLEdBQXdDLEVBQXREO0FBQ0EsTUFBSWxCLE1BQU0sR0FBRyxNQUFNVCxRQUFRLENBQUM2QixlQUFULENBQXlCSixHQUF6QixFQUE4QkMsSUFBOUIsRUFBb0NDLEtBQXBDLENBQW5CO0FBQ0F0QixFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSx1QkFBWixFQUFxQ0csTUFBckMsRUFONkIsQ0FPN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFFBQU1xQixLQUFLLEdBQUcsTUFBTWIsT0FBTyxDQUFDYyxVQUFSLENBQW1CTixHQUFuQixDQUFwQjtBQUNBcEIsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQVosRUFBb0N3QixLQUFwQztBQUNBNUIsRUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEssSUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUHNCLElBQUFBLEtBRk87QUFHUEUsSUFBQUEsSUFBSSxFQUFFdkIsTUFIQztBQUlQVyxJQUFBQSxHQUFHLEVBQUU7QUFKRSxHQUFYO0FBTUg7O0FBRURhLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUFFakMsRUFBQUEsVUFBRjtBQUFjcUIsRUFBQUE7QUFBZCxDQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9hcGkiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IGNoZWNrQ29kZSwgZ2V0SldUUGF5bG9hZCB9ID0gcmVxdWlyZSgnLi4vY29tbW9uL1V0aWxzJylcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbC9Vc2VyJylcbmNvbnN0IENvbW1lbnRzID0gcmVxdWlyZSgnLi4vbW9kZWwvQ29tbWVudHMnKVxuXG5hc3luYyBmdW5jdGlvbiBhZGRDb21tZW50IChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJhZGRDb21tZW50IC0+IGJvZHlcIiwgYm9keSlcbiAgICBjb25zdCBzaWQgPSBib2R5LnNpZFxuICAgIGNvbnN0IGNvZGUgPSBib2R5LmNvZGVcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgY29uc3Qgb2JqID0gYXdhaXQgZ2V0SldUUGF5bG9hZChjdHguaGVhZGVyLmF1dGhvcml6YXRpb24pXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkKHsgX2lkOiBvYmouX2lkIH0pXG4gICAgICAgIGNvbnNvbGUubG9nKFwiYWRkUG9zdCAtPiB1c2VyXCIsIHVzZXIpXG4gICAgICAgIC8vIGlmKHVzZXIuZmF2czxib2R5LmZhdikge1xuICAgICAgICAvLyAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIC8vICAgICAgICAgY29kZTo1MDEsXG4gICAgICAgIC8vICAgICAgICAgbXNnOifnp6/liIbkuI3otrMnXG4gICAgICAgIC8vICAgICB9XG4gICAgICAgIC8vICAgICByZXR1cm4gXG4gICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgIC8vICAgICBhd2FpdCBVc2VyLnVwZGF0ZU9uZSh7X2lkOm9iai5faWR9LHskaW5jOntmYXZzOi1ib2R5LmZhdn19KVxuICAgICAgICAvLyB9XG4gICAgICAgIGNvbnN0IG5ld0NvbW1lbnQgPSBuZXcgQ29tbWVudChib2R5KVxuICAgICAgICBuZXdDb21tZW50LnVpZCA9IG9iai5faWRcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3Q29tbWVudC5zYXZlKClcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBtc2c6ICfmiJDlip/lj5Hooajor4TorronLFxuICAgICAgICAgICAgZGF0ZTogcmVzdWx0XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggemqjOivgeWksei0pSdcblxuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyDojrflj5bor4TorrrliJfooahcbmFzeW5jIGZ1bmN0aW9uIGdldENvbW1lbnRzIChjdHgpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBjdHgucXVlcnlcbiAgICBjb25zdCB0aWQgPSBwYXJhbXMudGlkXG4gICAgY29uc3QgcGFnZSA9IHBhcmFtcy5wYWdlID8gcGFyYW1zLnBhZ2UgOiAwXG4gICAgY29uc3QgbGltaXQgPSBwYXJhbXMubGltaXQgPyBwYXJzZUludChwYXJhbXMubGltaXQpIDogMTBcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgQ29tbWVudHMuZ2V0Q29tbWVudHNMaXN0KHRpZCwgcGFnZSwgbGltaXQpXG4gICAgY29uc29sZS5sb2coXCJnZXRDb21tZW50cyAtPiByZXN1bHRcIiwgcmVzdWx0KVxuICAgIC8vIOWIpOaWreeUqOaIt+aYr+WQpueZu+W9le+8jOW3sueZu+W9leeahOeUqOaIt+aJjeWOu+WIpOaWreeCuei1nuS/oeaBr1xuICAgIC8vIGxldCBvYmogPSB7fVxuICAgIC8vIGlmICh0eXBlb2YgY3R4LmhlYWRlci5hdXRob3JpemF0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vICAgICBvYmogPSBhd2FpdCBnZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICAvLyB9XG4gICAgLy8gaWYgKHR5cGVvZiBvYmouX2lkICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vICAgICByZXN1bHQgPSByZXN1bHQubWFwKGl0ZW0gPT4gaXRlbS50b0pTT04oKSlcbiAgICAvLyAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAvLyAgICAgICAgIGxldCBpdGVtID0gcmVzdWx0W2ldXG4gICAgLy8gICAgICAgICBpdGVtLmhhbmRlZCA9ICcwJ1xuICAgIC8vICAgICAgICAgY29uc3QgY29tbWVudHNIYW5kcyA9IGF3YWl0IENvbW1lbnRzSGFuZHMuZmluZE9uZSh7IGNpZDogaXRlbS5faWQsIHVpZDogb2JqLl9pZCB9KVxuICAgIC8vICAgICAgICAgaWYgKGNvbW1lbnRzSGFuZHMgJiYgY29tbWVudHNIYW5kcy5jaWQpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAoY29tbWVudHNIYW5kcy51aWQgPT09IG9iai5faWQpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgaXRlbS5oYW5kZWQgPSAnMSdcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgIH1cbiAgICAvLyB9XG4gICAgY29uc3QgdG90YWwgPSBhd2FpdCBDb21tZW50LnF1ZXJ5Q291bnQodGlkKVxuICAgIGNvbnNvbGUubG9nKFwiZ2V0Q29tbWVudHMgLT4gdG90YWxcIiwgdG90YWwpXG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgdG90YWwsXG4gICAgICAgIGRhdGE6IHJlc3VsdCxcbiAgICAgICAgbXNnOiAn5p+l6K+i5oiQ5YqfJ1xuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IGFkZENvbW1lbnQsIGdldENvbW1lbnRzIH0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "CommentController.js"
      ],
      "names": [
        "checkCode",
        "getJWTPayload",
        "require",
        "User",
        "Comments",
        "addComment",
        "ctx",
        "body",
        "request",
        "console",
        "log",
        "sid",
        "code",
        "result",
        "obj",
        "header",
        "authorization",
        "user",
        "findById",
        "_id",
        "newComment",
        "Comment",
        "uid",
        "save",
        "msg",
        "date",
        "getComments",
        "params",
        "query",
        "tid",
        "page",
        "limit",
        "parseInt",
        "getCommentsList",
        "total",
        "queryCount",
        "data",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAM;AAAEA,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA+BC,OAAO,CAAC,iBAAD,CAA5C;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,eAAD,CAApB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAC,mBAAD,CAAxB;;AAEA,eAAeG,UAAf,CAA2BC,GAA3B,EAAgC;AAC5B,QAAM;AAAEC,IAAAA;AAAF,MAAWD,GAAG,CAACE,OAArB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCH,IAAlC;AACA,QAAMI,GAAG,GAAGJ,IAAI,CAACI,GAAjB;AACA,QAAMC,IAAI,GAAGL,IAAI,CAACK,IAAlB;AACA,QAAMC,MAAM,GAAG,MAAMb,SAAS,CAACW,GAAD,EAAMC,IAAN,CAA9B;;AACA,MAAIC,MAAJ,EAAY;AACR,UAAMC,GAAG,GAAG,MAAMb,aAAa,CAACK,GAAG,CAACS,MAAJ,CAAWC,aAAZ,CAA/B;AACA,UAAMC,IAAI,GAAG,MAAMd,IAAI,CAACe,QAAL,CAAc;AAAEC,MAAAA,GAAG,EAAEL,GAAG,CAACK;AAAX,KAAd,CAAnB;AACAV,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BO,IAA/B,EAHQ,CAIR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,UAAMG,UAAU,GAAG,IAAIC,OAAJ,CAAYd,IAAZ,CAAnB;AACAa,IAAAA,UAAU,CAACE,GAAX,GAAiBR,GAAG,CAACK,GAArB;AACA,UAAMN,MAAM,GAAG,MAAMO,UAAU,CAACG,IAAX,EAArB;AACAjB,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPK,MAAAA,IAAI,EAAE,GADC;AAEPY,MAAAA,GAAG,EAAE,QAFE;AAGPC,MAAAA,IAAI,EAAEZ;AAHC,KAAX;AAKH,GArBD,MAqBO;AACHP,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPK,MAAAA,IAAI,EAAE,GADC;AAEPY,MAAAA,GAAG,EAAE;AAFE,KAAX;AAKH;AACJ,C,CAED;;;AACA,eAAeE,WAAf,CAA4BpB,GAA5B,EAAiC;AAC7B,QAAMqB,MAAM,GAAGrB,GAAG,CAACsB,KAAnB;AACA,QAAMC,GAAG,GAAGF,MAAM,CAACE,GAAnB;AACA,QAAMC,IAAI,GAAGH,MAAM,CAACG,IAAP,GAAcH,MAAM,CAACG,IAArB,GAA4B,CAAzC;AACA,QAAMC,KAAK,GAAGJ,MAAM,CAACI,KAAP,GAAeC,QAAQ,CAACL,MAAM,CAACI,KAAR,CAAvB,GAAwC,EAAtD;AACA,MAAIlB,MAAM,GAAG,MAAMT,QAAQ,CAAC6B,eAAT,CAAyBJ,GAAzB,EAA8BC,IAA9B,EAAoCC,KAApC,CAAnB;AACAtB,EAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqCG,MAArC,EAN6B,CAO7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,QAAMqB,KAAK,GAAG,MAAMb,OAAO,CAACc,UAAR,CAAmBN,GAAnB,CAApB;AACApB,EAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCwB,KAApC;AACA5B,EAAAA,GAAG,CAACC,IAAJ,GAAW;AACPK,IAAAA,IAAI,EAAE,GADC;AAEPsB,IAAAA,KAFO;AAGPE,IAAAA,IAAI,EAAEvB,MAHC;AAIPW,IAAAA,GAAG,EAAE;AAJE,GAAX;AAMH;;AAEDa,MAAM,CAACC,OAAP,GAAiB;AAAEjC,EAAAA,UAAF;AAAcqB,EAAAA;AAAd,CAAjB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "const { checkCode, getJWTPayload } = require('../common/Utils')\nconst User = require('../model/User')\nconst Comments = require('../model/Comments')\n\nasync function addComment (ctx) {\n    const { body } = ctx.request\n    console.log(\"addComment -> body\", body)\n    const sid = body.sid\n    const code = body.code\n    const result = await checkCode(sid, code)\n    if (result) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const user = await User.findById({ _id: obj._id })\n        console.log(\"addPost -> user\", user)\n        // if(user.favs<body.fav) {\n        //     ctx.body = {\n        //         code:501,\n        //         msg:'积分不足'\n        //     }\n        //     return \n        // } else {\n        //     await User.updateOne({_id:obj._id},{$inc:{favs:-body.fav}})\n        // }\n        const newComment = new Comment(body)\n        newComment.uid = obj._id\n        const result = await newComment.save()\n        ctx.body = {\n            code: 200,\n            msg: '成功发表评论',\n            date: result\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '图片验证码验证失败'\n\n        }\n    }\n}\n\n// 获取评论列表\nasync function getComments (ctx) {\n    const params = ctx.query\n    const tid = params.tid\n    const page = params.page ? params.page : 0\n    const limit = params.limit ? parseInt(params.limit) : 10\n    let result = await Comments.getCommentsList(tid, page, limit)\n    console.log(\"getComments -> result\", result)\n    // 判断用户是否登录，已登录的用户才去判断点赞信息\n    // let obj = {}\n    // if (typeof ctx.header.authorization !== 'undefined') {\n    //     obj = await getJWTPayload(ctx.header.authorization)\n    // }\n    // if (typeof obj._id !== 'undefined') {\n    //     result = result.map(item => item.toJSON())\n    //     for (let i = 0; i < result.length; i++) {\n    //         let item = result[i]\n    //         item.handed = '0'\n    //         const commentsHands = await CommentsHands.findOne({ cid: item._id, uid: obj._id })\n    //         if (commentsHands && commentsHands.cid) {\n    //             if (commentsHands.uid === obj._id) {\n    //                 item.handed = '1'\n    //             }\n    //         }\n    //     }\n    // }\n    const total = await Comment.queryCount(tid)\n    console.log(\"getComments -> total\", total)\n    ctx.body = {\n        code: 200,\n        total,\n        data: result,\n        msg: '查询成功'\n    }\n}\n\nmodule.exports = { addComment, getComments }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585748476994
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/commentRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/commentRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/commentRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules/commentRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
        "sourceFileName": "commentRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst {\n  addComment\n} = require('../../api/CommentController');\n\nconst router = new Router();\nrouter.prefix('/comments');\nrouter.post('/reply', addComment);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1lbnRSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsImFkZENvbW1lbnQiLCJyb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxNQUFNLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXBCOztBQUNBLE1BQU07QUFBRUMsRUFBQUE7QUFBRixJQUFlRCxPQUFPLENBQUMsNkJBQUQsQ0FBNUI7O0FBRUEsTUFBTUUsTUFBTSxHQUFDLElBQUlILE1BQUosRUFBYjtBQUVBRyxNQUFNLENBQUNDLE1BQVAsQ0FBYyxXQUFkO0FBQ0FELE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLFFBQVosRUFBcUJILFVBQXJCO0FBRUFJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlSixNQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL3JvdXRlcy9tb2R1bGVzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUm91dGVyPXJlcXVpcmUoJ2tvYS1yb3V0ZXInKVxuY29uc3QgeyBhZGRDb21tZW50IH09cmVxdWlyZSgnLi4vLi4vYXBpL0NvbW1lbnRDb250cm9sbGVyJylcblxuY29uc3Qgcm91dGVyPW5ldyBSb3V0ZXIoKVxuXG5yb3V0ZXIucHJlZml4KCcvY29tbWVudHMnKVxucm91dGVyLnBvc3QoJy9yZXBseScsYWRkQ29tbWVudClcblxubW9kdWxlLmV4cG9ydHM9cm91dGVyIl19",
    "map": {
      "version": 3,
      "sources": [
        "commentRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "addComment",
        "router",
        "prefix",
        "post",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAeD,OAAO,CAAC,6BAAD,CAA5B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AAEAG,MAAM,CAACC,MAAP,CAAc,WAAd;AACAD,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,UAArB;AAEAI,MAAM,CAACC,OAAP,GAAeJ,MAAf",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst { addComment }=require('../../api/CommentController')\n\nconst router=new Router()\n\nrouter.prefix('/comments')\nrouter.post('/reply',addComment)\n\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585712631350
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/CommentController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/CommentController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/CommentController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api/CommentController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
        "sourceFileName": "CommentController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst {\n  checkCode,\n  getJWTPayload\n} = require('../common/Utils');\n\nconst User = require('../model/User');\n\nconst Comments = require('../model/Comments');\n\nasync function addComment(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"addComment -> body\", body);\n  const sid = body.sid;\n  const code = body.code;\n  const result = await checkCode(sid, code);\n\n  if (result) {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const user = await User.findById({\n      _id: obj._id\n    });\n    console.log(\"addPost -> user\", user); // if(user.favs<body.fav) {\n    //     ctx.body = {\n    //         code:501,\n    //         msg:'积分不足'\n    //     }\n    //     return \n    // } else {\n    //     await User.updateOne({_id:obj._id},{$inc:{favs:-body.fav}})\n    // }\n\n    const newComments = new Comments(body);\n    newComments.uid = obj._id;\n    const result = await newComments.save();\n    ctx.body = {\n      code: 200,\n      msg: '成功发表评论',\n      date: result\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '图片验证码验证失败'\n    };\n  }\n} // 获取评论列表\n\n\nasync function getComments(ctx) {\n  const params = ctx.query;\n  const tid = params.tid;\n  const page = params.page ? params.page : 0;\n  const limit = params.limit ? parseInt(params.limit) : 10;\n  let result = await Comments.getCommentsList(tid, page, limit);\n  console.log(\"getComments -> result\", result); // 判断用户是否登录，已登录的用户才去判断点赞信息\n  // let obj = {}\n  // if (typeof ctx.header.authorization !== 'undefined') {\n  //     obj = await getJWTPayload(ctx.header.authorization)\n  // }\n  // if (typeof obj._id !== 'undefined') {\n  //     result = result.map(item => item.toJSON())\n  //     for (let i = 0; i < result.length; i++) {\n  //         let item = result[i]\n  //         item.handed = '0'\n  //         const commentsHands = await CommentsHands.findOne({ cid: item._id, uid: obj._id })\n  //         if (commentsHands && commentsHands.cid) {\n  //             if (commentsHands.uid === obj._id) {\n  //                 item.handed = '1'\n  //             }\n  //         }\n  //     }\n  // }\n\n  const total = await Comment.queryCount(tid);\n  console.log(\"getComments -> total\", total);\n  ctx.body = {\n    code: 200,\n    total,\n    data: result,\n    msg: '查询成功'\n  };\n}\n\nmodule.exports = {\n  addComment,\n  getComments\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImNoZWNrQ29kZSIsImdldEpXVFBheWxvYWQiLCJyZXF1aXJlIiwiVXNlciIsIkNvbW1lbnRzIiwiYWRkQ29tbWVudCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsInNpZCIsImNvZGUiLCJyZXN1bHQiLCJvYmoiLCJoZWFkZXIiLCJhdXRob3JpemF0aW9uIiwidXNlciIsImZpbmRCeUlkIiwiX2lkIiwibmV3Q29tbWVudHMiLCJ1aWQiLCJzYXZlIiwibXNnIiwiZGF0ZSIsImdldENvbW1lbnRzIiwicGFyYW1zIiwicXVlcnkiLCJ0aWQiLCJwYWdlIiwibGltaXQiLCJwYXJzZUludCIsImdldENvbW1lbnRzTGlzdCIsInRvdGFsIiwiQ29tbWVudCIsInF1ZXJ5Q291bnQiLCJkYXRhIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNO0FBQUVBLEVBQUFBLFNBQUY7QUFBYUMsRUFBQUE7QUFBYixJQUErQkMsT0FBTyxDQUFDLGlCQUFELENBQTVDOztBQUNBLE1BQU1DLElBQUksR0FBR0QsT0FBTyxDQUFDLGVBQUQsQ0FBcEI7O0FBQ0EsTUFBTUUsUUFBUSxHQUFHRixPQUFPLENBQUMsbUJBQUQsQ0FBeEI7O0FBRUEsZUFBZUcsVUFBZixDQUEyQkMsR0FBM0IsRUFBZ0M7QUFDNUIsUUFBTTtBQUFFQyxJQUFBQTtBQUFGLE1BQVdELEdBQUcsQ0FBQ0UsT0FBckI7QUFDQUMsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksb0JBQVosRUFBa0NILElBQWxDO0FBQ0EsUUFBTUksR0FBRyxHQUFHSixJQUFJLENBQUNJLEdBQWpCO0FBQ0EsUUFBTUMsSUFBSSxHQUFHTCxJQUFJLENBQUNLLElBQWxCO0FBQ0EsUUFBTUMsTUFBTSxHQUFHLE1BQU1iLFNBQVMsQ0FBQ1csR0FBRCxFQUFNQyxJQUFOLENBQTlCOztBQUNBLE1BQUlDLE1BQUosRUFBWTtBQUNSLFVBQU1DLEdBQUcsR0FBRyxNQUFNYixhQUFhLENBQUNLLEdBQUcsQ0FBQ1MsTUFBSixDQUFXQyxhQUFaLENBQS9CO0FBQ0EsVUFBTUMsSUFBSSxHQUFHLE1BQU1kLElBQUksQ0FBQ2UsUUFBTCxDQUFjO0FBQUVDLE1BQUFBLEdBQUcsRUFBRUwsR0FBRyxDQUFDSztBQUFYLEtBQWQsQ0FBbkI7QUFDQVYsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksaUJBQVosRUFBK0JPLElBQS9CLEVBSFEsQ0FJUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0EsVUFBTUcsV0FBVyxHQUFHLElBQUloQixRQUFKLENBQWFHLElBQWIsQ0FBcEI7QUFDQWEsSUFBQUEsV0FBVyxDQUFDQyxHQUFaLEdBQWtCUCxHQUFHLENBQUNLLEdBQXRCO0FBQ0EsVUFBTU4sTUFBTSxHQUFHLE1BQU1PLFdBQVcsQ0FBQ0UsSUFBWixFQUFyQjtBQUNBaEIsSUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEssTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUFcsTUFBQUEsR0FBRyxFQUFFLFFBRkU7QUFHUEMsTUFBQUEsSUFBSSxFQUFFWDtBQUhDLEtBQVg7QUFLSCxHQXJCRCxNQXFCTztBQUNIUCxJQUFBQSxHQUFHLENBQUNDLElBQUosR0FBVztBQUNQSyxNQUFBQSxJQUFJLEVBQUUsR0FEQztBQUVQVyxNQUFBQSxHQUFHLEVBQUU7QUFGRSxLQUFYO0FBS0g7QUFDSixDLENBRUQ7OztBQUNBLGVBQWVFLFdBQWYsQ0FBNEJuQixHQUE1QixFQUFpQztBQUM3QixRQUFNb0IsTUFBTSxHQUFHcEIsR0FBRyxDQUFDcUIsS0FBbkI7QUFDQSxRQUFNQyxHQUFHLEdBQUdGLE1BQU0sQ0FBQ0UsR0FBbkI7QUFDQSxRQUFNQyxJQUFJLEdBQUdILE1BQU0sQ0FBQ0csSUFBUCxHQUFjSCxNQUFNLENBQUNHLElBQXJCLEdBQTRCLENBQXpDO0FBQ0EsUUFBTUMsS0FBSyxHQUFHSixNQUFNLENBQUNJLEtBQVAsR0FBZUMsUUFBUSxDQUFDTCxNQUFNLENBQUNJLEtBQVIsQ0FBdkIsR0FBd0MsRUFBdEQ7QUFDQSxNQUFJakIsTUFBTSxHQUFHLE1BQU1ULFFBQVEsQ0FBQzRCLGVBQVQsQ0FBeUJKLEdBQXpCLEVBQThCQyxJQUE5QixFQUFvQ0MsS0FBcEMsQ0FBbkI7QUFDQXJCLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHVCQUFaLEVBQXFDRyxNQUFyQyxFQU42QixDQU83QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0EsUUFBTW9CLEtBQUssR0FBRyxNQUFNQyxPQUFPLENBQUNDLFVBQVIsQ0FBbUJQLEdBQW5CLENBQXBCO0FBQ0FuQixFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxzQkFBWixFQUFvQ3VCLEtBQXBDO0FBQ0EzQixFQUFBQSxHQUFHLENBQUNDLElBQUosR0FBVztBQUNQSyxJQUFBQSxJQUFJLEVBQUUsR0FEQztBQUVQcUIsSUFBQUEsS0FGTztBQUdQRyxJQUFBQSxJQUFJLEVBQUV2QixNQUhDO0FBSVBVLElBQUFBLEdBQUcsRUFBRTtBQUpFLEdBQVg7QUFNSDs7QUFFRGMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQUVqQyxFQUFBQSxVQUFGO0FBQWNvQixFQUFBQTtBQUFkLENBQWpCIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL2FwaSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgY2hlY2tDb2RlLCBnZXRKV1RQYXlsb2FkIH0gPSByZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXInKVxuY29uc3QgQ29tbWVudHMgPSByZXF1aXJlKCcuLi9tb2RlbC9Db21tZW50cycpXG5cbmFzeW5jIGZ1bmN0aW9uIGFkZENvbW1lbnQgKGN0eCkge1xuICAgIGNvbnN0IHsgYm9keSB9ID0gY3R4LnJlcXVlc3RcbiAgICBjb25zb2xlLmxvZyhcImFkZENvbW1lbnQgLT4gYm9keVwiLCBib2R5KVxuICAgIGNvbnN0IHNpZCA9IGJvZHkuc2lkXG4gICAgY29uc3QgY29kZSA9IGJvZHkuY29kZVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNoZWNrQ29kZShzaWQsIGNvZGUpXG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgICBjb25zdCBvYmogPSBhd2FpdCBnZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQoeyBfaWQ6IG9iai5faWQgfSlcbiAgICAgICAgY29uc29sZS5sb2coXCJhZGRQb3N0IC0+IHVzZXJcIiwgdXNlcilcbiAgICAgICAgLy8gaWYodXNlci5mYXZzPGJvZHkuZmF2KSB7XG4gICAgICAgIC8vICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgLy8gICAgICAgICBjb2RlOjUwMSxcbiAgICAgICAgLy8gICAgICAgICBtc2c6J+enr+WIhuS4jei2sydcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gICAgIHJldHVybiBcbiAgICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgLy8gICAgIGF3YWl0IFVzZXIudXBkYXRlT25lKHtfaWQ6b2JqLl9pZH0seyRpbmM6e2ZhdnM6LWJvZHkuZmF2fX0pXG4gICAgICAgIC8vIH1cbiAgICAgICAgY29uc3QgbmV3Q29tbWVudHMgPSBuZXcgQ29tbWVudHMoYm9keSlcbiAgICAgICAgbmV3Q29tbWVudHMudWlkID0gb2JqLl9pZFxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBuZXdDb21tZW50cy5zYXZlKClcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBtc2c6ICfmiJDlip/lj5Hooajor4TorronLFxuICAgICAgICAgICAgZGF0ZTogcmVzdWx0XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggemqjOivgeWksei0pSdcblxuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyDojrflj5bor4TorrrliJfooahcbmFzeW5jIGZ1bmN0aW9uIGdldENvbW1lbnRzIChjdHgpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBjdHgucXVlcnlcbiAgICBjb25zdCB0aWQgPSBwYXJhbXMudGlkXG4gICAgY29uc3QgcGFnZSA9IHBhcmFtcy5wYWdlID8gcGFyYW1zLnBhZ2UgOiAwXG4gICAgY29uc3QgbGltaXQgPSBwYXJhbXMubGltaXQgPyBwYXJzZUludChwYXJhbXMubGltaXQpIDogMTBcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgQ29tbWVudHMuZ2V0Q29tbWVudHNMaXN0KHRpZCwgcGFnZSwgbGltaXQpXG4gICAgY29uc29sZS5sb2coXCJnZXRDb21tZW50cyAtPiByZXN1bHRcIiwgcmVzdWx0KVxuICAgIC8vIOWIpOaWreeUqOaIt+aYr+WQpueZu+W9le+8jOW3sueZu+W9leeahOeUqOaIt+aJjeWOu+WIpOaWreeCuei1nuS/oeaBr1xuICAgIC8vIGxldCBvYmogPSB7fVxuICAgIC8vIGlmICh0eXBlb2YgY3R4LmhlYWRlci5hdXRob3JpemF0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vICAgICBvYmogPSBhd2FpdCBnZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICAvLyB9XG4gICAgLy8gaWYgKHR5cGVvZiBvYmouX2lkICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vICAgICByZXN1bHQgPSByZXN1bHQubWFwKGl0ZW0gPT4gaXRlbS50b0pTT04oKSlcbiAgICAvLyAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAvLyAgICAgICAgIGxldCBpdGVtID0gcmVzdWx0W2ldXG4gICAgLy8gICAgICAgICBpdGVtLmhhbmRlZCA9ICcwJ1xuICAgIC8vICAgICAgICAgY29uc3QgY29tbWVudHNIYW5kcyA9IGF3YWl0IENvbW1lbnRzSGFuZHMuZmluZE9uZSh7IGNpZDogaXRlbS5faWQsIHVpZDogb2JqLl9pZCB9KVxuICAgIC8vICAgICAgICAgaWYgKGNvbW1lbnRzSGFuZHMgJiYgY29tbWVudHNIYW5kcy5jaWQpIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAoY29tbWVudHNIYW5kcy51aWQgPT09IG9iai5faWQpIHtcbiAgICAvLyAgICAgICAgICAgICAgICAgaXRlbS5oYW5kZWQgPSAnMSdcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICB9XG4gICAgLy8gICAgIH1cbiAgICAvLyB9XG4gICAgY29uc3QgdG90YWwgPSBhd2FpdCBDb21tZW50LnF1ZXJ5Q291bnQodGlkKVxuICAgIGNvbnNvbGUubG9nKFwiZ2V0Q29tbWVudHMgLT4gdG90YWxcIiwgdG90YWwpXG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgdG90YWwsXG4gICAgICAgIGRhdGE6IHJlc3VsdCxcbiAgICAgICAgbXNnOiAn5p+l6K+i5oiQ5YqfJ1xuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IGFkZENvbW1lbnQsIGdldENvbW1lbnRzIH0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "CommentController.js"
      ],
      "names": [
        "checkCode",
        "getJWTPayload",
        "require",
        "User",
        "Comments",
        "addComment",
        "ctx",
        "body",
        "request",
        "console",
        "log",
        "sid",
        "code",
        "result",
        "obj",
        "header",
        "authorization",
        "user",
        "findById",
        "_id",
        "newComments",
        "uid",
        "save",
        "msg",
        "date",
        "getComments",
        "params",
        "query",
        "tid",
        "page",
        "limit",
        "parseInt",
        "getCommentsList",
        "total",
        "Comment",
        "queryCount",
        "data",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAM;AAAEA,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA+BC,OAAO,CAAC,iBAAD,CAA5C;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,eAAD,CAApB;;AACA,MAAME,QAAQ,GAAGF,OAAO,CAAC,mBAAD,CAAxB;;AAEA,eAAeG,UAAf,CAA2BC,GAA3B,EAAgC;AAC5B,QAAM;AAAEC,IAAAA;AAAF,MAAWD,GAAG,CAACE,OAArB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCH,IAAlC;AACA,QAAMI,GAAG,GAAGJ,IAAI,CAACI,GAAjB;AACA,QAAMC,IAAI,GAAGL,IAAI,CAACK,IAAlB;AACA,QAAMC,MAAM,GAAG,MAAMb,SAAS,CAACW,GAAD,EAAMC,IAAN,CAA9B;;AACA,MAAIC,MAAJ,EAAY;AACR,UAAMC,GAAG,GAAG,MAAMb,aAAa,CAACK,GAAG,CAACS,MAAJ,CAAWC,aAAZ,CAA/B;AACA,UAAMC,IAAI,GAAG,MAAMd,IAAI,CAACe,QAAL,CAAc;AAAEC,MAAAA,GAAG,EAAEL,GAAG,CAACK;AAAX,KAAd,CAAnB;AACAV,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BO,IAA/B,EAHQ,CAIR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,UAAMG,WAAW,GAAG,IAAIhB,QAAJ,CAAaG,IAAb,CAApB;AACAa,IAAAA,WAAW,CAACC,GAAZ,GAAkBP,GAAG,CAACK,GAAtB;AACA,UAAMN,MAAM,GAAG,MAAMO,WAAW,CAACE,IAAZ,EAArB;AACAhB,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPK,MAAAA,IAAI,EAAE,GADC;AAEPW,MAAAA,GAAG,EAAE,QAFE;AAGPC,MAAAA,IAAI,EAAEX;AAHC,KAAX;AAKH,GArBD,MAqBO;AACHP,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPK,MAAAA,IAAI,EAAE,GADC;AAEPW,MAAAA,GAAG,EAAE;AAFE,KAAX;AAKH;AACJ,C,CAED;;;AACA,eAAeE,WAAf,CAA4BnB,GAA5B,EAAiC;AAC7B,QAAMoB,MAAM,GAAGpB,GAAG,CAACqB,KAAnB;AACA,QAAMC,GAAG,GAAGF,MAAM,CAACE,GAAnB;AACA,QAAMC,IAAI,GAAGH,MAAM,CAACG,IAAP,GAAcH,MAAM,CAACG,IAArB,GAA4B,CAAzC;AACA,QAAMC,KAAK,GAAGJ,MAAM,CAACI,KAAP,GAAeC,QAAQ,CAACL,MAAM,CAACI,KAAR,CAAvB,GAAwC,EAAtD;AACA,MAAIjB,MAAM,GAAG,MAAMT,QAAQ,CAAC4B,eAAT,CAAyBJ,GAAzB,EAA8BC,IAA9B,EAAoCC,KAApC,CAAnB;AACArB,EAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAAqCG,MAArC,EAN6B,CAO7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,QAAMoB,KAAK,GAAG,MAAMC,OAAO,CAACC,UAAR,CAAmBP,GAAnB,CAApB;AACAnB,EAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCuB,KAApC;AACA3B,EAAAA,GAAG,CAACC,IAAJ,GAAW;AACPK,IAAAA,IAAI,EAAE,GADC;AAEPqB,IAAAA,KAFO;AAGPG,IAAAA,IAAI,EAAEvB,MAHC;AAIPU,IAAAA,GAAG,EAAE;AAJE,GAAX;AAMH;;AAEDc,MAAM,CAACC,OAAP,GAAiB;AAAEjC,EAAAA,UAAF;AAAcoB,EAAAA;AAAd,CAAjB",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/api",
      "sourcesContent": [
        "const { checkCode, getJWTPayload } = require('../common/Utils')\nconst User = require('../model/User')\nconst Comments = require('../model/Comments')\n\nasync function addComment (ctx) {\n    const { body } = ctx.request\n    console.log(\"addComment -> body\", body)\n    const sid = body.sid\n    const code = body.code\n    const result = await checkCode(sid, code)\n    if (result) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const user = await User.findById({ _id: obj._id })\n        console.log(\"addPost -> user\", user)\n        // if(user.favs<body.fav) {\n        //     ctx.body = {\n        //         code:501,\n        //         msg:'积分不足'\n        //     }\n        //     return \n        // } else {\n        //     await User.updateOne({_id:obj._id},{$inc:{favs:-body.fav}})\n        // }\n        const newComments = new Comments(body)\n        newComments.uid = obj._id\n        const result = await newComments.save()\n        ctx.body = {\n            code: 200,\n            msg: '成功发表评论',\n            date: result\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '图片验证码验证失败'\n\n        }\n    }\n}\n\n// 获取评论列表\nasync function getComments (ctx) {\n    const params = ctx.query\n    const tid = params.tid\n    const page = params.page ? params.page : 0\n    const limit = params.limit ? parseInt(params.limit) : 10\n    let result = await Comments.getCommentsList(tid, page, limit)\n    console.log(\"getComments -> result\", result)\n    // 判断用户是否登录，已登录的用户才去判断点赞信息\n    // let obj = {}\n    // if (typeof ctx.header.authorization !== 'undefined') {\n    //     obj = await getJWTPayload(ctx.header.authorization)\n    // }\n    // if (typeof obj._id !== 'undefined') {\n    //     result = result.map(item => item.toJSON())\n    //     for (let i = 0; i < result.length; i++) {\n    //         let item = result[i]\n    //         item.handed = '0'\n    //         const commentsHands = await CommentsHands.findOne({ cid: item._id, uid: obj._id })\n    //         if (commentsHands && commentsHands.cid) {\n    //             if (commentsHands.uid === obj._id) {\n    //                 item.handed = '1'\n    //             }\n    //         }\n    //     }\n    // }\n    const total = await Comment.queryCount(tid)\n    console.log(\"getComments -> total\", total)\n    ctx.body = {\n        code: 200,\n        total,\n        data: result,\n        msg: '查询成功'\n    }\n}\n\nmodule.exports = { addComment, getComments }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585749337423
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comment.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comment.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comment.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comment.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "Comment.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _DBHelpler = _interopRequireDefault(require(\"../config/DBHelpler\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst Schema = _DBHelpler.default.Schema;\nconst CommentsSchema = new Schema({\n  tid: {\n    type: String,\n    ref: 'post'\n  },\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  cuid: {\n    type: String,\n    ref: 'users'\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  hands: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '1'\n  },\n  isRead: {\n    type: String,\n    default: '0'\n  },\n  isBest: {\n    type: String,\n    default: '0'\n  }\n}, {\n  toJSON: {\n    virtuals: true\n  }\n});\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({\n      tid: id\n    });\n  },\n  findByCid: function (id) {\n    return this.findOne({\n      _id: id\n    });\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({\n      tid: id\n    }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: {\n        status: {\n          $eq: '0'\n        }\n      }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit);\n  },\n  queryCount: function (id) {\n    return this.find({\n      tid: id\n    }).countDocuments();\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({\n      cuid: id\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      cuid: {\n        $ne: id\n      },\n      isRead: {\n        $eq: '0'\n      },\n      // 未读状态\n      status: {\n        $eq: '1'\n      } // 是否显示\n\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).populate({\n      path: 'uid',\n      select: '_id name'\n    }).populate({\n      path: 'cuid',\n      select: '_id name'\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  getTotal: function (id) {\n    return this.find({\n      uid: id,\n      isRead: '0',\n      status: '1'\n    }).countDocuments();\n  } // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n\n};\n\nconst Comments = _DBHelpler.default.model('comments', CommentsSchema);\n\nvar _default = Comments;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnQuanMiXSwibmFtZXMiOlsiU2NoZW1hIiwibW9uZ29vc2UiLCJDb21tZW50c1NjaGVtYSIsInRpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJ1aWQiLCJjdWlkIiwiY29udGVudCIsImNyZWF0ZWQiLCJEYXRlIiwiaGFuZHMiLCJOdW1iZXIiLCJkZWZhdWx0Iiwic3RhdHVzIiwiaXNSZWFkIiwiaXNCZXN0IiwidG9KU09OIiwidmlydHVhbHMiLCJwcmUiLCJuZXh0IiwicG9zdCIsImVycm9yIiwiZG9jIiwibmFtZSIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJmaW5kQnlUaWQiLCJpZCIsImZpbmQiLCJmaW5kQnlDaWQiLCJmaW5kT25lIiwiX2lkIiwiZ2V0Q29tbWVudHNMaXN0IiwicGFnZSIsImxpbWl0IiwicG9wdWxhdGUiLCJwYXRoIiwic2VsZWN0IiwibWF0Y2giLCIkZXEiLCJza2lwIiwicXVlcnlDb3VudCIsImNvdW50RG9jdW1lbnRzIiwiZ2V0Q29tbWV0c1B1YmxpYyIsInNvcnQiLCJnZXRNc2dMaXN0IiwiJG5lIiwiZ2V0VG90YWwiLCJDb21tZW50cyIsIm1vZGVsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7QUFFQSxNQUFNQSxNQUFNLEdBQUdDLG1CQUFTRCxNQUF4QjtBQUVBLE1BQU1FLGNBQWMsR0FBRyxJQUFJRixNQUFKLENBQVc7QUFDaENHLEVBQUFBLEdBQUcsRUFBRTtBQUFFQyxJQUFBQSxJQUFJLEVBQUVDLE1BQVI7QUFBZ0JDLElBQUFBLEdBQUcsRUFBRTtBQUFyQixHQUQyQjtBQUVoQ0MsRUFBQUEsR0FBRyxFQUFFO0FBQUVILElBQUFBLElBQUksRUFBRUMsTUFBUjtBQUFnQkMsSUFBQUEsR0FBRyxFQUFFO0FBQXJCLEdBRjJCO0FBR2hDRSxFQUFBQSxJQUFJLEVBQUU7QUFBRUosSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FIMEI7QUFJaENHLEVBQUFB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RUFvQkpVLElBcEJJLENBb0JDO0FBQUVyQyxNQUFBQSxPQUFPLEVBQUUsQ0FBQztBQUFaLEtBcEJELENBQVA7QUFxQkQsR0FwRHNCO0FBcUR2QndDLEVBQUFBLFFBQVEsRUFBRSxVQUFVcEIsRUFBVixFQUFjO0FBQ3RCLFdBQU8sS0FBS0MsSUFBTCxDQUFVO0FBQUV4QixNQUFBQSxHQUFHLEVBQUV1QixFQUFQO0FBQVdkLE1BQUFBLE1BQU0sRUFBRSxHQUFuQjtBQUF3QkQsTUFBQUEsTUFBTSxFQUFFO0FBQWhDLEtBQVYsRUFBaUQ4QixjQUFqRCxFQUFQO0FBQ0QsR0F2RHNCLENBd0R2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBeEZ1QixDQUF6Qjs7QUEyRkEsTUFBTU0sUUFBUSxHQUFHbEQsbUJBQVNtRCxLQUFULENBQWUsVUFBZixFQUEyQmxELGNBQTNCLENBQWpCOztlQUVlaUQsUSIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9tb2RlbCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICcuLi9jb25maWcvREJIZWxwbGVyJ1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWFcblxuY29uc3QgQ29tbWVudHNTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdGlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAncG9zdCcgfSxcbiAgdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIGN1aWQ6IHsgdHlwZTogU3RyaW5nLCByZWY6ICd1c2VycycgfSxcbiAgY29udGVudDogeyB0eXBlOiBTdHJpbmcgfSxcbiAgY3JlYXRlZDogeyB0eXBlOiBEYXRlIH0sXG4gIGhhbmRzOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxuICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMScgfSxcbiAgaXNSZWFkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJzAnIH0sXG4gIGlzQmVzdDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9XG59LCB7IHRvSlNPTjogeyB2aXJ0dWFsczogdHJ1ZSB9IH0pXG5cbkNvbW1lbnRzU2NoZW1hLnByZSgnc2F2ZScsIGZ1bmN0aW9uIChuZXh0KSB7XG4gIHRoaXMuY3JlYXRlZCA9IG5ldyBEYXRlKClcbiAgbmV4dCgpXG59KVxuXG5Db21tZW50c1NjaGVtYS5wb3N0KCdzYXZlJywgZnVuY3Rpb24gKGVycm9yLCBkb2MsIG5leHQpIHtcbiAgaWYgKGVycm9yLm5hbWUgPT09ICdNb25nb0Vycm9yJyAmJiBlcnJvci5jb2RlID09PSAxMTAwMCkge1xuICAgIG5leHQobmV3IEVycm9yKCdUaGVyZSB3YXMgYSBkdXBsaWNhdGUga2V5IGVycm9yJykpXG4gIH0gZWxzZSB7XG4gICAgbmV4dChlcnJvcilcbiAgfVxufSlcblxuQ29tbWVudHNTY2hlbWEuc3RhdGljcyA9IHtcbiAgZmluZEJ5VGlkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHsgdGlkOiBpZCB9KVxuICB9LFxuICBmaW5kQnlDaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmRPbmUoeyBfaWQ6IGlkIH0pXG4gIH0sXG4gIGdldENvbW1lbnRzTGlzdDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB0aWQ6IGlkIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICdjdWlkJyxcbiAgICAgIHNlbGVjdDogJ19pZCBuYW1lIHBpYyBpc1ZpcCcsXG4gICAgICBtYXRjaDogeyBzdGF0dXM6IHsgJGVxOiAnMCcgfSB9XG4gICAgfSkucG9wdWxhdGUoe1xuICAgICAgcGF0aDogJ3RpZCcsXG4gICAgICBzZWxlY3Q6ICdfaWQgdGl0bGUgc3RhdHVzJ1xuICAgIH0pLnNraXAocGFnZSAqIGxpbWl0KS5saW1pdChsaW1pdClcbiAgfSxcbiAgcXVlcnlDb3VudDogZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IHRpZDogaWQgfSkuY291bnREb2N1bWVudHMoKVxuICB9LFxuICBnZXRDb21tZXRzUHVibGljOiBmdW5jdGlvbiAoaWQsIHBhZ2UsIGxpbWl0KSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IGN1aWQ6IGlkIH0pXG4gICAgICAucG9wdWxhdGUoe1xuICAgICAgICBwYXRoOiAndGlkJyxcbiAgICAgICAgc2VsZWN0OiAnX2lkIHRpdGxlJ1xuICAgICAgfSlcbiAgICAgIC5za2lwKHBhZ2UgKiBsaW1pdClcbiAgICAgIC5saW1pdChsaW1pdClcbiAgICAgIC5zb3J0KHsgY3JlYXRlZDogLTEgfSlcbiAgfSxcbiAgZ2V0TXNnTGlzdDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoe1xuICAgICAgdWlkOiBpZCxcbiAgICAgIGN1aWQ6IHsgJG5lOiBpZCB9LFxuICAgICAgaXNSZWFkOiB7ICRlcTogJzAnIH0sIC8vIOacquivu+eKtuaAgVxuICAgICAgc3RhdHVzOiB7ICRlcTogJzEnIH0gLy8g5piv5ZCm5pi+56S6XG4gICAgfSlcbiAgICAgIC5wb3B1bGF0ZSh7XG4gICAgICAgIHBhdGg6ICd0aWQnLFxuICAgICAgICBzZWxlY3Q6ICdfaWQgdGl0bGUnXG4gICAgICB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ3VpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCBuYW1lJ1xuICAgICAgfSlcbiAgICAgIC5wb3B1bGF0ZSh7XG4gICAgICAgIHBhdGg6ICdjdWlkJyxcbiAgICAgICAgc2VsZWN0OiAnX2lkIG5hbWUnXG4gICAgICB9KVxuICAgICAgLnNraXAobGltaXQgKiBwYWdlKVxuICAgICAgLmxpbWl0KGxpbWl0KVxuICAgICAgLnNvcnQoeyBjcmVhdGVkOiAtMSB9KVxuICB9LFxuICBnZXRUb3RhbDogZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IHVpZDogaWQsIGlzUmVhZDogJzAnLCBzdGF0dXM6ICcxJyB9KS5jb3VudERvY3VtZW50cygpXG4gIH1cbiAgLy8gZ2V0TXNnTGlzdDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAvLyAgIHJldHVybiB0aGlzLmFnZ3JlZ2F0ZShbXG4gIC8vICAgICB7XG4gIC8vICAgICAgICRsb29rdXA6IHtcbiAgLy8gICAgICAgICBmcm9tOiAncG9zdHMnLFxuICAvLyAgICAgICAgIGxldDogeyBwaWQ6IHsgJHRvT2JqZWN0SWQ6ICckdGlkJyB9IH0sXG4gIC8vICAgICAgICAgcGlwZWxpbmU6IFtcbiAgLy8gICAgICAgICAgIHsgJG1hdGNoOiB7ICRleHByOiB7ICRlcTogWyckX2lkJywgJyQkcGlkJ10gfSB9IH0sXG4gIC8vICAgICAgICAgICB7ICRwcm9qZWN0OiB7IF9pZDogMSwgdWlkOiAxLCBjb250ZW50OiAxIH0gfVxuICAvLyAgICAgICAgIF0sXG4gIC8vICAgICAgICAgYXM6ICdwb3N0J1xuICAvLyAgICAgICB9XG4gIC8vICAgICB9LFxuICAvLyAgICAge1xuICAvLyAgICAgICAkcmVwbGFjZVJvb3Q6IHtcbiAgLy8gICAgICAgICBuZXdSb290OiB7XG4gIC8vICAgICAgICAgICAkbWVyZ2VPYmplY3RzOiBbeyAkYXJyYXlFbGVtQXQ6IFsnJHBvc3QnLCAwXSB9LCAnJCRST09UJ11cbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH0sXG4gIC8vICAgICB7ICRhZGRGaWVsZHM6IHsgdXNlcklkOiB7ICR0b09iamVjdElkOiAnJHVpZCcgfSB9IH0sXG4gIC8vICAgICB7ICRsb29rdXA6IHsgZnJvbTogJ3VzZXJzJywgbG9jYWxGaWVsZDogJ3VzZXJJZCcsIGZvcmVpZ25GaWVsZDogJ19pZCcsIGFzOiAndHVpZCcgfSB9LFxuICAvLyAgICAgeyAkdW53aW5kOiAnJHR1aWQnIH0sXG4gIC8vICAgICB7ICRhZGRGaWVsZHM6IHsgZnVzZXJJZDogeyAkdG9PYmplY3RJZDogJyRjdWlkJyB9IH0gfSxcbiAgLy8gICAgIHsgJGxvb2t1cDogeyBmcm9tOiAndXNlcnMnLCBsb2NhbEZpZWxkOiAnZnVzZXJJZCcsIGZvcmVpZ25GaWVsZDogJ19pZCcsIGFzOiAnZnVpZCcgfSB9LFxuICAvLyAgICAgeyAkdW53aW5kOiAnJGZ1aWQnIH0sXG4gIC8vICAgICB7ICRwcm9qZWN0OiB7IHBvc3Q6IDAsIHR1aWQ6IHsgdXNlcm5hbWU6IDAsIHBhc3N3b3JkOiAwIH0sIGZ1aWQ6IHsgdXNlcm5hbWU6IDAsIHBhc3N3b3JkOiAwIH0sIHVzZXJJZDogMCwgZnVzZXJJZDogMCwgdGlkOiAwLCBjdWlkOiAwIH0gfSxcbiAgLy8gICAgIHsgJG1hdGNoOiB7IHVpZDogaWQsIHN0YXR1czogJzEnLCBpc1JlYWQ6ICcwJyB9IH1cbiAgLy8gICBdKVxuICAvLyAgICAgLnNraXAobGltaXQgKiBwYWdlKVxuICAvLyAgICAgLmxpbWl0KGxpbWl0KVxuICAvLyAgICAgLnNvcnQoeyBjcmVhdGVkOiAtMSB9KVxuICAvLyB9XG59XG5cbmNvbnN0IENvbW1lbnRzID0gbW9uZ29vc2UubW9kZWwoJ2NvbW1lbnRzJywgQ29tbWVudHNTY2hlbWEpXG5cbmV4cG9ydCBkZWZhdWx0IENvbW1lbnRzXG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Comment.js"
      ],
      "names": [
        "Schema",
        "mongoose",
        "CommentsSchema",
        "tid",
        "type",
        "String",
        "ref",
        "uid",
        "cuid",
        "content",
        "created",
        "Date",
        "hands",
        "Number",
        "default",
        "status",
        "isRead",
        "isBest",
        "toJSON",
        "virtuals",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "findByTid",
        "id",
        "find",
        "findByCid",
        "findOne",
        "_id",
        "getCommentsList",
        "page",
        "limit",
        "populate",
        "path",
        "select",
        "match",
        "$eq",
        "skip",
        "queryCount",
        "countDocuments",
        "getCommetsPublic",
        "sort",
        "getMsgList",
        "$ne",
        "getTotal",
        "Comments",
        "model"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "import mongoose from '../config/DBHelpler'\n\nconst Schema = mongoose.Schema\n\nconst CommentsSchema = new Schema({\n  tid: { type: String, ref: 'post' },\n  uid: { type: String, ref: 'users' },\n  cuid: { type: String, ref: 'users' },\n  content: { type: String },\n  created: { type: Date },\n  hands: { type: Number, default: 0 },\n  status: { type: String, default: '1' },\n  isRead: { type: String, default: '0' },\n  isBest: { type: String, default: '0' }\n}, { toJSON: { virtuals: true } })\n\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date()\n  next()\n})\n\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'))\n  } else {\n    next(error)\n  }\n})\n\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({ tid: id })\n  },\n  findByCid: function (id) {\n    return this.findOne({ _id: id })\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({ tid: id }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: { status: { $eq: '0' } }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit)\n  },\n  queryCount: function (id) {\n    return this.find({ tid: id }).countDocuments()\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({ cuid: id })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      cuid: { $ne: id },\n      isRead: { $eq: '0' }, // 未读状态\n      status: { $eq: '1' } // 是否显示\n    })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .populate({\n        path: 'uid',\n        select: '_id name'\n      })\n      .populate({\n        path: 'cuid',\n        select: '_id name'\n      })\n      .skip(limit * page)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getTotal: function (id) {\n    return this.find({ uid: id, isRead: '0', status: '1' }).countDocuments()\n  }\n  // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n}\n\nconst Comments = mongoose.model('comments', CommentsSchema)\n\nexport default Comments\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1585713913728
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comment.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comment.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comment.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comment.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "Comment.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _DBHelpler = _interopRequireDefault(require(\"../config/DBHelpler\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst Schema = _DBHelpler.default.Schema;\nconst CommentsSchema = new Schema({\n  tid: {\n    type: String,\n    ref: 'post'\n  },\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  cuid: {\n    type: String,\n    ref: 'users'\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  hands: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '1'\n  },\n  isRead: {\n    type: String,\n    default: '0'\n  },\n  isBest: {\n    type: String,\n    default: '0'\n  }\n}, {\n  toJSON: {\n    virtuals: true\n  }\n});\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({\n      tid: id\n    });\n  },\n  findByCid: function (id) {\n    return this.findOne({\n      _id: id\n    });\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({\n      tid: id\n    }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: {\n        status: {\n          $eq: '0'\n        }\n      }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit);\n  },\n  queryCount: function (id) {\n    return this.find({\n      tid: id\n    }).countDocuments();\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({\n      cuid: id\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      cuid: {\n        $ne: id\n      },\n      isRead: {\n        $eq: '0'\n      },\n      // 未读状态\n      status: {\n        $eq: '1'\n      } // 是否显示\n\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).populate({\n      path: 'uid',\n      select: '_id name'\n    }).populate({\n      path: 'cuid',\n      select: '_id name'\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  getTotal: function (id) {\n    return this.find({\n      uid: id,\n      isRead: '0',\n      status: '1'\n    }).countDocuments();\n  } // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n\n};\n\nconst Comments = _DBHelpler.default.model('comments', CommentsSchema);\n\nvar _default = Comments;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnQuanMiXSwibmFtZXMiOlsiU2NoZW1hIiwibW9uZ29vc2UiLCJDb21tZW50c1NjaGVtYSIsInRpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJ1aWQiLCJjdWlkIiwiY29udGVudCIsImNyZWF0ZWQiLCJEYXRlIiwiaGFuZHMiLCJOdW1iZXIiLCJkZWZhdWx0Iiwic3RhdHVzIiwiaXNSZWFkIiwiaXNCZXN0IiwidG9KU09OIiwidmlydHVhbHMiLCJwcmUiLCJuZXh0IiwicG9zdCIsImVycm9yIiwiZG9jIiwibmFtZSIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJmaW5kQnlUaWQiLCJpZCIsImZpbmQiLCJmaW5kQnlDaWQiLCJmaW5kT25lIiwiX2lkIiwiZ2V0Q29tbWVudHNMaXN0IiwicGFnZSIsImxpbWl0IiwicG9wdWxhdGUiLCJwYXRoIiwic2VsZWN0IiwibWF0Y2giLCIkZXEiLCJza2lwIiwicXVlcnlDb3VudCIsImNvdW50RG9jdW1lbnRzIiwiZ2V0Q29tbWV0c1B1YmxpYyIsInNvcnQiLCJnZXRNc2dMaXN0IiwiJG5lIiwiZ2V0VG90YWwiLCJDb21tZW50cyIsIm1vZGVsIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7Ozs7QUFFQSxNQUFNQSxNQUFNLEdBQUdDLG1CQUFTRCxNQUF4QjtBQUVBLE1BQU1FLGNBQWMsR0FBRyxJQUFJRixNQUFKLENBQVc7QUFDaENHLEVBQUFBLEdBQUcsRUFBRTtBQUFFQyxJQUFBQSxJQUFJLEVBQUVDLE1BQVI7QUFBZ0JDLElBQUFBLEdBQUcsRUFBRTtBQUFyQixHQUQyQjtBQUVoQ0MsRUFBQUEsR0FBRyxFQUFFO0FBQUVILElBQUFBLElBQUksRUFBRUMsTUFBUjtBQUFnQkMsSUFBQUEsR0FBRyxFQUFFO0FBQXJCLEdBRjJCO0FBR2hDRSxFQUFBQSxJQUFJLEVBQUU7QUFBRUosSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FIMEI7QUFJaENHLEVBQUFB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RUFvQkpVLElBcEJJLENBb0JDO0FBQUVyQyxNQUFBQSxPQUFPLEVBQUUsQ0FBQztBQUFaLEtBcEJELENBQVA7QUFxQkQsR0FwRHNCO0FBcUR2QndDLEVBQUFBLFFBQVEsRUFBRSxVQUFVcEIsRUFBVixFQUFjO0FBQ3RCLFdBQU8sS0FBS0MsSUFBTCxDQUFVO0FBQUV4QixNQUFBQSxHQUFHLEVBQUV1QixFQUFQO0FBQVdkLE1BQUFBLE1BQU0sRUFBRSxHQUFuQjtBQUF3QkQsTUFBQUEsTUFBTSxFQUFFO0FBQWhDLEtBQVYsRUFBaUQ4QixjQUFqRCxFQUFQO0FBQ0QsR0F2RHNCLENBd0R2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBeEZ1QixDQUF6Qjs7QUEyRkEsTUFBTU0sUUFBUSxHQUFHbEQsbUJBQVNtRCxLQUFULENBQWUsVUFBZixFQUEyQmxELGNBQTNCLENBQWpCOztlQUVlaUQsUSIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9tb2RlbCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tICcuLi9jb25maWcvREJIZWxwbGVyJ1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWFcblxuY29uc3QgQ29tbWVudHNTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdGlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAncG9zdCcgfSxcbiAgdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIGN1aWQ6IHsgdHlwZTogU3RyaW5nLCByZWY6ICd1c2VycycgfSxcbiAgY29udGVudDogeyB0eXBlOiBTdHJpbmcgfSxcbiAgY3JlYXRlZDogeyB0eXBlOiBEYXRlIH0sXG4gIGhhbmRzOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxuICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMScgfSxcbiAgaXNSZWFkOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJzAnIH0sXG4gIGlzQmVzdDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9XG59LCB7IHRvSlNPTjogeyB2aXJ0dWFsczogdHJ1ZSB9IH0pXG5cbkNvbW1lbnRzU2NoZW1hLnByZSgnc2F2ZScsIGZ1bmN0aW9uIChuZXh0KSB7XG4gIHRoaXMuY3JlYXRlZCA9IG5ldyBEYXRlKClcbiAgbmV4dCgpXG59KVxuXG5Db21tZW50c1NjaGVtYS5wb3N0KCdzYXZlJywgZnVuY3Rpb24gKGVycm9yLCBkb2MsIG5leHQpIHtcbiAgaWYgKGVycm9yLm5hbWUgPT09ICdNb25nb0Vycm9yJyAmJiBlcnJvci5jb2RlID09PSAxMTAwMCkge1xuICAgIG5leHQobmV3IEVycm9yKCdUaGVyZSB3YXMgYSBkdXBsaWNhdGUga2V5IGVycm9yJykpXG4gIH0gZWxzZSB7XG4gICAgbmV4dChlcnJvcilcbiAgfVxufSlcblxuQ29tbWVudHNTY2hlbWEuc3RhdGljcyA9IHtcbiAgZmluZEJ5VGlkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHsgdGlkOiBpZCB9KVxuICB9LFxuICBmaW5kQnlDaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmRPbmUoeyBfaWQ6IGlkIH0pXG4gIH0sXG4gIGdldENvbW1lbnRzTGlzdDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB0aWQ6IGlkIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICdjdWlkJyxcbiAgICAgIHNlbGVjdDogJ19pZCBuYW1lIHBpYyBpc1ZpcCcsXG4gICAgICBtYXRjaDogeyBzdGF0dXM6IHsgJGVxOiAnMCcgfSB9XG4gICAgfSkucG9wdWxhdGUoe1xuICAgICAgcGF0aDogJ3RpZCcsXG4gICAgICBzZWxlY3Q6ICdfaWQgdGl0bGUgc3RhdHVzJ1xuICAgIH0pLnNraXAocGFnZSAqIGxpbWl0KS5saW1pdChsaW1pdClcbiAgfSxcbiAgcXVlcnlDb3VudDogZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IHRpZDogaWQgfSkuY291bnREb2N1bWVudHMoKVxuICB9LFxuICBnZXRDb21tZXRzUHVibGljOiBmdW5jdGlvbiAoaWQsIHBhZ2UsIGxpbWl0KSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IGN1aWQ6IGlkIH0pXG4gICAgICAucG9wdWxhdGUoe1xuICAgICAgICBwYXRoOiAndGlkJyxcbiAgICAgICAgc2VsZWN0OiAnX2lkIHRpdGxlJ1xuICAgICAgfSlcbiAgICAgIC5za2lwKHBhZ2UgKiBsaW1pdClcbiAgICAgIC5saW1pdChsaW1pdClcbiAgICAgIC5zb3J0KHsgY3JlYXRlZDogLTEgfSlcbiAgfSxcbiAgZ2V0TXNnTGlzdDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoe1xuICAgICAgdWlkOiBpZCxcbiAgICAgIGN1aWQ6IHsgJG5lOiBpZCB9LFxuICAgICAgaXNSZWFkOiB7ICRlcTogJzAnIH0sIC8vIOacquivu+eKtuaAgVxuICAgICAgc3RhdHVzOiB7ICRlcTogJzEnIH0gLy8g5piv5ZCm5pi+56S6XG4gICAgfSlcbiAgICAgIC5wb3B1bGF0ZSh7XG4gICAgICAgIHBhdGg6ICd0aWQnLFxuICAgICAgICBzZWxlY3Q6ICdfaWQgdGl0bGUnXG4gICAgICB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ3VpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCBuYW1lJ1xuICAgICAgfSlcbiAgICAgIC5wb3B1bGF0ZSh7XG4gICAgICAgIHBhdGg6ICdjdWlkJyxcbiAgICAgICAgc2VsZWN0OiAnX2lkIG5hbWUnXG4gICAgICB9KVxuICAgICAgLnNraXAobGltaXQgKiBwYWdlKVxuICAgICAgLmxpbWl0KGxpbWl0KVxuICAgICAgLnNvcnQoeyBjcmVhdGVkOiAtMSB9KVxuICB9LFxuICBnZXRUb3RhbDogZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IHVpZDogaWQsIGlzUmVhZDogJzAnLCBzdGF0dXM6ICcxJyB9KS5jb3VudERvY3VtZW50cygpXG4gIH1cbiAgLy8gZ2V0TXNnTGlzdDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAvLyAgIHJldHVybiB0aGlzLmFnZ3JlZ2F0ZShbXG4gIC8vICAgICB7XG4gIC8vICAgICAgICRsb29rdXA6IHtcbiAgLy8gICAgICAgICBmcm9tOiAncG9zdHMnLFxuICAvLyAgICAgICAgIGxldDogeyBwaWQ6IHsgJHRvT2JqZWN0SWQ6ICckdGlkJyB9IH0sXG4gIC8vICAgICAgICAgcGlwZWxpbmU6IFtcbiAgLy8gICAgICAgICAgIHsgJG1hdGNoOiB7ICRleHByOiB7ICRlcTogWyckX2lkJywgJyQkcGlkJ10gfSB9IH0sXG4gIC8vICAgICAgICAgICB7ICRwcm9qZWN0OiB7IF9pZDogMSwgdWlkOiAxLCBjb250ZW50OiAxIH0gfVxuICAvLyAgICAgICAgIF0sXG4gIC8vICAgICAgICAgYXM6ICdwb3N0J1xuICAvLyAgICAgICB9XG4gIC8vICAgICB9LFxuICAvLyAgICAge1xuICAvLyAgICAgICAkcmVwbGFjZVJvb3Q6IHtcbiAgLy8gICAgICAgICBuZXdSb290OiB7XG4gIC8vICAgICAgICAgICAkbWVyZ2VPYmplY3RzOiBbeyAkYXJyYXlFbGVtQXQ6IFsnJHBvc3QnLCAwXSB9LCAnJCRST09UJ11cbiAgLy8gICAgICAgICB9XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH0sXG4gIC8vICAgICB7ICRhZGRGaWVsZHM6IHsgdXNlcklkOiB7ICR0b09iamVjdElkOiAnJHVpZCcgfSB9IH0sXG4gIC8vICAgICB7ICRsb29rdXA6IHsgZnJvbTogJ3VzZXJzJywgbG9jYWxGaWVsZDogJ3VzZXJJZCcsIGZvcmVpZ25GaWVsZDogJ19pZCcsIGFzOiAndHVpZCcgfSB9LFxuICAvLyAgICAgeyAkdW53aW5kOiAnJHR1aWQnIH0sXG4gIC8vICAgICB7ICRhZGRGaWVsZHM6IHsgZnVzZXJJZDogeyAkdG9PYmplY3RJZDogJyRjdWlkJyB9IH0gfSxcbiAgLy8gICAgIHsgJGxvb2t1cDogeyBmcm9tOiAndXNlcnMnLCBsb2NhbEZpZWxkOiAnZnVzZXJJZCcsIGZvcmVpZ25GaWVsZDogJ19pZCcsIGFzOiAnZnVpZCcgfSB9LFxuICAvLyAgICAgeyAkdW53aW5kOiAnJGZ1aWQnIH0sXG4gIC8vICAgICB7ICRwcm9qZWN0OiB7IHBvc3Q6IDAsIHR1aWQ6IHsgdXNlcm5hbWU6IDAsIHBhc3N3b3JkOiAwIH0sIGZ1aWQ6IHsgdXNlcm5hbWU6IDAsIHBhc3N3b3JkOiAwIH0sIHVzZXJJZDogMCwgZnVzZXJJZDogMCwgdGlkOiAwLCBjdWlkOiAwIH0gfSxcbiAgLy8gICAgIHsgJG1hdGNoOiB7IHVpZDogaWQsIHN0YXR1czogJzEnLCBpc1JlYWQ6ICcwJyB9IH1cbiAgLy8gICBdKVxuICAvLyAgICAgLnNraXAobGltaXQgKiBwYWdlKVxuICAvLyAgICAgLmxpbWl0KGxpbWl0KVxuICAvLyAgICAgLnNvcnQoeyBjcmVhdGVkOiAtMSB9KVxuICAvLyB9XG59XG5cbmNvbnN0IENvbW1lbnRzID0gbW9uZ29vc2UubW9kZWwoJ2NvbW1lbnRzJywgQ29tbWVudHNTY2hlbWEpXG5cbmV4cG9ydCBkZWZhdWx0IENvbW1lbnRzXG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Comment.js"
      ],
      "names": [
        "Schema",
        "mongoose",
        "CommentsSchema",
        "tid",
        "type",
        "String",
        "ref",
        "uid",
        "cuid",
        "content",
        "created",
        "Date",
        "hands",
        "Number",
        "default",
        "status",
        "isRead",
        "isBest",
        "toJSON",
        "virtuals",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "findByTid",
        "id",
        "find",
        "findByCid",
        "findOne",
        "_id",
        "getCommentsList",
        "page",
        "limit",
        "populate",
        "path",
        "select",
        "match",
        "$eq",
        "skip",
        "queryCount",
        "countDocuments",
        "getCommetsPublic",
        "sort",
        "getMsgList",
        "$ne",
        "getTotal",
        "Comments",
        "model"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "import mongoose from '../config/DBHelpler'\n\nconst Schema = mongoose.Schema\n\nconst CommentsSchema = new Schema({\n  tid: { type: String, ref: 'post' },\n  uid: { type: String, ref: 'users' },\n  cuid: { type: String, ref: 'users' },\n  content: { type: String },\n  created: { type: Date },\n  hands: { type: Number, default: 0 },\n  status: { type: String, default: '1' },\n  isRead: { type: String, default: '0' },\n  isBest: { type: String, default: '0' }\n}, { toJSON: { virtuals: true } })\n\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date()\n  next()\n})\n\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'))\n  } else {\n    next(error)\n  }\n})\n\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({ tid: id })\n  },\n  findByCid: function (id) {\n    return this.findOne({ _id: id })\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({ tid: id }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: { status: { $eq: '0' } }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit)\n  },\n  queryCount: function (id) {\n    return this.find({ tid: id }).countDocuments()\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({ cuid: id })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      cuid: { $ne: id },\n      isRead: { $eq: '0' }, // 未读状态\n      status: { $eq: '1' } // 是否显示\n    })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .populate({\n        path: 'uid',\n        select: '_id name'\n      })\n      .populate({\n        path: 'cuid',\n        select: '_id name'\n      })\n      .skip(limit * page)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getTotal: function (id) {\n    return this.find({ uid: id, isRead: '0', status: '1' }).countDocuments()\n  }\n  // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n}\n\nconst Comments = mongoose.model('comments', CommentsSchema)\n\nexport default Comments\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1585748377773
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comments.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comments.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comments.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comments.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "Comments.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nconst mongoose = require('../config/DBHelper');\n\nconst Schema = mongoose.Schema;\nconst CommentsSchema = new Schema({\n  tid: {\n    type: String,\n    ref: 'post'\n  },\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  cuid: {\n    type: String,\n    ref: 'users'\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  hands: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '1'\n  },\n  isRead: {\n    type: String,\n    default: '0'\n  },\n  isBest: {\n    type: String,\n    default: '0'\n  }\n}, {\n  toJSON: {\n    virtuals: true\n  }\n});\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({\n      tid: id\n    });\n  },\n  findByCid: function (id) {\n    return this.findOne({\n      _id: id\n    });\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({\n      tid: id\n    }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: {\n        status: {\n          $eq: '0'\n        }\n      }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit);\n  },\n  queryCount: function (id) {\n    return this.find({\n      tid: id\n    }).countDocuments();\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({\n      cuid: id\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      cuid: {\n        $ne: id\n      },\n      isRead: {\n        $eq: '0'\n      },\n      // 未读状态\n      status: {\n        $eq: '1'\n      } // 是否显示\n\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).populate({\n      path: 'uid',\n      select: '_id name'\n    }).populate({\n      path: 'cuid',\n      select: '_id name'\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  getTotal: function (id) {\n    return this.find({\n      uid: id,\n      isRead: '0',\n      status: '1'\n    }).countDocuments();\n  } // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n\n};\nconst Comments = mongoose.model('comments', CommentsSchema);\nvar _default = Comments;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnRzLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIkNvbW1lbnRzU2NoZW1hIiwidGlkIiwidHlwZSIsIlN0cmluZyIsInJlZiIsInVpZCIsImN1aWQiLCJjb250ZW50IiwiY3JlYXRlZCIsIkRhdGUiLCJoYW5kcyIsIk51bWJlciIsImRlZmF1bHQiLCJzdGF0dXMiLCJpc1JlYWQiLCJpc0Jlc3QiLCJ0b0pTT04iLCJ2aXJ0dWFscyIsInByZSIsIm5leHQiLCJwb3N0IiwiZXJyb3IiLCJkb2MiLCJuYW1lIiwiY29kZSIsIkVycm9yIiwic3RhdGljcyIsImZpbmRCeVRpZCIsImlkIiwiZmluZCIsImZpbmRCeUNpZCIsImZpbmRPbmUiLCJfaWQiLCJnZXRDb21tZW50c0xpc3QiLCJwYWdlIiwibGltaXQiLCJwb3B1bGF0ZSIsInBhdGgiLCJzZWxlY3QiLCJtYXRjaCIsIiRlcSIsInNraXAiLCJxdWVyeUNvdW50IiwiY291bnREb2N1bWVudHMiLCJnZXRDb21tZXRzUHVibGljIiwic29ydCIsImdldE1zZ0xpc3QiLCIkbmUiLCJnZXRUb3RhbCIsIkNvbW1lbnRzIiwibW9kZWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUF4Qjs7QUFFQSxNQUFNQyxNQUFNLEdBQUdGLFFBQVEsQ0FBQ0UsTUFBeEI7QUFFQSxNQUFNQyxjQUFjLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQ2hDRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEMkI7QUFFaENDLEVBQUFBLEdBQUcsRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVDLE1BQVI7QUFBZ0JDLElBQUFBLEdBQUcsRUFBRTtBQUFyQixHQUYyQjtBQUdoQ0UsRUFBQUEsSUFBSSxFQUFFO0FBQUVKLElBQUFBLElBQUksRUFBRUMs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SSxDQWtCQ04sS0FBSyxHQUFHRCxJQWxCVCxFQW1CSkMsS0FuQkksQ0FtQkVBLEtBbkJGLEVBb0JKVSxJQXBCSSxDQW9CQztBQUFFckMsTUFBQUEsT0FBTyxFQUFFLENBQUM7QUFBWixLQXBCRCxDQUFQO0FBcUJELEdBcERzQjtBQXFEdkJ3QyxFQUFBQSxRQUFRLEVBQUUsVUFBVXBCLEVBQVYsRUFBYztBQUN0QixXQUFPLEtBQUtDLElBQUwsQ0FBVTtBQUFFeEIsTUFBQUEsR0FBRyxFQUFFdUIsRUFBUDtBQUFXZCxNQUFBQSxNQUFNLEVBQUUsR0FBbkI7QUFBd0JELE1BQUFBLE1BQU0sRUFBRTtBQUFoQyxLQUFWLEVBQWlEOEIsY0FBakQsRUFBUDtBQUNELEdBdkRzQixDQXdEdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQXhGdUIsQ0FBekI7QUEyRkEsTUFBTU0sUUFBUSxHQUFHcEQsUUFBUSxDQUFDcUQsS0FBVCxDQUFlLFVBQWYsRUFBMkJsRCxjQUEzQixDQUFqQjtlQUVlaUQsUSIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL2xlYXJuaW5nV29ybGQvbGVhcm4tZnJvbnQtZW5kL2tvYS1kZW1vL3NyYy9tb2RlbCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnLi4vY29uZmlnL0RCSGVscGVyJylcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IENvbW1lbnRzU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gIHRpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3Bvc3QnIH0sXG4gIHVpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3VzZXJzJyB9LFxuICBjdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIGNvbnRlbnQ6IHsgdHlwZTogU3RyaW5nIH0sXG4gIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICBoYW5kczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcbiAgc3RhdHVzOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJzEnIH0sXG4gIGlzUmVhZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9LFxuICBpc0Jlc3Q6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfVxufSwgeyB0b0pTT046IHsgdmlydHVhbHM6IHRydWUgfSB9KVxuXG5Db21tZW50c1NjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICB0aGlzLmNyZWF0ZWQgPSBuZXcgRGF0ZSgpXG4gIG5leHQoKVxufSlcblxuQ29tbWVudHNTY2hlbWEucG9zdCgnc2F2ZScsIGZ1bmN0aW9uIChlcnJvciwgZG9jLCBuZXh0KSB7XG4gIGlmIChlcnJvci5uYW1lID09PSAnTW9uZ29FcnJvcicgJiYgZXJyb3IuY29kZSA9PT0gMTEwMDApIHtcbiAgICBuZXh0KG5ldyBFcnJvcignVGhlcmUgd2FzIGEgZHVwbGljYXRlIGtleSBlcnJvcicpKVxuICB9IGVsc2Uge1xuICAgIG5leHQoZXJyb3IpXG4gIH1cbn0pXG5cbkNvbW1lbnRzU2NoZW1hLnN0YXRpY3MgPSB7XG4gIGZpbmRCeVRpZDogZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IHRpZDogaWQgfSlcbiAgfSxcbiAgZmluZEJ5Q2lkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHsgX2lkOiBpZCB9KVxuICB9LFxuICBnZXRDb21tZW50c0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHsgdGlkOiBpZCB9KS5wb3B1bGF0ZSh7XG4gICAgICBwYXRoOiAnY3VpZCcsXG4gICAgICBzZWxlY3Q6ICdfaWQgbmFtZSBwaWMgaXNWaXAnLFxuICAgICAgbWF0Y2g6IHsgc3RhdHVzOiB7ICRlcTogJzAnIH0gfVxuICAgIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICd0aWQnLFxuICAgICAgc2VsZWN0OiAnX2lkIHRpdGxlIHN0YXR1cydcbiAgICB9KS5za2lwKHBhZ2UgKiBsaW1pdCkubGltaXQobGltaXQpXG4gIH0sXG4gIHF1ZXJ5Q291bnQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB0aWQ6IGlkIH0pLmNvdW50RG9jdW1lbnRzKClcbiAgfSxcbiAgZ2V0Q29tbWV0c1B1YmxpYzogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyBjdWlkOiBpZCB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ3RpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCB0aXRsZSdcbiAgICAgIH0pXG4gICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG4gIGdldE1zZ0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHtcbiAgICAgIHVpZDogaWQsXG4gICAgICBjdWlkOiB7ICRuZTogaWQgfSxcbiAgICAgIGlzUmVhZDogeyAkZXE6ICcwJyB9LCAvLyDmnKror7vnirbmgIFcbiAgICAgIHN0YXR1czogeyAkZXE6ICcxJyB9IC8vIOaYr+WQpuaYvuekulxuICAgIH0pXG4gICAgICAucG9wdWxhdGUoe1xuICAgICAgICBwYXRoOiAndGlkJyxcbiAgICAgICAgc2VsZWN0OiAnX2lkIHRpdGxlJ1xuICAgICAgfSlcbiAgICAgIC5wb3B1bGF0ZSh7XG4gICAgICAgIHBhdGg6ICd1aWQnLFxuICAgICAgICBzZWxlY3Q6ICdfaWQgbmFtZSdcbiAgICAgIH0pXG4gICAgICAucG9wdWxhdGUoe1xuICAgICAgICBwYXRoOiAnY3VpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCBuYW1lJ1xuICAgICAgfSlcbiAgICAgIC5za2lwKGxpbWl0ICogcGFnZSlcbiAgICAgIC5saW1pdChsaW1pdClcbiAgICAgIC5zb3J0KHsgY3JlYXRlZDogLTEgfSlcbiAgfSxcbiAgZ2V0VG90YWw6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkLCBpc1JlYWQ6ICcwJywgc3RhdHVzOiAnMScgfSkuY291bnREb2N1bWVudHMoKVxuICB9XG4gIC8vIGdldE1zZ0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgLy8gICByZXR1cm4gdGhpcy5hZ2dyZWdhdGUoW1xuICAvLyAgICAge1xuICAvLyAgICAgICAkbG9va3VwOiB7XG4gIC8vICAgICAgICAgZnJvbTogJ3Bvc3RzJyxcbiAgLy8gICAgICAgICBsZXQ6IHsgcGlkOiB7ICR0b09iamVjdElkOiAnJHRpZCcgfSB9LFxuICAvLyAgICAgICAgIHBpcGVsaW5lOiBbXG4gIC8vICAgICAgICAgICB7ICRtYXRjaDogeyAkZXhwcjogeyAkZXE6IFsnJF9pZCcsICckJHBpZCddIH0gfSB9LFxuICAvLyAgICAgICAgICAgeyAkcHJvamVjdDogeyBfaWQ6IDEsIHVpZDogMSwgY29udGVudDogMSB9IH1cbiAgLy8gICAgICAgICBdLFxuICAvLyAgICAgICAgIGFzOiAncG9zdCdcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfSxcbiAgLy8gICAgIHtcbiAgLy8gICAgICAgJHJlcGxhY2VSb290OiB7XG4gIC8vICAgICAgICAgbmV3Um9vdDoge1xuICAvLyAgICAgICAgICAgJG1lcmdlT2JqZWN0czogW3sgJGFycmF5RWxlbUF0OiBbJyRwb3N0JywgMF0gfSwgJyQkUk9PVCddXG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICB9XG4gIC8vICAgICB9LFxuICAvLyAgICAgeyAkYWRkRmllbGRzOiB7IHVzZXJJZDogeyAkdG9PYmplY3RJZDogJyR1aWQnIH0gfSB9LFxuICAvLyAgICAgeyAkbG9va3VwOiB7IGZyb206ICd1c2VycycsIGxvY2FsRmllbGQ6ICd1c2VySWQnLCBmb3JlaWduRmllbGQ6ICdfaWQnLCBhczogJ3R1aWQnIH0gfSxcbiAgLy8gICAgIHsgJHVud2luZDogJyR0dWlkJyB9LFxuICAvLyAgICAgeyAkYWRkRmllbGRzOiB7IGZ1c2VySWQ6IHsgJHRvT2JqZWN0SWQ6ICckY3VpZCcgfSB9IH0sXG4gIC8vICAgICB7ICRsb29rdXA6IHsgZnJvbTogJ3VzZXJzJywgbG9jYWxGaWVsZDogJ2Z1c2VySWQnLCBmb3JlaWduRmllbGQ6ICdfaWQnLCBhczogJ2Z1aWQnIH0gfSxcbiAgLy8gICAgIHsgJHVud2luZDogJyRmdWlkJyB9LFxuICAvLyAgICAgeyAkcHJvamVjdDogeyBwb3N0OiAwLCB0dWlkOiB7IHVzZXJuYW1lOiAwLCBwYXNzd29yZDogMCB9LCBmdWlkOiB7IHVzZXJuYW1lOiAwLCBwYXNzd29yZDogMCB9LCB1c2VySWQ6IDAsIGZ1c2VySWQ6IDAsIHRpZDogMCwgY3VpZDogMCB9IH0sXG4gIC8vICAgICB7ICRtYXRjaDogeyB1aWQ6IGlkLCBzdGF0dXM6ICcxJywgaXNSZWFkOiAnMCcgfSB9XG4gIC8vICAgXSlcbiAgLy8gICAgIC5za2lwKGxpbWl0ICogcGFnZSlcbiAgLy8gICAgIC5saW1pdChsaW1pdClcbiAgLy8gICAgIC5zb3J0KHsgY3JlYXRlZDogLTEgfSlcbiAgLy8gfVxufVxuXG5jb25zdCBDb21tZW50cyA9IG1vbmdvb3NlLm1vZGVsKCdjb21tZW50cycsIENvbW1lbnRzU2NoZW1hKVxuXG5leHBvcnQgZGVmYXVsdCBDb21tZW50c1xuIl19",
    "map": {
      "version": 3,
      "sources": [
        "Comments.js"
      ],
      "names": [
        "mongoose",
        "require",
        "Schema",
        "CommentsSchema",
        "tid",
        "type",
        "String",
        "ref",
        "uid",
        "cuid",
        "content",
        "created",
        "Date",
        "hands",
        "Number",
        "default",
        "status",
        "isRead",
        "isBest",
        "toJSON",
        "virtuals",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "findByTid",
        "id",
        "find",
        "findByCid",
        "findOne",
        "_id",
        "getCommentsList",
        "page",
        "limit",
        "populate",
        "path",
        "select",
        "match",
        "$eq",
        "skip",
        "queryCount",
        "countDocuments",
        "getCommetsPublic",
        "sort",
        "getMsgList",
        "$ne",
        "getTotal",
        "Comments",
        "model"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\n\nconst Schema = mongoose.Schema\n\nconst CommentsSchema = new Schema({\n  tid: { type: String, ref: 'post' },\n  uid: { type: String, ref: 'users' },\n  cuid: { type: String, ref: 'users' },\n  content: { type: String },\n  created: { type: Date },\n  hands: { type: Number, default: 0 },\n  status: { type: String, default: '1' },\n  isRead: { type: String, default: '0' },\n  isBest: { type: String, default: '0' }\n}, { toJSON: { virtuals: true } })\n\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date()\n  next()\n})\n\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'))\n  } else {\n    next(error)\n  }\n})\n\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({ tid: id })\n  },\n  findByCid: function (id) {\n    return this.findOne({ _id: id })\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({ tid: id }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: { status: { $eq: '0' } }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit)\n  },\n  queryCount: function (id) {\n    return this.find({ tid: id }).countDocuments()\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({ cuid: id })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      cuid: { $ne: id },\n      isRead: { $eq: '0' }, // 未读状态\n      status: { $eq: '1' } // 是否显示\n    })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .populate({\n        path: 'uid',\n        select: '_id name'\n      })\n      .populate({\n        path: 'cuid',\n        select: '_id name'\n      })\n      .skip(limit * page)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getTotal: function (id) {\n    return this.find({ uid: id, isRead: '0', status: '1' }).countDocuments()\n  }\n  // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n}\n\nconst Comments = mongoose.model('comments', CommentsSchema)\n\nexport default Comments\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1585748729153
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"filename\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comments.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/learningWorld/learn-front-end/koa-demo\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comments.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comments.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model/Comments.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
        "sourceFileName": "Comments.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst Schema = mongoose.Schema;\nconst CommentsSchema = new Schema({\n  tid: {\n    type: String,\n    ref: 'post'\n  },\n  uid: {\n    type: String,\n    ref: 'user'\n  },\n  cuid: {\n    type: String,\n    ref: 'user'\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  hands: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '1'\n  },\n  isRead: {\n    type: String,\n    default: '0'\n  },\n  isBest: {\n    type: String,\n    default: '0'\n  }\n}, {\n  toJSON: {\n    virtuals: true\n  }\n});\nCommentsSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n});\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({\n      tid: id\n    });\n  },\n  findByCid: function (id) {\n    return this.findOne({\n      _id: id\n    });\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({\n      tid: id\n    }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: {\n        status: {\n          $eq: '0'\n        }\n      }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit);\n  },\n  queryCount: function (id) {\n    return this.find({\n      tid: id\n    }).countDocuments();\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({\n      cuid: id\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      cuid: {\n        $ne: id\n      },\n      isRead: {\n        $eq: '0'\n      },\n      // 未读状态\n      status: {\n        $eq: '1'\n      } // 是否显示\n\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).populate({\n      path: 'uid',\n      select: '_id name'\n    }).populate({\n      path: 'cuid',\n      select: '_id name'\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  getTotal: function (id) {\n    return this.find({\n      uid: id,\n      isRead: '0',\n      status: '1'\n    }).countDocuments();\n  } // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n\n};\nconst Comments = mongoose.model('comments', CommentsSchema);\nmodule.exports = Comments;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnRzLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIkNvbW1lbnRzU2NoZW1hIiwidGlkIiwidHlwZSIsIlN0cmluZyIsInJlZiIsInVpZCIsImN1aWQiLCJjb250ZW50IiwiY3JlYXRlZCIsIkRhdGUiLCJoYW5kcyIsIk51bWJlciIsImRlZmF1bHQiLCJzdGF0dXMiLCJpc1JlYWQiLCJpc0Jlc3QiLCJ0b0pTT04iLCJ2aXJ0dWFscyIsInZpcnR1YWwiLCJsb2NhbEZpZWxkIiwiZm9yZWlnbkZpZWxkIiwicHJlIiwibmV4dCIsInBvc3QiLCJlcnJvciIsImRvYyIsIm5hbWUiLCJjb2RlIiwiRXJyb3IiLCJzdGF0aWNzIiwiZmluZEJ5VGlkIiwiaWQiLCJmaW5kIiwiZmluZEJ5Q2lkIiwiZmluZE9uZSIsIl9pZCIsImdldENvbW1lbnRzTGlzdCIsInBhZ2UiLCJsaW1pdCIsInBvcHVsYXRlIiwicGF0aCIsInNlbGVjdCIsIm1hdGNoIiwiJGVxIiwic2tpcCIsInF1ZXJ5Q291bnQiLCJjb3VudERvY3VtZW50cyIsImdldENvbW1ldHNQdWJsaWMiLCJzb3J0IiwiZ2V0TXNnTGlzdCIsIiRuZSIsImdldFRvdGFsIiwiQ29tbWVudHMiLCJtb2RlbCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsb0JBQUQsQ0FBeEI7O0FBRUEsTUFBTUMsTUFBTSxHQUFHRixRQUFRLENBQUNFLE1BQXhCO0FBRUEsTUFBTUMsY0FBYyxHQUFHLElBQUlELE1BQUosQ0FBVztBQUNoQ0UsRUFBQUEsR0FBRyxFQUFFO0FBQUVDLElBQUFBLElBQUksRUFBRUMsTUFBUjtBQUFnQkMsSUFBQUEsR0FBRyxFQUFFO0FBQXJCLEdBRDJCO0FBRWhDQyxFQUFBQSxHQUFHLEVBQUU7QUFBRUgsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIs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TUFBQUEsTUFBTSxFQUFFO0FBRkEsS0FOTCxFQVVKRixRQVZJLENBVUs7QUFDUkMsTUFBQUEsSUFBSSxFQUFFLEtBREU7QUFFUkMsTUFBQUEsTUFBTSxFQUFFO0FBRkEsS0FWTCxFQWNKRixRQWRJLENBY0s7QUFDUkMsTUFBQUEsSUFBSSxFQUFFLE1BREU7QUFFUkMsTUFBQUEsTUFBTSxFQUFFO0FBRkEsS0FkTCxFQWtCSkcsSUFsQkksQ0FrQkNOLEtBQUssR0FBR0QsSUFsQlQsRUFtQkpDLEtBbkJJLENBbUJFQSxLQW5CRixFQW9CSlUsSUFwQkksQ0FvQkM7QUFBRXhDLE1BQUFBLE9BQU8sRUFBRSxDQUFDO0FBQVosS0FwQkQsQ0FBUDtBQXFCRCxHQXBEc0I7QUFxRHZCMkMsRUFBQUEsUUFBUSxFQUFFLFVBQVVwQixFQUFWLEVBQWM7QUFDdEIsV0FBTyxLQUFLQyxJQUFMLENBQVU7QUFBRTNCLE1BQUFBLEdBQUcsRUFBRTBCLEVBQVA7QUFBV2pCLE1BQUFBLE1BQU0sRUFBRSxHQUFuQjtBQUF3QkQsTUFBQUEsTUFBTSxFQUFFO0FBQWhDLEtBQVYsRUFBaURpQyxjQUFqRCxFQUFQO0FBQ0QsR0F2RHNCLENBd0R2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBeEZ1QixDQUF6QjtBQTJGQSxNQUFNTSxRQUFRLEdBQUd2RCxRQUFRLENBQUN3RCxLQUFULENBQWUsVUFBZixFQUEyQnJELGNBQTNCLENBQWpCO0FBRUFzRCxNQUFNLENBQUNDLE9BQVAsR0FBaUJILFFBQWpCIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbGVhcm5pbmdXb3JsZC9sZWFybi1mcm9udC1lbmQva29hLWRlbW8vc3JjL21vZGVsIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCcuLi9jb25maWcvREJIZWxwZXInKVxuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWFcblxuY29uc3QgQ29tbWVudHNTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdGlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAncG9zdCcgfSxcbiAgdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcicgfSxcbiAgY3VpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3VzZXInIH0sXG4gIGNvbnRlbnQ6IHsgdHlwZTogU3RyaW5nIH0sXG4gIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICBoYW5kczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcbiAgc3RhdHVzOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJzEnIH0sXG4gIGlzUmVhZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9LFxuICBpc0Jlc3Q6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfVxufSwgeyB0b0pTT046IHsgdmlydHVhbHM6IHRydWUgfSB9KVxuXG5Db21tZW50c1NjaGVtYS52aXJ0dWFsKCd1c2VyJywge1xuICByZWY6ICd1c2VycycsXG4gIGxvY2FsRmllbGQ6ICd1aWQnLFxuICBmb3JlaWduRmllbGQ6ICdfaWQnXG59KVxuXG5Db21tZW50c1NjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICB0aGlzLmNyZWF0ZWQgPSBuZXcgRGF0ZSgpXG4gIG5leHQoKVxufSlcblxuQ29tbWVudHNTY2hlbWEucG9zdCgnc2F2ZScsIGZ1bmN0aW9uIChlcnJvciwgZG9jLCBuZXh0KSB7XG4gIGlmIChlcnJvci5uYW1lID09PSAnTW9uZ29FcnJvcicgJiYgZXJyb3IuY29kZSA9PT0gMTEwMDApIHtcbiAgICBuZXh0KG5ldyBFcnJvcignVGhlcmUgd2FzIGEgZHVwbGljYXRlIGtleSBlcnJvcicpKVxuICB9IGVsc2Uge1xuICAgIG5leHQoZXJyb3IpXG4gIH1cbn0pXG5cbkNvbW1lbnRzU2NoZW1hLnN0YXRpY3MgPSB7XG4gIGZpbmRCeVRpZDogZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IHRpZDogaWQgfSlcbiAgfSxcbiAgZmluZEJ5Q2lkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHsgX2lkOiBpZCB9KVxuICB9LFxuICBnZXRDb21tZW50c0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHsgdGlkOiBpZCB9KS5wb3B1bGF0ZSh7XG4gICAgICBwYXRoOiAnY3VpZCcsXG4gICAgICBzZWxlY3Q6ICdfaWQgbmFtZSBwaWMgaXNWaXAnLFxuICAgICAgbWF0Y2g6IHsgc3RhdHVzOiB7ICRlcTogJzAnIH0gfVxuICAgIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICd0aWQnLFxuICAgICAgc2VsZWN0OiAnX2lkIHRpdGxlIHN0YXR1cydcbiAgICB9KS5za2lwKHBhZ2UgKiBsaW1pdCkubGltaXQobGltaXQpXG4gIH0sXG4gIHF1ZXJ5Q291bnQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB0aWQ6IGlkIH0pLmNvdW50RG9jdW1lbnRzKClcbiAgfSxcbiAgZ2V0Q29tbWV0c1B1YmxpYzogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyBjdWlkOiBpZCB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ3RpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCB0aXRsZSdcbiAgICAgIH0pXG4gICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG4gIGdldE1zZ0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHtcbiAgICAgIHVpZDogaWQsXG4gICAgICBjdWlkOiB7ICRuZTogaWQgfSxcbiAgICAgIGlzUmVhZDogeyAkZXE6ICcwJyB9LCAvLyDmnKror7vnirbmgIFcbiAgICAgIHN0YXR1czogeyAkZXE6ICcxJyB9IC8vIOaYr+WQpuaYvuekulxuICAgIH0pXG4gICAgICAucG9wdWxhdGUoe1xuICAgICAgICBwYXRoOiAndGlkJyxcbiAgICAgICAgc2VsZWN0OiAnX2lkIHRpdGxlJ1xuICAgICAgfSlcbiAgICAgIC5wb3B1bGF0ZSh7XG4gICAgICAgIHBhdGg6ICd1aWQnLFxuICAgICAgICBzZWxlY3Q6ICdfaWQgbmFtZSdcbiAgICAgIH0pXG4gICAgICAucG9wdWxhdGUoe1xuICAgICAgICBwYXRoOiAnY3VpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCBuYW1lJ1xuICAgICAgfSlcbiAgICAgIC5za2lwKGxpbWl0ICogcGFnZSlcbiAgICAgIC5saW1pdChsaW1pdClcbiAgICAgIC5zb3J0KHsgY3JlYXRlZDogLTEgfSlcbiAgfSxcbiAgZ2V0VG90YWw6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkLCBpc1JlYWQ6ICcwJywgc3RhdHVzOiAnMScgfSkuY291bnREb2N1bWVudHMoKVxuICB9XG4gIC8vIGdldE1zZ0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgLy8gICByZXR1cm4gdGhpcy5hZ2dyZWdhdGUoW1xuICAvLyAgICAge1xuICAvLyAgICAgICAkbG9va3VwOiB7XG4gIC8vICAgICAgICAgZnJvbTogJ3Bvc3RzJyxcbiAgLy8gICAgICAgICBsZXQ6IHsgcGlkOiB7ICR0b09iamVjdElkOiAnJHRpZCcgfSB9LFxuICAvLyAgICAgICAgIHBpcGVsaW5lOiBbXG4gIC8vICAgICAgICAgICB7ICRtYXRjaDogeyAkZXhwcjogeyAkZXE6IFsnJF9pZCcsICckJHBpZCddIH0gfSB9LFxuICAvLyAgICAgICAgICAgeyAkcHJvamVjdDogeyBfaWQ6IDEsIHVpZDogMSwgY29udGVudDogMSB9IH1cbiAgLy8gICAgICAgICBdLFxuICAvLyAgICAgICAgIGFzOiAncG9zdCdcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfSxcbiAgLy8gICAgIHtcbiAgLy8gICAgICAgJHJlcGxhY2VSb290OiB7XG4gIC8vICAgICAgICAgbmV3Um9vdDoge1xuICAvLyAgICAgICAgICAgJG1lcmdlT2JqZWN0czogW3sgJGFycmF5RWxlbUF0OiBbJyRwb3N0JywgMF0gfSwgJyQkUk9PVCddXG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICB9XG4gIC8vICAgICB9LFxuICAvLyAgICAgeyAkYWRkRmllbGRzOiB7IHVzZXJJZDogeyAkdG9PYmplY3RJZDogJyR1aWQnIH0gfSB9LFxuICAvLyAgICAgeyAkbG9va3VwOiB7IGZyb206ICd1c2VycycsIGxvY2FsRmllbGQ6ICd1c2VySWQnLCBmb3JlaWduRmllbGQ6ICdfaWQnLCBhczogJ3R1aWQnIH0gfSxcbiAgLy8gICAgIHsgJHVud2luZDogJyR0dWlkJyB9LFxuICAvLyAgICAgeyAkYWRkRmllbGRzOiB7IGZ1c2VySWQ6IHsgJHRvT2JqZWN0SWQ6ICckY3VpZCcgfSB9IH0sXG4gIC8vICAgICB7ICRsb29rdXA6IHsgZnJvbTogJ3VzZXJzJywgbG9jYWxGaWVsZDogJ2Z1c2VySWQnLCBmb3JlaWduRmllbGQ6ICdfaWQnLCBhczogJ2Z1aWQnIH0gfSxcbiAgLy8gICAgIHsgJHVud2luZDogJyRmdWlkJyB9LFxuICAvLyAgICAgeyAkcHJvamVjdDogeyBwb3N0OiAwLCB0dWlkOiB7IHVzZXJuYW1lOiAwLCBwYXNzd29yZDogMCB9LCBmdWlkOiB7IHVzZXJuYW1lOiAwLCBwYXNzd29yZDogMCB9LCB1c2VySWQ6IDAsIGZ1c2VySWQ6IDAsIHRpZDogMCwgY3VpZDogMCB9IH0sXG4gIC8vICAgICB7ICRtYXRjaDogeyB1aWQ6IGlkLCBzdGF0dXM6ICcxJywgaXNSZWFkOiAnMCcgfSB9XG4gIC8vICAgXSlcbiAgLy8gICAgIC5za2lwKGxpbWl0ICogcGFnZSlcbiAgLy8gICAgIC5saW1pdChsaW1pdClcbiAgLy8gICAgIC5zb3J0KHsgY3JlYXRlZDogLTEgfSlcbiAgLy8gfVxufVxuXG5jb25zdCBDb21tZW50cyA9IG1vbmdvb3NlLm1vZGVsKCdjb21tZW50cycsIENvbW1lbnRzU2NoZW1hKVxuXG5tb2R1bGUuZXhwb3J0cyA9IENvbW1lbnRzXG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Comments.js"
      ],
      "names": [
        "mongoose",
        "require",
        "Schema",
        "CommentsSchema",
        "tid",
        "type",
        "String",
        "ref",
        "uid",
        "cuid",
        "content",
        "created",
        "Date",
        "hands",
        "Number",
        "default",
        "status",
        "isRead",
        "isBest",
        "toJSON",
        "virtuals",
        "virtual",
        "localField",
        "foreignField",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "findByTid",
        "id",
        "find",
        "findByCid",
        "findOne",
        "_id",
        "getCommentsList",
        "page",
        "limit",
        "populate",
        "path",
        "select",
        "match",
        "$eq",
        "skip",
        "queryCount",
        "countDocuments",
        "getCommetsPublic",
        "sort",
        "getMsgList",
        "$ne",
        "getTotal",
        "Comments",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/learningWorld/learn-front-end/koa-demo/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\n\nconst Schema = mongoose.Schema\n\nconst CommentsSchema = new Schema({\n  tid: { type: String, ref: 'post' },\n  uid: { type: String, ref: 'user' },\n  cuid: { type: String, ref: 'user' },\n  content: { type: String },\n  created: { type: Date },\n  hands: { type: Number, default: 0 },\n  status: { type: String, default: '1' },\n  isRead: { type: String, default: '0' },\n  isBest: { type: String, default: '0' }\n}, { toJSON: { virtuals: true } })\n\nCommentsSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n})\n\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date()\n  next()\n})\n\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'))\n  } else {\n    next(error)\n  }\n})\n\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({ tid: id })\n  },\n  findByCid: function (id) {\n    return this.findOne({ _id: id })\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({ tid: id }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: { status: { $eq: '0' } }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit)\n  },\n  queryCount: function (id) {\n    return this.find({ tid: id }).countDocuments()\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({ cuid: id })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      cuid: { $ne: id },\n      isRead: { $eq: '0' }, // 未读状态\n      status: { $eq: '1' } // 是否显示\n    })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .populate({\n        path: 'uid',\n        select: '_id name'\n      })\n      .populate({\n        path: 'cuid',\n        select: '_id name'\n      })\n      .skip(limit * page)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getTotal: function (id) {\n    return this.find({ uid: id, isRead: '0', status: '1' }).countDocuments()\n  }\n  // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n}\n\nconst Comments = mongoose.model('comments', CommentsSchema)\n\nmodule.exports = Comments\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1585756419557
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/index.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst koa = require('koa');\n\nconst helmet = require('koa-helmet');\n\nconst statics = require('koa-static');\n\nconst cors = require('@koa/cors');\n\nconst JWT = require('koa-jwt');\n\nconst compress = require('koa-compress');\n\nconst path = require('path');\n\nconst koaBody = require('koa-body');\n\nconst jsonutil = require('koa-json');\n\nconst compose = require('koa-compose');\n\nconst router = require('./routes/routes');\n\nconst config = require('./config/index');\n\nconst errorHandle = require('./common/ErrorHandle');\n\nconst WebSocketServer = require('./config/WebSocket');\n\nconst app = new koa();\nconst ws = new WebSocketServer();\nws.init();\nglobal.ws = ws;\nconst isDevMode = process.env.NODE_ENV === 'production' ? false : true; //除了公共路径，其他路径都需要鉴权\n\nconst jwt = JWT({\n  secret: config.JWT_SECRET\n}).unless({\n  path: [/^\\/public/, /^\\/login/, /^\\/img/]\n});\nconst middleware = compose([koaBody({\n  multipart: true,\n  formidable: {\n    keepExtensions: true,\n    maxFieldsSize: 5 * 1024 * 1024\n  },\n  onError: err => {\n    console.log('koabody TCL:err', err);\n  }\n}), statics(path.join(__dirname, '../public')), cors(), jsonutil({\n  pretty: false,\n  param: 'pretty'\n}), helmet(), errorHandle, jwt]);\n\nif (!isDevMode) {\n  app.use(compress());\n}\n\napp.use(middleware); // app.use(statics(path.join(__dirname,'../public')))\n\napp.use(router());\napp.listen(3000);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImtvYSIsInJlcXVpcmUiLCJoZWxtZXQiLCJzdGF0aWNzIiwiY29ycyIsIkpXVCIsImNvbXByZXNzIiwicGF0aCIsImtvYUJvZHkiLCJqc29udXRpbCIsImNvbXBvc2UiLCJyb3V0ZXIiLCJjb25maWciLCJlcnJvckhhbmRsZSIsIldlYlNvY2tldFNlcnZlciIsImFwcCIsIndzIiwiaW5pdCIsImdsb2JhbCIsImlzRGV2TW9kZSIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImp3dCIsInNlY3JldCIsIkpXVF9TRUNSRVQiLCJ1bmxlc3MiLCJtaWRkbGV3YXJlIiwibXVsdGlwYXJ0IiwiZm9ybWlkYWJsZSIsImtlZXBFeHRlbnNpb25zIiwibWF4RmllbGRzU2l6ZSIsIm9uRXJyb3IiLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiam9pbiIsIl9fZGlybmFtZSIsInByZXR0eSIsInBhcmFtIiwidXNlIiwibGlzdGVuIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLEdBQUcsR0FBQ0MsT0FBTyxDQUFDLEtBQUQsQ0FBakI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFDRCxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNRSxPQUFPLEdBQUNGLE9BQU8sQ0FBQyxZQUFELENBQXJCOztBQUNBLE1BQU1HLElBQUksR0FBQ0gsT0FBTyxDQUFDLFdBQUQsQ0FBbEI7O0FBQ0EsTUFBTUksR0FBRyxHQUFDSixPQUFPLENBQUMsU0FBRCxDQUFqQjs7QUFDQSxNQUFNSyxRQUFRLEdBQUNMLE9BQU8sQ0FBQyxjQUFELENBQXRCOztBQUNBLE1BQU1NLElBQUksR0FBQ04sT0FBTyxDQUFDLE1BQUQsQ0FBbEI7O0FBQ0EsTUFBTU8sT0FBTyxHQUFDUCxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxNQUFNUSxRQUFRLEdBQUNSLE9BQU8sQ0FBQyxVQUFELENBQXRCOztBQUNBLE1BQU1TLE9BQU8sR0FBQ1QsT0FBTyxDQUFDLGFBQUQsQ0FBckI7O0FBRUEsTUFBTVUsTUFBTSxHQUFDVixPQUFPLENBQUMsaUJBQUQsQ0FBcEI7O0FBQ0EsTUFBTVcsTUFBTSxHQUFDWCxPQUFPLENBQUMsZ0JBQUQsQ0FBcEI7O0FBQ0EsTUFBTVksV0FBVyxHQUFDWixPQUFPLENBQUMsc0JBQUQsQ0FBekI7O0FBQ0EsTUFBTWEsZUFBZSxHQUFDYixPQUFPLENBQUMsb0JBQUQsQ0FBN0I7O0FBRUEsTUFBTWMsR0FBRyxHQUFDLElBQUlmLEdBQUosRUFBVjtBQUNBLE1BQU1nQixFQUFFLEdBQUUsSUFBSUYsZUFBSixFQUFWO0FBRUFFLEVBQUUsQ0FBQ0MsSUFBSDtBQUNBQyxNQUFNLENBQUNGLEVBQVAsR0FBVUEsRUFBVjtBQUNBLE1BQU1HLFNBQVMsR0FBQ0MsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFFBQVosS0FBdUIsWUFBdkIsR0FBb0MsS0FBcEMsR0FBMEMsSUFBMUQsQyxDQUVBOztBQUNBLE1BQU1DLEdBQUcsR0FBQ2xCLEdBQUcsQ0FBQztBQUFDbUIsRUFBQUEsTUFBTSxFQUFDWixNQUFNLENBQUNhO0FBQWYsQ0FBRCxDQUFILENBQWdDQyxNQUFoQyxDQUF1QztBQUFDbkIsRUFBQUEsSUFBSSxFQUFDLENBQUMsV0FBRCxFQUFhLFVBQWIsRUFBd0IsUUFBeEI7QUFBTixDQUF2QyxDQUFWO0FBRUEsTUFBTW9CLFVBQVUsR0FBQ2pCLE9BQU8sQ0FBQyxDQUNyQkYsT0FBTyxDQUFDO0FBQ0pvQixFQUFBQSxTQUFTLEVBQUUsSUFEUDtBQUVKQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsY0FBYyxFQUFDLElBRFA7QUFFUkMsSUFBQUEsYUFBYSxFQUFDLElBQUUsSUFBRixHQUFPO0FBRmIsR0FGUjtBQU1KQyxFQUFBQSxPQUFPLEVBQUVDLEdBQUcsSUFBRTtBQUNWQyxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQkFBWixFQUE4QkYsR0FBOUI7QUFDSDtBQVJHLENBQUQsQ0FEYyxFQVdyQjlCLE9BQU8sQ0FBQ0ksSUFBSSxDQUFDNkIsSUFBTCxDQUFVQyxTQUFWLEVBQW9CLFdBQXBCLENBQUQsQ0FYYyxFQVlyQmpDLElBQUksRUFaaUIsRUFhckJLLFFBQVEsQ0FBQztBQUFDNkIsRUFBQUEsTUFBTSxFQUFDLEtBQVI7QUFBY0MsRUFBQUEsS0FBSyxFQUFDO0FBQXBCLENBQUQsQ0FiYSxFQWNyQnJDLE1BQU0sRUFkZSxFQWVyQlcsV0FmcUIsRUFnQnJCVSxHQWhCcUIsQ0FBRCxDQUF4Qjs7QUFtQkEsSUFBSSxDQUFDSixTQUFMLEVBQWdCO0FBQ1pKLEVBQUFBLEdBQUcsQ0FBQ3lCLEdBQUosQ0FBUWxDLFFBQVEsRUFBaEI7QUFDSDs7QUFDRFMsR0FBRyxDQUFDeUIsR0FBSixDQUFRYixVQUFSLEUsQ0FDQTs7QUFDQVosR0FBRyxDQUFDeUIsR0FBSixDQUFRN0IsTUFBTSxFQUFkO0FBRUFJLEdBQUcsQ0FBQzBCLE1BQUosQ0FBVyxJQUFYIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qga29hPXJlcXVpcmUoJ2tvYScpXG5jb25zdCBoZWxtZXQ9cmVxdWlyZSgna29hLWhlbG1ldCcpXG5jb25zdCBzdGF0aWNzPXJlcXVpcmUoJ2tvYS1zdGF0aWMnKVxuY29uc3QgY29ycz1yZXF1aXJlKCdAa29hL2NvcnMnKVxuY29uc3QgSldUPXJlcXVpcmUoJ2tvYS1qd3QnKVxuY29uc3QgY29tcHJlc3M9cmVxdWlyZSgna29hLWNvbXByZXNzJylcbmNvbnN0IHBhdGg9cmVxdWlyZSgncGF0aCcpXG5jb25zdCBrb2FCb2R5PXJlcXVpcmUoJ2tvYS1ib2R5JylcbmNvbnN0IGpzb251dGlsPXJlcXVpcmUoJ2tvYS1qc29uJylcbmNvbnN0IGNvbXBvc2U9cmVxdWlyZSgna29hLWNvbXBvc2UnKVxuXG5jb25zdCByb3V0ZXI9cmVxdWlyZSgnLi9yb3V0ZXMvcm91dGVzJylcbmNvbnN0IGNvbmZpZz1yZXF1aXJlKCcuL2NvbmZpZy9pbmRleCcpXG5jb25zdCBlcnJvckhhbmRsZT1yZXF1aXJlKCcuL2NvbW1vbi9FcnJvckhhbmRsZScpXG5jb25zdCBXZWJTb2NrZXRTZXJ2ZXI9cmVxdWlyZSgnLi9jb25maWcvV2ViU29ja2V0JylcblxuY29uc3QgYXBwPW5ldyBrb2EoKVxuY29uc3Qgd3MgPW5ldyBXZWJTb2NrZXRTZXJ2ZXIoKVxuXG53cy5pbml0KClcbmdsb2JhbC53cz13c1xuY29uc3QgaXNEZXZNb2RlPXByb2Nlc3MuZW52Lk5PREVfRU5WPT09J3Byb2R1Y3Rpb24nP2ZhbHNlOnRydWVcblxuLy/pmaTkuoblhazlhbHot6/lvoTvvIzlhbbku5bot6/lvoTpg73pnIDopoHpibTmnYNcbmNvbnN0IGp3dD1KV1Qoe3NlY3JldDpjb25maWcuSldUX1NFQ1JFVH0pLnVubGVzcyh7cGF0aDpbL15cXC9wdWJsaWMvLC9eXFwvbG9naW4vLC9eXFwvaW1nL119KVxuXG5jb25zdCBtaWRkbGV3YXJlPWNvbXBvc2UoW1xuICAgIGtvYUJvZHkoe1xuICAgICAgICBtdWx0aXBhcnQ6IHRydWUsXG4gICAgICAgIGZvcm1pZGFibGU6IHtcbiAgICAgICAgICAgIGtlZXBFeHRlbnNpb25zOnRydWUsXG4gICAgICAgICAgICBtYXhGaWVsZHNTaXplOjUqMTAyNCoxMDI0XG4gICAgICAgIH0sXG4gICAgICAgIG9uRXJyb3I6IGVycj0+e1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2tvYWJvZHkgVENMOmVycicsZXJyKVxuICAgICAgICB9XG4gICAgfSksXG4gICAgc3RhdGljcyhwYXRoLmpvaW4oX19kaXJuYW1lLCcuLi9wdWJsaWMnKSksXG4gICAgY29ycygpLFxuICAgIGpzb251dGlsKHtwcmV0dHk6ZmFsc2UscGFyYW06J3ByZXR0eSd9KSxcbiAgICBoZWxtZXQoKSxcbiAgICBlcnJvckhhbmRsZSxcbiAgICBqd3Rcbl0pXG5cbmlmICghaXNEZXZNb2RlKSB7XG4gICAgYXBwLnVzZShjb21wcmVzcygpKVxufVxuYXBwLnVzZShtaWRkbGV3YXJlKVxuLy8gYXBwLnVzZShzdGF0aWNzKHBhdGguam9pbihfX2Rpcm5hbWUsJy4uL3B1YmxpYycpKSlcbmFwcC51c2Uocm91dGVyKCkpXG5cbmFwcC5saXN0ZW4oMzAwMCkiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "koa",
        "require",
        "helmet",
        "statics",
        "cors",
        "JWT",
        "compress",
        "path",
        "koaBody",
        "jsonutil",
        "compose",
        "router",
        "config",
        "errorHandle",
        "WebSocketServer",
        "app",
        "ws",
        "init",
        "global",
        "isDevMode",
        "process",
        "env",
        "NODE_ENV",
        "jwt",
        "secret",
        "JWT_SECRET",
        "unless",
        "middleware",
        "multipart",
        "formidable",
        "keepExtensions",
        "maxFieldsSize",
        "onError",
        "err",
        "console",
        "log",
        "join",
        "__dirname",
        "pretty",
        "param",
        "use",
        "listen"
      ],
      "mappings": ";;AAAA,MAAMA,GAAG,GAACC,OAAO,CAAC,KAAD,CAAjB;;AACA,MAAMC,MAAM,GAACD,OAAO,CAAC,YAAD,CAApB;;AACA,MAAME,OAAO,GAACF,OAAO,CAAC,YAAD,CAArB;;AACA,MAAMG,IAAI,GAACH,OAAO,CAAC,WAAD,CAAlB;;AACA,MAAMI,GAAG,GAACJ,OAAO,CAAC,SAAD,CAAjB;;AACA,MAAMK,QAAQ,GAACL,OAAO,CAAC,cAAD,CAAtB;;AACA,MAAMM,IAAI,GAACN,OAAO,CAAC,MAAD,CAAlB;;AACA,MAAMO,OAAO,GAACP,OAAO,CAAC,UAAD,CAArB;;AACA,MAAMQ,QAAQ,GAACR,OAAO,CAAC,UAAD,CAAtB;;AACA,MAAMS,OAAO,GAACT,OAAO,CAAC,aAAD,CAArB;;AAEA,MAAMU,MAAM,GAACV,OAAO,CAAC,iBAAD,CAApB;;AACA,MAAMW,MAAM,GAACX,OAAO,CAAC,gBAAD,CAApB;;AACA,MAAMY,WAAW,GAACZ,OAAO,CAAC,sBAAD,CAAzB;;AACA,MAAMa,eAAe,GAACb,OAAO,CAAC,oBAAD,CAA7B;;AAEA,MAAMc,GAAG,GAAC,IAAIf,GAAJ,EAAV;AACA,MAAMgB,EAAE,GAAE,IAAIF,eAAJ,EAAV;AAEAE,EAAE,CAACC,IAAH;AACAC,MAAM,CAACF,EAAP,GAAUA,EAAV;AACA,MAAMG,SAAS,GAACC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAuB,YAAvB,GAAoC,KAApC,GAA0C,IAA1D,C,CAEA;;AACA,MAAMC,GAAG,GAAClB,GAAG,CAAC;AAACmB,EAAAA,MAAM,EAACZ,MAAM,CAACa;AAAf,CAAD,CAAH,CAAgCC,MAAhC,CAAuC;AAACnB,EAAAA,IAAI,EAAC,CAAC,WAAD,EAAa,UAAb,EAAwB,QAAxB;AAAN,CAAvC,CAAV;AAEA,MAAMoB,UAAU,GAACjB,OAAO,CAAC,CACrBF,OAAO,CAAC;AACJoB,EAAAA,SAAS,EAAE,IADP;AAEJC,EAAAA,UAAU,EAAE;AACRC,IAAAA,cAAc,EAAC,IADP;AAERC,IAAAA,aAAa,EAAC,IAAE,IAAF,GAAO;AAFb,GAFR;AAMJC,EAAAA,OAAO,EAAEC,GAAG,IAAE;AACVC,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA8BF,GAA9B;AACH;AARG,CAAD,CADc,EAWrB9B,OAAO,CAACI,IAAI,CAAC6B,IAAL,CAAUC,SAAV,EAAoB,WAApB,CAAD,CAXc,EAYrBjC,IAAI,EAZiB,EAarBK,QAAQ,CAAC;AAAC6B,EAAAA,MAAM,EAAC,KAAR;AAAcC,EAAAA,KAAK,EAAC;AAApB,CAAD,CAba,EAcrBrC,MAAM,EAde,EAerBW,WAfqB,EAgBrBU,GAhBqB,CAAD,CAAxB;;AAmBA,IAAI,CAACJ,SAAL,EAAgB;AACZJ,EAAAA,GAAG,CAACyB,GAAJ,CAAQlC,QAAQ,EAAhB;AACH;;AACDS,GAAG,CAACyB,GAAJ,CAAQb,UAAR,E,CACA;;AACAZ,GAAG,CAACyB,GAAJ,CAAQ7B,MAAM,EAAd;AAEAI,GAAG,CAAC0B,MAAJ,CAAW,IAAX",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src",
      "sourcesContent": [
        "const koa=require('koa')\nconst helmet=require('koa-helmet')\nconst statics=require('koa-static')\nconst cors=require('@koa/cors')\nconst JWT=require('koa-jwt')\nconst compress=require('koa-compress')\nconst path=require('path')\nconst koaBody=require('koa-body')\nconst jsonutil=require('koa-json')\nconst compose=require('koa-compose')\n\nconst router=require('./routes/routes')\nconst config=require('./config/index')\nconst errorHandle=require('./common/ErrorHandle')\nconst WebSocketServer=require('./config/WebSocket')\n\nconst app=new koa()\nconst ws =new WebSocketServer()\n\nws.init()\nglobal.ws=ws\nconst isDevMode=process.env.NODE_ENV==='production'?false:true\n\n//除了公共路径，其他路径都需要鉴权\nconst jwt=JWT({secret:config.JWT_SECRET}).unless({path:[/^\\/public/,/^\\/login/,/^\\/img/]})\n\nconst middleware=compose([\n    koaBody({\n        multipart: true,\n        formidable: {\n            keepExtensions:true,\n            maxFieldsSize:5*1024*1024\n        },\n        onError: err=>{\n            console.log('koabody TCL:err',err)\n        }\n    }),\n    statics(path.join(__dirname,'../public')),\n    cors(),\n    jsonutil({pretty:false,param:'pretty'}),\n    helmet(),\n    errorHandle,\n    jwt\n])\n\nif (!isDevMode) {\n    app.use(compress())\n}\napp.use(middleware)\n// app.use(statics(path.join(__dirname,'../public')))\napp.use(router())\n\napp.listen(3000)"
      ]
    },
    "sourceType": "script",
    "mtime": 1586661631584
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/routes.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/routes.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/routes.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/routes.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes",
        "sourceFileName": "routes.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import combineRoutes from 'koa-combine-routers'\n// const moduleFiles = require.context('./modules', true, /\\.js$/)\n// const modules = moduleFiles.keys().reduce((items, path) => {\n//     const value = moduleFiles(path)\n//     items.push(value.default)\n//     return items\n// }, [])\n// export default combineRoutes(modules)\nconst combineRoutes = require('koa-combine-routers');\n\nconst publicRoutes = require('./modules/publicRouter');\n\nconst userRoutes = require('./modules/userRouter');\n\nconst loginRoutes = require('./modules/loginRouter');\n\nconst contentRouter = require('./modules/contentRouter');\n\nconst commentRouter = require('./modules/commentRouter');\n\nmodule.exports = combineRoutes(publicRoutes, loginRoutes, userRoutes, contentRouter, commentRouter);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy5qcyJdLCJuYW1lcyI6WyJjb21iaW5lUm91dGVzIiwicmVxdWlyZSIsInB1YmxpY1JvdXRlcyIsInVzZXJSb3V0ZXMiLCJsb2dpblJvdXRlcyIsImNvbnRlbnRSb3V0ZXIiLCJjb21tZW50Um91dGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0EsTUFBTUEsYUFBYSxHQUFDQyxPQUFPLENBQUMscUJBQUQsQ0FBM0I7O0FBQ0EsTUFBTUMsWUFBWSxHQUFDRCxPQUFPLENBQUMsd0JBQUQsQ0FBMUI7O0FBQ0EsTUFBTUUsVUFBVSxHQUFDRixPQUFPLENBQUMsc0JBQUQsQ0FBeEI7O0FBQ0EsTUFBTUcsV0FBVyxHQUFDSCxPQUFPLENBQUMsdUJBQUQsQ0FBekI7O0FBQ0EsTUFBTUksYUFBYSxHQUFDSixPQUFPLENBQUMseUJBQUQsQ0FBM0I7O0FBQ0EsTUFBTUssYUFBYSxHQUFDTCxPQUFPLENBQUMseUJBQUQsQ0FBM0I7O0FBRUFNLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlUixhQUFhLENBQ3hCRSxZQUR3QixFQUV4QkUsV0FGd0IsRUFHeEJELFVBSHdCLEVBSXhCRSxhQUp3QixFQUt4QkMsYUFMd0IsQ0FBNUIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvcm91dGVzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IGNvbWJpbmVSb3V0ZXMgZnJvbSAna29hLWNvbWJpbmUtcm91dGVycydcblxuLy8gY29uc3QgbW9kdWxlRmlsZXMgPSByZXF1aXJlLmNvbnRleHQoJy4vbW9kdWxlcycsIHRydWUsIC9cXC5qcyQvKVxuXG4vLyBjb25zdCBtb2R1bGVzID0gbW9kdWxlRmlsZXMua2V5cygpLnJlZHVjZSgoaXRlbXMsIHBhdGgpID0+IHtcbi8vICAgICBjb25zdCB2YWx1ZSA9IG1vZHVsZUZpbGVzKHBhdGgpXG4vLyAgICAgaXRlbXMucHVzaCh2YWx1ZS5kZWZhdWx0KVxuLy8gICAgIHJldHVybiBpdGVtc1xuLy8gfSwgW10pXG5cbi8vIGV4cG9ydCBkZWZhdWx0IGNvbWJpbmVSb3V0ZXMobW9kdWxlcylcblxuXG5jb25zdCBjb21iaW5lUm91dGVzPXJlcXVpcmUoJ2tvYS1jb21iaW5lLXJvdXRlcnMnKVxuY29uc3QgcHVibGljUm91dGVzPXJlcXVpcmUoJy4vbW9kdWxlcy9wdWJsaWNSb3V0ZXInKVxuY29uc3QgdXNlclJvdXRlcz1yZXF1aXJlKCcuL21vZHVsZXMvdXNlclJvdXRlcicpXG5jb25zdCBsb2dpblJvdXRlcz1yZXF1aXJlKCcuL21vZHVsZXMvbG9naW5Sb3V0ZXInKVxuY29uc3QgY29udGVudFJvdXRlcj1yZXF1aXJlKCcuL21vZHVsZXMvY29udGVudFJvdXRlcicpXG5jb25zdCBjb21tZW50Um91dGVyPXJlcXVpcmUoJy4vbW9kdWxlcy9jb21tZW50Um91dGVyJylcblxubW9kdWxlLmV4cG9ydHM9Y29tYmluZVJvdXRlcyhcbiAgICBwdWJsaWNSb3V0ZXMsXG4gICAgbG9naW5Sb3V0ZXMsXG4gICAgdXNlclJvdXRlcyxcbiAgICBjb250ZW50Um91dGVyLFxuICAgIGNvbW1lbnRSb3V0ZXJcbikiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "routes.js"
      ],
      "names": [
        "combineRoutes",
        "require",
        "publicRoutes",
        "userRoutes",
        "loginRoutes",
        "contentRouter",
        "commentRouter",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAGA,MAAMA,aAAa,GAACC,OAAO,CAAC,qBAAD,CAA3B;;AACA,MAAMC,YAAY,GAACD,OAAO,CAAC,wBAAD,CAA1B;;AACA,MAAME,UAAU,GAACF,OAAO,CAAC,sBAAD,CAAxB;;AACA,MAAMG,WAAW,GAACH,OAAO,CAAC,uBAAD,CAAzB;;AACA,MAAMI,aAAa,GAACJ,OAAO,CAAC,yBAAD,CAA3B;;AACA,MAAMK,aAAa,GAACL,OAAO,CAAC,yBAAD,CAA3B;;AAEAM,MAAM,CAACC,OAAP,GAAeR,aAAa,CACxBE,YADwB,EAExBE,WAFwB,EAGxBD,UAHwB,EAIxBE,aAJwB,EAKxBC,aALwB,CAA5B",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes",
      "sourcesContent": [
        "// import combineRoutes from 'koa-combine-routers'\n\n// const moduleFiles = require.context('./modules', true, /\\.js$/)\n\n// const modules = moduleFiles.keys().reduce((items, path) => {\n//     const value = moduleFiles(path)\n//     items.push(value.default)\n//     return items\n// }, [])\n\n// export default combineRoutes(modules)\n\n\nconst combineRoutes=require('koa-combine-routers')\nconst publicRoutes=require('./modules/publicRouter')\nconst userRoutes=require('./modules/userRouter')\nconst loginRoutes=require('./modules/loginRouter')\nconst contentRouter=require('./modules/contentRouter')\nconst commentRouter=require('./modules/commentRouter')\n\nmodule.exports=combineRoutes(\n    publicRoutes,\n    loginRoutes,\n    userRoutes,\n    contentRouter,\n    commentRouter\n)"
      ]
    },
    "sourceType": "script",
    "mtime": 1585709511114
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/publicRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/publicRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/publicRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/publicRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "publicRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst publicController = require('../../api/PublicController');\n\nconst contentController = require('../../api/ContentController');\n\nconst commentController = require('../../api/CommentController');\n\nconst router = new Router();\nrouter.prefix('/public');\nrouter.get('/getCaptcha', publicController);\nrouter.get('/list', contentController.getPostList);\nrouter.get('/content/detail', contentController.getPostDetail);\nrouter.get('/comments', commentController.getComments);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1YmxpY1JvdXRlci5qcyJdLCJuYW1lcyI6WyJSb3V0ZXIiLCJyZXF1aXJlIiwicHVibGljQ29udHJvbGxlciIsImNvbnRlbnRDb250cm9sbGVyIiwiY29tbWVudENvbnRyb2xsZXIiLCJyb3V0ZXIiLCJwcmVmaXgiLCJnZXQiLCJnZXRQb3N0TGlzdCIsImdldFBvc3REZXRhaWwiLCJnZXRDb21tZW50cyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsTUFBTSxHQUFDQyxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxnQkFBZ0IsR0FBQ0QsT0FBTyxDQUFDLDRCQUFELENBQTlCOztBQUNBLE1BQU1FLGlCQUFpQixHQUFDRixPQUFPLENBQUMsNkJBQUQsQ0FBL0I7O0FBQ0EsTUFBTUcsaUJBQWlCLEdBQUNILE9BQU8sQ0FBQyw2QkFBRCxDQUEvQjs7QUFFQSxNQUFNSSxNQUFNLEdBQUMsSUFBSUwsTUFBSixFQUFiO0FBRUFLLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFNBQWQ7QUFDQUQsTUFBTSxDQUFDRSxHQUFQLENBQVcsYUFBWCxFQUF5QkwsZ0JBQXpCO0FBRUFHLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLE9BQVgsRUFBb0JKLGlCQUFpQixDQUFDSyxXQUF0QztBQUVBSCxNQUFNLENBQUNFLEdBQVAsQ0FBVyxpQkFBWCxFQUE2QkosaUJBQWlCLENBQUNNLGFBQS9DO0FBRUFKLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLFdBQVgsRUFBdUJILGlCQUFpQixDQUFDTSxXQUF6QztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBZVAsTUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlcj1yZXF1aXJlKCdrb2Etcm91dGVyJylcbmNvbnN0IHB1YmxpY0NvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL1B1YmxpY0NvbnRyb2xsZXInKVxuY29uc3QgY29udGVudENvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL0NvbnRlbnRDb250cm9sbGVyJylcbmNvbnN0IGNvbW1lbnRDb250cm9sbGVyPXJlcXVpcmUoJy4uLy4uL2FwaS9Db21tZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcblxucm91dGVyLnByZWZpeCgnL3B1YmxpYycpXG5yb3V0ZXIuZ2V0KCcvZ2V0Q2FwdGNoYScscHVibGljQ29udHJvbGxlcilcblxucm91dGVyLmdldCgnL2xpc3QnLCBjb250ZW50Q29udHJvbGxlci5nZXRQb3N0TGlzdClcblxucm91dGVyLmdldCgnL2NvbnRlbnQvZGV0YWlsJyxjb250ZW50Q29udHJvbGxlci5nZXRQb3N0RGV0YWlsKVxuXG5yb3V0ZXIuZ2V0KCcvY29tbWVudHMnLGNvbW1lbnRDb250cm9sbGVyLmdldENvbW1lbnRzKVxuXG5tb2R1bGUuZXhwb3J0cz1yb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "publicRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "publicController",
        "contentController",
        "commentController",
        "router",
        "prefix",
        "get",
        "getPostList",
        "getPostDetail",
        "getComments",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,gBAAgB,GAACD,OAAO,CAAC,4BAAD,CAA9B;;AACA,MAAME,iBAAiB,GAACF,OAAO,CAAC,6BAAD,CAA/B;;AACA,MAAMG,iBAAiB,GAACH,OAAO,CAAC,6BAAD,CAA/B;;AAEA,MAAMI,MAAM,GAAC,IAAIL,MAAJ,EAAb;AAEAK,MAAM,CAACC,MAAP,CAAc,SAAd;AACAD,MAAM,CAACE,GAAP,CAAW,aAAX,EAAyBL,gBAAzB;AAEAG,MAAM,CAACE,GAAP,CAAW,OAAX,EAAoBJ,iBAAiB,CAACK,WAAtC;AAEAH,MAAM,CAACE,GAAP,CAAW,iBAAX,EAA6BJ,iBAAiB,CAACM,aAA/C;AAEAJ,MAAM,CAACE,GAAP,CAAW,WAAX,EAAuBH,iBAAiB,CAACM,WAAzC;AAEAC,MAAM,CAACC,OAAP,GAAeP,MAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst publicController=require('../../api/PublicController')\nconst contentController=require('../../api/ContentController')\nconst commentController=require('../../api/CommentController')\n\nconst router=new Router()\n\nrouter.prefix('/public')\nrouter.get('/getCaptcha',publicController)\n\nrouter.get('/list', contentController.getPostList)\n\nrouter.get('/content/detail',contentController.getPostDetail)\n\nrouter.get('/comments',commentController.getComments)\n\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585714190541
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/PublicController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/PublicController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/PublicController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/PublicController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "PublicController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst svgCaptcha = require('svg-captcha');\n\nconst redisConfig = require('../config/RedisConfig'); // const redisConfig=require('@/config/RedisConfig')\n// import svgCaptcha from 'svg-captcha'     es6\n// class PublicController{\n//     constructor() {}\n//     async getCaptcha(ctx) {\n//         const body = ctx.request.query\n//         console.log(body.sid)\n//         const newCaptcha=svgCaptcha.create({\n//             size: 4,\n//             ignoreChars: '0olil',\n//             color: true,\n//             noise: Math.floor(Math.random() * 5),\n//             width: 150,\n//             height: 50\n//         })\n//         // console.log(newCaptcha)\n//         ctx.body={\n//             code: 200,\n//             data: newCaptcha.data,\n//         }\n//     }\n// }\n\n\nmodule.exports = function (ctx) {\n  const body = ctx.request.query;\n  console.log(body.sid);\n  const newCaptcha = svgCaptcha.create({\n    size: 4,\n    ignoreChars: '0olil',\n    color: true,\n    noise: Math.floor(Math.random() * 5),\n    width: 150,\n    height: 50\n  }); // console.log(newCaptcha)\n\n  redisConfig.setValue(body.sid, newCaptcha.text, 10 * 60); //save for 10m\n  // redisConfig.getValue(body.sid).then((res) => {\n  //     console.log(res)\n  // })\n\n  ctx.body = {\n    code: 200,\n    data: newCaptcha.data\n  };\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlB1YmxpY0NvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsic3ZnQ2FwdGNoYSIsInJlcXVpcmUiLCJyZWRpc0NvbmZpZyIsIm1vZHVsZSIsImV4cG9ydHMiLCJjdHgiLCJib2R5IiwicmVxdWVzdCIsInF1ZXJ5IiwiY29uc29sZSIsImxvZyIsInNpZCIsIm5ld0NhcHRjaGEiLCJjcmVhdGUiLCJzaXplIiwiaWdub3JlQ2hhcnMiLCJjb2xvciIsIm5vaXNlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwid2lkdGgiLCJoZWlnaHQiLCJzZXRWYWx1ZSIsInRleHQiLCJjb2RlIiwiZGF0YSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxVQUFVLEdBQUNDLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLE1BQU1DLFdBQVcsR0FBQ0QsT0FBTyxDQUFDLHVCQUFELENBQXpCLEMsQ0FDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0FFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlLFVBQVNDLEdBQVQsRUFBYTtBQUN4QixRQUFNQyxJQUFJLEdBQUdELEdBQUcsQ0FBQ0UsT0FBSixDQUFZQyxLQUF6QjtBQUNBQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUosSUFBSSxDQUFDSyxHQUFqQjtBQUNBLFFBQU1DLFVBQVUsR0FBQ1osVUFBVSxDQUFDYSxNQUFYLENBQWtCO0FBQy9CQyxJQUFBQSxJQUFJLEVBQUUsQ0FEeUI7QUFFL0JDLElBQUFBLFdBQVcsRUFBRSxPQUZrQjtBQUcvQkMsSUFBQUEsS0FBSyxFQUFFLElBSHdCO0FBSS9CQyxJQUFBQSxLQUFLLEVBQUVDLElBQUksQ0FBQ0MsS0FBTCxDQUFXRCxJQUFJLENBQUNFLE1BQUwsS0FBZ0IsQ0FBM0IsQ0FKd0I7QUFLL0JDLElBQUFBLEtBQUssRUFBRSxHQUx3QjtBQU0vQkMsSUFBQUEsTUFBTSxFQUFFO0FBTnVCLEdBQWxCLENBQWpCLENBSHdCLENBV3hCOztBQUNBcEIsRUFBQUEsV0FBVyxDQUFDcUIsUUFBWixDQUFxQmpCLElBQUksQ0FBQ0ssR0FBMUIsRUFBK0JDLFVBQVUsQ0FBQ1ksSUFBMUMsRUFBK0MsS0FBSyxFQUFwRCxFQVp3QixDQVlnQztBQUN4RDtBQUNBO0FBQ0E7O0FBQ0FuQixFQUFBQSxHQUFHLENBQUNDLElBQUosR0FBUztBQUNMbUIsSUFBQUEsSUFBSSxFQUFDLEdBREE7QUFFTEMsSUFBQUEsSUFBSSxFQUFDZCxVQUFVLENBQUNjO0FBRlgsR0FBVDtBQUlILENBcEJEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjL2FwaSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHN2Z0NhcHRjaGE9cmVxdWlyZSgnc3ZnLWNhcHRjaGEnKVxuY29uc3QgcmVkaXNDb25maWc9cmVxdWlyZSgnLi4vY29uZmlnL1JlZGlzQ29uZmlnJylcbi8vIGNvbnN0IHJlZGlzQ29uZmlnPXJlcXVpcmUoJ0AvY29uZmlnL1JlZGlzQ29uZmlnJylcbi8vIGltcG9ydCBzdmdDYXB0Y2hhIGZyb20gJ3N2Zy1jYXB0Y2hhJyAgICAgZXM2XG5cblxuLy8gY2xhc3MgUHVibGljQ29udHJvbGxlcntcbi8vICAgICBjb25zdHJ1Y3RvcigpIHt9XG4vLyAgICAgYXN5bmMgZ2V0Q2FwdGNoYShjdHgpIHtcbi8vICAgICAgICAgY29uc3QgYm9keSA9IGN0eC5yZXF1ZXN0LnF1ZXJ5XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKGJvZHkuc2lkKVxuLy8gICAgICAgICBjb25zdCBuZXdDYXB0Y2hhPXN2Z0NhcHRjaGEuY3JlYXRlKHtcbi8vICAgICAgICAgICAgIHNpemU6IDQsXG4vLyAgICAgICAgICAgICBpZ25vcmVDaGFyczogJzBvbGlsJyxcbi8vICAgICAgICAgICAgIGNvbG9yOiB0cnVlLFxuLy8gICAgICAgICAgICAgbm9pc2U6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpLFxuLy8gICAgICAgICAgICAgd2lkdGg6IDE1MCxcbi8vICAgICAgICAgICAgIGhlaWdodDogNTBcbi8vICAgICAgICAgfSlcbi8vICAgICAgICAgLy8gY29uc29sZS5sb2cobmV3Q2FwdGNoYSlcbi8vICAgICAgICAgY3R4LmJvZHk9e1xuLy8gICAgICAgICAgICAgY29kZTogMjAwLFxuLy8gICAgICAgICAgICAgZGF0YTogbmV3Q2FwdGNoYS5kYXRhLFxuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxubW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oY3R4KXtcbiAgICBjb25zdCBib2R5ID0gY3R4LnJlcXVlc3QucXVlcnlcbiAgICBjb25zb2xlLmxvZyhib2R5LnNpZClcbiAgICBjb25zdCBuZXdDYXB0Y2hhPXN2Z0NhcHRjaGEuY3JlYXRlKHtcbiAgICAgICAgc2l6ZTogNCxcbiAgICAgICAgaWdub3JlQ2hhcnM6ICcwb2xpbCcsXG4gICAgICAgIGNvbG9yOiB0cnVlLFxuICAgICAgICBub2lzZTogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSksXG4gICAgICAgIHdpZHRoOiAxNTAsXG4gICAgICAgIGhlaWdodDogNTBcbiAgICB9KVxuICAgIC8vIGNvbnNvbGUubG9nKG5ld0NhcHRjaGEpXG4gICAgcmVkaXNDb25maWcuc2V0VmFsdWUoYm9keS5zaWQsIG5ld0NhcHRjaGEudGV4dCwxMCAqIDYwKSAvL3NhdmUgZm9yIDEwbVxuICAgIC8vIHJlZGlzQ29uZmlnLmdldFZhbHVlKGJvZHkuc2lkKS50aGVuKChyZXMpID0+IHtcbiAgICAvLyAgICAgY29uc29sZS5sb2cocmVzKVxuICAgIC8vIH0pXG4gICAgY3R4LmJvZHk9e1xuICAgICAgICBjb2RlOjIwMCxcbiAgICAgICAgZGF0YTpuZXdDYXB0Y2hhLmRhdGEsXG4gICAgfVxufSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "PublicController.js"
      ],
      "names": [
        "svgCaptcha",
        "require",
        "redisConfig",
        "module",
        "exports",
        "ctx",
        "body",
        "request",
        "query",
        "console",
        "log",
        "sid",
        "newCaptcha",
        "create",
        "size",
        "ignoreChars",
        "color",
        "noise",
        "Math",
        "floor",
        "random",
        "width",
        "height",
        "setValue",
        "text",
        "code",
        "data"
      ],
      "mappings": ";;AAAA,MAAMA,UAAU,GAACC,OAAO,CAAC,aAAD,CAAxB;;AACA,MAAMC,WAAW,GAACD,OAAO,CAAC,uBAAD,CAAzB,C,CACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAE,MAAM,CAACC,OAAP,GAAe,UAASC,GAAT,EAAa;AACxB,QAAMC,IAAI,GAAGD,GAAG,CAACE,OAAJ,CAAYC,KAAzB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYJ,IAAI,CAACK,GAAjB;AACA,QAAMC,UAAU,GAACZ,UAAU,CAACa,MAAX,CAAkB;AAC/BC,IAAAA,IAAI,EAAE,CADyB;AAE/BC,IAAAA,WAAW,EAAE,OAFkB;AAG/BC,IAAAA,KAAK,EAAE,IAHwB;AAI/BC,IAAAA,KAAK,EAAEC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,CAA3B,CAJwB;AAK/BC,IAAAA,KAAK,EAAE,GALwB;AAM/BC,IAAAA,MAAM,EAAE;AANuB,GAAlB,CAAjB,CAHwB,CAWxB;;AACApB,EAAAA,WAAW,CAACqB,QAAZ,CAAqBjB,IAAI,CAACK,GAA1B,EAA+BC,UAAU,CAACY,IAA1C,EAA+C,KAAK,EAApD,EAZwB,CAYgC;AACxD;AACA;AACA;;AACAnB,EAAAA,GAAG,CAACC,IAAJ,GAAS;AACLmB,IAAAA,IAAI,EAAC,GADA;AAELC,IAAAA,IAAI,EAACd,UAAU,CAACc;AAFX,GAAT;AAIH,CApBD",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "const svgCaptcha=require('svg-captcha')\nconst redisConfig=require('../config/RedisConfig')\n// const redisConfig=require('@/config/RedisConfig')\n// import svgCaptcha from 'svg-captcha'     es6\n\n\n// class PublicController{\n//     constructor() {}\n//     async getCaptcha(ctx) {\n//         const body = ctx.request.query\n//         console.log(body.sid)\n//         const newCaptcha=svgCaptcha.create({\n//             size: 4,\n//             ignoreChars: '0olil',\n//             color: true,\n//             noise: Math.floor(Math.random() * 5),\n//             width: 150,\n//             height: 50\n//         })\n//         // console.log(newCaptcha)\n//         ctx.body={\n//             code: 200,\n//             data: newCaptcha.data,\n//         }\n//     }\n// }\nmodule.exports=function(ctx){\n    const body = ctx.request.query\n    console.log(body.sid)\n    const newCaptcha=svgCaptcha.create({\n        size: 4,\n        ignoreChars: '0olil',\n        color: true,\n        noise: Math.floor(Math.random() * 5),\n        width: 150,\n        height: 50\n    })\n    // console.log(newCaptcha)\n    redisConfig.setValue(body.sid, newCaptcha.text,10 * 60) //save for 10m\n    // redisConfig.getValue(body.sid).then((res) => {\n    //     console.log(res)\n    // })\n    ctx.body={\n        code:200,\n        data:newCaptcha.data,\n    }\n}"
      ]
    },
    "sourceType": "script",
    "mtime": 1584437157098
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/RedisConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/RedisConfig.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/RedisConfig.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/RedisConfig.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "RedisConfig.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// for es5: const => var\nconst redis = require(\"redis\"); // import redis from 'redis'\n// const config = require(\"./index\")\n\n\nvar Promise = require('bluebird');\n\nvar DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb';\nvar REDIS = {\n  host: '47.99.202.255',\n  port: 15001,\n  password: '123456'\n};\nvar options = {\n  host: REDIS.host,\n  port: REDIS.port,\n  password: REDIS.password,\n  detect_buffers: true,\n  retry_strategy: function (options) {\n    if (options.error && options.error.code === 'ECONNREFUSED') {\n      return new Error('The server refused the connection');\n    }\n\n    if (options.total_retry_time > 1000 * 60 * 60) {\n      return new Error('Retry time exhausted');\n    }\n\n    if (options.attempt > 10) {\n      return undefined;\n    }\n\n    return Math.min(options.attempt * 100, 3000);\n  }\n};\nconst client = Promise.promisifyAll(redis.createClient(options)); // const client = redis.createClient(options)\n\nclient.on('error', function (err) {\n  console.log('Redis Client Error:' + err);\n});\n\nfunction setValue(key, value, time) {\n  if (typeof value === 'undefined' || value == null || value === '') {\n    return;\n  }\n\n  if (typeof value === 'string') {\n    if (typeof time !== 'undefined') {\n      client.set(key, value, 'EX', time);\n    } else {\n      client.set(key, value);\n    }\n  } else if (typeof value === 'object') {\n    Object.keys(value).forEach(item => {\n      client.hset(key, item, value[item], redis.print);\n    });\n  }\n} // setValue('id','24')\n\n\nfunction getValue(key) {\n  return client.getAsync(key);\n}\n\nvar getHValue = key => {\n  return client.hgetallAsync(key);\n};\n\nvar delValue = key => {\n  client.del(key, (err, res) => {\n    if (res === 1) {\n      console.log('delete successfully');\n    } else {\n      console.log('delete redis key error:' + err);\n    }\n  });\n}; // export {\n//     client,\n//     setValue,\n//     getValue,\n//     getHValue,\n//     delValue\n// }\n\n\nmodule.exports = {\n  client,\n  setValue,\n  getValue,\n  getHValue,\n  delValue\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlZGlzQ29uZmlnLmpzIl0sIm5hbWVzIjpbInJlZGlzIiwicmVxdWlyZSIsIlByb21pc2UiLCJEQl9VUkwiLCJSRURJUyIsImhvc3QiLCJwb3J0IiwicGFzc3dvcmQiLCJvcHRpb25zIiwiZGV0ZWN0X2J1ZmZlcnMiLCJyZXRyeV9zdHJhdGVneSIsImVycm9yIiwiY29kZSIsIkVycm9yIiwidG90YWxfcmV0cnlfdGltZSIsImF0dGVtcHQiLCJ1bmRlZmluZWQiLCJNYXRoIiwibWluIiwiY2xpZW50IiwicHJvbWlzaWZ5QWxsIiwiY3JlYXRlQ2xpZW50Iiwib24iLCJlcnIiLCJjb25zb2xlIiwibG9nIiwic2V0VmFsdWUiLCJrZXkiLCJ2YWx1ZSIsInRpbWUiLCJzZXQiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsIml0ZW0iLCJoc2V0IiwicHJpbnQiLCJnZXRWYWx1ZSIsImdldEFzeW5jIiwiZ2V0SFZhbHVlIiwiaGdldGFsbEFzeW5jIiwiZGVsVmFsdWUiLCJkZWwiLCJyZXMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFyQixDLENBQ0E7QUFDQTs7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFFQSxJQUFJRSxNQUFNLEdBQUMsa0RBQVg7QUFDQSxJQUFJQyxLQUFLLEdBQUc7QUFDUkMsRUFBQUEsSUFBSSxFQUFFLGVBREU7QUFFUkMsRUFBQUEsSUFBSSxFQUFFLEtBRkU7QUFHUkMsRUFBQUEsUUFBUSxFQUFFO0FBSEYsQ0FBWjtBQU1BLElBQUlDLE9BQU8sR0FBRztBQUNWSCxFQUFBQSxJQUFJLEVBQUVELEtBQUssQ0FBQ0MsSUFERjtBQUVWQyxFQUFBQSxJQUFJLEVBQUVGLEtBQUssQ0FBQ0UsSUFGRjtBQUdWQyxFQUFBQSxRQUFRLEVBQUVILEtBQUssQ0FBQ0csUUFITjtBQUlWRSxFQUFBQSxjQUFjLEVBQUUs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QUMxQixFQUFBQSxNQUFEO0FBQVFPLEVBQUFBLFFBQVI7QUFBaUJXLEVBQUFBLFFBQWpCO0FBQTBCRSxFQUFBQSxTQUExQjtBQUFvQ0UsRUFBQUE7QUFBcEMsQ0FBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyIvLyBmb3IgZXM1OiBjb25zdCA9PiB2YXJcblxuY29uc3QgcmVkaXMgPSByZXF1aXJlKFwicmVkaXNcIilcbi8vIGltcG9ydCByZWRpcyBmcm9tICdyZWRpcydcbi8vIGNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoXCIuL2luZGV4XCIpXG52YXIgUHJvbWlzZSA9IHJlcXVpcmUoJ2JsdWViaXJkJylcblxudmFyIERCX1VSTD0nbW9uZ29kYjovL3Rlc3Q6MTIzNDU2QDQ3Ljk5LjIwMi4yNTU6MTUwMDEvdGVzdGRiJ1xudmFyIFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAxNTAwMSxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cblxudmFyIG9wdGlvbnMgPSB7XG4gICAgaG9zdDogUkVESVMuaG9zdCxcbiAgICBwb3J0OiBSRURJUy5wb3J0LFxuICAgIHBhc3N3b3JkOiBSRURJUy5wYXNzd29yZCxcbiAgICBkZXRlY3RfYnVmZmVyczogdHJ1ZSxcbiAgICByZXRyeV9zdHJhdGVneTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuZXJyb3IgJiYgb3B0aW9ucy5lcnJvci5jb2RlID09PSAnRUNPTk5SRUZVU0VEJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignVGhlIHNlcnZlciByZWZ1c2VkIHRoZSBjb25uZWN0aW9uJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMudG90YWxfcmV0cnlfdGltZSA+IDEwMDAgKiA2MCAqIDYwKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdSZXRyeSB0aW1lIGV4aGF1c3RlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmF0dGVtcHQgPiAxMCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTWF0aC5taW4ob3B0aW9ucy5hdHRlbXB0ICogMTAwLCAzMDAwKTtcbiAgICB9XG59XG5cbmNvbnN0IGNsaWVudCA9IFByb21pc2UucHJvbWlzaWZ5QWxsKHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKSlcbi8vIGNvbnN0IGNsaWVudCA9IHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKVxuXG5jbGllbnQub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycikge1xuICAgIGNvbnNvbGUubG9nKCdSZWRpcyBDbGllbnQgRXJyb3I6JyArIGVycilcbn0pXG5cbmZ1bmN0aW9uIHNldFZhbHVlIChrZXksIHZhbHVlLCB0aW1lKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgdmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycpe1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYodHlwZW9mIHRpbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjbGllbnQuc2V0KGtleSx2YWx1ZSwnRVgnLHRpbWUpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjbGllbnQuc2V0KGtleSx2YWx1ZSlcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jyl7XG4gICAgICAgIE9iamVjdC5rZXlzKHZhbHVlKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICBjbGllbnQuaHNldChrZXksIGl0ZW0sIHZhbHVlW2l0ZW1dLCByZWRpcy5wcmludClcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbi8vIHNldFZhbHVlKCdpZCcsJzI0JylcblxuZnVuY3Rpb24gZ2V0VmFsdWUgKGtleSkge1xuICAgIHJldHVybiBjbGllbnQuZ2V0QXN5bmMoa2V5KVxufVxuXG52YXIgZ2V0SFZhbHVlID0gKGtleSkgPT4ge1xuICAgIHJldHVybiBjbGllbnQuaGdldGFsbEFzeW5jKGtleSlcbn1cblxudmFyIGRlbFZhbHVlID0gKGtleSkgPT4ge1xuICAgIGNsaWVudC5kZWwoa2V5LCAoZXJyLCByZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcz09PTEpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0ZSBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGUgcmVkaXMga2V5IGVycm9yOicgKyBlcnIpXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG4vLyBleHBvcnQge1xuLy8gICAgIGNsaWVudCxcbi8vICAgICBzZXRWYWx1ZSxcbi8vICAgICBnZXRWYWx1ZSxcbi8vICAgICBnZXRIVmFsdWUsXG4vLyAgICAgZGVsVmFsdWVcbi8vIH1cbm1vZHVsZS5leHBvcnRzPXtjbGllbnQsc2V0VmFsdWUsZ2V0VmFsdWUsZ2V0SFZhbHVlLGRlbFZhbHVlfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "RedisConfig.js"
      ],
      "names": [
        "redis",
        "require",
        "Promise",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "options",
        "detect_buffers",
        "retry_strategy",
        "error",
        "code",
        "Error",
        "total_retry_time",
        "attempt",
        "undefined",
        "Math",
        "min",
        "client",
        "promisifyAll",
        "createClient",
        "on",
        "err",
        "console",
        "log",
        "setValue",
        "key",
        "value",
        "time",
        "set",
        "Object",
        "keys",
        "forEach",
        "item",
        "hset",
        "print",
        "getValue",
        "getAsync",
        "getHValue",
        "hgetallAsync",
        "delValue",
        "del",
        "res",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "// for es5: const => var\n\nconst redis = require(\"redis\")\n// import redis from 'redis'\n// const config = require(\"./index\")\nvar Promise = require('bluebird')\n\nvar DB_URL='mongodb://test:123456@47.99.202.255:15001/testdb'\nvar REDIS = {\n    host: '47.99.202.255',\n    port: 15001,\n    password: '123456'\n}\n\nvar options = {\n    host: REDIS.host,\n    port: REDIS.port,\n    password: REDIS.password,\n    detect_buffers: true,\n    retry_strategy: function (options) {\n        if (options.error && options.error.code === 'ECONNREFUSED') {\n            return new Error('The server refused the connection');\n        }\n        if (options.total_retry_time > 1000 * 60 * 60) {\n            return new Error('Retry time exhausted');\n        }\n        if (options.attempt > 10) {\n            return undefined;\n        }\n        return Math.min(options.attempt * 100, 3000);\n    }\n}\n\nconst client = Promise.promisifyAll(redis.createClient(options))\n// const client = redis.createClient(options)\n\nclient.on('error', function (err) {\n    console.log('Redis Client Error:' + err)\n})\n\nfunction setValue (key, value, time) {\n    if (typeof value === 'undefined' || value == null || value === ''){\n        return\n    }\n    if (typeof value === 'string') {\n        if(typeof time !== 'undefined') {\n            client.set(key,value,'EX',time)\n        } else {\n            client.set(key,value)\n        }\n    } else if (typeof value === 'object'){\n        Object.keys(value).forEach((item) => {\n            client.hset(key, item, value[item], redis.print)\n        })\n    }\n}\n\n// setValue('id','24')\n\nfunction getValue (key) {\n    return client.getAsync(key)\n}\n\nvar getHValue = (key) => {\n    return client.hgetallAsync(key)\n}\n\nvar delValue = (key) => {\n    client.del(key, (err, res) => {\n        if (res===1){\n            console.log('delete successfully');\n        } else {\n            console.log('delete redis key error:' + err)\n        }\n    })\n}\n\n// export {\n//     client,\n//     setValue,\n//     getValue,\n//     getHValue,\n//     delValue\n// }\nmodule.exports={client,setValue,getValue,getHValue,delValue}"
      ]
    },
    "sourceType": "script",
    "mtime": 1582788906050
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/ContentController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/ContentController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/ContentController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/ContentController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "ContentController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import Post from '../model/Post'\nconst Post = require('../model/Post');\n\nconst config = require('../config/index');\n\nconst User = require('../model/User'); // const Comments = require('../model/Comments')\n\n\nconst {\n  checkCode,\n  getJWTPayload\n} = require('../common/Utils');\n\nconst UserCollect = require('../model/UserCollect');\n\nconst moment = require('dayjs');\n\nconst mkdir = require('make-dir');\n\nconst uuid = require(\"uuid/v4\");\n\nconst fs = require('fs');\n\nasync function getPostList(ctx) {\n  // const post = new Post({\n  //     uid:'5e6db4551418c95ecec41ac8',  //现在插入需要 uid ，之前不知道是怎么插入成功的\n  //     title:'test title5',\n  //     content:'test content 1',\n  //     catalog:'share',\n  //     fav:20,\n  //     isEnd:'0',\n  //     reads:'0',\n  //     answer:'0',\n  //     status:'0',\n  //     isTop:'0',\n  //     sort:'0',\n  //     tags:[{\n  //         name:'精华',\n  //         class: ''\n  //     }]\n  // })\n  // const tmp=await post.save()\n  // console.log(\"module.exports -> tmp\", tmp)\n  const body = ctx.query;\n  const sort = body.sort ? body.sort : 'created';\n  const page = body.page ? parseInt(body.page) : 0;\n  const limit = body.limit ? parseInt(body.limit) : 20;\n  const options = {};\n\n  if (typeof body.catalog !== 'undefined' && body.catalog !== '') {\n    options.catalog = body.catalog;\n  }\n\n  if (typeof body.isTop !== 'undefined') {\n    options.isTop = body.isTop;\n  }\n\n  if (typeof body.status !== 'undefined' && body.status !== '') {\n    options.isEnd = body.status;\n  }\n\n  if (typeof body.tag !== 'undefined' && body.tag !== '') {\n    options.tags = {\n      $elemMatch: {\n        name: body.tag\n      }\n    };\n  } // const result = await Post.getList(options, sort, page, limit)\n  // const result = Post.getList(options, sort, page, limit)\n\n\n  const result = await Post.getList(options, sort, page, limit);\n  console.log(result);\n  ctx.body = {\n    code: 200,\n    data: result,\n    msg: '获取文章列表成功'\n  };\n}\n\nasync function uploadImg(ctx) {\n  const file = ctx.request.files.file;\n  console.log(\"uploadImg -> file\", file);\n  const ext = file.name.split('.').pop(); //删除并返回最后一个元素\n\n  const dir = `${config.uploadPath}/${moment().format('YYYYMMDD')}`;\n  await mkdir(dir);\n  const picname = uuid();\n  const destPath = `${dir}/${picname}.${ext}`;\n  const reader = fs.createReadStream(file.path); //文件路径\n\n  const upStream = fs.createWriteStream(destPath); //目标路径\n\n  const filePath = `/${moment().format('YYYYMMDD')}/${picname}.${ext}`; //日期/uuid.png\n\n  reader.pipe(upStream);\n  ctx.body = {\n    code: 200,\n    msg: '图片上传成功',\n    data: filePath\n  };\n}\n\nasync function addPost(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"addPost -> body\", body);\n  const sid = body.sid;\n  const code = body.code;\n  const result = await checkCode(sid, code);\n\n  if (result) {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const user = await User.findById({\n      _id: obj._id\n    });\n    console.log(\"addPost -> user\", user);\n\n    if (user.favs < body.fav) {\n      ctx.body = {\n        code: 501,\n        msg: '积分不足'\n      };\n      return;\n    } else {\n      await User.updateOne({\n        _id: obj._id\n      }, {\n        $inc: {\n          favs: -body.fav\n        }\n      });\n    }\n\n    const newPost = new Post(body);\n    newPost.uid = obj._id;\n    const result = await newPost.save();\n    ctx.body = {\n      code: 200,\n      msg: '成功保存的文章',\n      date: result\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '图片验证码验证失败'\n    };\n  }\n}\n\nasync function getPostDetail(ctx) {\n  const params = ctx.query;\n\n  if (!params.tid) {\n    ctx.body = {\n      code: 500,\n      msg: '文章id为空'\n    };\n    return;\n  }\n\n  const post = await Post.findByTid(params.tid);\n  let isFav = 0;\n\n  if (typeof ctx.header.authorization !== 'undefined' && ctx.header.authorization !== '') {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const userCollect = await UserCollect.findOne({\n      uid: obj._id,\n      tid: params.tid\n    });\n\n    if (userCollect && userCollect.tid) {\n      isFav = 1;\n    }\n  }\n\n  const newPost = post.toJSON();\n  newPost.isFav = isFav;\n  const result = await Post.updateOne({\n    _id: params.tid\n  }, {\n    $inc: {\n      reads: 1\n    }\n  });\n\n  if (post._id && result.ok === 1) {\n    ctx.body = {\n      code: 200,\n      data: newPost,\n      msg: '查询文章详情成功'\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '获取文章详情失败'\n    };\n  }\n}\n\nasync function getPostListByUid(ctx) {\n  const params = ctx.query;\n  const page = params.page ? parseInt(params.page) : 0;\n  const limit = params.limit ? parseInt(params.limit) : 20;\n  const obj = await getJWTPayload(ctx.header.authorization);\n  const userId = obj._id;\n  const result = await Post.getListByUid(userId, page, limit);\n  const nums = await Post.countByUid(userId);\n\n  if (result.length >= 0) {\n    ctx.body = {\n      code: 200,\n      data: result,\n      nums,\n      msg: '成功获取用户的文章列表'\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '无法获取用户的文章'\n    };\n  }\n}\n\nasync function deletePostByUid() {}\n\nmodule.exports = {\n  getPostList,\n  uploadImg,\n  addPost,\n  getPostDetail,\n  getPostListByUid,\n  deletePostByUid\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbnRlbnRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlBvc3QiLCJyZXF1aXJlIiwiY29uZmlnIiwiVXNlciIsImNoZWNrQ29kZSIsImdldEpXVFBheWxvYWQiLCJVc2VyQ29sbGVjdCIsIm1vbWVudCIsIm1rZGlyIiwidXVpZCIsImZzIiwiZ2V0UG9zdExpc3QiLCJjdHgiLCJib2R5IiwicXVlcnkiLCJzb3J0IiwicGFnZSIsInBhcnNlSW50IiwibGltaXQiLCJvcHRpb25zIiwiY2F0YWxvZyIsImlzVG9wIiwic3RhdHVzIiwiaXNFbmQiLCJ0YWciLCJ0YWdzIiwiJGVsZW1NYXRjaCIsIm5hbWUiLCJyZXN1bHQiLCJnZXRMaXN0IiwiY29uc29sZSIsImxvZyIsImNvZGUiLCJkYXRhIiwibXNnIiwidXBsb2FkSW1nIiwiZmlsZSIsInJlcXVlc3QiLCJmaWxlcyIsImV4dCIsInNwbGl0IiwicG9wIiwiZGlyIiwidXBsb2FkUGF0aCIsImZvcm1hdCIsInBpY25hbWUiLCJkZXN0UGF0aCIsInJlYWRlciIsImNyZWF0ZVJlYWRTdHJlYW0iLCJwYXRoIiwidXBTdHJlYW0iLCJjcmVhdGVXcml0ZVN0cmVhbSIsImZpbGVQYXRoIiwicGlwZSIsImFkZFBvc3QiLCJzaWQiLCJvYmoiLCJoZWFkZXIiLCJhdXRob3JpemF0aW9uIiwidXNlciIsImZpbmRCeUlkIiwiX2lkIiwiZmF2cyIsImZhdiIsInVwZGF0ZU9uZSIsIiRpbmMiLCJuZXdQb3N0IiwidWlkIiwic2F2ZSIsImRhdGUiLCJnZXRQb3N0RGV0YWlsIiwicGFyYW1zIiwidGlkIiwicG9zdCIsImZpbmRCeVRpZCIsImlzRmF2IiwidXNlckNvbGxlY3QiLCJmaW5kT25lIiwidG9KU09OIiwicmVhZHMiLCJvayIsImdldFBvc3RMaXN0QnlVaWQiLCJ1c2VySWQiLCJnZXRMaXN0QnlVaWQiLCJudW1zIiwiY291bnRCeVVpZCIsImxlbmd0aCIsImRlbGV0ZVBvc3RCeVVpZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwi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QiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9hcGkiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgUG9zdCBmcm9tICcuLi9tb2RlbC9Qb3N0J1xuY29uc3QgUG9zdCA9IHJlcXVpcmUoJy4uL21vZGVsL1Bvc3QnKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4JylcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbC9Vc2VyJylcbi8vIGNvbnN0IENvbW1lbnRzID0gcmVxdWlyZSgnLi4vbW9kZWwvQ29tbWVudHMnKVxuY29uc3QgeyBjaGVja0NvZGUsIGdldEpXVFBheWxvYWQgfSA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG5jb25zdCBVc2VyQ29sbGVjdCA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXJDb2xsZWN0JylcblxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuY29uc3QgbWtkaXIgPSByZXF1aXJlKCdtYWtlLWRpcicpXG5jb25zdCB1dWlkID0gcmVxdWlyZShcInV1aWQvdjRcIilcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0TGlzdCAoY3R4KSB7XG4gICAgLy8gY29uc3QgcG9zdCA9IG5ldyBQb3N0KHtcbiAgICAvLyAgICAgdWlkOic1ZTZkYjQ1NTE0MThjOTVlY2VjNDFhYzgnLCAgLy/njrDlnKjmj5LlhaXpnIDopoEgdWlkIO+8jOS5i+WJjeS4jeefpemBk+aYr+aAjuS5iOaPkuWFpeaIkOWKn+eahFxuICAgIC8vICAgICB0aXRsZTondGVzdCB0aXRsZTUnLFxuICAgIC8vICAgICBjb250ZW50Oid0ZXN0IGNvbnRlbnQgMScsXG4gICAgLy8gICAgIGNhdGFsb2c6J3NoYXJlJyxcbiAgICAvLyAgICAgZmF2OjIwLFxuICAgIC8vICAgICBpc0VuZDonMCcsXG4gICAgLy8gICAgIHJlYWRzOicwJyxcbiAgICAvLyAgICAgYW5zd2VyOicwJyxcbiAgICAvLyAgICAgc3RhdHVzOicwJyxcbiAgICAvLyAgICAgaXNUb3A6JzAnLFxuICAgIC8vICAgICBzb3J0OicwJyxcbiAgICAvLyAgICAgdGFnczpbe1xuICAgIC8vICAgICAgICAgbmFtZTon57K+5Y2OJyxcbiAgICAvLyAgICAgICAgIGNsYXNzOiAnJ1xuICAgIC8vICAgICB9XVxuICAgIC8vIH0pXG4gICAgLy8gY29uc3QgdG1wPWF3YWl0IHBvc3Quc2F2ZSgpXG4gICAgLy8gY29uc29sZS5sb2coXCJtb2R1bGUuZXhwb3J0cyAtPiB0bXBcIiwgdG1wKVxuXG5cbiAgICBjb25zdCBib2R5ID0gY3R4LnF1ZXJ5XG4gICAgY29uc3Qgc29ydCA9IGJvZHkuc29ydCA/IGJvZHkuc29ydCA6ICdjcmVhdGVkJ1xuICAgIGNvbnN0IHBhZ2UgPSBib2R5LnBhZ2UgPyBwYXJzZUludChib2R5LnBhZ2UpIDogMFxuICAgIGNvbnN0IGxpbWl0ID0gYm9keS5saW1pdCA/IHBhcnNlSW50KGJvZHkubGltaXQpIDogMjBcbiAgICBjb25zdCBvcHRpb25zID0ge31cblxuICAgIGlmICh0eXBlb2YgYm9keS5jYXRhbG9nICE9PSAndW5kZWZpbmVkJyAmJiBib2R5LmNhdGFsb2cgIT09ICcnKSB7XG4gICAgICAgIG9wdGlvbnMuY2F0YWxvZyA9IGJvZHkuY2F0YWxvZ1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGJvZHkuaXNUb3AgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIG9wdGlvbnMuaXNUb3AgPSBib2R5LmlzVG9wXG4gICAgfVxuICAgIGlmICh0eXBlb2YgYm9keS5zdGF0dXMgIT09ICd1bmRlZmluZWQnICYmIGJvZHkuc3RhdHVzICE9PSAnJykge1xuICAgICAgICBvcHRpb25zLmlzRW5kID0gYm9keS5zdGF0dXNcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBib2R5LnRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYm9keS50YWcgIT09ICcnKSB7XG4gICAgICAgIG9wdGlvbnMudGFncyA9IHsgJGVsZW1NYXRjaDogeyBuYW1lOiBib2R5LnRhZyB9IH1cbiAgICB9XG4gICAgLy8gY29uc3QgcmVzdWx0ID0gYXdhaXQgUG9zdC5nZXRMaXN0KG9wdGlvbnMsIHNvcnQsIHBhZ2UsIGxpbWl0KVxuICAgIC8vIGNvbnN0IHJlc3VsdCA9IFBvc3QuZ2V0TGlzdChvcHRpb25zLCBzb3J0LCBwYWdlLCBsaW1pdClcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBQb3N0LmdldExpc3Qob3B0aW9ucywgc29ydCwgcGFnZSwgbGltaXQpXG4gICAgY29uc29sZS5sb2cocmVzdWx0KVxuXG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICBtc2c6ICfojrflj5bmlofnq6DliJfooajmiJDlip8nXG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiB1cGxvYWRJbWcgKGN0eCkge1xuICAgIGNvbnN0IGZpbGUgPSBjdHgucmVxdWVzdC5maWxlcy5maWxlXG4gICAgY29uc29sZS5sb2coXCJ1cGxvYWRJbWcgLT4gZmlsZVwiLCBmaWxlKVxuICAgIGNvbnN0IGV4dCA9IGZpbGUubmFtZS5zcGxpdCgnLicpLnBvcCgpIC8v5Yig6Zmk5bm26L+U5Zue5pyA5ZCO5LiA5Liq5YWD57SgXG4gICAgY29uc3QgZGlyID0gYCR7Y29uZmlnLnVwbG9hZFBhdGh9LyR7bW9tZW50KCkuZm9ybWF0KCdZWVlZTU1ERCcpfWBcbiAgICBhd2FpdCBta2RpcihkaXIpXG4gICAgY29uc3QgcGljbmFtZSA9IHV1aWQoKVxuICAgIGNvbnN0IGRlc3RQYXRoID0gYCR7ZGlyfS8ke3BpY25hbWV9LiR7ZXh0fWBcbiAgICBjb25zdCByZWFkZXIgPSBmcy5jcmVhdGVSZWFkU3RyZWFtKGZpbGUucGF0aCkgIC8v5paH5Lu26Lev5b6EXG4gICAgY29uc3QgdXBTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShkZXN0UGF0aCkgLy/nm67moIfot6/lvoRcbiAgICBjb25zdCBmaWxlUGF0aCA9IGAvJHttb21lbnQoKS5mb3JtYXQoJ1lZWVlNTUREJyl9LyR7cGljbmFtZX0uJHtleHR9YCAgLy/ml6XmnJ8vdXVpZC5wbmdcbiAgICByZWFkZXIucGlwZSh1cFN0cmVhbSlcbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICBtc2c6ICflm77niYfkuIrkvKDmiJDlip8nLFxuICAgICAgICBkYXRhOiBmaWxlUGF0aFxuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gYWRkUG9zdCAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwiYWRkUG9zdCAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgc2lkID0gYm9keS5zaWRcbiAgICBjb25zdCBjb2RlID0gYm9keS5jb2RlXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tDb2RlKHNpZCwgY29kZSlcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh7IF9pZDogb2JqLl9pZCB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcImFkZFBvc3QgLT4gdXNlclwiLCB1c2VyKVxuICAgICAgICBpZiAodXNlci5mYXZzIDwgYm9keS5mYXYpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDUwMSxcbiAgICAgICAgICAgICAgICBtc2c6ICfnp6/liIbkuI3otrMnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IFVzZXIudXBkYXRlT25lKHsgX2lkOiBvYmouX2lkIH0sIHsgJGluYzogeyBmYXZzOiAtYm9keS5mYXYgfSB9KVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld1Bvc3QgPSBuZXcgUG9zdChib2R5KVxuICAgICAgICBuZXdQb3N0LnVpZCA9IG9iai5faWRcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3UG9zdC5zYXZlKClcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBtc2c6ICfmiJDlip/kv53lrZjnmoTmlofnq6AnLFxuICAgICAgICAgICAgZGF0ZTogcmVzdWx0XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggemqjOivgeWksei0pSdcblxuICAgICAgICB9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0RGV0YWlsIChjdHgpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBjdHgucXVlcnlcbiAgICBpZiAoIXBhcmFtcy50aWQpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmlofnq6BpZOS4uuepuidcbiAgICAgICAgfVxuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5VGlkKHBhcmFtcy50aWQpXG4gICAgbGV0IGlzRmF2ID0gMFxuICAgIGlmIChcbiAgICAgICAgdHlwZW9mIGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbiAhPT0gJ3VuZGVmaW5lZCcgJiYgY3R4LmhlYWRlci5hdXRob3JpemF0aW9uICE9PSAnJ1xuICAgICkge1xuICAgICAgICBjb25zdCBvYmogPSBhd2FpdCBnZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICAgICAgY29uc3QgdXNlckNvbGxlY3QgPSBhd2FpdCBVc2VyQ29sbGVjdC5maW5kT25lKHtcbiAgICAgICAgICAgIHVpZDogb2JqLl9pZCxcbiAgICAgICAgICAgIHRpZDogcGFyYW1zLnRpZFxuICAgICAgICB9KVxuICAgICAgICBpZiAodXNlckNvbGxlY3QgJiYgdXNlckNvbGxlY3QudGlkKSB7XG4gICAgICAgICAgICBpc0ZhdiA9IDFcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBuZXdQb3N0ID0gcG9zdC50b0pTT04oKVxuICAgIG5ld1Bvc3QuaXNGYXYgPSBpc0ZhdlxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFBvc3QudXBkYXRlT25lKFxuICAgICAgICB7IF9pZDogcGFyYW1zLnRpZCB9LFxuICAgICAgICB7ICRpbmM6IHsgcmVhZHM6IDEgfSB9XG4gICAgKVxuICAgIGlmIChwb3N0Ll9pZCAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBkYXRhOiBuZXdQb3N0LFxuICAgICAgICAgICAgbXNnOiAn5p+l6K+i5paH56ug6K+m5oOF5oiQ5YqfJ1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfojrflj5bmlofnq6Dor6bmg4XlpLHotKUnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFBvc3RMaXN0QnlVaWQoY3R4KXtcbiAgICBjb25zdCBwYXJhbXM9Y3R4LnF1ZXJ5XG4gICAgY29uc3QgcGFnZT1wYXJhbXMucGFnZT9wYXJzZUludChwYXJhbXMucGFnZSk6MFxuICAgIGNvbnN0IGxpbWl0PXBhcmFtcy5saW1pdD9wYXJzZUludChwYXJhbXMubGltaXQpOjIwXG4gICAgY29uc3Qgb2JqPWF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgIGNvbnN0IHVzZXJJZD1vYmouX2lkXG5cbiAgICBjb25zdCByZXN1bHQ9YXdhaXQgUG9zdC5nZXRMaXN0QnlVaWQodXNlcklkLHBhZ2UsbGltaXQpXG4gICAgY29uc3QgbnVtcz1hd2FpdCBQb3N0LmNvdW50QnlVaWQodXNlcklkKVxuXG4gICAgaWYocmVzdWx0Lmxlbmd0aD49MCl7XG4gICAgICAgIGN0eC5ib2R5PXtcbiAgICAgICAgICAgIGNvZGU6MjAwLFxuICAgICAgICAgICAgZGF0YTpyZXN1bHQsXG4gICAgICAgICAgICBudW1zLFxuICAgICAgICAgICAgbXNnOifmiJDlip/ojrflj5bnlKjmiLfnmoTmlofnq6DliJfooagnXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keT17XG4gICAgICAgICAgICBjb2RlOjUwMCxcbiAgICAgICAgICAgIG1zZzon5peg5rOV6I635Y+W55So5oi355qE5paH56ugJ1xuICAgICAgICB9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBkZWxldGVQb3N0QnlVaWQoKXtcblxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0geyBnZXRQb3N0TGlzdCwgdXBsb2FkSW1nLCBhZGRQb3N0LCBnZXRQb3N0RGV0YWlsLCBnZXRQb3N0TGlzdEJ5VWlkLGRlbGV0ZVBvc3RCeVVpZCB9Il19",
    "map": {
      "version": 3,
      "sources": [
        "ContentController.js"
      ],
      "names": [
        "Post",
        "require",
        "config",
        "User",
        "checkCode",
        "getJWTPayload",
        "UserCollect",
        "moment",
        "mkdir",
        "uuid",
        "fs",
        "getPostList",
        "ctx",
        "body",
        "query",
        "sort",
        "page",
        "parseInt",
        "limit",
        "options",
        "catalog",
        "isTop",
        "status",
        "isEnd",
        "tag",
        "tags",
        "$elemMatch",
        "name",
        "result",
        "getList",
        "console",
        "log",
        "code",
        "data",
        "msg",
        "uploadImg",
        "file",
        "request",
        "files",
        "ext",
        "split",
        "pop",
        "dir",
        "uploadPath",
        "format",
        "picname",
        "destPath",
        "reader",
        "createReadStream",
        "path",
        "upStream",
        "createWriteStream",
        "filePath",
        "pipe",
        "addPost",
        "sid",
        "obj",
        "header",
        "authorization",
        "user",
        "findById",
        "_id",
        "favs",
        "fav",
        "updateOne",
        "$inc",
        "newPost",
        "uid",
        "save",
        "date",
        "getPostDetail",
        "params",
        "tid",
        "post",
        "findByTid",
        "isFav",
        "userCollect",
        "findOne",
        "toJSON",
        "reads",
        "ok",
        "getPostListByUid",
        "userId",
        "getListByUid",
        "nums",
        "countByUid",
        "length",
        "deletePostByUid",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "// import Post from '../model/Post'\nconst Post = require('../model/Post')\nconst config = require('../config/index')\nconst User = require('../model/User')\n// const Comments = require('../model/Comments')\nconst { checkCode, getJWTPayload } = require('../common/Utils')\nconst UserCollect = require('../model/UserCollect')\n\nconst moment = require('dayjs')\nconst mkdir = require('make-dir')\nconst uuid = require(\"uuid/v4\")\nconst fs = require('fs')\n\nasync function getPostList (ctx) {\n    // const post = new Post({\n    //     uid:'5e6db4551418c95ecec41ac8',  //现在插入需要 uid ，之前不知道是怎么插入成功的\n    //     title:'test title5',\n    //     content:'test content 1',\n    //     catalog:'share',\n    //     fav:20,\n    //     isEnd:'0',\n    //     reads:'0',\n    //     answer:'0',\n    //     status:'0',\n    //     isTop:'0',\n    //     sort:'0',\n    //     tags:[{\n    //         name:'精华',\n    //         class: ''\n    //     }]\n    // })\n    // const tmp=await post.save()\n    // console.log(\"module.exports -> tmp\", tmp)\n\n\n    const body = ctx.query\n    const sort = body.sort ? body.sort : 'created'\n    const page = body.page ? parseInt(body.page) : 0\n    const limit = body.limit ? parseInt(body.limit) : 20\n    const options = {}\n\n    if (typeof body.catalog !== 'undefined' && body.catalog !== '') {\n        options.catalog = body.catalog\n    }\n    if (typeof body.isTop !== 'undefined') {\n        options.isTop = body.isTop\n    }\n    if (typeof body.status !== 'undefined' && body.status !== '') {\n        options.isEnd = body.status\n    }\n    if (typeof body.tag !== 'undefined' && body.tag !== '') {\n        options.tags = { $elemMatch: { name: body.tag } }\n    }\n    // const result = await Post.getList(options, sort, page, limit)\n    // const result = Post.getList(options, sort, page, limit)\n    const result = await Post.getList(options, sort, page, limit)\n    console.log(result)\n\n    ctx.body = {\n        code: 200,\n        data: result,\n        msg: '获取文章列表成功'\n    }\n}\n\nasync function uploadImg (ctx) {\n    const file = ctx.request.files.file\n    console.log(\"uploadImg -> file\", file)\n    const ext = file.name.split('.').pop() //删除并返回最后一个元素\n    const dir = `${config.uploadPath}/${moment().format('YYYYMMDD')}`\n    await mkdir(dir)\n    const picname = uuid()\n    const destPath = `${dir}/${picname}.${ext}`\n    const reader = fs.createReadStream(file.path)  //文件路径\n    const upStream = fs.createWriteStream(destPath) //目标路径\n    const filePath = `/${moment().format('YYYYMMDD')}/${picname}.${ext}`  //日期/uuid.png\n    reader.pipe(upStream)\n    ctx.body = {\n        code: 200,\n        msg: '图片上传成功',\n        data: filePath\n    }\n}\n\nasync function addPost (ctx) {\n    const { body } = ctx.request\n    console.log(\"addPost -> body\", body)\n    const sid = body.sid\n    const code = body.code\n    const result = await checkCode(sid, code)\n    if (result) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const user = await User.findById({ _id: obj._id })\n        console.log(\"addPost -> user\", user)\n        if (user.favs < body.fav) {\n            ctx.body = {\n                code: 501,\n                msg: '积分不足'\n            }\n            return\n        } else {\n            await User.updateOne({ _id: obj._id }, { $inc: { favs: -body.fav } })\n        }\n        const newPost = new Post(body)\n        newPost.uid = obj._id\n        const result = await newPost.save()\n        ctx.body = {\n            code: 200,\n            msg: '成功保存的文章',\n            date: result\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '图片验证码验证失败'\n\n        }\n    }\n}\n\nasync function getPostDetail (ctx) {\n    const params = ctx.query\n    if (!params.tid) {\n        ctx.body = {\n            code: 500,\n            msg: '文章id为空'\n        }\n        return\n    }\n    const post = await Post.findByTid(params.tid)\n    let isFav = 0\n    if (\n        typeof ctx.header.authorization !== 'undefined' && ctx.header.authorization !== ''\n    ) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const userCollect = await UserCollect.findOne({\n            uid: obj._id,\n            tid: params.tid\n        })\n        if (userCollect && userCollect.tid) {\n            isFav = 1\n        }\n    }\n    const newPost = post.toJSON()\n    newPost.isFav = isFav\n    const result = await Post.updateOne(\n        { _id: params.tid },\n        { $inc: { reads: 1 } }\n    )\n    if (post._id && result.ok === 1) {\n        ctx.body = {\n            code: 200,\n            data: newPost,\n            msg: '查询文章详情成功'\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '获取文章详情失败'\n        }\n    }\n}\n\nasync function getPostListByUid(ctx){\n    const params=ctx.query\n    const page=params.page?parseInt(params.page):0\n    const limit=params.limit?parseInt(params.limit):20\n    const obj=await getJWTPayload(ctx.header.authorization)\n    const userId=obj._id\n\n    const result=await Post.getListByUid(userId,page,limit)\n    const nums=await Post.countByUid(userId)\n\n    if(result.length>=0){\n        ctx.body={\n            code:200,\n            data:result,\n            nums,\n            msg:'成功获取用户的文章列表'\n        }\n    } else {\n        ctx.body={\n            code:500,\n            msg:'无法获取用户的文章'\n        }\n    }\n}\n\nasync function deletePostByUid(){\n\n}\n\n\nmodule.exports = { getPostList, uploadImg, addPost, getPostDetail, getPostListByUid,deletePostByUid }"
      ]
    },
    "sourceType": "script",
    "mtime": 1586401951537
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Post.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Post.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Post.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Post.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "Post.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import mongoose from '@/config/DBHelpler'\n// import moment from 'dayjs'\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst PostSchema = new Schema({\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  title: {\n    type: String\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  catalog: {\n    type: String\n  },\n  fav: {\n    type: String,\n    default: ''\n  },\n  isEnd: {\n    type: String,\n    default: '0'\n  },\n  reads: {\n    type: Number,\n    default: 0\n  },\n  answer: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '0'\n  },\n  isTop: {\n    type: String,\n    default: '0'\n  },\n  sort: {\n    type: String,\n    default: 100\n  },\n  tags: {\n    type: Array,\n    default: [// {\n      //   name: '',\n      //   class: ''\n      // }\n    ]\n  }\n});\nPostSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n});\nPostSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss');\n  next();\n});\nPostSchema.statics = {\n  /**\n   * 获取文章列表数据\n   * @param {Object} options 筛选条件\n   * @param {String} sort 排序方式\n   * @param {Number} page 分页页数\n   * @param {Number} limit 分页条数\n   */\n  // getList: function (options, sort, page, limit) {\n  //   return this.find(options)\n  //     .sort({ [sort]: -1 })\n  //     .skip(page * limit)\n  //     .limit(limit)\n  //     // .populate({\n  //     //   path: 'uid',\n  //     //   select: 'name isVip pic'\n  //     // })\n  // },\n  // 通过 sort，skip，limit，populate 去查询文章，其中 populate 可以查询到 user 的信息\n  getList: function (options, sort, page, limit) {\n    return this.find(options).sort({\n      [sort]: -1\n    }).skip(page * limit).limit(limit).populate({\n      path: 'uid',\n      select: 'name isVip pic'\n    });\n  },\n  getTopWeek: function () {\n    return this.find({\n      created: {\n        $gte: moment().subtract(7, 'days')\n      }\n    }, {\n      answer: 1,\n      title: 1\n    }).sort({\n      answer: -1\n    }).limit(15);\n  },\n  findByTid: function (id) {\n    return this.findOne({\n      _id: id\n    }).populate({\n      path: 'uid',\n      select: 'name pic isVip _id'\n    });\n  },\n  getListByUid: function (id, page, limit) {\n    return this.find({\n      uid: id\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  countByUid: function (id) {\n    return this.find({\n      uid: id\n    }).countDocuments();\n  }\n};\nconst PostModel = mongoose.model('post', PostSchema); // export default PostModel\n\nmodule.exports = PostModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBvc3QuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiUG9zdFNjaGVtYSIsInVpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJ0aXRsZSIsImNvbnRlbnQiLCJjcmVhdGVkIiwiRGF0ZSIsImNhdGFsb2ciLCJmYXYiLCJkZWZhdWx0IiwiaXNFbmQiLCJyZWFkcyIsIk51bWJlciIsImFuc3dlciIsInN0YXR1cyIsImlzVG9wIiwic29ydCIsInRhZ3MiLCJBcnJheSIsInZpcnR1YWwiLCJsb2NhbEZpZWxkIiwiZm9yZWlnbkZpZWxkIiwicHJlIiwibmV4dCIsImZvcm1hdCIsInN0YXRpY3MiLCJnZXRMaXN0Iiwib3B0aW9ucyIsInBhZ2UiLCJsaW1pdCIsImZpbmQiLCJza2lwIiwicG9wdWxhdGUiLCJwYXRoIiwic2VsZWN0IiwiZ2V0VG9wV2VlayIsIiRndGUiLCJzdWJ0cmFjdCIsImZpbmRCeVRpZCIsImlkIiwiZmluZE9uZSIsIl9pZCIsImdldExpc3RCeVVpZCIsImNvdW50QnlVaWQiLCJjb3VudERvY3VtZW50cyIsIlBvc3RNb2RlbCIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0EsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsb0JBQUQsQ0FBeEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsT0FBRCxDQUF0Qjs7QUFFQSxNQUFNRSxNQUFNLEdBQUdILFFBQVEsQ0FBQ0csTUFBeEI7QUFFQSxNQUFNQyxVQUFVLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQzVCRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEdUI7QUFFNUJDLEVBQUFBLEtBQUssRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FGcUI7QUFHNUJHLEVBQUFBLE9B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SSxDQU9DO0FBQUVILE1BQUFBLE1BQU0sRUFBRSxDQUFDO0FBQVgsS0FQRCxFQVFKZ0IsS0FSSSxDQVFFLEVBUkYsQ0FBUDtBQVNELEdBeENrQjtBQXlDbkJTLEVBQUFBLFNBQVMsRUFBRSxVQUFVQyxFQUFWLEVBQWM7QUFDdkIsV0FBTyxLQUFLQyxPQUFMLENBQWE7QUFBRUMsTUFBQUEsR0FBRyxFQUFFRjtBQUFQLEtBQWIsRUFBMEJQLFFBQTFCLENBQW1DO0FBQ3hDQyxNQUFBQSxJQUFJLEVBQUUsS0FEa0M7QUFFeENDLE1BQUFBLE1BQU0sRUFBRTtBQUZnQyxLQUFuQyxDQUFQO0FBSUQsR0E5Q2tCO0FBK0NuQlEsRUFBQUEsWUFBWSxFQUFFLFVBQVVILEVBQVYsRUFBY1gsSUFBZCxFQUFvQkMsS0FBcEIsRUFBMkI7QUFDdkMsV0FBTyxLQUFLQyxJQUFMLENBQVU7QUFBRS9CLE1BQUFBLEdBQUcsRUFBRXdDO0FBQVAsS0FBVixFQUNKUixJQURJLENBQ0NILElBQUksR0FBR0MsS0FEUixFQUVKQSxLQUZJLENBRUVBLEtBRkYsRUFHSmIsSUFISSxDQUdDO0FBQUVYLE1BQUFBLE9BQU8sRUFBRSxDQUFDO0FBQVosS0FIRCxDQUFQO0FBSUQsR0FwRGtCO0FBcURuQnNDLEVBQUFBLFVBQVUsRUFBRSxVQUFVSixFQUFWLEVBQWM7QUFDeEIsV0FBTyxLQUFLVCxJQUFMLENBQVU7QUFBRS9CLE1BQUFBLEdBQUcsRUFBRXdDO0FBQVAsS0FBVixFQUF1QkssY0FBdkIsRUFBUDtBQUNEO0FBdkRrQixDQUFyQjtBQTBEQSxNQUFNQyxTQUFTLEdBQUduRCxRQUFRLENBQUNvRCxLQUFULENBQWUsTUFBZixFQUF1QmhELFVBQXZCLENBQWxCLEMsQ0FFQTs7QUFDQWlELE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsU0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgbW9uZ29vc2UgZnJvbSAnQC9jb25maWcvREJIZWxwbGVyJ1xuLy8gaW1wb3J0IG1vbWVudCBmcm9tICdkYXlqcydcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnLi4vY29uZmlnL0RCSGVscGVyJylcbmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ2RheWpzJylcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IFBvc3RTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIHRpdGxlOiB7IHR5cGU6IFN0cmluZyB9LFxuICBjb250ZW50OiB7IHR5cGU6IFN0cmluZyB9LFxuICBjcmVhdGVkOiB7IHR5cGU6IERhdGUgfSxcbiAgY2F0YWxvZzogeyB0eXBlOiBTdHJpbmcgfSxcbiAgZmF2OiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDonJyB9LFxuICBpc0VuZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9LFxuICByZWFkczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcbiAgYW5zd2VyOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxuICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfSxcbiAgaXNUb3A6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfSxcbiAgc29ydDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6IDEwMCB9LFxuICB0YWdzOiB7XG4gICAgdHlwZTogQXJyYXksXG4gICAgZGVmYXVsdDogW1xuICAgICAgLy8ge1xuICAgICAgLy8gICBuYW1lOiAnJyxcbiAgICAgIC8vICAgY2xhc3M6ICcnXG4gICAgICAvLyB9XG4gICAgXVxuICB9XG59KVxuXG5Qb3N0U2NoZW1hLnZpcnR1YWwoJ3VzZXInLCB7XG4gIHJlZjogJ3VzZXJzJyxcbiAgbG9jYWxGaWVsZDogJ3VpZCcsXG4gIGZvcmVpZ25GaWVsZDogJ19pZCdcbn0pXG5cblBvc3RTY2hlbWEucHJlKCdzYXZlJywgZnVuY3Rpb24gKG5leHQpIHtcbiAgdGhpcy5jcmVhdGVkID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgbmV4dCgpXG59KVxuXG5Qb3N0U2NoZW1hLnN0YXRpY3MgPSB7XG4gIC8qKlxuICAgKiDojrflj5bmlofnq6DliJfooajmlbDmja5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMg562b6YCJ5p2h5Lu2XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzb3J0IOaOkuW6j+aWueW8j1xuICAgKiBAcGFyYW0ge051bWJlcn0gcGFnZSDliIbpobXpobXmlbBcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGxpbWl0IOWIhumhteadoeaVsFxuICAgKi9cbiAgLy8gZ2V0TGlzdDogZnVuY3Rpb24gKG9wdGlvbnMsIHNvcnQsIHBhZ2UsIGxpbWl0KSB7XG4gIC8vICAgcmV0dXJuIHRoaXMuZmluZChvcHRpb25zKVxuICAvLyAgICAgLnNvcnQoeyBbc29ydF06IC0xIH0pXG4gIC8vICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gIC8vICAgICAubGltaXQobGltaXQpXG4gIC8vICAgICAvLyAucG9wdWxhdGUoe1xuICAvLyAgICAgLy8gICBwYXRoOiAndWlkJyxcbiAgLy8gICAgIC8vICAgc2VsZWN0OiAnbmFtZSBpc1ZpcCBwaWMnXG4gIC8vICAgICAvLyB9KVxuICAvLyB9LFxuXG4gIC8vIOmAmui/hyBzb3J077yMc2tpcO+8jGxpbWl077yMcG9wdWxhdGUg5Y675p+l6K+i5paH56ug77yM5YW25LitIHBvcHVsYXRlIOWPr+S7peafpeivouWIsCB1c2VyIOeahOS/oeaBr1xuICBnZXRMaXN0OiBmdW5jdGlvbiAob3B0aW9ucywgc29ydCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKG9wdGlvbnMpXG4gICAgLnNvcnQoe1tzb3J0XTotMX0pXG4gICAgLnNraXAocGFnZSpsaW1pdClcbiAgICAubGltaXQobGltaXQpXG4gICAgLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6J3VpZCcsICAgICAgICBcbiAgICAgIHNlbGVjdDonbmFtZSBpc1ZpcCBwaWMnXG4gICAgfSlcbiAgfSxcbiAgZ2V0VG9wV2VlazogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoe1xuICAgICAgY3JlYXRlZDoge1xuICAgICAgICAkZ3RlOiBtb21lbnQoKS5zdWJ0cmFjdCg3LCAnZGF5cycpXG4gICAgICB9XG4gICAgfSwge1xuICAgICAgYW5zd2VyOiAxLFxuICAgICAgdGl0bGU6IDFcbiAgICB9KS5zb3J0KHsgYW5zd2VyOiAtMSB9KVxuICAgICAgLmxpbWl0KDE1KVxuICB9LFxuICBmaW5kQnlUaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmRPbmUoeyBfaWQ6IGlkIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICd1aWQnLFxuICAgICAgc2VsZWN0OiAnbmFtZSBwaWMgaXNWaXAgX2lkJ1xuICAgIH0pXG4gIH0sXG4gIGdldExpc3RCeVVpZDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pXG4gICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG4gIGNvdW50QnlVaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pLmNvdW50RG9jdW1lbnRzKClcbiAgfVxufVxuXG5jb25zdCBQb3N0TW9kZWwgPSBtb25nb29zZS5tb2RlbCgncG9zdCcsIFBvc3RTY2hlbWEpXG5cbi8vIGV4cG9ydCBkZWZhdWx0IFBvc3RNb2RlbFxubW9kdWxlLmV4cG9ydHMgPSBQb3N0TW9kZWwiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Post.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "PostSchema",
        "uid",
        "type",
        "String",
        "ref",
        "title",
        "content",
        "created",
        "Date",
        "catalog",
        "fav",
        "default",
        "isEnd",
        "reads",
        "Number",
        "answer",
        "status",
        "isTop",
        "sort",
        "tags",
        "Array",
        "virtual",
        "localField",
        "foreignField",
        "pre",
        "next",
        "format",
        "statics",
        "getList",
        "options",
        "page",
        "limit",
        "find",
        "skip",
        "populate",
        "path",
        "select",
        "getTopWeek",
        "$gte",
        "subtract",
        "findByTid",
        "id",
        "findOne",
        "_id",
        "getListByUid",
        "countByUid",
        "countDocuments",
        "PostModel",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "// import mongoose from '@/config/DBHelpler'\n// import moment from 'dayjs'\nconst mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\n\nconst Schema = mongoose.Schema\n\nconst PostSchema = new Schema({\n  uid: { type: String, ref: 'users' },\n  title: { type: String },\n  content: { type: String },\n  created: { type: Date },\n  catalog: { type: String },\n  fav: { type: String, default:'' },\n  isEnd: { type: String, default: '0' },\n  reads: { type: Number, default: 0 },\n  answer: { type: Number, default: 0 },\n  status: { type: String, default: '0' },\n  isTop: { type: String, default: '0' },\n  sort: { type: String, default: 100 },\n  tags: {\n    type: Array,\n    default: [\n      // {\n      //   name: '',\n      //   class: ''\n      // }\n    ]\n  }\n})\n\nPostSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n})\n\nPostSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss')\n  next()\n})\n\nPostSchema.statics = {\n  /**\n   * 获取文章列表数据\n   * @param {Object} options 筛选条件\n   * @param {String} sort 排序方式\n   * @param {Number} page 分页页数\n   * @param {Number} limit 分页条数\n   */\n  // getList: function (options, sort, page, limit) {\n  //   return this.find(options)\n  //     .sort({ [sort]: -1 })\n  //     .skip(page * limit)\n  //     .limit(limit)\n  //     // .populate({\n  //     //   path: 'uid',\n  //     //   select: 'name isVip pic'\n  //     // })\n  // },\n\n  // 通过 sort，skip，limit，populate 去查询文章，其中 populate 可以查询到 user 的信息\n  getList: function (options, sort, page, limit) {\n    return this.find(options)\n    .sort({[sort]:-1})\n    .skip(page*limit)\n    .limit(limit)\n    .populate({\n      path:'uid',        \n      select:'name isVip pic'\n    })\n  },\n  getTopWeek: function () {\n    return this.find({\n      created: {\n        $gte: moment().subtract(7, 'days')\n      }\n    }, {\n      answer: 1,\n      title: 1\n    }).sort({ answer: -1 })\n      .limit(15)\n  },\n  findByTid: function (id) {\n    return this.findOne({ _id: id }).populate({\n      path: 'uid',\n      select: 'name pic isVip _id'\n    })\n  },\n  getListByUid: function (id, page, limit) {\n    return this.find({ uid: id })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  countByUid: function (id) {\n    return this.find({ uid: id }).countDocuments()\n  }\n}\n\nconst PostModel = mongoose.model('post', PostSchema)\n\n// export default PostModel\nmodule.exports = PostModel"
      ]
    },
    "sourceType": "script",
    "mtime": 1585706466117
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/DBHelper.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/DBHelper.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/DBHelper.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/DBHelper.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "DBHelper.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('mongoose'); // const config = require('./index')\n\n\nmongoose.set('useCreateIndex', true);\nconst DB_URL = 'mongodb://echo:123456@47.99.202.255:27018/testdb';\nconst REDIS = {\n  host: '47.99.202.255',\n  port: 27017,\n  password: '123456'\n};\nmongoose.connect(DB_URL, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\nmongoose.connection.on('connected', () => {\n  console.log('Mongoose connection open to ' + DB_URL);\n});\nmongoose.connection.on('error', err => {\n  console.log('Mongoose connection error: ' + err);\n});\nmongoose.connection.on('disconnected', () => {\n  console.log('Mongoose connection disconnected');\n});\nmodule.exports = mongoose;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRCSGVscGVyLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsInNldCIsIkRCX1VSTCIsIlJFRElTIiwiaG9zdCIsInBvcnQiLCJwYXNzd29yZCIsImNvbm5lY3QiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJjb25uZWN0aW9uIiwib24iLCJjb25zb2xlIiwibG9nIiwiZXJyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCLEMsQ0FDQTs7O0FBRUFELFFBQVEsQ0FBQ0UsR0FBVCxDQUFhLGdCQUFiLEVBQThCLElBQTlCO0FBRUEsTUFBTUMsTUFBTSxHQUFDLGtEQUFiO0FBQ0EsTUFBTUMsS0FBSyxHQUFHO0FBQ1ZDLEVBQUFBLElBQUksRUFBRSxlQURJO0FBRVZDLEVBQUFBLElBQUksRUFBRSxLQUZJO0FBR1ZDLEVBQUFBLFFBQVEsRUFBRTtBQUhBLENBQWQ7QUFNQVAsUUFBUSxDQUFDUSxPQUFULENBQWlCTCxNQUFqQixFQUF3QjtBQUNwQk0sRUFBQUEsZUFBZSxFQUFFLElBREc7QUFFcEJDLEVBQUFBLGtCQUFrQixFQUFFO0FBRkEsQ0FBeEI7QUFLQVYsUUFBUSxDQUFDVyxVQUFULENBQW9CQyxFQUFwQixDQUF1QixXQUF2QixFQUFvQyxNQUFNO0FBQ3RDQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQ0FBK0JYLE1BQTNDO0FBQ0gsQ0FGRDtBQUlBSCxRQUFRLENBQUNXLFVBQVQsQ0FBb0JDLEVBQXBCLENBQXVCLE9BQXZCLEVBQWlDRyxHQUFELElBQVM7QUFDckNGLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdDQUE4QkMsR0FBMUM7QUFDSCxDQUZEO0FBSUFmLFFBQVEsQ0FBQ1csVUFBVCxDQUFvQkMsRUFBcEIsQ0FBdUIsY0FBdkIsRUFBdUMsTUFBTTtBQUN6Q0MsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksa0NBQVo7QUFDSCxDQUZEO0FBSUFFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlakIsUUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJylcbi8vIGNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4vaW5kZXgnKVxuXG5tb25nb29zZS5zZXQoJ3VzZUNyZWF0ZUluZGV4Jyx0cnVlKVxuXG5jb25zdCBEQl9VUkw9J21vbmdvZGI6Ly9lY2hvOjEyMzQ1NkA0Ny45OS4yMDIuMjU1OjI3MDE4L3Rlc3RkYidcbmNvbnN0IFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAyNzAxNyxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cblxubW9uZ29vc2UuY29ubmVjdChEQl9VUkwse1xuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWVcbn0pXG5cbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oJ2Nvbm5lY3RlZCcsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnTW9uZ29vc2UgY29ubmVjdGlvbiBvcGVuIHRvICcrREJfVVJMKTtcbn0pXG5cbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdNb25nb29zZSBjb25uZWN0aW9uIGVycm9yOiAnK2Vycik7XG59KVxuXG5tb25nb29zZS5jb25uZWN0aW9uLm9uKCdkaXNjb25uZWN0ZWQnLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ01vbmdvb3NlIGNvbm5lY3Rpb24gZGlzY29ubmVjdGVkJylcbn0pXG5cbm1vZHVsZS5leHBvcnRzPW1vbmdvb3NlIl19",
    "map": {
      "version": 3,
      "sources": [
        "DBHelper.js"
      ],
      "names": [
        "mongoose",
        "require",
        "set",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "connect",
        "useNewUrlParser",
        "useUnifiedTopology",
        "connection",
        "on",
        "console",
        "log",
        "err",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB,C,CACA;;;AAEAD,QAAQ,CAACE,GAAT,CAAa,gBAAb,EAA8B,IAA9B;AAEA,MAAMC,MAAM,GAAC,kDAAb;AACA,MAAMC,KAAK,GAAG;AACVC,EAAAA,IAAI,EAAE,eADI;AAEVC,EAAAA,IAAI,EAAE,KAFI;AAGVC,EAAAA,QAAQ,EAAE;AAHA,CAAd;AAMAP,QAAQ,CAACQ,OAAT,CAAiBL,MAAjB,EAAwB;AACpBM,EAAAA,eAAe,EAAE,IADG;AAEpBC,EAAAA,kBAAkB,EAAE;AAFA,CAAxB;AAKAV,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,WAAvB,EAAoC,MAAM;AACtCC,EAAAA,OAAO,CAACC,GAAR,CAAY,iCAA+BX,MAA3C;AACH,CAFD;AAIAH,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAiCG,GAAD,IAAS;AACrCF,EAAAA,OAAO,CAACC,GAAR,CAAY,gCAA8BC,GAA1C;AACH,CAFD;AAIAf,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,cAAvB,EAAuC,MAAM;AACzCC,EAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ;AACH,CAFD;AAIAE,MAAM,CAACC,OAAP,GAAejB,QAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "const mongoose = require('mongoose')\n// const config = require('./index')\n\nmongoose.set('useCreateIndex',true)\n\nconst DB_URL='mongodb://echo:123456@47.99.202.255:27018/testdb'\nconst REDIS = {\n    host: '47.99.202.255',\n    port: 27017,\n    password: '123456'\n}\n\nmongoose.connect(DB_URL,{\n    useNewUrlParser: true,\n    useUnifiedTopology: true\n})\n\nmongoose.connection.on('connected', () => {\n    console.log('Mongoose connection open to '+DB_URL);\n})\n\nmongoose.connection.on('error', (err) => {\n    console.log('Mongoose connection error: '+err);\n})\n\nmongoose.connection.on('disconnected', () => {\n    console.log('Mongoose connection disconnected')\n})\n\nmodule.exports=mongoose"
      ]
    },
    "sourceType": "script",
    "mtime": 1583598900525
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/index.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst path = require('path');\n\nconst DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb';\nconst REDIS = {\n  host: '47.99.202.255',\n  port: 15001,\n  password: '123456'\n};\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'none' : 'http://localhost:8080';\nconst uploadPath = process.env.NODE_ENV === 'production' ? '/app/public' : path.join(path.resolve(__dirname), '../../public');\nconst JWT_SECRET = 'onedaythisismyfuture'; // 本来是一个编码后的值，这里使用了随机写的字母\n// export default {\n//     DB_URL,\n//     REDIS\n// }\n\nconst wsPort = 3001;\nmodule.exports = {\n  DB_URL,\n  REDIS,\n  uploadPath,\n  JWT_SECRET,\n  baseUrl,\n  wsPort\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInBhdGgiLCJyZXF1aXJlIiwiREJfVVJMIiwiUkVESVMiLCJob3N0IiwicG9ydCIsInBhc3N3b3JkIiwiYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInVwbG9hZFBhdGgiLCJqb2luIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsIkpXVF9TRUNSRVQiLCJ3c1BvcnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBRUEsTUFBTUMsTUFBTSxHQUFHLGtEQUFmO0FBQ0EsTUFBTUMsS0FBSyxHQUFHO0FBQ1ZDLEVBQUFBLElBQUksRUFBRSxlQURJO0FBRVZDLEVBQUFBLElBQUksRUFBRSxLQUZJO0FBR1ZDLEVBQUFBLFFBQVEsRUFBRTtBQUhBLENBQWQ7QUFLQSxNQUFNQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxRQUFaLEtBQXlCLFlBQXpCLEdBQXdDLE1BQXhDLEdBQWlELHVCQUFqRTtBQUNBLE1BQU1DLFVBQVUsR0FBR0gsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFFBQVosS0FBeUIsWUFBekIsR0FBd0MsYUFBeEMsR0FBd0RWLElBQUksQ0FBQ1ksSUFBTCxDQUFVWixJQUFJLENBQUNhLE9BQUwsQ0FBYUMsU0FBYixDQUFWLEVBQW1DLGNBQW5DLENBQTNFO0FBQ0EsTUFBTUMsVUFBVSxHQUFHLHNCQUFuQixDLENBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBOztBQUNBLE1BQU1DLE1BQU0sR0FBRyxJQUFmO0FBRUFDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUFFaEIsRUFBQUEsTUFBRjtBQUFVQyxFQUFBQSxLQUFWO0FBQWlCUSxFQUFBQSxVQUFqQjtBQUE2QkksRUFBQUEsVUFBN0I7QUFBeUNSLEVBQUFBLE9BQXpDO0FBQWtEUyxFQUFBQTtBQUFsRCxDQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpXG5cbmNvbnN0IERCX1VSTCA9ICdtb25nb2RiOi8vdGVzdDoxMjM0NTZANDcuOTkuMjAyLjI1NToxNTAwMS90ZXN0ZGInXG5jb25zdCBSRURJUyA9IHtcbiAgICBob3N0OiAnNDcuOTkuMjAyLjI1NScsXG4gICAgcG9ydDogMTUwMDEsXG4gICAgcGFzc3dvcmQ6ICcxMjM0NTYnXG59XG5jb25zdCBiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdub25lJyA6ICdodHRwOi8vbG9jYWxob3N0OjgwODAnXG5jb25zdCB1cGxvYWRQYXRoID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICcvYXBwL3B1YmxpYycgOiBwYXRoLmpvaW4ocGF0aC5yZXNvbHZlKF9fZGlybmFtZSksICcuLi8uLi9wdWJsaWMnKVxuY29uc3QgSldUX1NFQ1JFVCA9ICdvbmVkYXl0aGlzaXNteWZ1dHVyZScgIC8vIOacrOadpeaYr+S4gOS4que8lueggeWQjueahOWAvO+8jOi/memHjOS9v+eUqOS6humaj+acuuWGmeeahOWtl+avjVxuLy8gZXhwb3J0IGRlZmF1bHQge1xuLy8gICAgIERCX1VSTCxcbi8vICAgICBSRURJU1xuLy8gfVxuY29uc3Qgd3NQb3J0ID0gMzAwMVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgREJfVVJMLCBSRURJUywgdXBsb2FkUGF0aCwgSldUX1NFQ1JFVCwgYmFzZVVybCwgd3NQb3J0IH0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "path",
        "require",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "baseUrl",
        "process",
        "env",
        "NODE_ENV",
        "uploadPath",
        "join",
        "resolve",
        "__dirname",
        "JWT_SECRET",
        "wsPort",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AAEA,MAAMC,MAAM,GAAG,kDAAf;AACA,MAAMC,KAAK,GAAG;AACVC,EAAAA,IAAI,EAAE,eADI;AAEVC,EAAAA,IAAI,EAAE,KAFI;AAGVC,EAAAA,QAAQ,EAAE;AAHA,CAAd;AAKA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,MAAxC,GAAiD,uBAAjE;AACA,MAAMC,UAAU,GAAGH,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,aAAxC,GAAwDV,IAAI,CAACY,IAAL,CAAUZ,IAAI,CAACa,OAAL,CAAaC,SAAb,CAAV,EAAmC,cAAnC,CAA3E;AACA,MAAMC,UAAU,GAAG,sBAAnB,C,CAA2C;AAC3C;AACA;AACA;AACA;;AACA,MAAMC,MAAM,GAAG,IAAf;AAEAC,MAAM,CAACC,OAAP,GAAiB;AAAEhB,EAAAA,MAAF;AAAUC,EAAAA,KAAV;AAAiBQ,EAAAA,UAAjB;AAA6BI,EAAAA,UAA7B;AAAyCR,EAAAA,OAAzC;AAAkDS,EAAAA;AAAlD,CAAjB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "const path = require('path')\n\nconst DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb'\nconst REDIS = {\n    host: '47.99.202.255',\n    port: 15001,\n    password: '123456'\n}\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'none' : 'http://localhost:8080'\nconst uploadPath = process.env.NODE_ENV === 'production' ? '/app/public' : path.join(path.resolve(__dirname), '../../public')\nconst JWT_SECRET = 'onedaythisismyfuture'  // 本来是一个编码后的值，这里使用了随机写的字母\n// export default {\n//     DB_URL,\n//     REDIS\n// }\nconst wsPort = 3001\n\nmodule.exports = { DB_URL, REDIS, uploadPath, JWT_SECRET, baseUrl, wsPort }"
      ]
    },
    "sourceType": "script",
    "mtime": 1586661426170
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/User.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/User.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/User.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/User.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "User.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String,\n    index: {\n      unique: true\n    },\n    sparse: true\n  },\n  name: {\n    type: String\n  },\n  password: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  updated: {\n    type: Date\n  },\n  favs: {\n    type: Number,\n    default: 100\n  },\n  gender: {\n    type: String,\n    default: ''\n  },\n  roles: {\n    type: Array,\n    default: ['user']\n  },\n  pic: {\n    type: String,\n    default: '/img/bear-200-200.jpg'\n  },\n  // 使用的是前端的图片地址\n  mobile: {\n    type: String,\n    match: /^1[3-9](\\d{9})$/,\n    default: ''\n  },\n  status: {\n    type: String,\n    default: '0'\n  },\n  regmark: {\n    type: String,\n    default: ''\n  },\n  location: {\n    type: String,\n    default: ''\n  },\n  isVip: {\n    type: String,\n    default: '0'\n  },\n  count: {\n    type: Number,\n    default: 0\n  }\n});\nUserSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH-mm:ss');\n  next();\n});\nUserSchema.pre('update', function (next) {\n  this.updated = moment().format('YYYY-MM-DD HH-mm:ss');\n  next();\n});\nUserSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MogoError' && error.code === 11000) {\n    next(new Error('Error:Mongoose has a duplicate key.'));\n  } else {\n    next(error);\n  }\n});\nUserSchema.statics = {\n  findByID: function (id) {\n    return this.findOne({\n      _id: id\n    }, {\n      password: 0,\n      username: 0,\n      mobile: 0\n    });\n  }\n};\nconst UserModel = mongoose.model('users', UserSchema);\nmodule.exports = UserModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiVXNlclNjaGVtYSIsInVzZXJuYW1lIiwidHlwZSIsIlN0cmluZyIsImluZGV4IiwidW5pcXVlIiwic3BhcnNlIiwibmFtZSIsInBhc3N3b3JkIiwiY3JlYXRlZCIsIkRhdGUiLCJ1cGRhdGVkIiwiZmF2cyIsIk51bWJlciIsImRlZmF1bHQiLCJnZW5kZXIiLCJyb2xlcyIsIkFycmF5IiwicGljIiwibW9iaWxlIiwibWF0Y2giLCJzdGF0dXMiLCJyZWdtYXJrIiwibG9jYXRpb24iLCJpc1ZpcCIsImNvdW50IiwicHJlIiwibmV4dCIsImZvcm1hdCIsInBvc3QiLCJlcnJvciIsImRvYyIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJmaW5kQnlJRCIsImlkIiwiZmluZE9uZSIsIl9pZCIsIlVzZXJNb2RlbCIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUF4Qjs7QUFDQSxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxPQUFELENBQXRCOztBQUNBLE1BQU1FLE1BQU0sR0FBQ0gsUUFBUSxDQUFDRyxNQUF0QjtBQUVBLE1BQU1DLFVBQVUsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDMUJFLEVBQUFBLFFBQVEsRUFBQztBQUFDQyxJQUFBQSxJQUFJLEVBQUNDLE1BQU47QUFBYUMsSUFBQUEsS0FBSyxFQUFDO0FBQUVDLE1BQUFBLE1BQU0sRUFBQztBQUFULEtBQW5CO0FBQWtDQyxJQUFBQSxNQUFNLEVBQUM7QUFBekMsR0FEaUI7QUFFMUJDLEVBQUFBLElBQUksRUFBQztBQUFDTCxJQUFBQSxJQUFJLEVBQUNDO0FBQU4sR0FGcUI7QUFHMUJLLEVBQUFBLFFBQVEsRUFBQztBQUFDTixJQUFBQSxJQUFJLEVBQUNDO0FBQU4sR0FIaUI7QUFJMUJNLEVBQUFB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QUhrQixLQUF0QixDQUFQO0FBS0g7QUFQZ0IsQ0FBckI7QUFVQSxNQUFNb0IsU0FBUyxHQUFDM0MsUUFBUSxDQUFDNEMsS0FBVCxDQUFlLE9BQWYsRUFBdUJ4QyxVQUF2QixDQUFoQjtBQUNBeUMsTUFBTSxDQUFDQyxPQUFQLEdBQWVILFNBQWYiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9EQkhlbHBlcicpXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCBTY2hlbWE9bW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgICB1c2VybmFtZTp7dHlwZTpTdHJpbmcsaW5kZXg6eyB1bmlxdWU6dHJ1ZX0sc3BhcnNlOnRydWV9LFxuICAgIG5hbWU6e3R5cGU6U3RyaW5nfSxcbiAgICBwYXNzd29yZDp7dHlwZTpTdHJpbmd9LFxuICAgIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIHVwZGF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIGZhdnM6IHsgdHlwZTogTnVtYmVyLGRlZmF1bHQ6MTAwIH0sXG4gICAgZ2VuZGVyOiB7IHR5cGU6IFN0cmluZyxkZWZhdWx0OicnIH0sXG4gICAgcm9sZXM6IHsgdHlwZTogQXJyYXksZGVmYXVsdDpbJ3VzZXInXSB9LFxuICAgIHBpYzogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonL2ltZy9iZWFyLTIwMC0yMDAuanBnJyB9LCAgLy8g5L2/55So55qE5piv5YmN56uv55qE5Zu+54mH5Zyw5Z2AXG4gICAgbW9iaWxlOiB7IHR5cGU6IFN0cmluZyxtYXRjaDovXjFbMy05XShcXGR7OX0pJC8sZGVmYXVsdDonJyB9LFxuICAgIHN0YXR1czogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonMCcgfSxcbiAgICByZWdtYXJrOiB7IHR5cGU6IFN0cmluZyxkZWZhdWx0OicnIH0sXG4gICAgbG9jYXRpb246IHsgdHlwZTogU3RyaW5nLGRlZmF1bHQ6JycgfSxcbiAgICBpc1ZpcDogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonMCcgfSxcbiAgICBjb3VudDogeyB0eXBlOiBOdW1iZXIsZGVmYXVsdDowIH0sXG59KVxuXG5Vc2VyU2NoZW1hLnByZSgnc2F2ZScsZnVuY3Rpb24obmV4dCl7XG4gICAgdGhpcy5jcmVhdGVkPW1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCBISC1tbTpzcycpXG4gICAgbmV4dCgpXG59KVxuXG5Vc2VyU2NoZW1hLnByZSgndXBkYXRlJyxmdW5jdGlvbihuZXh0KXtcbiAgICB0aGlzLnVwZGF0ZWQ9bW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhILW1tOnNzJylcbiAgICBuZXh0KClcbn0pXG5cblVzZXJTY2hlbWEucG9zdCgnc2F2ZScsZnVuY3Rpb24oZXJyb3IsZG9jLG5leHQpe1xuICAgIGlmKGVycm9yLm5hbWUgPT09ICdNb2dvRXJyb3InICYmIGVycm9yLmNvZGU9PT0xMTAwMCl7XG4gICAgICAgIG5leHQobmV3IEVycm9yKCdFcnJvcjpNb25nb29zZSBoYXMgYSBkdXBsaWNhdGUga2V5LicpKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIG5leHQoZXJyb3IpXG4gICAgfVxufSlcblxuVXNlclNjaGVtYS5zdGF0aWNzID0ge1xuICAgIGZpbmRCeUlEOiBmdW5jdGlvbihpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maW5kT25lKHtfaWQ6aWR9LHtcbiAgICAgICAgICAgIHBhc3N3b3JkOiAwLFxuICAgICAgICAgICAgdXNlcm5hbWU6MCxcbiAgICAgICAgICAgIG1vYmlsZTowXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5jb25zdCBVc2VyTW9kZWw9bW9uZ29vc2UubW9kZWwoJ3VzZXJzJyxVc2VyU2NoZW1hKVxubW9kdWxlLmV4cG9ydHM9VXNlck1vZGVsIl19",
    "map": {
      "version": 3,
      "sources": [
        "User.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "UserSchema",
        "username",
        "type",
        "String",
        "index",
        "unique",
        "sparse",
        "name",
        "password",
        "created",
        "Date",
        "updated",
        "favs",
        "Number",
        "default",
        "gender",
        "roles",
        "Array",
        "pic",
        "mobile",
        "match",
        "status",
        "regmark",
        "location",
        "isVip",
        "count",
        "pre",
        "next",
        "format",
        "post",
        "error",
        "doc",
        "code",
        "Error",
        "statics",
        "findByID",
        "id",
        "findOne",
        "_id",
        "UserModel",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\nconst Schema=mongoose.Schema\n\nconst UserSchema = new Schema({\n    username:{type:String,index:{ unique:true},sparse:true},\n    name:{type:String},\n    password:{type:String},\n    created: { type: Date },\n    updated: { type: Date },\n    favs: { type: Number,default:100 },\n    gender: { type: String,default:'' },\n    roles: { type: Array,default:['user'] },\n    pic: { type: String,default:'/img/bear-200-200.jpg' },  // 使用的是前端的图片地址\n    mobile: { type: String,match:/^1[3-9](\\d{9})$/,default:'' },\n    status: { type: String,default:'0' },\n    regmark: { type: String,default:'' },\n    location: { type: String,default:'' },\n    isVip: { type: String,default:'0' },\n    count: { type: Number,default:0 },\n})\n\nUserSchema.pre('save',function(next){\n    this.created=moment().format('YYYY-MM-DD HH-mm:ss')\n    next()\n})\n\nUserSchema.pre('update',function(next){\n    this.updated=moment().format('YYYY-MM-DD HH-mm:ss')\n    next()\n})\n\nUserSchema.post('save',function(error,doc,next){\n    if(error.name === 'MogoError' && error.code===11000){\n        next(new Error('Error:Mongoose has a duplicate key.'))\n    } else {\n        next(error)\n    }\n})\n\nUserSchema.statics = {\n    findByID: function(id) {\n        return this.findOne({_id:id},{\n            password: 0,\n            username:0,\n            mobile:0\n        })\n    }\n}\n\nconst UserModel=mongoose.model('users',UserSchema)\nmodule.exports=UserModel"
      ]
    },
    "sourceType": "script",
    "mtime": 1586353993439
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/Utils.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/Utils.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/Utils.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/Utils.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
        "sourceFileName": "Utils.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst redisConfig = require('../config/RedisConfig');\n\nconst config = require('../config/index');\n\nconst jwt = require('jsonwebtoken');\n\nvar getJWTPayload = function (token) {\n  console.log(\"secret->secret\", token.split('')[1]);\n  return jwt.verify(token.split(' ')[1], config.JWT_SECRET);\n};\n\nasync function checkCode(key, value) {\n  console.log(\"checkCode -> checkCode\", checkCode);\n  const redisData = await redisConfig.getValue(key);\n  console.log(\"checkCode -> redisData\", redisData);\n\n  if (redisData != null) {\n    debugger;\n\n    if (redisData.toLowerCase() === value.toLowerCase()) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n}\n\nexports.getJWTPayload = getJWTPayload;\nexports.checkCode = checkCode;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlV0aWxzLmpzIl0sIm5hbWVzIjpbInJlZGlzQ29uZmlnIiwicmVxdWlyZSIsImNvbmZpZyIsImp3dCIsImdldEpXVFBheWxvYWQiLCJ0b2tlbiIsImNvbnNvbGUiLCJsb2ciLCJzcGxpdCIsInZlcmlmeSIsIkpXVF9TRUNSRVQiLCJjaGVja0NvZGUiLCJrZXkiLCJ2YWx1ZSIsInJlZGlzRGF0YSIsImdldFZhbHVlIiwidG9Mb3dlckNhc2UiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFdBQVcsR0FBR0MsT0FBTyxDQUFDLHVCQUFELENBQTNCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLGlCQUFELENBQXRCOztBQUNBLE1BQU1FLEdBQUcsR0FBR0YsT0FBTyxDQUFDLGNBQUQsQ0FBbkI7O0FBRUEsSUFBSUcsYUFBYSxHQUFHLFVBQVVDLEtBQVYsRUFBaUI7QUFDakNDLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdCQUFaLEVBQThCRixLQUFLLENBQUNHLEtBQU4sQ0FBWSxFQUFaLEVBQWdCLENBQWhCLENBQTlCO0FBQ0EsU0FBT0wsR0FBRyxDQUFDTSxNQUFKLENBQVdKLEtBQUssQ0FBQ0csS0FBTixDQUFZLEdBQVosRUFBaUIsQ0FBakIsQ0FBWCxFQUFnQ04sTUFBTSxDQUFDUSxVQUF2QyxDQUFQO0FBQ0gsQ0FIRDs7QUFLQSxlQUFlQyxTQUFmLENBQTBCQyxHQUExQixFQUErQkMsS0FBL0IsRUFBc0M7QUFDbENQLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaLEVBQXNDSSxTQUF0QztBQUNBLFFBQU1HLFNBQVMsR0FBRyxNQUFNZCxXQUFXLENBQUNlLFFBQVosQ0FBcUJILEdBQXJCLENBQXhCO0FBQ0FOLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaLEVBQXNDTyxTQUF0Qzs7QUFDQSxNQUFJQSxTQUFTLElBQUksSUFBakIsRUFBdUI7QUFDbkI7O0FBQ0EsUUFBSUEsU0FBUyxDQUFDRSxXQUFWLE9BQTRCSCxLQUFLLENBQUNHLFdBQU4sRUFBaEMsRUFBcUQ7QUFDakQsYUFBTyxJQUFQO0FBQ0gsS0FGRCxNQUVPO0FBQ0gsYUFBTyxLQUFQO0FBQ0g7QUFDSixHQVBELE1BT087QUFDSCxXQUFPLEtBQVA7QUFDSDtBQUNKOztBQUVEQyxPQUFPLENBQUNiLGFBQVIsR0FBd0JBLGFBQXhCO0FBQ0FhLE9BQU8sQ0FBQ04sU0FBUixHQUFvQkEsU0FBcEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvY29tbW9uIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcmVkaXNDb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcvUmVkaXNDb25maWcnKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4JylcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpXG5cbnZhciBnZXRKV1RQYXlsb2FkID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgY29uc29sZS5sb2coXCJzZWNyZXQtPnNlY3JldFwiLCB0b2tlbi5zcGxpdCgnJylbMV0pXG4gICAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4uc3BsaXQoJyAnKVsxXSwgY29uZmlnLkpXVF9TRUNSRVQpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrQ29kZSAoa2V5LCB2YWx1ZSkge1xuICAgIGNvbnNvbGUubG9nKFwiY2hlY2tDb2RlIC0+IGNoZWNrQ29kZVwiLCBjaGVja0NvZGUpXG4gICAgY29uc3QgcmVkaXNEYXRhID0gYXdhaXQgcmVkaXNDb25maWcuZ2V0VmFsdWUoa2V5KVxuICAgIGNvbnNvbGUubG9nKFwiY2hlY2tDb2RlIC0+IHJlZGlzRGF0YVwiLCByZWRpc0RhdGEpXG4gICAgaWYgKHJlZGlzRGF0YSAhPSBudWxsKSB7XG4gICAgICAgIGRlYnVnZ2VyXG4gICAgICAgIGlmIChyZWRpc0RhdGEudG9Mb3dlckNhc2UoKSA9PT0gdmFsdWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxufVxuXG5leHBvcnRzLmdldEpXVFBheWxvYWQgPSBnZXRKV1RQYXlsb2FkO1xuZXhwb3J0cy5jaGVja0NvZGUgPSBjaGVja0NvZGU7Il19",
    "map": {
      "version": 3,
      "sources": [
        "Utils.js"
      ],
      "names": [
        "redisConfig",
        "require",
        "config",
        "jwt",
        "getJWTPayload",
        "token",
        "console",
        "log",
        "split",
        "verify",
        "JWT_SECRET",
        "checkCode",
        "key",
        "value",
        "redisData",
        "getValue",
        "toLowerCase",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,WAAW,GAAGC,OAAO,CAAC,uBAAD,CAA3B;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,iBAAD,CAAtB;;AACA,MAAME,GAAG,GAAGF,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAIG,aAAa,GAAG,UAAUC,KAAV,EAAiB;AACjCC,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,KAAK,CAACG,KAAN,CAAY,EAAZ,EAAgB,CAAhB,CAA9B;AACA,SAAOL,GAAG,CAACM,MAAJ,CAAWJ,KAAK,CAACG,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAX,EAAgCN,MAAM,CAACQ,UAAvC,CAAP;AACH,CAHD;;AAKA,eAAeC,SAAf,CAA0BC,GAA1B,EAA+BC,KAA/B,EAAsC;AAClCP,EAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCI,SAAtC;AACA,QAAMG,SAAS,GAAG,MAAMd,WAAW,CAACe,QAAZ,CAAqBH,GAArB,CAAxB;AACAN,EAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCO,SAAtC;;AACA,MAAIA,SAAS,IAAI,IAAjB,EAAuB;AACnB;;AACA,QAAIA,SAAS,CAACE,WAAV,OAA4BH,KAAK,CAACG,WAAN,EAAhC,EAAqD;AACjD,aAAO,IAAP;AACH,KAFD,MAEO;AACH,aAAO,KAAP;AACH;AACJ,GAPD,MAOO;AACH,WAAO,KAAP;AACH;AACJ;;AAEDC,OAAO,CAACb,aAAR,GAAwBA,aAAxB;AACAa,OAAO,CAACN,SAAR,GAAoBA,SAApB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
      "sourcesContent": [
        "const redisConfig = require('../config/RedisConfig')\nconst config = require('../config/index')\nconst jwt = require('jsonwebtoken')\n\nvar getJWTPayload = function (token) {\n    console.log(\"secret->secret\", token.split('')[1])\n    return jwt.verify(token.split(' ')[1], config.JWT_SECRET)\n}\n\nasync function checkCode (key, value) {\n    console.log(\"checkCode -> checkCode\", checkCode)\n    const redisData = await redisConfig.getValue(key)\n    console.log(\"checkCode -> redisData\", redisData)\n    if (redisData != null) {\n        debugger\n        if (redisData.toLowerCase() === value.toLowerCase()) {\n            return true\n        } else {\n            return false\n        }\n    } else {\n        return false\n    }\n}\n\nexports.getJWTPayload = getJWTPayload;\nexports.checkCode = checkCode;"
      ]
    },
    "sourceType": "script",
    "mtime": 1584589663148
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/UserCollect.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/UserCollect.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/UserCollect.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/UserCollect.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "UserCollect.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst moogoose = require('../config/DBHelper');\n\nconst Schema = moogoose.Schema;\nconst UserCollectSchema = new Schema({\n  uid: {\n    type: String\n  },\n  tid: {\n    type: String\n  },\n  title: {\n    type: String\n  },\n  created: {\n    type: Date\n  }\n});\nUserCollectSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nUserCollectSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nUserCollectSchema.statics = {\n  getListByUid: function (id, page, limit) {\n    return this.find({\n      uid: id\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  countByUid: function (id) {\n    return this.find({\n      uid: id\n    }).countDocuments();\n  }\n};\nconst UserCollect = moogoose.model('user_collect', UserCollectSchema);\nmodule.exports = UserCollect;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb2xsZWN0LmpzIl0sIm5hbWVzIjpbIm1vb2dvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIlVzZXJDb2xsZWN0U2NoZW1hIiwidWlkIiwidHlwZSIsIlN0cmluZyIsInRpZCIsInRpdGxlIiwiY3JlYXRlZCIsIkRhdGUiLCJwcmUiLCJuZXh0IiwicG9zdCIsImVycm9yIiwiZG9jIiwibmFtZSIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJnZXRMaXN0QnlVaWQiLCJpZCIsInBhZ2UiLCJsaW1pdCIsImZpbmQiLCJza2lwIiwic29ydCIsImNvdW50QnlVaWQiLCJjb3VudERvY3VtZW50cyIsIlVzZXJDb2xsZWN0IiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFELENBQXhCOztBQUVBLE1BQU1DLE1BQU0sR0FBR0YsUUFBUSxDQUFDRSxNQUF4QjtBQUVBLE1BQU1DLGlCQUFpQixHQUFHLElBQUlELE1BQUosQ0FBVztBQUNqQ0UsRUFBQUEsR0FBRyxFQUFFO0FBQUVDLElBQUFBLElBQUksRUFBRUM7QUFBUixHQUQ0QjtBQUVqQ0MsRUFBQUEsR0FBRyxFQUFFO0FBQUVGLElBQUFBLElBQUksRUFBRUM7QUFBUixHQUY0QjtBQUdqQ0UsRUFBQUEsS0FBSyxFQUFFO0FBQUVILElBQUFBLElBQUksRUFBRUM7QUFBUixHQUgwQjtBQUlqQ0csRUFBQUEsT0FBTyxFQUFFO0FBQUVKLElBQUFBLElBQUksRUFBRUs7QUFBUjtBQUp3QixDQUFYLENBQTFCO0FBT0FQLGlCQUFpQixDQUFDUSxHQUFsQixDQUFzQixNQUF0QixFQUE4QixVQUFVQyxJQUFWLEVBQWdCO0FBQzFDLE9BQUtILE9BQUwsR0FBZSxJQUFJQyxJQUFKLEVBQWY7QUFDQUUsRUFBQUEsSUFBSTtBQUNQLENBSEQ7QUFLQVQsaUJBQWlCLENBQUNVLElBQWxCLENBQXVCLE1BQXZCLEVBQStCLFVBQVVDLEtBQVYsRUFBaUJDLEdBQWpCLEVBQXNCSCxJQUF0QixFQUE0QjtBQUN2RCxNQUFJRSxLQUFLLENBQUNFLElBQU4sS0FBZSxZQUFmLElBQStCRixLQUFLLENBQUNHLElBQU4sS0FBZSxLQUFsRCxFQUF5RDtBQUNyREwsSUFBQUEsSUFBSSxDQUFDLElBQUlNLEtBQUosQ0FBVSxpQ0FBVixDQUFELENBQUo7QUFDSCxHQUZELE1BRU87QUFDSE4sSUFBQUEsSUFBSSxDQUFDRSxLQUFELENBQUo7QUFDSDtBQUNKLENBTkQ7QUFRQVgsaUJBQWlCLENBQUNnQixPQUFsQixHQUE0QjtBQUN4QkMsRUFBQUEsWUFBWSxFQUFFLFVBQVVDLEVBQVYsRUFBY0MsSUFBZCxFQUFvQkMsS0FBcEIsRUFBMkI7QUFDckMsV0FBTyxLQUFLQyxJQUFMLENBQVU7QUFBRXBCLE1BQUFBLEdBQUcsRUFBRWlCO0FBQVAsS0FBVixFQUNGSSxJQURFLENBQ0dGLEtBQUssR0FBR0QsSUFEWCxFQUVGQyxLQUZFLENBRUlBLEtBRkosRUFHRkcsSUFIRSxDQUdHO0FBQUVqQixNQUFBQSxPQUFPLEVBQUUsQ0FBQztBQUFaLEtBSEgsQ0FBUDtBQUlILEdBTnVCO0FBT3hCa0IsRUFBQUEsVUFBVSxFQUFFLFVBQVVOLEVBQVYsRUFBYztBQUN0QixXQUFPLEtBQUtHLElBQUwsQ0FBVTtBQUFFcEIsTUFBQUEsR0FBRyxFQUFFaUI7QUFBUCxLQUFWLEVBQXVCTyxjQUF2QixFQUFQO0FBQ0g7QUFUdUIsQ0FBNUI7QUFXQSxNQUFNQyxXQUFXLEdBQUc3QixRQUFRLENBQUM4QixLQUFULENBQWUsY0FBZixFQUErQjNCLGlCQUEvQixDQUFwQjtBQUVBNEIsTUFBTSxDQUFDQyxPQUFQLEdBQWVILFdBQWYiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb29nb29zZSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9EQkhlbHBlcicpXG5cbmNvbnN0IFNjaGVtYSA9IG1vb2dvb3NlLlNjaGVtYVxuXG5jb25zdCBVc2VyQ29sbGVjdFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHVpZDogeyB0eXBlOiBTdHJpbmcgfSxcbiAgICB0aWQ6IHsgdHlwZTogU3RyaW5nIH0sXG4gICAgdGl0bGU6IHsgdHlwZTogU3RyaW5nIH0sXG4gICAgY3JlYXRlZDogeyB0eXBlOiBEYXRlIH0sXG59KVxuXG5Vc2VyQ29sbGVjdFNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICAgIHRoaXMuY3JlYXRlZCA9IG5ldyBEYXRlKClcbiAgICBuZXh0KClcbn0pXG5cblVzZXJDb2xsZWN0U2NoZW1hLnBvc3QoJ3NhdmUnLCBmdW5jdGlvbiAoZXJyb3IsIGRvYywgbmV4dCkge1xuICAgIGlmIChlcnJvci5uYW1lID09PSAnTW9uZ29FcnJvcicgJiYgZXJyb3IuY29kZSA9PT0gMTEwMDApIHtcbiAgICAgICAgbmV4dChuZXcgRXJyb3IoJ1RoZXJlIHdhcyBhIGR1cGxpY2F0ZSBrZXkgZXJyb3InKSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0KGVycm9yKVxuICAgIH1cbn0pXG5cblVzZXJDb2xsZWN0U2NoZW1hLnN0YXRpY3MgPSB7XG4gICAgZ2V0TGlzdEJ5VWlkOiBmdW5jdGlvbiAoaWQsIHBhZ2UsIGxpbWl0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pXG4gICAgICAgICAgICAuc2tpcChsaW1pdCAqIHBhZ2UpXG4gICAgICAgICAgICAubGltaXQobGltaXQpXG4gICAgICAgICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gICAgfSxcbiAgICBjb3VudEJ5VWlkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZCh7IHVpZDogaWQgfSkuY291bnREb2N1bWVudHMoKVxuICAgIH1cbn1cbmNvbnN0IFVzZXJDb2xsZWN0ID0gbW9vZ29vc2UubW9kZWwoJ3VzZXJfY29sbGVjdCcsIFVzZXJDb2xsZWN0U2NoZW1hKVxuXG5tb2R1bGUuZXhwb3J0cz1Vc2VyQ29sbGVjdCJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "UserCollect.js"
      ],
      "names": [
        "moogoose",
        "require",
        "Schema",
        "UserCollectSchema",
        "uid",
        "type",
        "String",
        "tid",
        "title",
        "created",
        "Date",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "getListByUid",
        "id",
        "page",
        "limit",
        "find",
        "skip",
        "sort",
        "countByUid",
        "countDocuments",
        "UserCollect",
        "model",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AAEA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AAEA,MAAMC,iBAAiB,GAAG,IAAID,MAAJ,CAAW;AACjCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC;AAAR,GAD4B;AAEjCC,EAAAA,GAAG,EAAE;AAAEF,IAAAA,IAAI,EAAEC;AAAR,GAF4B;AAGjCE,EAAAA,KAAK,EAAE;AAAEH,IAAAA,IAAI,EAAEC;AAAR,GAH0B;AAIjCG,EAAAA,OAAO,EAAE;AAAEJ,IAAAA,IAAI,EAAEK;AAAR;AAJwB,CAAX,CAA1B;AAOAP,iBAAiB,CAACQ,GAAlB,CAAsB,MAAtB,EAA8B,UAAUC,IAAV,EAAgB;AAC1C,OAAKH,OAAL,GAAe,IAAIC,IAAJ,EAAf;AACAE,EAAAA,IAAI;AACP,CAHD;AAKAT,iBAAiB,CAACU,IAAlB,CAAuB,MAAvB,EAA+B,UAAUC,KAAV,EAAiBC,GAAjB,EAAsBH,IAAtB,EAA4B;AACvD,MAAIE,KAAK,CAACE,IAAN,KAAe,YAAf,IAA+BF,KAAK,CAACG,IAAN,KAAe,KAAlD,EAAyD;AACrDL,IAAAA,IAAI,CAAC,IAAIM,KAAJ,CAAU,iCAAV,CAAD,CAAJ;AACH,GAFD,MAEO;AACHN,IAAAA,IAAI,CAACE,KAAD,CAAJ;AACH;AACJ,CAND;AAQAX,iBAAiB,CAACgB,OAAlB,GAA4B;AACxBC,EAAAA,YAAY,EAAE,UAAUC,EAAV,EAAcC,IAAd,EAAoBC,KAApB,EAA2B;AACrC,WAAO,KAAKC,IAAL,CAAU;AAAEpB,MAAAA,GAAG,EAAEiB;AAAP,KAAV,EACFI,IADE,CACGF,KAAK,GAAGD,IADX,EAEFC,KAFE,CAEIA,KAFJ,EAGFG,IAHE,CAGG;AAAEjB,MAAAA,OAAO,EAAE,CAAC;AAAZ,KAHH,CAAP;AAIH,GANuB;AAOxBkB,EAAAA,UAAU,EAAE,UAAUN,EAAV,EAAc;AACtB,WAAO,KAAKG,IAAL,CAAU;AAAEpB,MAAAA,GAAG,EAAEiB;AAAP,KAAV,EAAuBO,cAAvB,EAAP;AACH;AATuB,CAA5B;AAWA,MAAMC,WAAW,GAAG7B,QAAQ,CAAC8B,KAAT,CAAe,cAAf,EAA+B3B,iBAA/B,CAApB;AAEA4B,MAAM,CAACC,OAAP,GAAeH,WAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "const moogoose = require('../config/DBHelper')\n\nconst Schema = moogoose.Schema\n\nconst UserCollectSchema = new Schema({\n    uid: { type: String },\n    tid: { type: String },\n    title: { type: String },\n    created: { type: Date },\n})\n\nUserCollectSchema.pre('save', function (next) {\n    this.created = new Date()\n    next()\n})\n\nUserCollectSchema.post('save', function (error, doc, next) {\n    if (error.name === 'MongoError' && error.code === 11000) {\n        next(new Error('There was a duplicate key error'))\n    } else {\n        next(error)\n    }\n})\n\nUserCollectSchema.statics = {\n    getListByUid: function (id, page, limit) {\n        return this.find({ uid: id })\n            .skip(limit * page)\n            .limit(limit)\n            .sort({ created: -1 })\n    },\n    countByUid: function (id) {\n        return this.find({ uid: id }).countDocuments()\n    }\n}\nconst UserCollect = moogoose.model('user_collect', UserCollectSchema)\n\nmodule.exports=UserCollect"
      ]
    },
    "sourceType": "script",
    "mtime": 1586009564419
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/CommentController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/CommentController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/CommentController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/CommentController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "CommentController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst {\n  checkCode,\n  getJWTPayload\n} = require('../common/Utils'); // const User = require('../model/User')\n\n\nconst Comments = require('../model/Comments');\n\nconst Post = require('../model/Post');\n\nasync function addComment(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"addComment -> body\", body);\n  const sid = body.sid;\n  const code = body.code;\n  const result = await checkCode(sid, code);\n\n  if (result) {\n    const newComments = new Comments(body);\n    const obj = await getJWTPayload(ctx.header.authorization);\n    newComments.cuid = obj._id;\n    const post = await Post.findOne({\n      _id: body.tid\n    });\n    newComments.uid = post.uid;\n    const comment = await newComments.save(); // const num = await Comments.getTotal(post.uid)\n\n    const updatePostresult = await Post.updateOne({\n      _id: body.tid\n    }, {\n      $inc: {\n        answer: 1\n      }\n    }); // const user = await User.findById({ _id: obj._id })\n    // if(user.favs<body.fav) {\n    //     ctx.body = {\n    //         code:501,\n    //         msg:'积分不足'\n    //     }\n    //     return \n    // } else {\n    //     await User.updateOne({_id:obj._id},{$inc:{favs:-body.fav}})\n    // }\n\n    if (comment._id && updatePostresult.ok === 1) {\n      ctx.body = {\n        code: 200,\n        msg: '成功发表评论',\n        date: comment\n      };\n    } else {\n      ctx.body = {\n        code: 500,\n        msg: '评论失败'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '图片验证码验证失败'\n    };\n  }\n} // 获取评论列表\n\n\nasync function getComments(ctx) {\n  console.log('getComments');\n  const params = ctx.query;\n  const tid = params.tid;\n  console.log(\"getComments -> tid\", tid);\n  const page = params.page ? params.page : 0;\n  const limit = params.limit ? parseInt(params.limit) : 10;\n  let result = await Comments.getCommentsList(tid, page, limit);\n  console.log(\"getComments -> result\", result); // 判断用户是否登录，已登录的用户才去判断点赞信息\n  // let obj = {}\n  // if (typeof ctx.header.authorization !== 'undefined') {\n  //     obj = await getJWTPayload(ctx.header.authorization)\n  // }\n  // if (typeof obj._id !== 'undefined') {\n  //     result = result.map(item => item.toJSON())\n  //     for (let i = 0; i < result.length; i++) {\n  //         let item = result[i]\n  //         item.handed = '0'\n  //         const commentsHands = await CommentsHands.findOne({ cid: item._id, uid: obj._id })\n  //         if (commentsHands && commentsHands.cid) {\n  //             if (commentsHands.uid === obj._id) {\n  //                 item.handed = '1'\n  //             }\n  //         }\n  //     }\n  // }\n\n  const total = await Comments.queryCount(tid);\n  console.log(\"getComments -> total\", total);\n  ctx.body = {\n    code: 200,\n    total,\n    data: result,\n    msg: '查询成功'\n  };\n}\n\nmodule.exports = {\n  addComment,\n  getComments\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImNoZWNrQ29kZSIsImdldEpXVFBheWxvYWQiLCJyZXF1aXJlIiwiQ29tbWVudHMiLCJQb3N0IiwiYWRkQ29tbWVudCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsInNpZCIsImNvZGUiLCJyZXN1bHQiLCJuZXdDb21tZW50cyIsIm9iaiIsImhlYWRlciIsImF1dGhvcml6YXRpb24iLCJjdWlkIiwiX2lkIiwicG9zdCIsImZpbmRPbmUiLCJ0aWQiLCJ1aWQiLCJjb21tZW50Iiwic2F2ZSIsInVwZGF0ZVBvc3RyZXN1bHQiLCJ1cGRhdGVPbmUiLCIkaW5jIiwiYW5zd2VyIiwib2siLCJtc2ciLCJkYXRlIiwiZ2V0Q29tbWVudHMiLCJwYXJhbXMiLCJxdWVyeSIsInBhZ2UiLCJsaW1pdCIsInBhcnNlSW50IiwiZ2V0Q29tbWVudHNMaXN0IiwidG90YWwiLCJxdWVyeUNvdW50IiwiZGF0YSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTTtBQUFFQSxFQUFBQSxTQUFGO0FBQWFDLEVBQUFBO0FBQWIsSUFBK0JDLE9BQU8sQ0FBQyxpQkFBRCxDQUE1QyxDLENBQ0E7OztBQUNBLE1BQU1DLFFBQVEsR0FBR0QsT0FBTyxDQUFDLG1CQUFELENBQXhCOztBQUNBLE1BQU1FLElBQUksR0FBR0YsT0FBTyxDQUFDLGVBQUQsQ0FBcEI7O0FBRUEsZUFBZUcsVUFBZixDQUEyQkMsR0FBM0IsRUFBZ0M7QUFDNUIsUUFBTTtBQUFFQyxJQUFBQTtBQUFGLE1BQVdELEdBQUcsQ0FBQ0UsT0FBckI7QUFDQUMsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksb0JBQVosRUFBa0NILElBQWxDO0FBQ0EsUUFBTUksR0FBRyxHQUFHSixJQUFJLENBQUNJLEdBQWpCO0FBQ0EsUUFBTUMsSUFBSSxHQUFHTCxJQUFJLENBQUNLLElBQWxCO0FBQ0EsUUFBTUMsTUFBTSxHQUFH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TyxDQUFDQyxHQUFSLENBQVksc0JBQVosRUFBb0M4QixLQUFwQztBQUNBbEMsRUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEssSUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUDRCLElBQUFBLEtBRk87QUFHUEUsSUFBQUEsSUFBSSxFQUFFN0IsTUFIQztBQUlQa0IsSUFBQUEsR0FBRyxFQUFFO0FBSkUsR0FBWDtBQU1IOztBQUVEWSxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRXZDLEVBQUFBLFVBQUY7QUFBYzRCLEVBQUFBO0FBQWQsQ0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvYXBpIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBjaGVja0NvZGUsIGdldEpXVFBheWxvYWQgfSA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG4vLyBjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWwvVXNlcicpXG5jb25zdCBDb21tZW50cyA9IHJlcXVpcmUoJy4uL21vZGVsL0NvbW1lbnRzJylcbmNvbnN0IFBvc3QgPSByZXF1aXJlKCcuLi9tb2RlbC9Qb3N0JylcblxuYXN5bmMgZnVuY3Rpb24gYWRkQ29tbWVudCAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwiYWRkQ29tbWVudCAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgc2lkID0gYm9keS5zaWRcbiAgICBjb25zdCBjb2RlID0gYm9keS5jb2RlXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tDb2RlKHNpZCwgY29kZSlcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IG5ld0NvbW1lbnRzID0gbmV3IENvbW1lbnRzKGJvZHkpXG4gICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgICAgICBuZXdDb21tZW50cy5jdWlkID0gb2JqLl9pZFxuXG4gICAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBQb3N0LmZpbmRPbmUoeyBfaWQ6IGJvZHkudGlkIH0pXG4gICAgICAgIG5ld0NvbW1lbnRzLnVpZCA9IHBvc3QudWlkXG4gICAgICAgIGNvbnN0IGNvbW1lbnQgPSBhd2FpdCBuZXdDb21tZW50cy5zYXZlKClcbiAgICAgICAgLy8gY29uc3QgbnVtID0gYXdhaXQgQ29tbWVudHMuZ2V0VG90YWwocG9zdC51aWQpXG5cbiAgICAgICAgY29uc3QgdXBkYXRlUG9zdHJlc3VsdCA9IGF3YWl0IFBvc3QudXBkYXRlT25lKHsgX2lkOiBib2R5LnRpZCB9LCB7ICRpbmM6IHsgYW5zd2VyOiAxIH0gfSlcblxuICAgICAgICAvLyBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh7IF9pZDogb2JqLl9pZCB9KVxuICAgICAgICAvLyBpZih1c2VyLmZhdnM8Ym9keS5mYXYpIHtcbiAgICAgICAgLy8gICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAvLyAgICAgICAgIGNvZGU6NTAxLFxuICAgICAgICAvLyAgICAgICAgIG1zZzon56ev5YiG5LiN6LazJ1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyAgICAgcmV0dXJuIFxuICAgICAgICAvLyB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgYXdhaXQgVXNlci51cGRhdGVPbmUoe19pZDpvYmouX2lkfSx7JGluYzp7ZmF2czotYm9keS5mYXZ9fSlcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIGlmIChjb21tZW50Ll9pZCAmJiB1cGRhdGVQb3N0cmVzdWx0Lm9rID09PSAxKSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICAgICAgbXNnOiAn5oiQ5Yqf5Y+R6KGo6K+E6K66JyxcbiAgICAgICAgICAgICAgICBkYXRlOiBjb21tZW50XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICAgICAgbXNnOiAn6K+E6K665aSx6LSlJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICflm77niYfpqozor4HnoIHpqozor4HlpLHotKUnXG5cbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8g6I635Y+W6K+E6K665YiX6KGoXG5hc3luYyBmdW5jdGlvbiBnZXRDb21tZW50cyAoY3R4KSB7XG4gICAgY29uc29sZS5sb2coJ2dldENvbW1lbnRzJylcbiAgICBjb25zdCBwYXJhbXMgPSBjdHgucXVlcnlcbiAgICBjb25zdCB0aWQgPSBwYXJhbXMudGlkXG4gICAgY29uc29sZS5sb2coXCJnZXRDb21tZW50cyAtPiB0aWRcIiwgdGlkKVxuICAgIGNvbnN0IHBhZ2UgPSBwYXJhbXMucGFnZSA/IHBhcmFtcy5wYWdlIDogMFxuICAgIGNvbnN0IGxpbWl0ID0gcGFyYW1zLmxpbWl0ID8gcGFyc2VJbnQocGFyYW1zLmxpbWl0KSA6IDEwXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IENvbW1lbnRzLmdldENvbW1lbnRzTGlzdCh0aWQsIHBhZ2UsIGxpbWl0KVxuICAgIGNvbnNvbGUubG9nKFwiZ2V0Q29tbWVudHMgLT4gcmVzdWx0XCIsIHJlc3VsdClcbiAgICAvLyDliKTmlq3nlKjmiLfmmK/lkKbnmbvlvZXvvIzlt7LnmbvlvZXnmoTnlKjmiLfmiY3ljrvliKTmlq3ngrnotZ7kv6Hmga9cbiAgICAvLyBsZXQgb2JqID0ge31cbiAgICAvLyBpZiAodHlwZW9mIGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyAgICAgb2JqID0gYXdhaXQgZ2V0SldUUGF5bG9hZChjdHguaGVhZGVyLmF1dGhvcml6YXRpb24pXG4gICAgLy8gfVxuICAgIC8vIGlmICh0eXBlb2Ygb2JqLl9pZCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyAgICAgcmVzdWx0ID0gcmVzdWx0Lm1hcChpdGVtID0+IGl0ZW0udG9KU09OKCkpXG4gICAgLy8gICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gICAgICAgICBsZXQgaXRlbSA9IHJlc3VsdFtpXVxuICAgIC8vICAgICAgICAgaXRlbS5oYW5kZWQgPSAnMCdcbiAgICAvLyAgICAgICAgIGNvbnN0IGNvbW1lbnRzSGFuZHMgPSBhd2FpdCBDb21tZW50c0hhbmRzLmZpbmRPbmUoeyBjaWQ6IGl0ZW0uX2lkLCB1aWQ6IG9iai5faWQgfSlcbiAgICAvLyAgICAgICAgIGlmIChjb21tZW50c0hhbmRzICYmIGNvbW1lbnRzSGFuZHMuY2lkKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYgKGNvbW1lbnRzSGFuZHMudWlkID09PSBvYmouX2lkKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgIGl0ZW0uaGFuZGVkID0gJzEnXG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICB9XG4gICAgLy8gfVxuICAgIGNvbnN0IHRvdGFsID0gYXdhaXQgQ29tbWVudHMucXVlcnlDb3VudCh0aWQpXG4gICAgY29uc29sZS5sb2coXCJnZXRDb21tZW50cyAtPiB0b3RhbFwiLCB0b3RhbClcbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICB0b3RhbCxcbiAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICBtc2c6ICfmn6Xor6LmiJDlip8nXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgYWRkQ29tbWVudCwgZ2V0Q29tbWVudHMgfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "CommentController.js"
      ],
      "names": [
        "checkCode",
        "getJWTPayload",
        "require",
        "Comments",
        "Post",
        "addComment",
        "ctx",
        "body",
        "request",
        "console",
        "log",
        "sid",
        "code",
        "result",
        "newComments",
        "obj",
        "header",
        "authorization",
        "cuid",
        "_id",
        "post",
        "findOne",
        "tid",
        "uid",
        "comment",
        "save",
        "updatePostresult",
        "updateOne",
        "$inc",
        "answer",
        "ok",
        "msg",
        "date",
        "getComments",
        "params",
        "query",
        "page",
        "limit",
        "parseInt",
        "getCommentsList",
        "total",
        "queryCount",
        "data",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "const { checkCode, getJWTPayload } = require('../common/Utils')\n// const User = require('../model/User')\nconst Comments = require('../model/Comments')\nconst Post = require('../model/Post')\n\nasync function addComment (ctx) {\n    const { body } = ctx.request\n    console.log(\"addComment -> body\", body)\n    const sid = body.sid\n    const code = body.code\n    const result = await checkCode(sid, code)\n    if (result) {\n        const newComments = new Comments(body)\n        const obj = await getJWTPayload(ctx.header.authorization)\n        newComments.cuid = obj._id\n\n        const post = await Post.findOne({ _id: body.tid })\n        newComments.uid = post.uid\n        const comment = await newComments.save()\n        // const num = await Comments.getTotal(post.uid)\n\n        const updatePostresult = await Post.updateOne({ _id: body.tid }, { $inc: { answer: 1 } })\n\n        // const user = await User.findById({ _id: obj._id })\n        // if(user.favs<body.fav) {\n        //     ctx.body = {\n        //         code:501,\n        //         msg:'积分不足'\n        //     }\n        //     return \n        // } else {\n        //     await User.updateOne({_id:obj._id},{$inc:{favs:-body.fav}})\n        // }\n\n        if (comment._id && updatePostresult.ok === 1) {\n            ctx.body = {\n                code: 200,\n                msg: '成功发表评论',\n                date: comment\n            }\n        } else {\n            ctx.body = {\n                code: 500,\n                msg: '评论失败'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '图片验证码验证失败'\n\n        }\n    }\n}\n\n// 获取评论列表\nasync function getComments (ctx) {\n    console.log('getComments')\n    const params = ctx.query\n    const tid = params.tid\n    console.log(\"getComments -> tid\", tid)\n    const page = params.page ? params.page : 0\n    const limit = params.limit ? parseInt(params.limit) : 10\n    let result = await Comments.getCommentsList(tid, page, limit)\n    console.log(\"getComments -> result\", result)\n    // 判断用户是否登录，已登录的用户才去判断点赞信息\n    // let obj = {}\n    // if (typeof ctx.header.authorization !== 'undefined') {\n    //     obj = await getJWTPayload(ctx.header.authorization)\n    // }\n    // if (typeof obj._id !== 'undefined') {\n    //     result = result.map(item => item.toJSON())\n    //     for (let i = 0; i < result.length; i++) {\n    //         let item = result[i]\n    //         item.handed = '0'\n    //         const commentsHands = await CommentsHands.findOne({ cid: item._id, uid: obj._id })\n    //         if (commentsHands && commentsHands.cid) {\n    //             if (commentsHands.uid === obj._id) {\n    //                 item.handed = '1'\n    //             }\n    //         }\n    //     }\n    // }\n    const total = await Comments.queryCount(tid)\n    console.log(\"getComments -> total\", total)\n    ctx.body = {\n        code: 200,\n        total,\n        data: result,\n        msg: '查询成功'\n    }\n}\n\nmodule.exports = { addComment, getComments }"
      ]
    },
    "sourceType": "script",
    "mtime": 1586017612454
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Comments.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Comments.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Comments.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Comments.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "Comments.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst Schema = mongoose.Schema;\nconst CommentsSchema = new Schema({\n  tid: {\n    type: String,\n    ref: 'post'\n  },\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  cuid: {\n    type: String,\n    ref: 'users'\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  hands: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '1'\n  },\n  isRead: {\n    type: String,\n    default: '0'\n  },\n  isBest: {\n    type: String,\n    default: '0'\n  }\n}, {\n  toJSON: {\n    virtuals: true\n  }\n});\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({\n      tid: id\n    });\n  },\n  findByCid: function (id) {\n    return this.findOne({\n      _id: id\n    });\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({\n      tid: id\n    }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: {\n        status: {\n          $eq: '0'\n        }\n      }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit);\n  },\n  queryCount: function (id) {\n    return this.find({\n      tid: id\n    }).countDocuments();\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({\n      cuid: id\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      // cuid: { $ne: id },\n      cuid: id,\n      isRead: {\n        $eq: '0'\n      },\n      // 未读状态\n      status: {\n        $eq: '1'\n      } // 是否显示\n\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).populate({\n      path: 'uid',\n      select: '_id name'\n    }).populate({\n      path: 'cuid',\n      select: '_id name'\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  getTotal: function (id) {\n    return this.find({\n      uid: id,\n      isRead: '0',\n      status: '1'\n    }).countDocuments();\n  } // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n\n};\nconst Comments = mongoose.model('comments', CommentsSchema);\nmodule.exports = Comments;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnRzLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIkNvbW1lbnRzU2NoZW1hIiwidGlkIiwidHlwZSIsIlN0cmluZyIsInJlZiIsInVpZCIsImN1aWQiLCJjb250ZW50IiwiY3JlYXRlZCIsIkRhdGUiLCJoYW5kcyIsIk51bWJlciIsImRlZmF1bHQiLCJzdGF0dXMiLCJpc1JlYWQiLCJpc0Jlc3QiLCJ0b0pTT04iLCJ2aXJ0dWFscyIsInByZSIsIm5leHQiLCJwb3N0IiwiZXJyb3IiLCJkb2MiLCJuYW1lIiwiY29kZSIsIkVycm9yIiwic3RhdGljcyIsImZpbmRCeVRpZCIsImlkIiwiZmluZCIsImZpbmRCeUNpZCIsImZpbmRPbmUiLCJfaWQiLCJnZXRDb21tZW50c0xpc3QiLCJwYWdlIiwibGltaXQiLCJwb3B1bGF0ZSIsInBhdGgiLCJzZWxlY3QiLCJtYXRjaCIsIiRlcSIsInNraXAiLCJxdWVyeUNvdW50IiwiY291bnREb2N1bWVudHMiLCJnZXRDb21tZXRzUHVibGljIiwic29ydCIsImdldE1zZ0xpc3QiLCJnZXRUb3RhbCIsIkNvbW1lbnRzIiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFELENBQXhCOztBQUVBLE1BQU1DLE1BQU0sR0FBR0YsUUFBUSxDQUFDRSxNQUF4QjtBQUVBLE1BQU1DLGNBQWMsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDaENFLEVBQUFBLEdBQUcsRUFBRTtBQUFFQyxJQUFBQSxJQUFJLEVBQUVDLE1BQVI7QUFBZ0JDLElBQUFBLEdBQUcsRUFBRTtBQUFyQixHQUQyQjtBQUVoQ0MsRUFBQUEsR0FBRyxFQUFFO0FBQUVILElBQUFBLElBQUksRUFBRUMsTUFBUjtBQUFnQkMsSUFBQUEsR0FBRyxFQUFFO0FBQXJCLEdBRjJCO0FBR2hDRSxFQUFBQSxJQUFJLEVBQUU7QUFBRUosSUFBQUEsSUFB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QUFHRCxJQW5CVCxFQW9CSkMsS0FwQkksQ0FvQkVBLEtBcEJGLEVBcUJKVSxJQXJCSSxDQXFCQztBQUFFckMsTUFBQUEsT0FBTyxFQUFFLENBQUM7QUFBWixLQXJCRCxDQUFQO0FBc0JELEdBckRzQjtBQXVEdkJ1QyxFQUFBQSxRQUFRLEVBQUUsVUFBVW5CLEVBQVYsRUFBYztBQUN0QixXQUFPLEtBQUtDLElBQUwsQ0FBVTtBQUFFeEIsTUFBQUEsR0FBRyxFQUFFdUIsRUFBUDtBQUFXZCxNQUFBQSxNQUFNLEVBQUUsR0FBbkI7QUFBd0JELE1BQUFBLE1BQU0sRUFBRTtBQUFoQyxLQUFWLEVBQWlEOEIsY0FBakQsRUFBUDtBQUNELEdBekRzQixDQTBEdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQTFGdUIsQ0FBekI7QUE2RkEsTUFBTUssUUFBUSxHQUFHbkQsUUFBUSxDQUFDb0QsS0FBVCxDQUFlLFVBQWYsRUFBMkJqRCxjQUEzQixDQUFqQjtBQUVBa0QsTUFBTSxDQUFDQyxPQUFQLEdBQWlCSCxRQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9tb2RlbCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnLi4vY29uZmlnL0RCSGVscGVyJylcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IENvbW1lbnRzU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gIHRpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3Bvc3QnIH0sXG4gIHVpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3VzZXJzJyB9LFxuICBjdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIGNvbnRlbnQ6IHsgdHlwZTogU3RyaW5nIH0sXG4gIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICBoYW5kczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcbiAgc3RhdHVzOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJzEnIH0sXG4gIGlzUmVhZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9LFxuICBpc0Jlc3Q6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfVxufSwgeyB0b0pTT046IHsgdmlydHVhbHM6IHRydWUgfSB9KVxuXG5Db21tZW50c1NjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICB0aGlzLmNyZWF0ZWQgPSBuZXcgRGF0ZSgpXG4gIG5leHQoKVxufSlcblxuQ29tbWVudHNTY2hlbWEucG9zdCgnc2F2ZScsIGZ1bmN0aW9uIChlcnJvciwgZG9jLCBuZXh0KSB7XG4gIGlmIChlcnJvci5uYW1lID09PSAnTW9uZ29FcnJvcicgJiYgZXJyb3IuY29kZSA9PT0gMTEwMDApIHtcbiAgICBuZXh0KG5ldyBFcnJvcignVGhlcmUgd2FzIGEgZHVwbGljYXRlIGtleSBlcnJvcicpKVxuICB9IGVsc2Uge1xuICAgIG5leHQoZXJyb3IpXG4gIH1cbn0pXG5cbkNvbW1lbnRzU2NoZW1hLnN0YXRpY3MgPSB7XG4gIGZpbmRCeVRpZDogZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IHRpZDogaWQgfSlcbiAgfSxcbiAgZmluZEJ5Q2lkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHsgX2lkOiBpZCB9KVxuICB9LFxuICBnZXRDb21tZW50c0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHsgdGlkOiBpZCB9KS5wb3B1bGF0ZSh7XG4gICAgICBwYXRoOiAnY3VpZCcsXG4gICAgICBzZWxlY3Q6ICdfaWQgbmFtZSBwaWMgaXNWaXAnLFxuICAgICAgbWF0Y2g6IHsgc3RhdHVzOiB7ICRlcTogJzAnIH0gfVxuICAgIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICd0aWQnLFxuICAgICAgc2VsZWN0OiAnX2lkIHRpdGxlIHN0YXR1cydcbiAgICB9KS5za2lwKHBhZ2UgKiBsaW1pdCkubGltaXQobGltaXQpXG4gIH0sXG4gIHF1ZXJ5Q291bnQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB0aWQ6IGlkIH0pLmNvdW50RG9jdW1lbnRzKClcbiAgfSxcbiAgZ2V0Q29tbWV0c1B1YmxpYzogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyBjdWlkOiBpZCB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ3RpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCB0aXRsZSdcbiAgICAgIH0pXG4gICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG4gIGdldE1zZ0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHtcbiAgICAgIHVpZDogaWQsXG4gICAgICAvLyBjdWlkOiB7ICRuZTogaWQgfSxcbiAgICAgIGN1aWQ6aWQsXG4gICAgICBpc1JlYWQ6IHsgJGVxOiAnMCcgfSwgLy8g5pyq6K+754q25oCBXG4gICAgICBzdGF0dXM6IHsgJGVxOiAnMScgfSAvLyDmmK/lkKbmmL7npLpcbiAgICB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ3RpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCB0aXRsZSdcbiAgICAgIH0pXG4gICAgICAucG9wdWxhdGUoe1xuICAgICAgICBwYXRoOiAndWlkJyxcbiAgICAgICAgc2VsZWN0OiAnX2lkIG5hbWUnXG4gICAgICB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ2N1aWQnLFxuICAgICAgICBzZWxlY3Q6ICdfaWQgbmFtZSdcbiAgICAgIH0pXG4gICAgICAuc2tpcChsaW1pdCAqIHBhZ2UpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG5cbiAgZ2V0VG90YWw6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkLCBpc1JlYWQ6ICcwJywgc3RhdHVzOiAnMScgfSkuY291bnREb2N1bWVudHMoKVxuICB9XG4gIC8vIGdldE1zZ0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgLy8gICByZXR1cm4gdGhpcy5hZ2dyZWdhdGUoW1xuICAvLyAgICAge1xuICAvLyAgICAgICAkbG9va3VwOiB7XG4gIC8vICAgICAgICAgZnJvbTogJ3Bvc3RzJyxcbiAgLy8gICAgICAgICBsZXQ6IHsgcGlkOiB7ICR0b09iamVjdElkOiAnJHRpZCcgfSB9LFxuICAvLyAgICAgICAgIHBpcGVsaW5lOiBbXG4gIC8vICAgICAgICAgICB7ICRtYXRjaDogeyAkZXhwcjogeyAkZXE6IFsnJF9pZCcsICckJHBpZCddIH0gfSB9LFxuICAvLyAgICAgICAgICAgeyAkcHJvamVjdDogeyBfaWQ6IDEsIHVpZDogMSwgY29udGVudDogMSB9IH1cbiAgLy8gICAgICAgICBdLFxuICAvLyAgICAgICAgIGFzOiAncG9zdCdcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfSxcbiAgLy8gICAgIHtcbiAgLy8gICAgICAgJHJlcGxhY2VSb290OiB7XG4gIC8vICAgICAgICAgbmV3Um9vdDoge1xuICAvLyAgICAgICAgICAgJG1lcmdlT2JqZWN0czogW3sgJGFycmF5RWxlbUF0OiBbJyRwb3N0JywgMF0gfSwgJyQkUk9PVCddXG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICB9XG4gIC8vICAgICB9LFxuICAvLyAgICAgeyAkYWRkRmllbGRzOiB7IHVzZXJJZDogeyAkdG9PYmplY3RJZDogJyR1aWQnIH0gfSB9LFxuICAvLyAgICAgeyAkbG9va3VwOiB7IGZyb206ICd1c2VycycsIGxvY2FsRmllbGQ6ICd1c2VySWQnLCBmb3JlaWduRmllbGQ6ICdfaWQnLCBhczogJ3R1aWQnIH0gfSxcbiAgLy8gICAgIHsgJHVud2luZDogJyR0dWlkJyB9LFxuICAvLyAgICAgeyAkYWRkRmllbGRzOiB7IGZ1c2VySWQ6IHsgJHRvT2JqZWN0SWQ6ICckY3VpZCcgfSB9IH0sXG4gIC8vICAgICB7ICRsb29rdXA6IHsgZnJvbTogJ3VzZXJzJywgbG9jYWxGaWVsZDogJ2Z1c2VySWQnLCBmb3JlaWduRmllbGQ6ICdfaWQnLCBhczogJ2Z1aWQnIH0gfSxcbiAgLy8gICAgIHsgJHVud2luZDogJyRmdWlkJyB9LFxuICAvLyAgICAgeyAkcHJvamVjdDogeyBwb3N0OiAwLCB0dWlkOiB7IHVzZXJuYW1lOiAwLCBwYXNzd29yZDogMCB9LCBmdWlkOiB7IHVzZXJuYW1lOiAwLCBwYXNzd29yZDogMCB9LCB1c2VySWQ6IDAsIGZ1c2VySWQ6IDAsIHRpZDogMCwgY3VpZDogMCB9IH0sXG4gIC8vICAgICB7ICRtYXRjaDogeyB1aWQ6IGlkLCBzdGF0dXM6ICcxJywgaXNSZWFkOiAnMCcgfSB9XG4gIC8vICAgXSlcbiAgLy8gICAgIC5za2lwKGxpbWl0ICogcGFnZSlcbiAgLy8gICAgIC5saW1pdChsaW1pdClcbiAgLy8gICAgIC5zb3J0KHsgY3JlYXRlZDogLTEgfSlcbiAgLy8gfVxufVxuXG5jb25zdCBDb21tZW50cyA9IG1vbmdvb3NlLm1vZGVsKCdjb21tZW50cycsIENvbW1lbnRzU2NoZW1hKVxuXG5tb2R1bGUuZXhwb3J0cyA9IENvbW1lbnRzXG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Comments.js"
      ],
      "names": [
        "mongoose",
        "require",
        "Schema",
        "CommentsSchema",
        "tid",
        "type",
        "String",
        "ref",
        "uid",
        "cuid",
        "content",
        "created",
        "Date",
        "hands",
        "Number",
        "default",
        "status",
        "isRead",
        "isBest",
        "toJSON",
        "virtuals",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "findByTid",
        "id",
        "find",
        "findByCid",
        "findOne",
        "_id",
        "getCommentsList",
        "page",
        "limit",
        "populate",
        "path",
        "select",
        "match",
        "$eq",
        "skip",
        "queryCount",
        "countDocuments",
        "getCommetsPublic",
        "sort",
        "getMsgList",
        "getTotal",
        "Comments",
        "model",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AAEA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AAEA,MAAMC,cAAc,GAAG,IAAID,MAAJ,CAAW;AAChCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GAD2B;AAEhCC,EAAAA,GAAG,EAAE;AAAEH,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GAF2B;AAGhCE,EAAAA,IAAI,EAAE;AAAEJ,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GAH0B;AAIhCG,EAAAA,OAAO,EAAE;AAAEL,IAAAA,IAAI,EAAEC;AAAR,GAJuB;AAKhCK,EAAAA,OAAO,EAAE;AAAEN,IAAAA,IAAI,EAAEO;AAAR,GALuB;AAMhCC,EAAAA,KAAK,EAAE;AAAER,IAAAA,IAAI,EAAES,MAAR;AAAgBC,IAAAA,OAAO,EAAE;AAAzB,GANyB;AAOhCC,EAAAA,MAAM,EAAE;AAAEX,IAAAA,IAAI,EAAEC,MAAR;AAAgBS,IAAAA,OAAO,EAAE;AAAzB,GAPwB;AAQhCE,EAAAA,MAAM,EAAE;AAAEZ,IAAAA,IAAI,EAAEC,MAAR;AAAgBS,IAAAA,OAAO,EAAE;AAAzB,GARwB;AAShCG,EAAAA,MAAM,EAAE;AAAEb,IAAAA,IAAI,EAAEC,MAAR;AAAgBS,IAAAA,OAAO,EAAE;AAAzB;AATwB,CAAX,EAUpB;AAAEI,EAAAA,MAAM,EAAE;AAAEC,IAAAA,QAAQ,EAAE;AAAZ;AAAV,CAVoB,CAAvB;AAYAjB,cAAc,CAACkB,GAAf,CAAmB,MAAnB,EAA2B,UAAUC,IAAV,EAAgB;AACzC,OAAKX,OAAL,GAAe,IAAIC,IAAJ,EAAf;AACAU,EAAAA,IAAI;AACL,CAHD;AAKAnB,cAAc,CAACoB,IAAf,CAAoB,MAApB,EAA4B,UAAUC,KAAV,EAAiBC,GAAjB,EAAsBH,IAAtB,EAA4B;AACtD,MAAIE,KAAK,CAACE,IAAN,KAAe,YAAf,IAA+BF,KAAK,CAACG,IAAN,KAAe,KAAlD,EAAyD;AACvDL,IAAAA,IAAI,CAAC,IAAIM,KAAJ,CAAU,iCAAV,CAAD,CAAJ;AACD,GAFD,MAEO;AACLN,IAAAA,IAAI,CAACE,KAAD,CAAJ;AACD;AACF,CAND;AAQArB,cAAc,CAAC0B,OAAf,GAAyB;AACvBC,EAAAA,SAAS,EAAE,UAAUC,EAAV,EAAc;AACvB,WAAO,KAAKC,IAAL,CAAU;AAAE5B,MAAAA,GAAG,EAAE2B;AAAP,KAAV,CAAP;AACD,GAHsB;AAIvBE,EAAAA,SAAS,EAAE,UAAUF,EAAV,EAAc;AACvB,WAAO,KAAKG,OAAL,CAAa;AAAEC,MAAAA,GAAG,EAAEJ;AAAP,KAAb,CAAP;AACD,GANsB;AAOvBK,EAAAA,eAAe,EAAE,UAAUL,EAAV,EAAcM,IAAd,EAAoBC,KAApB,EAA2B;AAC1C,WAAO,KAAKN,IAAL,CAAU;AAAE5B,MAAAA,GAAG,EAAE2B;AAAP,KAAV,EAAuBQ,QAAvB,CAAgC;AACrCC,MAAAA,IAAI,EAAE,MAD+B;AAErCC,MAAAA,MAAM,EAAE,oBAF6B;AAGrCC,MAAAA,KAAK,EAAE;AAAE1B,QAAAA,MAAM,EAAE;AAAE2B,UAAAA,GAAG,EAAE;AAAP;AAAV;AAH8B,KAAhC,EAIJJ,QAJI,CAIK;AACVC,MAAAA,IAAI,EAAE,KADI;AAEVC,MAAAA,MAAM,EAAE;AAFE,KAJL,EAOJG,IAPI,CAOCP,IAAI,GAAGC,KAPR,EAOeA,KAPf,CAOqBA,KAPrB,CAAP;AAQD,GAhBsB;AAiBvBO,EAAAA,UAAU,EAAE,UAAUd,EAAV,EAAc;AACxB,WAAO,KAAKC,IAAL,CAAU;AAAE5B,MAAAA,GAAG,EAAE2B;AAAP,KAAV,EAAuBe,cAAvB,EAAP;AACD,GAnBsB;AAoBvBC,EAAAA,gBAAgB,EAAE,UAAUhB,EAAV,EAAcM,IAAd,EAAoBC,KAApB,EAA2B;AAC3C,WAAO,KAAKN,IAAL,CAAU;AAAEvB,MAAAA,IAAI,EAAEsB;AAAR,KAAV,EACJQ,QADI,CACK;AACRC,MAAAA,IAAI,EAAE,KADE;AAERC,MAAAA,MAAM,EAAE;AAFA,KADL,EAKJG,IALI,CAKCP,IAAI,GAAGC,KALR,EAMJA,KANI,CAMEA,KANF,EAOJU,IAPI,CAOC;AAAErC,MAAAA,OAAO,EAAE,CAAC;AAAZ,KAPD,CAAP;AAQD,GA7BsB;AA8BvBsC,EAAAA,UAAU,EAAE,UAAUlB,EAAV,EAAcM,IAAd,EAAoBC,KAApB,EAA2B;AACrC,WAAO,KAAKN,IAAL,CAAU;AACfxB,MAAAA,GAAG,EAAEuB,EADU;AAEf;AACAtB,MAAAA,IAAI,EAACsB,EAHU;AAIfd,MAAAA,MAAM,EAAE;AAAE0B,QAAAA,GAAG,EAAE;AAAP,OAJO;AAIO;AACtB3B,MAAAA,MAAM,EAAE;AAAE2B,QAAAA,GAAG,EAAE;AAAP,OALO,CAKM;;AALN,KAAV,EAOJJ,QAPI,CAOK;AACRC,MAAAA,IAAI,EAAE,KADE;AAERC,MAAAA,MAAM,EAAE;AAFA,KAPL,EAWJF,QAXI,CAWK;AACRC,MAAAA,IAAI,EAAE,KADE;AAERC,MAAAA,MAAM,EAAE;AAFA,KAXL,EAeJF,QAfI,CAeK;AACRC,MAAAA,IAAI,EAAE,MADE;AAERC,MAAAA,MAAM,EAAE;AAFA,KAfL,EAmBJG,IAnBI,CAmBCN,KAAK,GAAGD,IAnBT,EAoBJC,KApBI,CAoBEA,KApBF,EAqBJU,IArBI,CAqBC;AAAErC,MAAAA,OAAO,EAAE,CAAC;AAAZ,KArBD,CAAP;AAsBD,GArDsB;AAuDvBuC,EAAAA,QAAQ,EAAE,UAAUnB,EAAV,EAAc;AACtB,WAAO,KAAKC,IAAL,CAAU;AAAExB,MAAAA,GAAG,EAAEuB,EAAP;AAAWd,MAAAA,MAAM,EAAE,GAAnB;AAAwBD,MAAAA,MAAM,EAAE;AAAhC,KAAV,EAAiD8B,cAAjD,EAAP;AACD,GAzDsB,CA0DvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AA1FuB,CAAzB;AA6FA,MAAMK,QAAQ,GAAGnD,QAAQ,CAACoD,KAAT,CAAe,UAAf,EAA2BjD,cAA3B,CAAjB;AAEAkD,MAAM,CAACC,OAAP,GAAiBH,QAAjB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\n\nconst Schema = mongoose.Schema\n\nconst CommentsSchema = new Schema({\n  tid: { type: String, ref: 'post' },\n  uid: { type: String, ref: 'users' },\n  cuid: { type: String, ref: 'users' },\n  content: { type: String },\n  created: { type: Date },\n  hands: { type: Number, default: 0 },\n  status: { type: String, default: '1' },\n  isRead: { type: String, default: '0' },\n  isBest: { type: String, default: '0' }\n}, { toJSON: { virtuals: true } })\n\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date()\n  next()\n})\n\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'))\n  } else {\n    next(error)\n  }\n})\n\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({ tid: id })\n  },\n  findByCid: function (id) {\n    return this.findOne({ _id: id })\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({ tid: id }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: { status: { $eq: '0' } }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit)\n  },\n  queryCount: function (id) {\n    return this.find({ tid: id }).countDocuments()\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({ cuid: id })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      // cuid: { $ne: id },\n      cuid:id,\n      isRead: { $eq: '0' }, // 未读状态\n      status: { $eq: '1' } // 是否显示\n    })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .populate({\n        path: 'uid',\n        select: '_id name'\n      })\n      .populate({\n        path: 'cuid',\n        select: '_id name'\n      })\n      .skip(limit * page)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n\n  getTotal: function (id) {\n    return this.find({ uid: id, isRead: '0', status: '1' }).countDocuments()\n  }\n  // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n}\n\nconst Comments = mongoose.model('comments', CommentsSchema)\n\nmodule.exports = Comments\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1586250029582
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/userRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/userRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/userRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/userRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "userRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require(\"koa-router\");\n\nconst {\n  userSign,\n  updateUserInfo,\n  changePassword,\n  getMsg,\n  setMsg\n} = require('../../api/UserController');\n\nconst {\n  getPostListByUid,\n  deletePostByUid\n} = require('../../api/ContentController');\n\nconst router = new Router();\nrouter.prefix('/user');\nrouter.get('/fav', userSign);\nrouter.post('/basic', updateUserInfo);\nrouter.post('/changePassword', changePassword);\nrouter.get('/getMsg', getMsg);\nrouter.get('/setMsg', setMsg);\nrouter.get('/post', getPostListByUid);\nrouter.post('/deletePost', deletePostByUid); // router.get('/account',userController.userAccount)\n// router.get('/permission',userController.userPermission)\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXJSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsInVzZXJTaWduIiwidXBkYXRlVXNlckluZm8iLCJjaGFuZ2VQYXNzd29yZCIsImdldE1zZyIsInNldE1zZyIsImdldFBvc3RMaXN0QnlVaWQiLCJkZWxldGVQb3N0QnlVaWQiLCJyb3V0ZXIiLCJwcmVmaXgiLCJnZXQiLCJwb3N0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxZQUFELENBQXRCOztBQUNBLE1BQU07QUFBRUMsRUFBQUEsUUFBRjtBQUFZQyxFQUFBQSxjQUFaO0FBQTRCQyxFQUFBQSxjQUE1QjtBQUE0Q0MsRUFBQUEsTUFBNUM7QUFBb0RDLEVBQUFBO0FBQXBELElBQWdFTCxPQUFPLENBQUMsMEJBQUQsQ0FBN0U7O0FBQ0EsTUFBTTtBQUFDTSxFQUFBQSxnQkFBRDtBQUFrQkMsRUFBQUE7QUFBbEIsSUFBb0NQLE9BQU8sQ0FBQyw2QkFBRCxDQUFqRDs7QUFFQSxNQUFNUSxNQUFNLEdBQUcsSUFBSVQsTUFBSixFQUFmO0FBQ0FTLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLE9BQWQ7QUFDQUQsTUFBTSxDQUFDRSxHQUFQLENBQVcsTUFBWCxFQUFtQlQsUUFBbkI7QUFFQU8sTUFBTSxDQUFDRyxJQUFQLENBQVksUUFBWixFQUFzQlQsY0FBdEI7QUFDQU0sTUFBTSxDQUFDRyxJQUFQLENBQVksaUJBQVosRUFBK0JSLGNBQS9CO0FBRUFLLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLFNBQVgsRUFBcUJOLE1BQXJCO0FBQ0FJLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLFNBQVgsRUFBcUJMLE1BQXJCO0FBRUFHLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLE9BQVgsRUFBbUJKLGdCQUFuQjtBQUNBRSxNQUFNLENBQUNHLElBQVAsQ0FBWSxhQUFaLEVBQTBCSixlQUExQixFLENBRUE7QUFDQTs7QUFFQUssTUFBTSxDQUFDQyxPQUFQLEdBQWlCTCxNQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlciA9IHJlcXVpcmUoXCJrb2Etcm91dGVyXCIpXG5jb25zdCB7IHVzZXJTaWduLCB1cGRhdGVVc2VySW5mbywgY2hhbmdlUGFzc3dvcmQsIGdldE1zZywgc2V0TXNnICB9ID0gcmVxdWlyZSgnLi4vLi4vYXBpL1VzZXJDb250cm9sbGVyJylcbmNvbnN0IHtnZXRQb3N0TGlzdEJ5VWlkLGRlbGV0ZVBvc3RCeVVpZH0gPXJlcXVpcmUoJy4uLy4uL2FwaS9Db250ZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlciA9IG5ldyBSb3V0ZXIoKVxucm91dGVyLnByZWZpeCgnL3VzZXInKVxucm91dGVyLmdldCgnL2ZhdicsIHVzZXJTaWduKVxuXG5yb3V0ZXIucG9zdCgnL2Jhc2ljJywgdXBkYXRlVXNlckluZm8pXG5yb3V0ZXIucG9zdCgnL2NoYW5nZVBhc3N3b3JkJywgY2hhbmdlUGFzc3dvcmQpXG5cbnJvdXRlci5nZXQoJy9nZXRNc2cnLGdldE1zZylcbnJvdXRlci5nZXQoJy9zZXRNc2cnLHNldE1zZylcblxucm91dGVyLmdldCgnL3Bvc3QnLGdldFBvc3RMaXN0QnlVaWQpXG5yb3V0ZXIucG9zdCgnL2RlbGV0ZVBvc3QnLGRlbGV0ZVBvc3RCeVVpZClcblxuLy8gcm91dGVyLmdldCgnL2FjY291bnQnLHVzZXJDb250cm9sbGVyLnVzZXJBY2NvdW50KVxuLy8gcm91dGVyLmdldCgnL3Blcm1pc3Npb24nLHVzZXJDb250cm9sbGVyLnVzZXJQZXJtaXNzaW9uKVxuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlciJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "userRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "userSign",
        "updateUserInfo",
        "changePassword",
        "getMsg",
        "setMsg",
        "getPostListByUid",
        "deletePostByUid",
        "router",
        "prefix",
        "get",
        "post",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,YAAD,CAAtB;;AACA,MAAM;AAAEC,EAAAA,QAAF;AAAYC,EAAAA,cAAZ;AAA4BC,EAAAA,cAA5B;AAA4CC,EAAAA,MAA5C;AAAoDC,EAAAA;AAApD,IAAgEL,OAAO,CAAC,0BAAD,CAA7E;;AACA,MAAM;AAACM,EAAAA,gBAAD;AAAkBC,EAAAA;AAAlB,IAAoCP,OAAO,CAAC,6BAAD,CAAjD;;AAEA,MAAMQ,MAAM,GAAG,IAAIT,MAAJ,EAAf;AACAS,MAAM,CAACC,MAAP,CAAc,OAAd;AACAD,MAAM,CAACE,GAAP,CAAW,MAAX,EAAmBT,QAAnB;AAEAO,MAAM,CAACG,IAAP,CAAY,QAAZ,EAAsBT,cAAtB;AACAM,MAAM,CAACG,IAAP,CAAY,iBAAZ,EAA+BR,cAA/B;AAEAK,MAAM,CAACE,GAAP,CAAW,SAAX,EAAqBN,MAArB;AACAI,MAAM,CAACE,GAAP,CAAW,SAAX,EAAqBL,MAArB;AAEAG,MAAM,CAACE,GAAP,CAAW,OAAX,EAAmBJ,gBAAnB;AACAE,MAAM,CAACG,IAAP,CAAY,aAAZ,EAA0BJ,eAA1B,E,CAEA;AACA;;AAEAK,MAAM,CAACC,OAAP,GAAiBL,MAAjB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router = require(\"koa-router\")\nconst { userSign, updateUserInfo, changePassword, getMsg, setMsg  } = require('../../api/UserController')\nconst {getPostListByUid,deletePostByUid} =require('../../api/ContentController')\n\nconst router = new Router()\nrouter.prefix('/user')\nrouter.get('/fav', userSign)\n\nrouter.post('/basic', updateUserInfo)\nrouter.post('/changePassword', changePassword)\n\nrouter.get('/getMsg',getMsg)\nrouter.get('/setMsg',setMsg)\n\nrouter.get('/post',getPostListByUid)\nrouter.post('/deletePost',deletePostByUid)\n\n// router.get('/account',userController.userAccount)\n// router.get('/permission',userController.userPermission)\n\nmodule.exports = router"
      ]
    },
    "sourceType": "script",
    "mtime": 1586401610851
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/UserController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/UserController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/UserController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/UserController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "UserController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst SignRecord = require('../model/SignRecord');\n\nconst User = require('../model/User');\n\nconst Utils = require('../common/Utils');\n\nconst {\n  setValue\n} = require('../config/RedisConfig');\n\nconst {\n  send\n} = require('../config/MailConfig');\n\nconst config = require('../config/index');\n\nconst {\n  getJWTPayload\n} = require('../common/Utils');\n\nconst Comments = require('../model/Comments');\n\nconst moment = require('dayjs');\n\nconst uuid = require('uuid/v4');\n\nconst jwt = require('jsonwebtoken');\n\nconst bcrypt = require('bcrypt');\n\nasync function userSign(ctx) {\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  const record = await SignRecord.findByUid(obj._id);\n  console.log(\"userSign -> record\", record);\n  const user = await User.findByID(obj._id);\n  let newRecord = {};\n  let result = '';\n  record.created = '2020-03-14T02:54:41.000Z';\n\n  if (record !== null) {\n    if (moment(record.created).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD')) {\n      ctx.body = {\n        code: 500,\n        favs: user.favs,\n        count: user.count,\n        lastSign: record.created,\n        msg: '用户已经签到'\n      };\n      return;\n    } else {\n      let count = user.count;\n      console.log(\"userSign -> count\", count);\n      let fav = 0;\n\n      if (moment(record.created).format('YYYY-MM-DD') === moment().subtract(1, 'days').format('YYYY-MM-DD')) {\n        count += 1;\n\n        if (count < 5) {\n          fav = 5;\n        } else if (count >= 5 && count < 15) {\n          fav = 10;\n        } else if (count >= 15 && count < 30) {\n          fav = 15;\n        } else if (count >= 30 && count < 100) {\n          fav = 20;\n        } else if (count >= 100 && count < 365) {\n          fav = 30;\n        } else if (count >= 365) {\n          fav = 50;\n        }\n\n        await User.updateOne({\n          _id: obj._id\n        }, {\n          $inc: {\n            favs: fav,\n            count: 1\n          }\n        });\n        result = {\n          favs: user.favs + fav,\n          count: user.count + 1\n        };\n      } else {\n        fav = 5;\n        await User.updateOne({\n          _id: obj._id\n        }, {\n          $set: {\n            count: 1\n          },\n          $inc: {\n            favs: fav\n          }\n        });\n        result = {\n          favs: user.favs + fav,\n          count: 1\n        };\n      }\n\n      newRecord = new SignRecord({\n        uid: obj._id,\n        favs: fav\n      });\n      await newRecord.save();\n    }\n  } else {\n    await User.updateOne({\n      _id: obj._id\n    }, {\n      $set: {\n        count: 1\n      },\n      $inc: {\n        favs: 5\n      }\n    });\n    newRecord = new SignRecord({\n      uid: obj._id,\n      favs: 5 // lastSign: moment().format('YYYY-MM-DD HH:mm:ss')\n\n    });\n    await newRecord.save();\n    result = {\n      favs: user.favs + 5,\n      count: 1\n    };\n  }\n\n  ctx.body = {\n    code: 200,\n    msg: '请求成功',\n    ...result,\n    lastSign: newRecord.created\n  };\n}\n\nasync function updateUserInfo(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"updateUserInfo -> body\", body);\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  console.log(\"updateUserInfo -> obj\", obj);\n  const user = await User.findOne({\n    _id: obj._id\n  });\n  console.log(\"updateUserInfo -> user\", user);\n  let msg = '';\n\n  if (body.username && body.username !== user.username) {\n    const tmpUser = await User.findOne({\n      username: body.username\n    });\n    console.log(\"updateUserInfo -> tmpUser\", tmpUser);\n\n    if (tmpUser && tmpUser.password) {\n      ctx.body = {\n        code: 501,\n        msg: '邮箱已经注册'\n      };\n      return;\n    }\n\n    const key = uuid();\n    setValue(key, jwt.sign({\n      _id: obj._id\n    }, config.JWT_SECRET, {\n      expiresIn: '30m'\n    }));\n    await send({\n      type: 'email',\n      data: {\n        key: key,\n        username: body.username\n      },\n      code: '',\n      expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n      email: user.username,\n      user: user.name\n    });\n    msg = '更新基本资料成功，账号修改需要邮件确认，请查收邮件';\n  }\n\n  const arr = ['username', 'mobile', 'password'];\n  arr.map(item => {\n    delete body[item];\n  });\n  const result = await User.updateOne({\n    _id: obj._id\n  }, body);\n  console.log(\"result\", result);\n\n  if (result.n === 1 && result.ok === 1) {\n    ctx.body = {\n      code: 200,\n      msg: msg === '' ? '更新成功' : msg\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '更新失败'\n    };\n  }\n}\n\nasync function changePassword(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"changePassword -> body\", body);\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  const user = await User.findOne({\n    _id: obj._id\n  });\n  console.log(\"changePassword -> user\", user);\n  let msg = '';\n\n  if (await bcrypt.compare(body.oldPassword, user.password)) {\n    body.newPassword = await bcrypt.hash(body.newPassword, 5);\n    console.log(\"changePassword ->  body.newPassword\", body.newPassword);\n    const result = await User.updateOne({\n      _id: obj._id\n    }, {\n      password: body.newPassword\n    });\n    console.log(\"result\", result);\n\n    if (result.n === 1 && result.ok === 1) {\n      ctx.body = {\n        code: 200,\n        msg: msg === '' ? '更新成功' : msg\n      };\n    } else {\n      ctx.body = {\n        code: 500,\n        msg: '更新失败'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 501,\n      msg: '原来的密码填写错误'\n    };\n    return;\n  }\n}\n\nasync function getMsg(ctx) {\n  const params = ctx.query;\n  const page = params.page ? params.page : 0;\n  const limit = params.limit ? parseInt(params.limit) : 0;\n  const obj = await getJWTPayload(ctx.header.authorization);\n  const result = await Comments.getMsgList(obj._id, page, limit);\n  const num = await Comments.getTotal(obj._id);\n  console.log(\"getMsg -> result\", result);\n  ctx.body = {\n    code: 200,\n    data: result,\n    total: num\n  };\n}\n\nasync function setMsg(ctx) {\n  const params = ctx.query;\n\n  if (params.id) {\n    const result = await Comments.updateOne({\n      _id: params.id\n    }, {\n      isRead: '1'\n    });\n\n    if (result.ok === 1) {\n      ctx.body = {\n        code: 200\n      };\n    }\n  } else {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const result = await Comments.updateMany({\n      uid: obj._id\n    }, {\n      isRead: '1'\n    });\n\n    if (result.ok === 1) {\n      ctx.body = {\n        code: 200\n      };\n    }\n  }\n}\n\nmodule.exports = {\n  userSign,\n  updateUserInfo,\n  changePassword,\n  getMsg,\n  setMsg\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlNpZ25SZWNvcmQiLCJyZXF1aXJlIiwiVXNlciIsIlV0aWxzIiwic2V0VmFsdWUiLCJzZW5kIiwiY29uZmlnIiwiZ2V0SldUUGF5bG9hZCIsIkNvbW1lbnRzIiwibW9tZW50IiwidXVpZCIsImp3dCIsImJjcnlwdCIsInVzZXJTaWduIiwiY3R4Iiwib2JqIiwiaGVhZGVyIiwiYXV0aG9yaXphdGlvbiIsInJlY29yZCIsImZpbmRCeVVpZCIsIl9pZCIsImNvbnNvbGUiLCJsb2ciLCJ1c2VyIiwiZmluZEJ5SUQiLCJuZXdSZWNvcmQiLCJyZXN1bHQiLCJjcmVhdGVkIiwiZm9ybWF0IiwiYm9keSIsImNvZGUiLCJmYXZzIiwiY291bnQiLCJsYXN0U2lnbiIsIm1zZyIsImZhdiIsInN1YnRyYWN0IiwidXBkYXRlT25lIiwiJGluYyIsIiRzZXQiLCJ1aWQiLCJzYXZlIiwidXBkYXRlVXNlckluZm8iLCJyZXF1ZXN0IiwiZmluZE9uZSIsInVzZXJuYW1lIiwidG1wVXNlciIsInBhc3N3b3JkIiwia2V5Iiwic2lnbiIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJ0eXBlIiwiZGF0YSIsImV4cGlyZSIsImFkZCIsImVtYWlsIiwibmFtZSIsImFyciIsIm1hcCIsIml0ZW0iLCJuIiwib2siLCJjaGFuZ2VQYXNzd29yZCIsImNvbXBhcmUiLCJvbGRQYXNzd29yZCIsIm5ld1Bhc3N3b3JkIiwiaGFzaCIsImdldE1zZyIsInBhcmFtcyIsInF1ZXJ5IiwicGFnZSIsImxpbWl0IiwicGFyc2VJbnQiLCJnZXRNc2dMaXN0IiwibnVtIiwiZ2V0VG90YWwiLCJ0b3RhbCIsInNldE1zZyIsImlkIiwiaXNSZWFkIiwidXBkYXRlTWFueSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUMscUJBQUQsQ0FBMUI7O0FBQ0EsTUFBTUMsSUFBSSxHQUFHRCxPQUFP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Q08sR0FBRyxDQUFDRSxNQUFKLENBQVdDLGFBQVosQ0FBL0I7QUFDQSxVQUFNUyxNQUFNLEdBQUcsTUFBTWxCLFFBQVEsQ0FBQ3lFLFVBQVQsQ0FDakI7QUFBRXpDLE1BQUFBLEdBQUcsRUFBRXpCLEdBQUcsQ0FBQ0s7QUFBWCxLQURpQixFQUVqQjtBQUFFNEQsTUFBQUEsTUFBTSxFQUFFO0FBQVYsS0FGaUIsQ0FBckI7O0FBSUEsUUFBSXRELE1BQU0sQ0FBQ29DLEVBQVAsS0FBYyxDQUFsQixFQUFxQjtBQUNqQmhELE1BQUFBLEdBQUcsQ0FBQ2UsSUFBSixHQUFXO0FBQ1BDLFFBQUFBLElBQUksRUFBRTtBQURDLE9BQVg7QUFHSDtBQUNKO0FBQ0o7O0FBR0RvRCxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRXRFLEVBQUFBLFFBQUY7QUFBWTZCLEVBQUFBLGNBQVo7QUFBNEJxQixFQUFBQSxjQUE1QjtBQUE0Q0ssRUFBQUEsTUFBNUM7QUFBb0RVLEVBQUFBO0FBQXBELENBQWpCIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjL2FwaSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFNpZ25SZWNvcmQgPSByZXF1aXJlKCcuLi9tb2RlbC9TaWduUmVjb3JkJylcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbC9Vc2VyJylcbmNvbnN0IFV0aWxzID0gcmVxdWlyZSgnLi4vY29tbW9uL1V0aWxzJylcbmNvbnN0IHsgc2V0VmFsdWUgfSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9SZWRpc0NvbmZpZycpXG5jb25zdCB7IHNlbmQgfSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9NYWlsQ29uZmlnJylcbmNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4uL2NvbmZpZy9pbmRleCcpXG5jb25zdCB7IGdldEpXVFBheWxvYWQgfSA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG5jb25zdCBDb21tZW50cyA9IHJlcXVpcmUoJy4uL21vZGVsL0NvbW1lbnRzJylcblxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuY29uc3QgdXVpZCA9IHJlcXVpcmUoJ3V1aWQvdjQnKVxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpXG5cbmFzeW5jIGZ1bmN0aW9uIHVzZXJTaWduIChjdHgpIHtcbiAgICBjb25zdCBvYmogPSBhd2FpdCBVdGlscy5nZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICBjb25zdCByZWNvcmQgPSBhd2FpdCBTaWduUmVjb3JkLmZpbmRCeVVpZChvYmouX2lkKVxuICAgIGNvbnNvbGUubG9nKFwidXNlclNpZ24gLT4gcmVjb3JkXCIsIHJlY29yZClcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJRChvYmouX2lkKVxuICAgIGxldCBuZXdSZWNvcmQgPSB7fVxuICAgIGxldCByZXN1bHQgPSAnJ1xuICAgIHJlY29yZC5jcmVhdGVkID0gJzIwMjAtMDMtMTRUMDI6NTQ6NDEuMDAwWidcbiAgICBpZiAocmVjb3JkICE9PSBudWxsKSB7XG4gICAgICAgIGlmIChtb21lbnQocmVjb3JkLmNyZWF0ZWQpLmZvcm1hdCgnWVlZWS1NTS1ERCcpID09PSBtb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQnKSkge1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIGZhdnM6IHVzZXIuZmF2cyxcbiAgICAgICAgICAgICAgICBjb3VudDogdXNlci5jb3VudCxcbiAgICAgICAgICAgICAgICBsYXN0U2lnbjogcmVjb3JkLmNyZWF0ZWQsXG4gICAgICAgICAgICAgICAgbXNnOiAn55So5oi35bey57uP562+5YiwJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgY291bnQgPSB1c2VyLmNvdW50XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXJTaWduIC0+IGNvdW50XCIsIGNvdW50KVxuICAgICAgICAgICAgbGV0IGZhdiA9IDBcbiAgICAgICAgICAgIGlmIChtb21lbnQocmVjb3JkLmNyZWF0ZWQpLmZvcm1hdCgnWVlZWS1NTS1ERCcpID09PSBtb21lbnQoKS5zdWJ0cmFjdCgxLCAnZGF5cycpLmZvcm1hdCgnWVlZWS1NTS1ERCcpKSB7XG4gICAgICAgICAgICAgICAgY291bnQgKz0gMVxuICAgICAgICAgICAgICAgIGlmIChjb3VudCA8IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gNVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQgPj0gNSAmJiBjb3VudCA8IDE1KSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdiA9IDEwXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSAxNSAmJiBjb3VudCA8IDMwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdiA9IDE1XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSAzMCAmJiBjb3VudCA8IDEwMCkge1xuICAgICAgICAgICAgICAgICAgICBmYXYgPSAyMFxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQgPj0gMTAwICYmIGNvdW50IDwgMzY1KSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdiA9IDMwXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSAzNjUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gNTBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXdhaXQgVXNlci51cGRhdGVPbmUoXG4gICAgICAgICAgICAgICAgICAgIHsgX2lkOiBvYmouX2lkIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgJGluYzogeyBmYXZzOiBmYXYsIGNvdW50OiAxIH0gfVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdnM6IHVzZXIuZmF2cyArIGZhdixcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IHVzZXIuY291bnQgKyAxXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmYXYgPSA1XG4gICAgICAgICAgICAgICAgYXdhaXQgVXNlci51cGRhdGVPbmUoXG4gICAgICAgICAgICAgICAgICAgIHsgX2lkOiBvYmouX2lkIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHsgY291bnQ6IDEgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRpbmM6IHsgZmF2czogZmF2IH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdnM6IHVzZXIuZmF2cyArIGZhdixcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IDFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdSZWNvcmQgPSBuZXcgU2lnblJlY29yZCh7XG4gICAgICAgICAgICAgICAgdWlkOiBvYmouX2lkLFxuICAgICAgICAgICAgICAgIGZhdnM6IGZhdlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGF3YWl0IG5ld1JlY29yZC5zYXZlKClcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IFVzZXIudXBkYXRlT25lKHtcbiAgICAgICAgICAgIF9pZDogb2JqLl9pZFxuICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRzZXQ6IHsgY291bnQ6IDEgfSxcbiAgICAgICAgICAgICAgICAkaW5jOiB7IGZhdnM6IDUgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgbmV3UmVjb3JkID0gbmV3IFNpZ25SZWNvcmQoe1xuICAgICAgICAgICAgdWlkOiBvYmouX2lkLFxuICAgICAgICAgICAgZmF2czogNVxuICAgICAgICAgICAgLy8gbGFzdFNpZ246IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpXG4gICAgICAgIH0pXG4gICAgICAgIGF3YWl0IG5ld1JlY29yZC5zYXZlKClcbiAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgZmF2czogdXNlci5mYXZzICsgNSxcbiAgICAgICAgICAgIGNvdW50OiAxXG4gICAgICAgIH1cbiAgICB9XG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgbXNnOiAn6K+35rGC5oiQ5YqfJyxcbiAgICAgICAgLi4ucmVzdWx0LFxuICAgICAgICBsYXN0U2lnbjogbmV3UmVjb3JkLmNyZWF0ZWRcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVVzZXJJbmZvIChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJ1cGRhdGVVc2VySW5mbyAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgb2JqID0gYXdhaXQgVXRpbHMuZ2V0SldUUGF5bG9hZChjdHguaGVhZGVyLmF1dGhvcml6YXRpb24pXG4gICAgY29uc29sZS5sb2coXCJ1cGRhdGVVc2VySW5mbyAtPiBvYmpcIiwgb2JqKVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBfaWQ6IG9iai5faWQgfSlcbiAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVVzZXJJbmZvIC0+IHVzZXJcIiwgdXNlcilcbiAgICBsZXQgbXNnID0gJydcbiAgICBpZiAoYm9keS51c2VybmFtZSAmJiBib2R5LnVzZXJuYW1lICE9PSB1c2VyLnVzZXJuYW1lKSB7XG4gICAgICAgIGNvbnN0IHRtcFVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogYm9keS51c2VybmFtZSB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVVzZXJJbmZvIC0+IHRtcFVzZXJcIiwgdG1wVXNlcilcbiAgICAgICAgaWYgKHRtcFVzZXIgJiYgdG1wVXNlci5wYXNzd29yZCkge1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAxLFxuICAgICAgICAgICAgICAgIG1zZzogJ+mCrueuseW3sue7j+azqOWGjCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGtleSA9IHV1aWQoKVxuICAgICAgICBzZXRWYWx1ZShcbiAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgIGp3dC5zaWduKHsgX2lkOiBvYmouX2lkIH0sIGNvbmZpZy5KV1RfU0VDUkVULCB7XG4gICAgICAgICAgICAgICAgZXhwaXJlc0luOiAnMzBtJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgICBhd2FpdCBzZW5kKHtcbiAgICAgICAgICAgIHR5cGU6ICdlbWFpbCcsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb2RlOiAnJyxcbiAgICAgICAgICAgIGV4cGlyZTogbW9tZW50KCkuYWRkKDMwLCAnbWludXRlcycpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpLFxuICAgICAgICAgICAgZW1haWw6IHVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICB1c2VyOiB1c2VyLm5hbWVcbiAgICAgICAgfSlcbiAgICAgICAgbXNnID0gJ+abtOaWsOWfuuacrOi1hOaWmeaIkOWKn++8jOi0puWPt+S/ruaUuemcgOimgemCruS7tuehruiupO+8jOivt+afpeaUtumCruS7tidcbiAgICB9XG4gICAgY29uc3QgYXJyID0gWyd1c2VybmFtZScsICdtb2JpbGUnLCAncGFzc3dvcmQnXVxuICAgIGFyci5tYXAoaXRlbSA9PiB7XG4gICAgICAgIGRlbGV0ZSBib2R5W2l0ZW1dXG4gICAgfSlcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBVc2VyLnVwZGF0ZU9uZSh7IF9pZDogb2JqLl9pZCB9LCBib2R5KVxuICAgIGNvbnNvbGUubG9nKFwicmVzdWx0XCIsIHJlc3VsdClcbiAgICBpZiAocmVzdWx0Lm4gPT09IDEgJiYgcmVzdWx0Lm9rID09PSAxKSB7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgY29kZTogMjAwLFxuICAgICAgICAgICAgbXNnOiBtc2cgPT09ICcnID8gJ+abtOaWsOaIkOWKnycgOiBtc2dcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgbXNnOiAn5pu05paw5aSx6LSlJ1xuICAgICAgICB9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjaGFuZ2VQYXNzd29yZCAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlUGFzc3dvcmQgLT4gYm9keVwiLCBib2R5KVxuICAgIGNvbnN0IG9iaiA9IGF3YWl0IFV0aWxzLmdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBfaWQ6IG9iai5faWQgfSlcbiAgICBjb25zb2xlLmxvZyhcImNoYW5nZVBhc3N3b3JkIC0+IHVzZXJcIiwgdXNlcilcbiAgICBsZXQgbXNnID0gJydcbiAgICBpZiAoYXdhaXQgYmNyeXB0LmNvbXBhcmUoYm9keS5vbGRQYXNzd29yZCwgdXNlci5wYXNzd29yZCkpIHtcbiAgICAgICAgYm9keS5uZXdQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKGJvZHkubmV3UGFzc3dvcmQsIDUpXG4gICAgICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlUGFzc3dvcmQgLT4gIGJvZHkubmV3UGFzc3dvcmRcIiwgYm9keS5uZXdQYXNzd29yZClcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgVXNlci51cGRhdGVPbmUoeyBfaWQ6IG9iai5faWQgfSwgeyBwYXNzd29yZDogYm9keS5uZXdQYXNzd29yZCB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdFwiLCByZXN1bHQpXG4gICAgICAgIGlmIChyZXN1bHQubiA9PT0gMSAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBtc2c6IG1zZyA9PT0gJycgPyAn5pu05paw5oiQ5YqfJyA6IG1zZ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIG1zZzogJ+abtOaWsOWksei0pSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgY29kZTogNTAxLFxuICAgICAgICAgICAgbXNnOiAn5Y6f5p2l55qE5a+G56CB5aGr5YaZ6ZSZ6K+vJ1xuICAgICAgICB9XG4gICAgICAgIHJldHVyblxuICAgIH1cblxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRNc2cgKGN0eCkge1xuICAgIGNvbnN0IHBhcmFtcyA9IGN0eC5xdWVyeVxuICAgIGNvbnN0IHBhZ2UgPSBwYXJhbXMucGFnZSA/IHBhcmFtcy5wYWdlIDogMFxuICAgIGNvbnN0IGxpbWl0ID0gcGFyYW1zLmxpbWl0ID8gcGFyc2VJbnQocGFyYW1zLmxpbWl0KSA6IDBcblxuICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IENvbW1lbnRzLmdldE1zZ0xpc3Qob2JqLl9pZCwgcGFnZSwgbGltaXQpXG4gICAgY29uc3QgbnVtID0gYXdhaXQgQ29tbWVudHMuZ2V0VG90YWwob2JqLl9pZClcblxuICAgIGNvbnNvbGUubG9nKFwiZ2V0TXNnIC0+IHJlc3VsdFwiLCByZXN1bHQpXG5cbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgIHRvdGFsOiBudW1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNldE1zZyAoY3R4KSB7XG4gICAgY29uc3QgcGFyYW1zID0gY3R4LnF1ZXJ5XG4gICAgaWYgKHBhcmFtcy5pZCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDb21tZW50cy51cGRhdGVPbmUoXG4gICAgICAgICAgICB7IF9pZDogcGFyYW1zLmlkIH0sXG4gICAgICAgICAgICB7IGlzUmVhZDogJzEnIH1cbiAgICAgICAgKVxuICAgICAgICBpZiAocmVzdWx0Lm9rID09PSAxKSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiAyMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDb21tZW50cy51cGRhdGVNYW55KFxuICAgICAgICAgICAgeyB1aWQ6IG9iai5faWQgfSxcbiAgICAgICAgICAgIHsgaXNSZWFkOiAnMScgfVxuICAgICAgICApXG4gICAgICAgIGlmIChyZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0geyB1c2VyU2lnbiwgdXBkYXRlVXNlckluZm8sIGNoYW5nZVBhc3N3b3JkLCBnZXRNc2csIHNldE1zZyB9Il19",
    "map": {
      "version": 3,
      "sources": [
        "UserController.js"
      ],
      "names": [
        "SignRecord",
        "require",
        "User",
        "Utils",
        "setValue",
        "send",
        "config",
        "getJWTPayload",
        "Comments",
        "moment",
        "uuid",
        "jwt",
        "bcrypt",
        "userSign",
        "ctx",
        "obj",
        "header",
        "authorization",
        "record",
        "findByUid",
        "_id",
        "console",
        "log",
        "user",
        "findByID",
        "newRecord",
        "result",
        "created",
        "format",
        "body",
        "code",
        "favs",
        "count",
        "lastSign",
        "msg",
        "fav",
        "subtract",
        "updateOne",
        "$inc",
        "$set",
        "uid",
        "save",
        "updateUserInfo",
        "request",
        "findOne",
        "username",
        "tmpUser",
        "password",
        "key",
        "sign",
        "JWT_SECRET",
        "expiresIn",
        "type",
        "data",
        "expire",
        "add",
        "email",
        "name",
        "arr",
        "map",
        "item",
        "n",
        "ok",
        "changePassword",
        "compare",
        "oldPassword",
        "newPassword",
        "hash",
        "getMsg",
        "params",
        "query",
        "page",
        "limit",
        "parseInt",
        "getMsgList",
        "num",
        "getTotal",
        "total",
        "setMsg",
        "id",
        "isRead",
        "updateMany",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "const SignRecord = require('../model/SignRecord')\nconst User = require('../model/User')\nconst Utils = require('../common/Utils')\nconst { setValue } = require('../config/RedisConfig')\nconst { send } = require('../config/MailConfig')\nconst config = require('../config/index')\nconst { getJWTPayload } = require('../common/Utils')\nconst Comments = require('../model/Comments')\n\nconst moment = require('dayjs')\nconst uuid = require('uuid/v4')\nconst jwt = require('jsonwebtoken')\nconst bcrypt = require('bcrypt')\n\nasync function userSign (ctx) {\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    const record = await SignRecord.findByUid(obj._id)\n    console.log(\"userSign -> record\", record)\n    const user = await User.findByID(obj._id)\n    let newRecord = {}\n    let result = ''\n    record.created = '2020-03-14T02:54:41.000Z'\n    if (record !== null) {\n        if (moment(record.created).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD')) {\n            ctx.body = {\n                code: 500,\n                favs: user.favs,\n                count: user.count,\n                lastSign: record.created,\n                msg: '用户已经签到'\n            }\n            return\n        } else {\n            let count = user.count\n            console.log(\"userSign -> count\", count)\n            let fav = 0\n            if (moment(record.created).format('YYYY-MM-DD') === moment().subtract(1, 'days').format('YYYY-MM-DD')) {\n                count += 1\n                if (count < 5) {\n                    fav = 5\n                } else if (count >= 5 && count < 15) {\n                    fav = 10\n                } else if (count >= 15 && count < 30) {\n                    fav = 15\n                } else if (count >= 30 && count < 100) {\n                    fav = 20\n                } else if (count >= 100 && count < 365) {\n                    fav = 30\n                } else if (count >= 365) {\n                    fav = 50\n                }\n                await User.updateOne(\n                    { _id: obj._id },\n                    { $inc: { favs: fav, count: 1 } }\n                )\n                result = {\n                    favs: user.favs + fav,\n                    count: user.count + 1\n                }\n            } else {\n                fav = 5\n                await User.updateOne(\n                    { _id: obj._id },\n                    {\n                        $set: { count: 1 },\n                        $inc: { favs: fav }\n                    }\n                )\n                result = {\n                    favs: user.favs + fav,\n                    count: 1\n                }\n            }\n            newRecord = new SignRecord({\n                uid: obj._id,\n                favs: fav\n            })\n            await newRecord.save()\n        }\n    } else {\n        await User.updateOne({\n            _id: obj._id\n        },\n            {\n                $set: { count: 1 },\n                $inc: { favs: 5 }\n            })\n        newRecord = new SignRecord({\n            uid: obj._id,\n            favs: 5\n            // lastSign: moment().format('YYYY-MM-DD HH:mm:ss')\n        })\n        await newRecord.save()\n        result = {\n            favs: user.favs + 5,\n            count: 1\n        }\n    }\n    ctx.body = {\n        code: 200,\n        msg: '请求成功',\n        ...result,\n        lastSign: newRecord.created\n    }\n}\n\nasync function updateUserInfo (ctx) {\n    const { body } = ctx.request\n    console.log(\"updateUserInfo -> body\", body)\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    console.log(\"updateUserInfo -> obj\", obj)\n    const user = await User.findOne({ _id: obj._id })\n    console.log(\"updateUserInfo -> user\", user)\n    let msg = ''\n    if (body.username && body.username !== user.username) {\n        const tmpUser = await User.findOne({ username: body.username })\n        console.log(\"updateUserInfo -> tmpUser\", tmpUser)\n        if (tmpUser && tmpUser.password) {\n            ctx.body = {\n                code: 501,\n                msg: '邮箱已经注册'\n            }\n            return\n        }\n        const key = uuid()\n        setValue(\n            key,\n            jwt.sign({ _id: obj._id }, config.JWT_SECRET, {\n                expiresIn: '30m'\n            })\n        )\n        await send({\n            type: 'email',\n            data: {\n                key: key,\n                username: body.username\n            },\n            code: '',\n            expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n            email: user.username,\n            user: user.name\n        })\n        msg = '更新基本资料成功，账号修改需要邮件确认，请查收邮件'\n    }\n    const arr = ['username', 'mobile', 'password']\n    arr.map(item => {\n        delete body[item]\n    })\n    const result = await User.updateOne({ _id: obj._id }, body)\n    console.log(\"result\", result)\n    if (result.n === 1 && result.ok === 1) {\n        ctx.body = {\n            code: 200,\n            msg: msg === '' ? '更新成功' : msg\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '更新失败'\n        }\n    }\n}\n\nasync function changePassword (ctx) {\n    const { body } = ctx.request\n    console.log(\"changePassword -> body\", body)\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    const user = await User.findOne({ _id: obj._id })\n    console.log(\"changePassword -> user\", user)\n    let msg = ''\n    if (await bcrypt.compare(body.oldPassword, user.password)) {\n        body.newPassword = await bcrypt.hash(body.newPassword, 5)\n        console.log(\"changePassword ->  body.newPassword\", body.newPassword)\n        const result = await User.updateOne({ _id: obj._id }, { password: body.newPassword })\n        console.log(\"result\", result)\n        if (result.n === 1 && result.ok === 1) {\n            ctx.body = {\n                code: 200,\n                msg: msg === '' ? '更新成功' : msg\n            }\n        } else {\n            ctx.body = {\n                code: 500,\n                msg: '更新失败'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 501,\n            msg: '原来的密码填写错误'\n        }\n        return\n    }\n\n}\n\nasync function getMsg (ctx) {\n    const params = ctx.query\n    const page = params.page ? params.page : 0\n    const limit = params.limit ? parseInt(params.limit) : 0\n\n    const obj = await getJWTPayload(ctx.header.authorization)\n    const result = await Comments.getMsgList(obj._id, page, limit)\n    const num = await Comments.getTotal(obj._id)\n\n    console.log(\"getMsg -> result\", result)\n\n    ctx.body = {\n        code: 200,\n        data: result,\n        total: num\n    }\n}\n\nasync function setMsg (ctx) {\n    const params = ctx.query\n    if (params.id) {\n        const result = await Comments.updateOne(\n            { _id: params.id },\n            { isRead: '1' }\n        )\n        if (result.ok === 1) {\n            ctx.body = {\n                code: 200\n            }\n        }\n    } else {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const result = await Comments.updateMany(\n            { uid: obj._id },\n            { isRead: '1' }\n        )\n        if (result.ok === 1) {\n            ctx.body = {\n                code: 200\n            }\n        }\n    }\n}\n\n\nmodule.exports = { userSign, updateUserInfo, changePassword, getMsg, setMsg }"
      ]
    },
    "sourceType": "script",
    "mtime": 1586314181597
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/SignRecord.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/SignRecord.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/SignRecord.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/SignRecord.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "SignRecord.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst SignRecordSchema = new Schema({\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  created: {\n    type: Date\n  },\n  favs: {\n    type: Number\n  },\n  lastSign: {\n    type: Date\n  }\n});\nSignRecordSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss');\n  next();\n});\nSignRecordSchema.statics = {\n  findByUid: function (uid) {\n    return this.findOne({\n      uid: uid\n    }).sort({\n      created: -1\n    });\n  }\n};\nconst SignRecord = mongoose.model('sign_record', SignRecordSchema);\nmodule.exports = SignRecord;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNpZ25SZWNvcmQuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiU2lnblJlY29yZFNjaGVtYSIsInVpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJjcmVhdGVkIiwiRGF0ZSIsImZhdnMiLCJOdW1iZXIiLCJsYXN0U2lnbiIsInByZSIsIm5leHQiLCJmb3JtYXQiLCJzdGF0aWNzIiwiZmluZEJ5VWlkIiwiZmluZE9uZSIsInNvcnQiLCJTaWduUmVjb3JkIiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFELENBQXhCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLE9BQUQsQ0FBdEI7O0FBRUEsTUFBTUUsTUFBTSxHQUFHSCxRQUFRLENBQUNHLE1BQXhCO0FBRUEsTUFBTUMsZ0JBQWdCLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQ2hDRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEMkI7QUFFaENDLEVBQUFBLE9BQU8sRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVJO0FBQVIsR0FGdUI7QUFHaENDLEVBQUFBLElBQUksRUFBRTtBQUFFTCxJQUFBQSxJQUFJLEVBQUVNO0FBQVIsR0FIMEI7QUFJaENDLEVBQUFBLFFBQVEsRUFBRTtBQUFFUCxJQUFBQSxJQUFJLEVBQUVJO0FBQVI7QUFKc0IsQ0FBWCxDQUF6QjtBQU9BTixnQkFBZ0IsQ0FBQ1UsR0FBakIsQ0FBcUIsTUFBckIsRUFBNkIsVUFBVUMsSUFBVixFQUFnQjtBQUN6QyxPQUFLTixPQUFMLEdBQWVQLE1BQU0sR0FBR2MsTUFBVCxDQUFnQixxQkFBaEIsQ0FBZjtBQUNBRCxFQUFBQSxJQUFJO0FBQ1AsQ0FIRDtBQUtBWCxnQkFBZ0IsQ0FBQ2EsT0FBakIsR0FBMkI7QUFDdkJDLEVBQUFBLFNBQVMsRUFBRSxVQUFVYixHQUFWLEVBQWU7QUFDdEIsV0FBTyxLQUFLYyxPQUFMLENBQWE7QUFBQ2QsTUFBQUEsR0FBRyxFQUFDQTtBQUFMLEtBQWIsRUFBd0JlLElBQXhCLENBQTZCO0FBQUNYLE1BQUFBLE9BQU8sRUFBQyxDQUFDO0FBQVYsS0FBN0IsQ0FBUDtBQUNIO0FBSHNCLENBQTNCO0FBTUEsTUFBTVksVUFBVSxHQUFHckIsUUFBUSxDQUFDc0IsS0FBVCxDQUFlLGFBQWYsRUFBOEJsQixnQkFBOUIsQ0FBbkI7QUFFQW1CLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlSCxVQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjL21vZGVsIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCcuLi9jb25maWcvREJIZWxwZXInKVxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWFcblxuY29uc3QgU2lnblJlY29yZFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHVpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3VzZXJzJyB9LFxuICAgIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIGZhdnM6IHsgdHlwZTogTnVtYmVyIH0sXG4gICAgbGFzdFNpZ246IHsgdHlwZTogRGF0ZSB9XG59KVxuXG5TaWduUmVjb3JkU2NoZW1hLnByZSgnc2F2ZScsIGZ1bmN0aW9uIChuZXh0KSB7XG4gICAgdGhpcy5jcmVhdGVkID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICBuZXh0KClcbn0pXG5cblNpZ25SZWNvcmRTY2hlbWEuc3RhdGljcyA9IHtcbiAgICBmaW5kQnlVaWQ6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZE9uZSh7dWlkOnVpZH0pLnNvcnQoe2NyZWF0ZWQ6LTF9KVxuICAgIH1cbn1cblxuY29uc3QgU2lnblJlY29yZCA9IG1vbmdvb3NlLm1vZGVsKCdzaWduX3JlY29yZCcsIFNpZ25SZWNvcmRTY2hlbWEpXG5cbm1vZHVsZS5leHBvcnRzPVNpZ25SZWNvcmQiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "SignRecord.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "SignRecordSchema",
        "uid",
        "type",
        "String",
        "ref",
        "created",
        "Date",
        "favs",
        "Number",
        "lastSign",
        "pre",
        "next",
        "format",
        "statics",
        "findByUid",
        "findOne",
        "sort",
        "SignRecord",
        "model",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,OAAD,CAAtB;;AAEA,MAAME,MAAM,GAAGH,QAAQ,CAACG,MAAxB;AAEA,MAAMC,gBAAgB,GAAG,IAAID,MAAJ,CAAW;AAChCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GAD2B;AAEhCC,EAAAA,OAAO,EAAE;AAAEH,IAAAA,IAAI,EAAEI;AAAR,GAFuB;AAGhCC,EAAAA,IAAI,EAAE;AAAEL,IAAAA,IAAI,EAAEM;AAAR,GAH0B;AAIhCC,EAAAA,QAAQ,EAAE;AAAEP,IAAAA,IAAI,EAAEI;AAAR;AAJsB,CAAX,CAAzB;AAOAN,gBAAgB,CAACU,GAAjB,CAAqB,MAArB,EAA6B,UAAUC,IAAV,EAAgB;AACzC,OAAKN,OAAL,GAAeP,MAAM,GAAGc,MAAT,CAAgB,qBAAhB,CAAf;AACAD,EAAAA,IAAI;AACP,CAHD;AAKAX,gBAAgB,CAACa,OAAjB,GAA2B;AACvBC,EAAAA,SAAS,EAAE,UAAUb,GAAV,EAAe;AACtB,WAAO,KAAKc,OAAL,CAAa;AAACd,MAAAA,GAAG,EAACA;AAAL,KAAb,EAAwBe,IAAxB,CAA6B;AAACX,MAAAA,OAAO,EAAC,CAAC;AAAV,KAA7B,CAAP;AACH;AAHsB,CAA3B;AAMA,MAAMY,UAAU,GAAGrB,QAAQ,CAACsB,KAAT,CAAe,aAAf,EAA8BlB,gBAA9B,CAAnB;AAEAmB,MAAM,CAACC,OAAP,GAAeH,UAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\n\nconst Schema = mongoose.Schema\n\nconst SignRecordSchema = new Schema({\n    uid: { type: String, ref: 'users' },\n    created: { type: Date },\n    favs: { type: Number },\n    lastSign: { type: Date }\n})\n\nSignRecordSchema.pre('save', function (next) {\n    this.created = moment().format('YYYY-MM-DD HH:mm:ss')\n    next()\n})\n\nSignRecordSchema.statics = {\n    findByUid: function (uid) {\n        return this.findOne({uid:uid}).sort({created:-1})\n    }\n}\n\nconst SignRecord = mongoose.model('sign_record', SignRecordSchema)\n\nmodule.exports=SignRecord"
      ]
    },
    "sourceType": "script",
    "mtime": 1584200712828
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/MailConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/MailConfig.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/MailConfig.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/MailConfig.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "MailConfig.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst nodemailer = require('nodemailer');\n\nconst config = require('./index');\n\nconst qs = require('qs'); // async..await is not allowed in global scope, must use a wrapper\n\n\nasync function send(sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount()\n  // create reusable transporter object using the default SMTP transport\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.163.com',\n    port: 465,\n    secure: true,\n    // true for 465, false for other ports\n    auth: {\n      user: 'leedawnm@163.com',\n      // generated ethereal user\n      pass: '93thing51' // generated ethereal password\n\n    }\n  }); // let sendInfo = {\n  //   code: '1234',\n  //   expire: '2019-10-01',\n  //   email: 'imoocbrian@qq.com',\n  //   user: 'Brian',\n  // }\n\n  const baseUrl = config.baseUrl;\n  const route = sendInfo.type === 'email' ? '/confirm' : '/reset';\n  const url = `${baseUrl}/#${route}?` + qs.stringify(sendInfo.data); // send mail with defined transport object\n\n  const info = await transporter.sendMail({\n    from: '\"认证邮件\" <leedawnm@163.com>',\n    // sender address\n    to: sendInfo.email,\n    // list of receivers\n    subject: sendInfo.user !== '' && sendInfo.type !== 'email' ? `你好开发者，${sendInfo.user}！《慕课网前端全栈实践》注册码` : '论坛系统密码确认修改链接',\n    // Subject line\n    text: `您在《慕课网前端全栈实践》课程中注册，您的邀请码是${sendInfo.code},邀请码的过期时间: ${sendInfo.expire}`,\n    // plain text body\n    html: `\n  \n        <div style=\"border: 1px solid #dcdcdc;color: #676767;width: 600px; margin: 0 auto; padding-bottom: 50px;position: relative;\">\n        <div style=\"height: 60px; background: #393d49; line-height: 60px; color: #58a36f; font-size: 18px;padding-left: 10px;\">Imooc社区——欢迎来到官方社区</div>\n        <div style=\"padding: 25px\">\n          <div>您好，${sendInfo.user}童鞋，重置链接有效时间30分钟，请在${sendInfo.expire}之前${sendInfo.code ? '重置您的密码' : '修改您的邮箱为：' + sendInfo.data.username}：</div>\n          <a href=\"${url}\" style=\"padding: 10px 20px; color: #fff; background: #009e94; display: inline-block;margin: 15px 0;\">${sendInfo.code ? '立即重置密码' : '确认设置邮箱'}</a>\n          <div style=\"padding: 5px; background: #f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定。</div>\n        </div>\n        <div style=\"background: #fafafa; color: #b4b4b4;text-align: center; line-height: 45px; height: 45px; position: absolute; left: 0; bottom: 0;width: 100%;\">系统邮件，请勿直接回复</div>\n    </div>\n    ` // html body\n\n  });\n  return `Message sent: %s, ${info.messageId}`; // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n  // Preview only available when sending through an Ethereal account\n  // console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n} // main().catch(console.error)\n\n\nmodule.exports = send;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1haWxDb25maWcuanMiXSwibmFtZXMiOlsibm9kZW1haWxlciIsInJlcXVpcmUiLCJjb25maWciLCJxcyIsInNlbmQiLCJzZW5kSW5mbyIsInRyYW5zcG9ydGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwidXNlciIsInBhc3MiLCJiYXNlVXJsIiwicm91dGUiLCJ0eXBlIiwidXJsIiwic3RyaW5naWZ5IiwiZGF0YSIsImluZm8iLCJzZW5kTWFpbCIsImZyb20iLCJ0byIsImVtYWlsIiwic3ViamVjdCIsInRleHQiLCJjb2RlIiwiZXhwaXJlIiwiaHRtbCIsInVzZXJuYW1lIiwibWVzc2FnZUlkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxVQUFVLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXhCOztBQUNBLE1BQU1DLE1BQU0sR0FBQ0QsT0FBTyxDQUFDLFNBQUQsQ0FBcEI7O0FBQ0EsTUFBTUUsRUFBRSxHQUFDRixPQUFPLENBQUMsSUFBRCxDQUFoQixDLENBRUE7OztBQUNBLGVBQWVHLElBQWYsQ0FBcUJDLFFBQXJCLEVBQStCO0FBQzdCO0FBQ0E7QUFDQTtBQUVBO0FBQ0EsUUFBTUMsV0FBVyxHQUFHTixVQUFVLENBQUNPLGVBQVgsQ0FBMkI7QUFDN0NDLElBQUFBLElBQUksRUFBRSxjQUR1QztBQUU3Q0MsSUFBQUEsSUFBSSxFQUFFLEdBRnVDO0FBRzdDQyxJQUFBQSxNQUFNLEVBQUUsSUFIcUM7QUFHL0I7QUFDZEMsSUFBQUEsSUFBSSxFQUFFO0FBQ0pDLE1BQUFBLElBQUksRUFBRSxrQkFERjtBQUNzQjtBQUMxQkMsTUFBQUEsSUFBSSxFQUFFLFdBRkYsQ0FFYzs7QUFGZDtBQUp1QyxHQUEzQixDQUFwQixDQU42QixDQWdCN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFFBQU1DLE9BQU8sR0FBR1osTUFBTSxDQUFDWSxPQUF2QjtBQUNBLFFBQU1DLEtBQUssR0FBR1YsUUFBUSxDQUFDVyxJQUFULEtBQWtCLE9BQWxCLEdBQTRCLFVBQTVCLEdBQXlDLFFBQXZEO0FBQ0EsUUFBTUMsR0FBRyxHQUFJLEdBQUVILE9BQVEsS0FBSUMsS0FBTSxHQUFyQixHQUEwQlosRUFBRSxDQUFDZSxTQUFILENBQWFiLFFBQVEsQ0FBQ2MsSUFBdEIsQ0FBdEMsQ0F4QjZCLENBMEI3Qjs7QUFDQSxRQUFNQyxJQUFJLEdBQUcsTUFBTWQsV0FBVyxDQUFDZSxRQUFaLENBQXFCO0FBQ3RDQyxJQUFBQSxJQUFJLEVBQUUsMkJBRGdDO0FBQ0g7QUFDbkNDLElBQUFBLEVBQUUsRUFBRWxCLFFBQVEsQ0FBQ21CLEtBRnlCO0FBRWxCO0FBQ3BCQyxJQUFBQSxPQUFPLEVBQ0xwQixRQUFRLENBQUNPLElBQVQsS0FBa0IsRUFBbEIsSUFBd0JQLFFBQVEsQ0FBQ1csSUFBVCxLQUFpQixPQUF6QyxHQUNLLFNBQVFYLFFBQVEsQ0FBQ08sSUFBSyxpQkFEM0IsR0FFSSxjQU5nQztBQU1oQjtBQUN0QmMsSUFBQUEsSUFBSSxFQUFHLDRCQUNMckIsUUFBUSxDQUFDc0IsSUFDUixjQUFhdEIsUUFBUSxDQUFDdUIsTUFBTyxFQVRNO0FBU0g7QUFDbkNDLElBQUFBLElBQUksRUFBRzs7Ozs7b0JBS1N4QixRQUFRLENBQUNPLElBQUsscUJBQzVCUCxRQUFRLENBQUN1QixNQUNSLEtBQUl2QixRQUFRLENBQUNzQixJQUFULEdBQWdCLFFBQWhCLEdBQTJCLGFBQWF0QixRQUFRLENBQUNjLElBQVQsQ0FBY1csUUFBUztxQkFDckRiLEdBQUkseUdBQXdHWixRQUFRLENBQUNzQixJQUFULEdBQWdCLFFBQWhCLEdBQTJCLFFBQVM7Ozs7O0tBbEIzSCxDQXVCcEM7O0FBdkJvQyxHQUFyQixDQUFuQjtBQTBCQSxTQUFRLHFCQUFvQlAsSUFBSSxDQUFDVyxTQUFVLEVBQTNDLENBckQ2QixDQXNEN0I7QUFFQTtBQUNBO0FBQ0E7QUFDRCxDLENBRUQ7OztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBZ0I3QixJQUFoQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBub2RlbWFpbGVyPXJlcXVpcmUoJ25vZGVtYWlsZXInKVxuY29uc3QgY29uZmlnPXJlcXVpcmUoJy4vaW5kZXgnKVxuY29uc3QgcXM9cmVxdWlyZSgncXMnKVxuXG4vLyBhc3luYy4uYXdhaXQgaXMgbm90IGFsbG93ZWQgaW4gZ2xvYmFsIHNjb3BlLCBtdXN0IHVzZSBhIHdyYXBwZXJcbmFzeW5jIGZ1bmN0aW9uIHNlbmQgKHNlbmRJbmZvKSB7XG4gIC8vIEdlbmVyYXRlIHRlc3QgU01UUCBzZXJ2aWNlIGFjY291bnQgZnJvbSBldGhlcmVhbC5lbWFpbFxuICAvLyBPbmx5IG5lZWRlZCBpZiB5b3UgZG9uJ3QgaGF2ZSBhIHJlYWwgbWFpbCBhY2NvdW50IGZvciB0ZXN0aW5nXG4gIC8vIGxldCB0ZXN0QWNjb3VudCA9IGF3YWl0IG5vZGVtYWlsZXIuY3JlYXRlVGVzdEFjY291bnQoKVxuXG4gIC8vIGNyZWF0ZSByZXVzYWJsZSB0cmFuc3BvcnRlciBvYmplY3QgdXNpbmcgdGhlIGRlZmF1bHQgU01UUCB0cmFuc3BvcnRcbiAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgaG9zdDogJ3NtdHAuMTYzLmNvbScsXG4gICAgcG9ydDogNDY1LFxuICAgIHNlY3VyZTogdHJ1ZSwgLy8gdHJ1ZSBmb3IgNDY1LCBmYWxzZSBmb3Igb3RoZXIgcG9ydHNcbiAgICBhdXRoOiB7XG4gICAgICB1c2VyOiAnbGVlZGF3bm1AMTYzLmNvbScsIC8vIGdlbmVyYXRlZCBldGhlcmVhbCB1c2VyXG4gICAgICBwYXNzOiAnOTN0aGluZzUxJyAvLyBnZW5lcmF0ZWQgZXRoZXJlYWwgcGFzc3dvcmRcbiAgICB9XG4gIH0pXG5cbiAgLy8gbGV0IHNlbmRJbmZvID0ge1xuICAvLyAgIGNvZGU6ICcxMjM0JyxcbiAgLy8gICBleHBpcmU6ICcyMDE5LTEwLTAxJyxcbiAgLy8gICBlbWFpbDogJ2ltb29jYnJpYW5AcXEuY29tJyxcbiAgLy8gICB1c2VyOiAnQnJpYW4nLFxuICAvLyB9XG4gIGNvbnN0IGJhc2VVcmwgPSBjb25maWcuYmFzZVVybFxuICBjb25zdCByb3V0ZSA9IHNlbmRJbmZvLnR5cGUgPT09ICdlbWFpbCcgPyAnL2NvbmZpcm0nIDogJy9yZXNldCdcbiAgY29uc3QgdXJsID0gYCR7YmFzZVVybH0vIyR7cm91dGV9P2AgKyBxcy5zdHJpbmdpZnkoc2VuZEluZm8uZGF0YSlcblxuICAvLyBzZW5kIG1haWwgd2l0aCBkZWZpbmVkIHRyYW5zcG9ydCBvYmplY3RcbiAgY29uc3QgaW5mbyA9IGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKHtcbiAgICBmcm9tOiAnXCLorqTor4Hpgq7ku7ZcIiA8bGVlZGF3bm1AMTYzLmNvbT4nLCAvLyBzZW5kZXIgYWRkcmVzc1xuICAgIHRvOiBzZW5kSW5mby5lbWFpbCwgLy8gbGlzdCBvZiByZWNlaXZlcnNcbiAgICBzdWJqZWN0OlxuICAgICAgc2VuZEluZm8udXNlciAhPT0gJycgJiYgc2VuZEluZm8udHlwZSAhPT0nZW1haWwnXG4gICAgICAgID8gYOS9oOWlveW8gOWPkeiAhe+8jCR7c2VuZEluZm8udXNlcn3vvIHjgIrmhZXor77nvZHliY3nq6/lhajmoIjlrp7ot7XjgIvms6jlhoznoIFgXG4gICAgICAgIDogJ+iuuuWdm+ezu+e7n+WvhueggeehruiupOS/ruaUuemTvuaOpScsIC8vIFN1YmplY3QgbGluZVxuICAgIHRleHQ6IGDmgqjlnKjjgIrmhZXor77nvZHliY3nq6/lhajmoIjlrp7ot7XjgIvor77nqIvkuK3ms6jlhozvvIzmgqjnmoTpgoDor7fnoIHmmK8ke1xuICAgICAgc2VuZEluZm8uY29kZVxuICAgICAgfSzpgoDor7fnoIHnmoTov4fmnJ/ml7bpl7Q6ICR7c2VuZEluZm8uZXhwaXJlfWAsIC8vIHBsYWluIHRleHQgYm9keVxuICAgIGh0bWw6IGBcbiAgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJib3JkZXI6IDFweCBzb2xpZCAjZGNkY2RjO2NvbG9yOiAjNjc2NzY3O3dpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmctYm90dG9tOiA1MHB4O3Bvc2l0aW9uOiByZWxhdGl2ZTtcIj5cbiAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogNjBweDsgYmFja2dyb3VuZDogIzM5M2Q0OTsgbGluZS1oZWlnaHQ6IDYwcHg7IGNvbG9yOiAjNThhMzZmOyBmb250LXNpemU6IDE4cHg7cGFkZGluZy1sZWZ0OiAxMHB4O1wiPkltb29j56S+5Yy64oCU4oCU5qyi6L+O5p2l5Yiw5a6Y5pa556S+5Yy6PC9kaXY+XG4gICAgICAgIDxkaXYgc3R5bGU9XCJwYWRkaW5nOiAyNXB4XCI+XG4gICAgICAgICAgPGRpdj7mgqjlpb3vvIwke3NlbmRJbmZvLnVzZXJ956ul6Z6L77yM6YeN572u6ZO+5o6l5pyJ5pWI5pe26Ze0MzDliIbpkp/vvIzor7flnKgke1xuICAgICAgc2VuZEluZm8uZXhwaXJlXG4gICAgICB95LmL5YmNJHtzZW5kSW5mby5jb2RlID8gJ+mHjee9ruaCqOeahOWvhueggScgOiAn5L+u5pS55oKo55qE6YKu566x5Li677yaJyArIHNlbmRJbmZvLmRhdGEudXNlcm5hbWV977yaPC9kaXY+XG4gICAgICAgICAgPGEgaHJlZj1cIiR7dXJsfVwiIHN0eWxlPVwicGFkZGluZzogMTBweCAyMHB4OyBjb2xvcjogI2ZmZjsgYmFja2dyb3VuZDogIzAwOWU5NDsgZGlzcGxheTogaW5saW5lLWJsb2NrO21hcmdpbjogMTVweCAwO1wiPiR7c2VuZEluZm8uY29kZSA/ICfnq4vljbPph43nva7lr4bnoIEnIDogJ+ehruiupOiuvue9rumCrueusSd9PC9hPlxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJwYWRkaW5nOiA1cHg7IGJhY2tncm91bmQ6ICNmMmYyZjI7XCI+5aaC5p6c6K+l6YKu5Lu25LiN5piv55Sx5L2g5pys5Lq65pON5L2c77yM6K+35Yu/6L+b6KGM5r+A5rS777yB5ZCm5YiZ5L2g55qE6YKu566x5bCG5Lya6KKr5LuW5Lq657uR5a6a44CCPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogI2ZhZmFmYTsgY29sb3I6ICNiNGI0YjQ7dGV4dC1hbGlnbjogY2VudGVyOyBsaW5lLWhlaWdodDogNDVweDsgaGVpZ2h0OiA0NXB4OyBwb3NpdGlvbjogYWJzb2x1dGU7IGxlZnQ6IDA7IGJvdHRvbTogMDt3aWR0aDogMTAwJTtcIj7ns7vnu5/pgq7ku7bvvIzor7fli7/nm7TmjqXlm57lpI08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICBgIC8vIGh0bWwgYm9keVxuICB9KVxuXG4gIHJldHVybiBgTWVzc2FnZSBzZW50OiAlcywgJHtpbmZvLm1lc3NhZ2VJZH1gXG4gIC8vIE1lc3NhZ2Ugc2VudDogPGI2NThmOGNhLTYyOTYtY2NmNC04MzA2LTg3ZDU3YTBiNDMyMUBleGFtcGxlLmNvbT5cblxuICAvLyBQcmV2aWV3IG9ubHkgYXZhaWxhYmxlIHdoZW4gc2VuZGluZyB0aHJvdWdoIGFuIEV0aGVyZWFsIGFjY291bnRcbiAgLy8gY29uc29sZS5sb2coJ1ByZXZpZXcgVVJMOiAlcycsIG5vZGVtYWlsZXIuZ2V0VGVzdE1lc3NhZ2VVcmwoaW5mbykpXG4gIC8vIFByZXZpZXcgVVJMOiBodHRwczovL2V0aGVyZWFsLmVtYWlsL21lc3NhZ2UvV2FRS01nS2RkeFFEb291Li4uXG59XG5cbi8vIG1haW4oKS5jYXRjaChjb25zb2xlLmVycm9yKVxuXG5tb2R1bGUuZXhwb3J0cz0gc2VuZFxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "MailConfig.js"
      ],
      "names": [
        "nodemailer",
        "require",
        "config",
        "qs",
        "send",
        "sendInfo",
        "transporter",
        "createTransport",
        "host",
        "port",
        "secure",
        "auth",
        "user",
        "pass",
        "baseUrl",
        "route",
        "type",
        "url",
        "stringify",
        "data",
        "info",
        "sendMail",
        "from",
        "to",
        "email",
        "subject",
        "text",
        "code",
        "expire",
        "html",
        "username",
        "messageId",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,UAAU,GAACC,OAAO,CAAC,YAAD,CAAxB;;AACA,MAAMC,MAAM,GAACD,OAAO,CAAC,SAAD,CAApB;;AACA,MAAME,EAAE,GAACF,OAAO,CAAC,IAAD,CAAhB,C,CAEA;;;AACA,eAAeG,IAAf,CAAqBC,QAArB,EAA+B;AAC7B;AACA;AACA;AAEA;AACA,QAAMC,WAAW,GAAGN,UAAU,CAACO,eAAX,CAA2B;AAC7CC,IAAAA,IAAI,EAAE,cADuC;AAE7CC,IAAAA,IAAI,EAAE,GAFuC;AAG7CC,IAAAA,MAAM,EAAE,IAHqC;AAG/B;AACdC,IAAAA,IAAI,EAAE;AACJC,MAAAA,IAAI,EAAE,kBADF;AACsB;AAC1BC,MAAAA,IAAI,EAAE,WAFF,CAEc;;AAFd;AAJuC,GAA3B,CAApB,CAN6B,CAgB7B;AACA;AACA;AACA;AACA;AACA;;AACA,QAAMC,OAAO,GAAGZ,MAAM,CAACY,OAAvB;AACA,QAAMC,KAAK,GAAGV,QAAQ,CAACW,IAAT,KAAkB,OAAlB,GAA4B,UAA5B,GAAyC,QAAvD;AACA,QAAMC,GAAG,GAAI,GAAEH,OAAQ,KAAIC,KAAM,GAArB,GAA0BZ,EAAE,CAACe,SAAH,CAAab,QAAQ,CAACc,IAAtB,CAAtC,CAxB6B,CA0B7B;;AACA,QAAMC,IAAI,GAAG,MAAMd,WAAW,CAACe,QAAZ,CAAqB;AACtCC,IAAAA,IAAI,EAAE,2BADgC;AACH;AACnCC,IAAAA,EAAE,EAAElB,QAAQ,CAACmB,KAFyB;AAElB;AACpBC,IAAAA,OAAO,EACLpB,QAAQ,CAACO,IAAT,KAAkB,EAAlB,IAAwBP,QAAQ,CAACW,IAAT,KAAiB,OAAzC,GACK,SAAQX,QAAQ,CAACO,IAAK,iBAD3B,GAEI,cANgC;AAMhB;AACtBc,IAAAA,IAAI,EAAG,4BACLrB,QAAQ,CAACsB,IACR,cAAatB,QAAQ,CAACuB,MAAO,EATM;AASH;AACnCC,IAAAA,IAAI,EAAG;;;;;oBAKSxB,QAAQ,CAACO,IAAK,qBAC5BP,QAAQ,CAACuB,MACR,KAAIvB,QAAQ,CAACsB,IAAT,GAAgB,QAAhB,GAA2B,aAAatB,QAAQ,CAACc,IAAT,CAAcW,QAAS;qBACrDb,GAAI,yGAAwGZ,QAAQ,CAACsB,IAAT,GAAgB,QAAhB,GAA2B,QAAS;;;;;KAlB3H,CAuBpC;;AAvBoC,GAArB,CAAnB;AA0BA,SAAQ,qBAAoBP,IAAI,CAACW,SAAU,EAA3C,CArD6B,CAsD7B;AAEA;AACA;AACA;AACD,C,CAED;;;AAEAC,MAAM,CAACC,OAAP,GAAgB7B,IAAhB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "const nodemailer=require('nodemailer')\nconst config=require('./index')\nconst qs=require('qs')\n\n// async..await is not allowed in global scope, must use a wrapper\nasync function send (sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount()\n\n  // create reusable transporter object using the default SMTP transport\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.163.com',\n    port: 465,\n    secure: true, // true for 465, false for other ports\n    auth: {\n      user: 'leedawnm@163.com', // generated ethereal user\n      pass: '93thing51' // generated ethereal password\n    }\n  })\n\n  // let sendInfo = {\n  //   code: '1234',\n  //   expire: '2019-10-01',\n  //   email: 'imoocbrian@qq.com',\n  //   user: 'Brian',\n  // }\n  const baseUrl = config.baseUrl\n  const route = sendInfo.type === 'email' ? '/confirm' : '/reset'\n  const url = `${baseUrl}/#${route}?` + qs.stringify(sendInfo.data)\n\n  // send mail with defined transport object\n  const info = await transporter.sendMail({\n    from: '\"认证邮件\" <leedawnm@163.com>', // sender address\n    to: sendInfo.email, // list of receivers\n    subject:\n      sendInfo.user !== '' && sendInfo.type !=='email'\n        ? `你好开发者，${sendInfo.user}！《慕课网前端全栈实践》注册码`\n        : '论坛系统密码确认修改链接', // Subject line\n    text: `您在《慕课网前端全栈实践》课程中注册，您的邀请码是${\n      sendInfo.code\n      },邀请码的过期时间: ${sendInfo.expire}`, // plain text body\n    html: `\n  \n        <div style=\"border: 1px solid #dcdcdc;color: #676767;width: 600px; margin: 0 auto; padding-bottom: 50px;position: relative;\">\n        <div style=\"height: 60px; background: #393d49; line-height: 60px; color: #58a36f; font-size: 18px;padding-left: 10px;\">Imooc社区——欢迎来到官方社区</div>\n        <div style=\"padding: 25px\">\n          <div>您好，${sendInfo.user}童鞋，重置链接有效时间30分钟，请在${\n      sendInfo.expire\n      }之前${sendInfo.code ? '重置您的密码' : '修改您的邮箱为：' + sendInfo.data.username}：</div>\n          <a href=\"${url}\" style=\"padding: 10px 20px; color: #fff; background: #009e94; display: inline-block;margin: 15px 0;\">${sendInfo.code ? '立即重置密码' : '确认设置邮箱'}</a>\n          <div style=\"padding: 5px; background: #f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定。</div>\n        </div>\n        <div style=\"background: #fafafa; color: #b4b4b4;text-align: center; line-height: 45px; height: 45px; position: absolute; left: 0; bottom: 0;width: 100%;\">系统邮件，请勿直接回复</div>\n    </div>\n    ` // html body\n  })\n\n  return `Message sent: %s, ${info.messageId}`\n  // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n\n  // Preview only available when sending through an Ethereal account\n  // console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n}\n\n// main().catch(console.error)\n\nmodule.exports= send\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1585366695740
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/loginRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/loginRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/loginRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/loginRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "loginRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst loginController = require('../../api/LoginController');\n\nconst router = new Router();\nrouter.prefix('/login'); // router.post('/forget',loginController.forget)\n\nrouter.post('/login', loginController.login);\nrouter.post('/reg', loginController.reg);\nrouter.post('/forget', loginController.forget);\nrouter.post('/reset', loginController.reset);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luUm91dGVyLmpzIl0sIm5hbWVzIjpbIlJvdXRlciIsInJlcXVpcmUiLCJsb2dpbkNvbnRyb2xsZXIiLCJyb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibG9naW4iLCJyZWciLCJmb3JnZXQiLCJyZXNldCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsTUFBTSxHQUFDQyxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxlQUFlLEdBQUNELE9BQU8sQ0FBQywyQkFBRCxDQUE3Qjs7QUFFQSxNQUFNRSxNQUFNLEdBQUMsSUFBSUgsTUFBSixFQUFiO0FBRUFHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFFBQWQsRSxDQUNBOztBQUNBRCxNQUFNLENBQUNFLElBQVAsQ0FBWSxRQUFaLEVBQXFCSCxlQUFlLENBQUNJLEtBQXJDO0FBQ0FILE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLE1BQVosRUFBbUJILGVBQWUsQ0FBQ0ssR0FBbkM7QUFDQUosTUFBTSxDQUFDRSxJQUFQLENBQVksU0FBWixFQUFzQkgsZUFBZSxDQUFDTSxNQUF0QztBQUNBTCxNQUFNLENBQUNFLElBQVAsQ0FBWSxRQUFaLEVBQXFCSCxlQUFlLENBQUNPLEtBQXJDO0FBRUFDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFnQlIsTUFBaEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvcm91dGVzL21vZHVsZXMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBSb3V0ZXI9cmVxdWlyZSgna29hLXJvdXRlcicpXG5jb25zdCBsb2dpbkNvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL0xvZ2luQ29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcblxucm91dGVyLnByZWZpeCgnL2xvZ2luJylcbi8vIHJvdXRlci5wb3N0KCcvZm9yZ2V0Jyxsb2dpbkNvbnRyb2xsZXIuZm9yZ2V0KVxucm91dGVyLnBvc3QoJy9sb2dpbicsbG9naW5Db250cm9sbGVyLmxvZ2luKVxucm91dGVyLnBvc3QoJy9yZWcnLGxvZ2luQ29udHJvbGxlci5yZWcpXG5yb3V0ZXIucG9zdCgnL2ZvcmdldCcsbG9naW5Db250cm9sbGVyLmZvcmdldClcbnJvdXRlci5wb3N0KCcvcmVzZXQnLGxvZ2luQ29udHJvbGxlci5yZXNldClcblxubW9kdWxlLmV4cG9ydHM9IHJvdXRlciJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "loginRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "loginController",
        "router",
        "prefix",
        "post",
        "login",
        "reg",
        "forget",
        "reset",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,eAAe,GAACD,OAAO,CAAC,2BAAD,CAA7B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AAEAG,MAAM,CAACC,MAAP,CAAc,QAAd,E,CACA;;AACAD,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,eAAe,CAACI,KAArC;AACAH,MAAM,CAACE,IAAP,CAAY,MAAZ,EAAmBH,eAAe,CAACK,GAAnC;AACAJ,MAAM,CAACE,IAAP,CAAY,SAAZ,EAAsBH,eAAe,CAACM,MAAtC;AACAL,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,eAAe,CAACO,KAArC;AAEAC,MAAM,CAACC,OAAP,GAAgBR,MAAhB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst loginController=require('../../api/LoginController')\n\nconst router=new Router()\n\nrouter.prefix('/login')\n// router.post('/forget',loginController.forget)\nrouter.post('/login',loginController.login)\nrouter.post('/reg',loginController.reg)\nrouter.post('/forget',loginController.forget)\nrouter.post('/reset',loginController.reset)\n\nmodule.exports= router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585404263267
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/LoginController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/LoginController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/LoginController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/LoginController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "LoginController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst send = require('../config/MailConfig.js');\n\nconst bcrypt = require('bcrypt');\n\nconst moment = require('dayjs');\n\nconst jsonwebtoken = require('jsonwebtoken');\n\nconst config = require('../config/index'); // const checkCode=require('../common/Utils')\n\n\nconst Utils = require('../common/Utils');\n\nconst User = require('../model/User');\n\nconst forget = function (ctx) {\n  const {\n    body\n  } = ctx.request;\n\n  if (typeof body.username !== 'undefined') {\n    try {\n      let result = send({\n        code: '1234',\n        expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n        email: body.username,\n        user: 'echo'\n      });\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: '邮件发送成功'\n      };\n    } catch (e) {\n      console.log(e);\n    }\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '服务器异常'\n    };\n  }\n};\n\nasync function login(ctx) {\n  const {\n    body\n  } = ctx.request;\n  let sid = body.sid;\n  let code = body.code;\n  let result = await Utils.checkCode(sid, code);\n  console.log(result);\n\n  if (result) {\n    let checkUserPasswd = false;\n    let user = await User.findOne({\n      username: body.username\n    });\n\n    if (await bcrypt.compare(body.password, user.password)) {\n      checkUserPasswd = true;\n    }\n\n    if (checkUserPasswd) {\n      const userObj = user.toJSON();\n      const arr = ['password']; //和源码有不同，这里没有删除邮箱了。\n\n      arr.map(item => {\n        delete userObj[item];\n      });\n      let token = jsonwebtoken.sign({\n        _id: userObj._id\n      }, config.JWT_SECRET, {\n        expiresIn: '1d'\n      }); //\n\n      ctx.body = {\n        code: 200,\n        data: userObj,\n        token: token\n      };\n    } else {\n      ctx.body = {\n        code: 404,\n        msg: '用户名或密码错误'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 401,\n      msg: '图片验证码不正确，请检查！'\n    };\n  }\n}\n\nasync function reg(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"reg -> body\", body);\n  let sid = body.sid;\n  let code = body.code;\n  let msg = {};\n  let result = await Utils.checkCode(sid, code);\n  console.log(\"result:\" + result);\n  let check = true;\n\n  if (result) {\n    let user1 = await User.findOne({\n      username: body.username\n    });\n\n    if (user1 !== null && typeof user1.username !== 'undefined') {\n      console.log(\"user1\" + user1);\n      msg.username = ['此邮箱已经被注册，可以通过邮箱找回密码'];\n      check = false;\n    }\n\n    check = true;\n    let user2 = await User.findOne({\n      name: body.name\n    });\n\n    if (user2 !== null && typeof user2.name !== 'undefined') {\n      msg.name = ['此昵称已经被注册，请修改'];\n      check = false;\n    }\n\n    if (check) {\n      body.password = await bcrypt.hash(body.password, 5);\n      let user = new User({\n        username: body.username,\n        name: body.name,\n        password: body.password,\n        created: moment().format('YYYY-MM-DD HH:mm:ss')\n      });\n      let result = await user.save();\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: '注册成功'\n      };\n      return;\n    }\n  } else {\n    msg.code = ['验证码已经失效，请重新获取！'];\n  }\n\n  ctx.body = {\n    code: 500,\n    msg: msg\n  };\n}\n\nasync function reset(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"reset -> body\", body, body.username);\n  let sid = body.sid;\n  let code = body.code;\n  let msg = {};\n  const result = await Utils.checkCode(sid, code);\n\n  if (result) {\n    let user = await User.findOne({\n      username: body.username\n    });\n\n    if (user === null && user.username === 'undefined') {\n      msg.username = ['此邮箱未注册，请确认'];\n      ctx.body = {\n        code: 500,\n        msg: msg\n      };\n    } else {\n      user.password = await bcrypt.hash(body.password, 5);\n      user.updated = moment().format('YYYY-MM-DD HH:mm:ss');\n      let result = await user.save();\n      const userObj = result.toJSON();\n      const arr = ['password'];\n      arr.map(item => {\n        delete userObj[item];\n      });\n      let token = jsonwebtoken.sign({\n        _id: userObj._id\n      }, config.JWT_SECRET, {\n        expiresIn: '1d'\n      }); //\n\n      ctx.body = {\n        code: 200,\n        data: userObj,\n        token: token,\n        msg: '更新密码成功！'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 401,\n      msg: '图片验证码不正确，请检查！'\n    };\n  }\n}\n\nmodule.exports = {\n  forget,\n  login,\n  reg,\n  reset\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxvZ2luQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJzZW5kIiwicmVxdWlyZSIsImJjcnlwdCIsIm1vbWVudCIsImpzb253ZWJ0b2tlbiIsImNvbmZpZyIsIlV0aWxzIiwiVXNlciIsImZvcmdldCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwidXNlcm5hbWUiLCJyZXN1bHQiLCJjb2RlIiwiZXhwaXJlIiwiYWRkIiwiZm9ybWF0IiwiZW1haWwiLCJ1c2VyIiwiZGF0YSIsIm1zZyIsImUiLCJjb25zb2xlIiwibG9nIiwibG9naW4iLCJzaWQiLCJjaGVja0NvZGUiLCJjaGVja1VzZXJQYXNzd2QiLCJmaW5kT25lIiwiY29tcGFyZSIsInBhc3N3b3JkIiwidXNlck9iaiIsInRvSlNPTiIsImFyciIsIm1hcCIsIml0ZW0iLCJ0b2tlbiIsInNpZ24iLCJfaWQiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwicmVnIiwiY2hlY2siLCJ1c2VyMSIsInVzZXIyIiwibmFtZSIsImhhc2giLCJjcmVhdGVkIiwic2F2ZSIsInJlc2V0IiwidXBkYXRlZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMseUJBQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxPQUFELENBQXRCOztBQUNBLE1BQU1HLFlBQVksR0FBR0gsT0FBTyxDQUFDLGNBQUQsQ0FBNUI7O0FBQ0EsTUFBTUksTUFBTSxHQUFHSixPQUFPLENBQUMsaUJBQUQsQ0FBdEIsQyxDQUNBOzs7QUFDQSxNQUFNSyxLQUFLLEdBQUdMLE9BQU8sQ0FBQyxpQkFBRCxDQUFyQjs7QUFDQSxNQUFNTSxJQUFJLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQXBCOztBQUVBLE1BQU1PLE1BQU0sR0FBRyxVQUFVQyxHQUFWLEVBQWU7QUFDMUIsUUFBTTtB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R2MsTUFBVCxDQUFnQixxQkFBaEIsQ0FBYjtBQUNBLFVBQUlKLE1BQU0sR0FBRyxNQUFNTSxJQUFJLENBQUM4QixJQUFMLEVBQW5CO0FBQ0EsWUFBTWpCLE9BQU8sR0FBR25CLE1BQU0sQ0FBQ29CLE1BQVAsRUFBaEI7QUFDQSxZQUFNQyxHQUFHLEdBQUcsQ0FBQyxVQUFELENBQVo7QUFDQUEsTUFBQUEsR0FBRyxDQUFDQyxHQUFKLENBQVNDLElBQUQsSUFBVTtBQUNkLGVBQU9KLE9BQU8sQ0FBQ0ksSUFBRCxDQUFkO0FBQ0gsT0FGRDtBQUdBLFVBQUlDLEtBQUssR0FBR2pDLFlBQVksQ0FBQ2tDLElBQWIsQ0FBa0I7QUFBRUMsUUFBQUEsR0FBRyxFQUFFUCxPQUFPLENBQUNPO0FBQWYsT0FBbEIsRUFBd0NsQyxNQUFNLENBQUNtQyxVQUEvQyxFQUEyRDtBQUFFQyxRQUFBQSxTQUFTLEVBQUU7QUFBYixPQUEzRCxDQUFaLENBVEcsQ0FTeUY7O0FBQzVGaEMsTUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEksUUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUE0sUUFBQUEsSUFBSSxFQUFFWSxPQUZDO0FBR1BLLFFBQUFBLEtBQUssRUFBRUEsS0FIQTtBQUlQaEIsUUFBQUEsR0FBRyxFQUFDO0FBSkcsT0FBWDtBQU1IO0FBQ0osR0F6QkQsTUF5Qk87QUFDSFosSUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEksTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUE8sTUFBQUEsR0FBRyxFQUFFO0FBRkUsS0FBWDtBQUlIO0FBQ0o7O0FBRUQrQixNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRTdDLEVBQUFBLE1BQUY7QUFBVWlCLEVBQUFBLEtBQVY7QUFBaUJpQixFQUFBQSxHQUFqQjtBQUFzQlEsRUFBQUE7QUFBdEIsQ0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvYXBpIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2VuZCA9IHJlcXVpcmUoJy4uL2NvbmZpZy9NYWlsQ29uZmlnLmpzJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCBqc29ud2VidG9rZW4gPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4Jylcbi8vIGNvbnN0IGNoZWNrQ29kZT1yZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXRpbHMgPSByZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXInKVxuXG5jb25zdCBmb3JnZXQgPSBmdW5jdGlvbiAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGlmICh0eXBlb2YgYm9keS51c2VybmFtZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBzZW5kKHtcbiAgICAgICAgICAgICAgICBjb2RlOiAnMTIzNCcsXG4gICAgICAgICAgICAgICAgZXhwaXJlOiBtb21lbnQoKS5hZGQoMzAsICdtaW51dGVzJykuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyksXG4gICAgICAgICAgICAgICAgZW1haWw6IGJvZHkudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgdXNlcjogJ2VjaG8nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgbXNnOiAn6YKu5Lu25Y+R6YCB5oiQ5YqfJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmnI3liqHlmajlvILluLgnXG4gICAgICAgIH1cbiAgICB9XG59XG5hc3luYyBmdW5jdGlvbiBsb2dpbiAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGxldCBzaWQgPSBib2R5LnNpZFxuICAgIGxldCBjb2RlID0gYm9keS5jb2RlXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IFV0aWxzLmNoZWNrQ29kZShzaWQsIGNvZGUpXG4gICAgY29uc29sZS5sb2cocmVzdWx0KVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgbGV0IGNoZWNrVXNlclBhc3N3ZCA9IGZhbHNlXG4gICAgICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWUgfSlcbiAgICAgICAgaWYgKGF3YWl0IGJjcnlwdC5jb21wYXJlKGJvZHkucGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpKSB7XG4gICAgICAgICAgICBjaGVja1VzZXJQYXNzd2QgPSB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoZWNrVXNlclBhc3N3ZCkge1xuICAgICAgICAgICAgY29uc3QgdXNlck9iaiA9IHVzZXIudG9KU09OKClcbiAgICAgICAgICAgIGNvbnN0IGFyciA9IFsncGFzc3dvcmQnXSAvL+WSjOa6kOeggeacieS4jeWQjO+8jOi/memHjOayoeacieWIoOmZpOmCrueuseS6huOAglxuICAgICAgICAgICAgYXJyLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB1c2VyT2JqW2l0ZW1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgbGV0IHRva2VuID0ganNvbndlYnRva2VuLnNpZ24oeyBfaWQ6IHVzZXJPYmouX2lkIH0sIGNvbmZpZy5KV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogJzFkJyB9KSAvL1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogMjAwLFxuICAgICAgICAgICAgICAgIGRhdGE6IHVzZXJPYmosXG4gICAgICAgICAgICAgICAgdG9rZW46IHRva2VuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA0MDQsXG4gICAgICAgICAgICAgICAgbXNnOiAn55So5oi35ZCN5oiW5a+G56CB6ZSZ6K+vJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA0MDEsXG4gICAgICAgICAgICBtc2c6ICflm77niYfpqozor4HnoIHkuI3mraPnoa7vvIzor7fmo4Dmn6XvvIEnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlZyAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwicmVnIC0+IGJvZHlcIiwgYm9keSlcbiAgICBsZXQgc2lkID0gYm9keS5zaWRcbiAgICBsZXQgY29kZSA9IGJvZHkuY29kZVxuICAgIGxldCBtc2cgPSB7fVxuICAgIGxldCByZXN1bHQgPSBhd2FpdCBVdGlscy5jaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGNvbnNvbGUubG9nKFwicmVzdWx0OlwiICsgcmVzdWx0KVxuICAgIGxldCBjaGVjayA9IHRydWVcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGxldCB1c2VyMSA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lOiBib2R5LnVzZXJuYW1lIH0pXG4gICAgICAgIGlmICh1c2VyMSAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjEudXNlcm5hbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIxXCIgKyB1c2VyMSlcbiAgICAgICAgICAgIG1zZy51c2VybmFtZSA9IFsn5q2k6YKu566x5bey57uP6KKr5rOo5YaM77yM5Y+v5Lul6YCa6L+H6YKu566x5om+5Zue5a+G56CBJ11cbiAgICAgICAgICAgIGNoZWNrID0gZmFsc2VcbiAgICAgICAgfVxuICAgICAgICBjaGVjayA9IHRydWVcbiAgICAgICAgbGV0IHVzZXIyID0gYXdhaXQgVXNlci5maW5kT25lKHsgbmFtZTogYm9keS5uYW1lIH0pXG4gICAgICAgIGlmICh1c2VyMiAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjIubmFtZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIG1zZy5uYW1lID0gWyfmraTmmLXnp7Dlt7Lnu4/ooqvms6jlhozvvIzor7fkv67mlLknXVxuICAgICAgICAgICAgY2hlY2sgPSBmYWxzZVxuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgICAgYm9keS5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKGJvZHkucGFzc3dvcmQsIDUpXG4gICAgICAgICAgICBsZXQgdXNlciA9IG5ldyBVc2VyKHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogYm9keS51c2VybmFtZSxcbiAgICAgICAgICAgICAgICBuYW1lOiBib2R5Lm5hbWUsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGJvZHkucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgY3JlYXRlZDogbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdXNlci5zYXZlKClcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgbXNnOiAn5rOo5YaM5oiQ5YqfJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBtc2cuY29kZSA9IFsn6aqM6K+B56CB5bey57uP5aSx5pWI77yM6K+36YeN5paw6I635Y+W77yBJ11cbiAgICB9XG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgbXNnOiBtc2dcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlc2V0IChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJyZXNldCAtPiBib2R5XCIsIGJvZHksIGJvZHkudXNlcm5hbWUpXG4gICAgbGV0IHNpZCA9IGJvZHkuc2lkXG4gICAgbGV0IGNvZGUgPSBib2R5LmNvZGVcbiAgICBsZXQgbXNnID0ge31cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBVdGlscy5jaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogYm9keS51c2VybmFtZSB9KVxuICAgICAgICBpZiAodXNlciA9PT0gbnVsbCAmJiB1c2VyLnVzZXJuYW1lID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgbXNnLnVzZXJuYW1lID0gWyfmraTpgq7nrrHmnKrms6jlhozvvIzor7fnoa7orqQnXVxuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIG1zZzogbXNnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1c2VyLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2goYm9keS5wYXNzd29yZCwgNSlcbiAgICAgICAgICAgIHVzZXIudXBkYXRlZD1tb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKVxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHVzZXIuc2F2ZSgpXG4gICAgICAgICAgICBjb25zdCB1c2VyT2JqID0gcmVzdWx0LnRvSlNPTigpXG4gICAgICAgICAgICBjb25zdCBhcnIgPSBbJ3Bhc3N3b3JkJ10gXG4gICAgICAgICAgICBhcnIubWFwKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHVzZXJPYmpbaXRlbV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBsZXQgdG9rZW4gPSBqc29ud2VidG9rZW4uc2lnbih7IF9pZDogdXNlck9iai5faWQgfSwgY29uZmlnLkpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnMWQnIH0pIC8vXG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICAgICAgZGF0YTogdXNlck9iaixcbiAgICAgICAgICAgICAgICB0b2tlbjogdG9rZW4sXG4gICAgICAgICAgICAgICAgbXNnOifmm7TmlrDlr4bnoIHmiJDlip/vvIEnXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDQwMSxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggeS4jeato+ehru+8jOivt+ajgOafpe+8gSdcbiAgICAgICAgfVxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IGZvcmdldCwgbG9naW4sIHJlZywgcmVzZXQgfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "LoginController.js"
      ],
      "names": [
        "send",
        "require",
        "bcrypt",
        "moment",
        "jsonwebtoken",
        "config",
        "Utils",
        "User",
        "forget",
        "ctx",
        "body",
        "request",
        "username",
        "result",
        "code",
        "expire",
        "add",
        "format",
        "email",
        "user",
        "data",
        "msg",
        "e",
        "console",
        "log",
        "login",
        "sid",
        "checkCode",
        "checkUserPasswd",
        "findOne",
        "compare",
        "password",
        "userObj",
        "toJSON",
        "arr",
        "map",
        "item",
        "token",
        "sign",
        "_id",
        "JWT_SECRET",
        "expiresIn",
        "reg",
        "check",
        "user1",
        "user2",
        "name",
        "hash",
        "created",
        "save",
        "reset",
        "updated",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "const send = require('../config/MailConfig.js')\nconst bcrypt = require('bcrypt')\nconst moment = require('dayjs')\nconst jsonwebtoken = require('jsonwebtoken')\nconst config = require('../config/index')\n// const checkCode=require('../common/Utils')\nconst Utils = require('../common/Utils')\nconst User = require('../model/User')\n\nconst forget = function (ctx) {\n    const { body } = ctx.request\n    if (typeof body.username !== 'undefined') {\n        try {\n            let result = send({\n                code: '1234',\n                expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n                email: body.username,\n                user: 'echo',\n            })\n            ctx.body = {\n                code: 200,\n                data: result,\n                msg: '邮件发送成功'\n            }\n        } catch (e) {\n            console.log(e)\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '服务器异常'\n        }\n    }\n}\nasync function login (ctx) {\n    const { body } = ctx.request\n    let sid = body.sid\n    let code = body.code\n    let result = await Utils.checkCode(sid, code)\n    console.log(result)\n    if (result) {\n        let checkUserPasswd = false\n        let user = await User.findOne({ username: body.username })\n        if (await bcrypt.compare(body.password, user.password)) {\n            checkUserPasswd = true\n        }\n        if (checkUserPasswd) {\n            const userObj = user.toJSON()\n            const arr = ['password'] //和源码有不同，这里没有删除邮箱了。\n            arr.map((item) => {\n                delete userObj[item]\n            })\n            let token = jsonwebtoken.sign({ _id: userObj._id }, config.JWT_SECRET, { expiresIn: '1d' }) //\n            ctx.body = {\n                code: 200,\n                data: userObj,\n                token: token\n            }\n        } else {\n            ctx.body = {\n                code: 404,\n                msg: '用户名或密码错误'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 401,\n            msg: '图片验证码不正确，请检查！'\n        }\n    }\n}\n\nasync function reg (ctx) {\n    const { body } = ctx.request\n    console.log(\"reg -> body\", body)\n    let sid = body.sid\n    let code = body.code\n    let msg = {}\n    let result = await Utils.checkCode(sid, code)\n    console.log(\"result:\" + result)\n    let check = true\n    if (result) {\n        let user1 = await User.findOne({ username: body.username })\n        if (user1 !== null && typeof user1.username !== 'undefined') {\n            console.log(\"user1\" + user1)\n            msg.username = ['此邮箱已经被注册，可以通过邮箱找回密码']\n            check = false\n        }\n        check = true\n        let user2 = await User.findOne({ name: body.name })\n        if (user2 !== null && typeof user2.name !== 'undefined') {\n            msg.name = ['此昵称已经被注册，请修改']\n            check = false\n        }\n        if (check) {\n            body.password = await bcrypt.hash(body.password, 5)\n            let user = new User({\n                username: body.username,\n                name: body.name,\n                password: body.password,\n                created: moment().format('YYYY-MM-DD HH:mm:ss')\n            })\n            let result = await user.save()\n            ctx.body = {\n                code: 200,\n                data: result,\n                msg: '注册成功'\n            }\n            return\n        }\n    } else {\n        msg.code = ['验证码已经失效，请重新获取！']\n    }\n    ctx.body = {\n        code: 500,\n        msg: msg\n    }\n}\n\nasync function reset (ctx) {\n    const { body } = ctx.request\n    console.log(\"reset -> body\", body, body.username)\n    let sid = body.sid\n    let code = body.code\n    let msg = {}\n    const result = await Utils.checkCode(sid, code)\n    if (result) {\n        let user = await User.findOne({ username: body.username })\n        if (user === null && user.username === 'undefined') {\n            msg.username = ['此邮箱未注册，请确认']\n            ctx.body = {\n                code: 500,\n                msg: msg\n            }\n        } else {\n            user.password = await bcrypt.hash(body.password, 5)\n            user.updated=moment().format('YYYY-MM-DD HH:mm:ss')\n            let result = await user.save()\n            const userObj = result.toJSON()\n            const arr = ['password'] \n            arr.map((item) => {\n                delete userObj[item]\n            })\n            let token = jsonwebtoken.sign({ _id: userObj._id }, config.JWT_SECRET, { expiresIn: '1d' }) //\n            ctx.body = {\n                code: 200,\n                data: userObj,\n                token: token,\n                msg:'更新密码成功！'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 401,\n            msg: '图片验证码不正确，请检查！'\n        }\n    }\n}\n\nmodule.exports = { forget, login, reg, reset }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585409595258
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/contentRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/contentRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/contentRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/contentRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "contentRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst contentController = require('../../api/ContentController');\n\nconst router = new Router();\nrouter.prefix('/content');\nrouter.post('/upload', contentController.uploadImg);\nrouter.post('/add', contentController.addPost);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRlbnRSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsImNvbnRlbnRDb250cm9sbGVyIiwicm91dGVyIiwicHJlZml4IiwicG9zdCIsInVwbG9hZEltZyIsImFkZFBvc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBQ0MsT0FBTyxDQUFDLFlBQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsaUJBQWlCLEdBQUNELE9BQU8sQ0FBQyw2QkFBRCxDQUEvQjs7QUFFQSxNQUFNRSxNQUFNLEdBQUMsSUFBSUgsTUFBSixFQUFiO0FBQ0FHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFVBQWQ7QUFFQUQsTUFBTSxDQUFDRSxJQUFQLENBQVksU0FBWixFQUFzQkgsaUJBQWlCLENBQUNJLFNBQXhDO0FBRUFILE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLE1BQVosRUFBbUJILGlCQUFpQixDQUFDSyxPQUFyQztBQUNBQyxNQUFNLENBQUNDLE9BQVAsR0FBZU4sTUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlcj1yZXF1aXJlKCdrb2Etcm91dGVyJylcbmNvbnN0IGNvbnRlbnRDb250cm9sbGVyPXJlcXVpcmUoJy4uLy4uL2FwaS9Db250ZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcbnJvdXRlci5wcmVmaXgoJy9jb250ZW50Jylcblxucm91dGVyLnBvc3QoJy91cGxvYWQnLGNvbnRlbnRDb250cm9sbGVyLnVwbG9hZEltZylcblxucm91dGVyLnBvc3QoJy9hZGQnLGNvbnRlbnRDb250cm9sbGVyLmFkZFBvc3QpXG5tb2R1bGUuZXhwb3J0cz1yb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "contentRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "contentController",
        "router",
        "prefix",
        "post",
        "uploadImg",
        "addPost",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,iBAAiB,GAACD,OAAO,CAAC,6BAAD,CAA/B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AACAG,MAAM,CAACC,MAAP,CAAc,UAAd;AAEAD,MAAM,CAACE,IAAP,CAAY,SAAZ,EAAsBH,iBAAiB,CAACI,SAAxC;AAEAH,MAAM,CAACE,IAAP,CAAY,MAAZ,EAAmBH,iBAAiB,CAACK,OAArC;AACAC,MAAM,CAACC,OAAP,GAAeN,MAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst contentController=require('../../api/ContentController')\n\nconst router=new Router()\nrouter.prefix('/content')\n\nrouter.post('/upload',contentController.uploadImg)\n\nrouter.post('/add',contentController.addPost)\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1584971949775
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/commentRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/commentRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/commentRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/commentRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "commentRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst {\n  addComment\n} = require('../../api/CommentController');\n\nconst router = new Router();\nrouter.prefix('/comments');\nrouter.post('/reply', addComment);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1lbnRSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsImFkZENvbW1lbnQiLCJyb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxNQUFNLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXBCOztBQUNBLE1BQU07QUFBRUMsRUFBQUE7QUFBRixJQUFlRCxPQUFPLENBQUMsNkJBQUQsQ0FBNUI7O0FBRUEsTUFBTUUsTUFBTSxHQUFDLElBQUlILE1BQUosRUFBYjtBQUVBRyxNQUFNLENBQUNDLE1BQVAsQ0FBYyxXQUFkO0FBQ0FELE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLFFBQVosRUFBcUJILFVBQXJCO0FBRUFJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlSixNQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjL3JvdXRlcy9tb2R1bGVzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUm91dGVyPXJlcXVpcmUoJ2tvYS1yb3V0ZXInKVxuY29uc3QgeyBhZGRDb21tZW50IH09cmVxdWlyZSgnLi4vLi4vYXBpL0NvbW1lbnRDb250cm9sbGVyJylcblxuY29uc3Qgcm91dGVyPW5ldyBSb3V0ZXIoKVxuXG5yb3V0ZXIucHJlZml4KCcvY29tbWVudHMnKVxucm91dGVyLnBvc3QoJy9yZXBseScsYWRkQ29tbWVudClcblxubW9kdWxlLmV4cG9ydHM9cm91dGVyIl19",
    "map": {
      "version": 3,
      "sources": [
        "commentRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "addComment",
        "router",
        "prefix",
        "post",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAeD,OAAO,CAAC,6BAAD,CAA5B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AAEAG,MAAM,CAACC,MAAP,CAAc,WAAd;AACAD,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,UAArB;AAEAI,MAAM,CAACC,OAAP,GAAeJ,MAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst { addComment }=require('../../api/CommentController')\n\nconst router=new Router()\n\nrouter.prefix('/comments')\nrouter.post('/reply',addComment)\n\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585712631350
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/ErrorHandle.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/ErrorHandle.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/ErrorHandle.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/ErrorHandle.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
        "sourceFileName": "ErrorHandle.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nmodule.exports = (ctx, next) => {\n  return next().catch(err => {\n    if (401 == err.status) {\n      ctx.status = 401;\n      ctx.body = {\n        code: 401,\n        msg: 'Protected resource,use Authorization header to get access\\n'\n      };\n    } else {\n      ctx.status = err.status || 500;\n      ctx.body = Object.assign({\n        code: 500,\n        msg: err.message\n      }, process.env.NODE_ENV === 'development' ? {\n        stack: err.statck\n      } : {});\n    }\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkVycm9ySGFuZGxlLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJjdHgiLCJuZXh0IiwiY2F0Y2giLCJlcnIiLCJzdGF0dXMiLCJib2R5IiwiY29kZSIsIm1zZyIsIk9iamVjdCIsImFzc2lnbiIsIm1lc3NhZ2UiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJzdGFjayIsInN0YXRjayJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsTUFBTSxDQUFDQyxPQUFQLEdBQWdCLENBQUNDLEdBQUQsRUFBS0MsSUFBTCxLQUFjO0FBQzFCLFNBQU9BLElBQUksR0FBR0MsS0FBUCxDQUFjQyxHQUFELElBQU87QUFDdkIsUUFBRyxPQUFLQSxHQUFHLENBQUNDLE1BQVosRUFBb0I7QUFDaEJKLE1BQUFBLEdBQUcsQ0FBQ0ksTUFBSixHQUFXLEdBQVg7QUFDQUosTUFBQUEsR0FBRyxDQUFDSyxJQUFKLEdBQVM7QUFDTEMsUUFBQUEsSUFBSSxFQUFDLEdBREE7QUFFTEMsUUFBQUEsR0FBRyxFQUFDO0FBRkMsT0FBVDtBQUlILEtBTkQsTUFNTztBQUNIUCxNQUFBQSxHQUFHLENBQUNJLE1BQUosR0FBYUQsR0FBRyxDQUFDQyxNQUFKLElBQWMsR0FBM0I7QUFDQUosTUFBQUEsR0FBRyxDQUFDSyxJQUFKLEdBQVdHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjO0FBQ3JCSCxRQUFBQSxJQUFJLEVBQUUsR0FEZTtBQUVyQkMsUUFBQUEsR0FBRyxFQUFFSixHQUFHLENBQUNPO0FBRlksT0FBZCxFQUdUQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsUUFBWixLQUF1QixhQUF2QixHQUFxQztBQUFDQyxRQUFBQSxLQUFLLEVBQUNYLEdBQUcsQ0FBQ1k7QUFBWCxPQUFyQyxHQUF3RCxFQUgvQyxDQUFYO0FBSUg7QUFDSixHQWRNLENBQVA7QUFlSCxDQWhCRCIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb21tb24iLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cz0gKGN0eCxuZXh0KSA9PiB7XG4gICAgcmV0dXJuIG5leHQoKS5jYXRjaCgoZXJyKT0+e1xuICAgICAgICBpZig0MDE9PWVyci5zdGF0dXMpIHtcbiAgICAgICAgICAgIGN0eC5zdGF0dXM9NDAxO1xuICAgICAgICAgICAgY3R4LmJvZHk9e1xuICAgICAgICAgICAgICAgIGNvZGU6NDAxLFxuICAgICAgICAgICAgICAgIG1zZzonUHJvdGVjdGVkIHJlc291cmNlLHVzZSBBdXRob3JpemF0aW9uIGhlYWRlciB0byBnZXQgYWNjZXNzXFxuJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgNTAwXG4gICAgICAgICAgICBjdHguYm9keSA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgICAgICBtc2c6IGVyci5tZXNzYWdlXG4gICAgICAgICAgICB9LHByb2Nlc3MuZW52Lk5PREVfRU5WPT09J2RldmVsb3BtZW50Jz97c3RhY2s6ZXJyLnN0YXRja306e30pXG4gICAgICAgIH1cbiAgICB9KTtcbn0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "ErrorHandle.js"
      ],
      "names": [
        "module",
        "exports",
        "ctx",
        "next",
        "catch",
        "err",
        "status",
        "body",
        "code",
        "msg",
        "Object",
        "assign",
        "message",
        "process",
        "env",
        "NODE_ENV",
        "stack",
        "statck"
      ],
      "mappings": ";;AAAAA,MAAM,CAACC,OAAP,GAAgB,CAACC,GAAD,EAAKC,IAAL,KAAc;AAC1B,SAAOA,IAAI,GAAGC,KAAP,CAAcC,GAAD,IAAO;AACvB,QAAG,OAAKA,GAAG,CAACC,MAAZ,EAAoB;AAChBJ,MAAAA,GAAG,CAACI,MAAJ,GAAW,GAAX;AACAJ,MAAAA,GAAG,CAACK,IAAJ,GAAS;AACLC,QAAAA,IAAI,EAAC,GADA;AAELC,QAAAA,GAAG,EAAC;AAFC,OAAT;AAIH,KAND,MAMO;AACHP,MAAAA,GAAG,CAACI,MAAJ,GAAaD,GAAG,CAACC,MAAJ,IAAc,GAA3B;AACAJ,MAAAA,GAAG,CAACK,IAAJ,GAAWG,MAAM,CAACC,MAAP,CAAc;AACrBH,QAAAA,IAAI,EAAE,GADe;AAErBC,QAAAA,GAAG,EAAEJ,GAAG,CAACO;AAFY,OAAd,EAGTC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAuB,aAAvB,GAAqC;AAACC,QAAAA,KAAK,EAACX,GAAG,CAACY;AAAX,OAArC,GAAwD,EAH/C,CAAX;AAIH;AACJ,GAdM,CAAP;AAeH,CAhBD",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
      "sourcesContent": [
        "module.exports= (ctx,next) => {\n    return next().catch((err)=>{\n        if(401==err.status) {\n            ctx.status=401;\n            ctx.body={\n                code:401,\n                msg:'Protected resource,use Authorization header to get access\\n'\n            }\n        } else {\n            ctx.status = err.status || 500\n            ctx.body = Object.assign({\n                code: 500,\n                msg: err.message\n            },process.env.NODE_ENV==='development'?{stack:err.statck}:{})\n        }\n    });\n}"
      ]
    },
    "sourceType": "script",
    "mtime": 1581480640837
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/routes.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/routes.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/routes.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/routes.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes",
        "sourceFileName": "routes.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import combineRoutes from 'koa-combine-routers'\n// const moduleFiles = require.context('./modules', true, /\\.js$/)\n// const modules = moduleFiles.keys().reduce((items, path) => {\n//     const value = moduleFiles(path)\n//     items.push(value.default)\n//     return items\n// }, [])\n// export default combineRoutes(modules)\nconst combineRoutes = require('koa-combine-routers');\n\nconst publicRoutes = require('./modules/publicRouter');\n\nconst userRoutes = require('./modules/userRouter');\n\nconst loginRoutes = require('./modules/loginRouter');\n\nconst contentRouter = require('./modules/contentRouter');\n\nconst commentRouter = require('./modules/commentRouter');\n\nmodule.exports = combineRoutes(publicRoutes, loginRoutes, userRoutes, contentRouter, commentRouter);\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy5qcyJdLCJuYW1lcyI6WyJjb21iaW5lUm91dGVzIiwicmVxdWlyZSIsInB1YmxpY1JvdXRlcyIsInVzZXJSb3V0ZXMiLCJsb2dpblJvdXRlcyIsImNvbnRlbnRSb3V0ZXIiLCJjb21tZW50Um91dGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0EsTUFBTUEsYUFBYSxHQUFDQyxPQUFPLENBQUMscUJBQUQsQ0FBM0I7O0FBQ0EsTUFBTUMsWUFBWSxHQUFDRCxPQUFPLENBQUMsd0JBQUQsQ0FBMUI7O0FBQ0EsTUFBTUUsVUFBVSxHQUFDRixPQUFPLENBQUMsc0JBQUQsQ0FBeEI7O0FBQ0EsTUFBTUcsV0FBVyxHQUFDSCxPQUFPLENBQUMsdUJBQUQsQ0FBekI7O0FBQ0EsTUFBTUksYUFBYSxHQUFDSixPQUFPLENBQUMseUJBQUQsQ0FBM0I7O0FBQ0EsTUFBTUssYUFBYSxHQUFDTCxPQUFPLENBQUMseUJBQUQsQ0FBM0I7O0FBRUFNLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlUixhQUFhLENBQ3hCRSxZQUR3QixFQUV4QkUsV0FGd0IsRUFHeEJELFVBSHdCLEVBSXhCRSxhQUp3QixFQUt4QkMsYUFMd0IsQ0FBNUIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvcm91dGVzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IGNvbWJpbmVSb3V0ZXMgZnJvbSAna29hLWNvbWJpbmUtcm91dGVycydcblxuLy8gY29uc3QgbW9kdWxlRmlsZXMgPSByZXF1aXJlLmNvbnRleHQoJy4vbW9kdWxlcycsIHRydWUsIC9cXC5qcyQvKVxuXG4vLyBjb25zdCBtb2R1bGVzID0gbW9kdWxlRmlsZXMua2V5cygpLnJlZHVjZSgoaXRlbXMsIHBhdGgpID0+IHtcbi8vICAgICBjb25zdCB2YWx1ZSA9IG1vZHVsZUZpbGVzKHBhdGgpXG4vLyAgICAgaXRlbXMucHVzaCh2YWx1ZS5kZWZhdWx0KVxuLy8gICAgIHJldHVybiBpdGVtc1xuLy8gfSwgW10pXG5cbi8vIGV4cG9ydCBkZWZhdWx0IGNvbWJpbmVSb3V0ZXMobW9kdWxlcylcblxuXG5jb25zdCBjb21iaW5lUm91dGVzPXJlcXVpcmUoJ2tvYS1jb21iaW5lLXJvdXRlcnMnKVxuY29uc3QgcHVibGljUm91dGVzPXJlcXVpcmUoJy4vbW9kdWxlcy9wdWJsaWNSb3V0ZXInKVxuY29uc3QgdXNlclJvdXRlcz1yZXF1aXJlKCcuL21vZHVsZXMvdXNlclJvdXRlcicpXG5jb25zdCBsb2dpblJvdXRlcz1yZXF1aXJlKCcuL21vZHVsZXMvbG9naW5Sb3V0ZXInKVxuY29uc3QgY29udGVudFJvdXRlcj1yZXF1aXJlKCcuL21vZHVsZXMvY29udGVudFJvdXRlcicpXG5jb25zdCBjb21tZW50Um91dGVyPXJlcXVpcmUoJy4vbW9kdWxlcy9jb21tZW50Um91dGVyJylcblxubW9kdWxlLmV4cG9ydHM9Y29tYmluZVJvdXRlcyhcbiAgICBwdWJsaWNSb3V0ZXMsXG4gICAgbG9naW5Sb3V0ZXMsXG4gICAgdXNlclJvdXRlcyxcbiAgICBjb250ZW50Um91dGVyLFxuICAgIGNvbW1lbnRSb3V0ZXJcbikiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "routes.js"
      ],
      "names": [
        "combineRoutes",
        "require",
        "publicRoutes",
        "userRoutes",
        "loginRoutes",
        "contentRouter",
        "commentRouter",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAGA,MAAMA,aAAa,GAACC,OAAO,CAAC,qBAAD,CAA3B;;AACA,MAAMC,YAAY,GAACD,OAAO,CAAC,wBAAD,CAA1B;;AACA,MAAME,UAAU,GAACF,OAAO,CAAC,sBAAD,CAAxB;;AACA,MAAMG,WAAW,GAACH,OAAO,CAAC,uBAAD,CAAzB;;AACA,MAAMI,aAAa,GAACJ,OAAO,CAAC,yBAAD,CAA3B;;AACA,MAAMK,aAAa,GAACL,OAAO,CAAC,yBAAD,CAA3B;;AAEAM,MAAM,CAACC,OAAP,GAAeR,aAAa,CACxBE,YADwB,EAExBE,WAFwB,EAGxBD,UAHwB,EAIxBE,aAJwB,EAKxBC,aALwB,CAA5B",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes",
      "sourcesContent": [
        "// import combineRoutes from 'koa-combine-routers'\n\n// const moduleFiles = require.context('./modules', true, /\\.js$/)\n\n// const modules = moduleFiles.keys().reduce((items, path) => {\n//     const value = moduleFiles(path)\n//     items.push(value.default)\n//     return items\n// }, [])\n\n// export default combineRoutes(modules)\n\n\nconst combineRoutes=require('koa-combine-routers')\nconst publicRoutes=require('./modules/publicRouter')\nconst userRoutes=require('./modules/userRouter')\nconst loginRoutes=require('./modules/loginRouter')\nconst contentRouter=require('./modules/contentRouter')\nconst commentRouter=require('./modules/commentRouter')\n\nmodule.exports=combineRoutes(\n    publicRoutes,\n    loginRoutes,\n    userRoutes,\n    contentRouter,\n    commentRouter\n)"
      ]
    },
    "sourceType": "script",
    "mtime": 1585709511114
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/publicRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/publicRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/publicRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/publicRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "publicRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst publicController = require('../../api/PublicController');\n\nconst contentController = require('../../api/ContentController');\n\nconst commentController = require('../../api/CommentController');\n\nconst router = new Router();\nrouter.prefix('/public');\nrouter.get('/getCaptcha', publicController);\nrouter.get('/list', contentController.getPostList);\nrouter.get('/content/detail', contentController.getPostDetail);\nrouter.get('/comments', commentController.getComments);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB1YmxpY1JvdXRlci5qcyJdLCJuYW1lcyI6WyJSb3V0ZXIiLCJyZXF1aXJlIiwicHVibGljQ29udHJvbGxlciIsImNvbnRlbnRDb250cm9sbGVyIiwiY29tbWVudENvbnRyb2xsZXIiLCJyb3V0ZXIiLCJwcmVmaXgiLCJnZXQiLCJnZXRQb3N0TGlzdCIsImdldFBvc3REZXRhaWwiLCJnZXRDb21tZW50cyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsTUFBTSxHQUFDQyxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxnQkFBZ0IsR0FBQ0QsT0FBTyxDQUFDLDRCQUFELENBQTlCOztBQUNBLE1BQU1FLGlCQUFpQixHQUFDRixPQUFPLENBQUMsNkJBQUQsQ0FBL0I7O0FBQ0EsTUFBTUcsaUJBQWlCLEdBQUNILE9BQU8sQ0FBQyw2QkFBRCxDQUEvQjs7QUFFQSxNQUFNSSxNQUFNLEdBQUMsSUFBSUwsTUFBSixFQUFiO0FBRUFLLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFNBQWQ7QUFDQUQsTUFBTSxDQUFDRSxHQUFQLENBQVcsYUFBWCxFQUF5QkwsZ0JBQXpCO0FBRUFHLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLE9BQVgsRUFBb0JKLGlCQUFpQixDQUFDSyxXQUF0QztBQUVBSCxNQUFNLENBQUNFLEdBQVAsQ0FBVyxpQkFBWCxFQUE2QkosaUJBQWlCLENBQUNNLGFBQS9DO0FBRUFKLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLFdBQVgsRUFBdUJILGlCQUFpQixDQUFDTSxXQUF6QztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBZVAsTUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlcj1yZXF1aXJlKCdrb2Etcm91dGVyJylcbmNvbnN0IHB1YmxpY0NvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL1B1YmxpY0NvbnRyb2xsZXInKVxuY29uc3QgY29udGVudENvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL0NvbnRlbnRDb250cm9sbGVyJylcbmNvbnN0IGNvbW1lbnRDb250cm9sbGVyPXJlcXVpcmUoJy4uLy4uL2FwaS9Db21tZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcblxucm91dGVyLnByZWZpeCgnL3B1YmxpYycpXG5yb3V0ZXIuZ2V0KCcvZ2V0Q2FwdGNoYScscHVibGljQ29udHJvbGxlcilcblxucm91dGVyLmdldCgnL2xpc3QnLCBjb250ZW50Q29udHJvbGxlci5nZXRQb3N0TGlzdClcblxucm91dGVyLmdldCgnL2NvbnRlbnQvZGV0YWlsJyxjb250ZW50Q29udHJvbGxlci5nZXRQb3N0RGV0YWlsKVxuXG5yb3V0ZXIuZ2V0KCcvY29tbWVudHMnLGNvbW1lbnRDb250cm9sbGVyLmdldENvbW1lbnRzKVxuXG5tb2R1bGUuZXhwb3J0cz1yb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "publicRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "publicController",
        "contentController",
        "commentController",
        "router",
        "prefix",
        "get",
        "getPostList",
        "getPostDetail",
        "getComments",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,gBAAgB,GAACD,OAAO,CAAC,4BAAD,CAA9B;;AACA,MAAME,iBAAiB,GAACF,OAAO,CAAC,6BAAD,CAA/B;;AACA,MAAMG,iBAAiB,GAACH,OAAO,CAAC,6BAAD,CAA/B;;AAEA,MAAMI,MAAM,GAAC,IAAIL,MAAJ,EAAb;AAEAK,MAAM,CAACC,MAAP,CAAc,SAAd;AACAD,MAAM,CAACE,GAAP,CAAW,aAAX,EAAyBL,gBAAzB;AAEAG,MAAM,CAACE,GAAP,CAAW,OAAX,EAAoBJ,iBAAiB,CAACK,WAAtC;AAEAH,MAAM,CAACE,GAAP,CAAW,iBAAX,EAA6BJ,iBAAiB,CAACM,aAA/C;AAEAJ,MAAM,CAACE,GAAP,CAAW,WAAX,EAAuBH,iBAAiB,CAACM,WAAzC;AAEAC,MAAM,CAACC,OAAP,GAAeP,MAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst publicController=require('../../api/PublicController')\nconst contentController=require('../../api/ContentController')\nconst commentController=require('../../api/CommentController')\n\nconst router=new Router()\n\nrouter.prefix('/public')\nrouter.get('/getCaptcha',publicController)\n\nrouter.get('/list', contentController.getPostList)\n\nrouter.get('/content/detail',contentController.getPostDetail)\n\nrouter.get('/comments',commentController.getComments)\n\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585714190541
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/PublicController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/PublicController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/PublicController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/PublicController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "PublicController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst svgCaptcha = require('svg-captcha');\n\nconst redisConfig = require('../config/RedisConfig'); // const redisConfig=require('@/config/RedisConfig')\n// import svgCaptcha from 'svg-captcha'     es6\n// class PublicController{\n//     constructor() {}\n//     async getCaptcha(ctx) {\n//         const body = ctx.request.query\n//         console.log(body.sid)\n//         const newCaptcha=svgCaptcha.create({\n//             size: 4,\n//             ignoreChars: '0olil',\n//             color: true,\n//             noise: Math.floor(Math.random() * 5),\n//             width: 150,\n//             height: 50\n//         })\n//         // console.log(newCaptcha)\n//         ctx.body={\n//             code: 200,\n//             data: newCaptcha.data,\n//         }\n//     }\n// }\n\n\nmodule.exports = function (ctx) {\n  const body = ctx.request.query;\n  console.log(body.sid);\n  const newCaptcha = svgCaptcha.create({\n    size: 4,\n    ignoreChars: '0olil',\n    color: true,\n    noise: Math.floor(Math.random() * 5),\n    width: 150,\n    height: 50\n  }); // console.log(newCaptcha)\n\n  redisConfig.setValue(body.sid, newCaptcha.text, 10 * 60); //save for 10m\n  // redisConfig.getValue(body.sid).then((res) => {\n  //     console.log(res)\n  // })\n\n  ctx.body = {\n    code: 200,\n    data: newCaptcha.data\n  };\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlB1YmxpY0NvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsic3ZnQ2FwdGNoYSIsInJlcXVpcmUiLCJyZWRpc0NvbmZpZyIsIm1vZHVsZSIsImV4cG9ydHMiLCJjdHgiLCJib2R5IiwicmVxdWVzdCIsInF1ZXJ5IiwiY29uc29sZSIsImxvZyIsInNpZCIsIm5ld0NhcHRjaGEiLCJjcmVhdGUiLCJzaXplIiwiaWdub3JlQ2hhcnMiLCJjb2xvciIsIm5vaXNlIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwid2lkdGgiLCJoZWlnaHQiLCJzZXRWYWx1ZSIsInRleHQiLCJjb2RlIiwiZGF0YSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxVQUFVLEdBQUNDLE9BQU8sQ0FBQyxhQUFELENBQXhCOztBQUNBLE1BQU1DLFdBQVcsR0FBQ0QsT0FBTyxDQUFDLHVCQUFELENBQXpCLEMsQ0FDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ0FFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlLFVBQVNDLEdBQVQsRUFBYTtBQUN4QixRQUFNQyxJQUFJLEdBQUdELEdBQUcsQ0FBQ0UsT0FBSixDQUFZQyxLQUF6QjtBQUNBQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUosSUFBSSxDQUFDSyxHQUFqQjtBQUNBLFFBQU1DLFVBQVUsR0FBQ1osVUFBVSxDQUFDYSxNQUFYLENBQWtCO0FBQy9CQyxJQUFBQSxJQUFJLEVBQUUsQ0FEeUI7QUFFL0JDLElBQUFBLFdBQVcsRUFBRSxPQUZrQjtBQUcvQkMsSUFBQUEsS0FBSyxFQUFFLElBSHdCO0FBSS9CQyxJQUFBQSxLQUFLLEVBQUVDLElBQUksQ0FBQ0MsS0FBTCxDQUFXRCxJQUFJLENBQUNFLE1BQUwsS0FBZ0IsQ0FBM0IsQ0FKd0I7QUFLL0JDLElBQUFBLEtBQUssRUFBRSxHQUx3QjtBQU0vQkMsSUFBQUEsTUFBTSxFQUFFO0FBTnVCLEdBQWxCLENBQWpCLENBSHdCLENBV3hCOztBQUNBcEIsRUFBQUEsV0FBVyxDQUFDcUIsUUFBWixDQUFxQmpCLElBQUksQ0FBQ0ssR0FBMUIsRUFBK0JDLFVBQVUsQ0FBQ1ksSUFBMUMsRUFBK0MsS0FBSyxFQUFwRCxFQVp3QixDQVlnQztBQUN4RDtBQUNBO0FBQ0E7O0FBQ0FuQixFQUFBQSxHQUFHLENBQUNDLElBQUosR0FBUztBQUNMbUIsSUFBQUEsSUFBSSxFQUFDLEdBREE7QUFFTEMsSUFBQUEsSUFBSSxFQUFDZCxVQUFVLENBQUNjO0FBRlgsR0FBVDtBQUlILENBcEJEIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjL2FwaSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHN2Z0NhcHRjaGE9cmVxdWlyZSgnc3ZnLWNhcHRjaGEnKVxuY29uc3QgcmVkaXNDb25maWc9cmVxdWlyZSgnLi4vY29uZmlnL1JlZGlzQ29uZmlnJylcbi8vIGNvbnN0IHJlZGlzQ29uZmlnPXJlcXVpcmUoJ0AvY29uZmlnL1JlZGlzQ29uZmlnJylcbi8vIGltcG9ydCBzdmdDYXB0Y2hhIGZyb20gJ3N2Zy1jYXB0Y2hhJyAgICAgZXM2XG5cblxuLy8gY2xhc3MgUHVibGljQ29udHJvbGxlcntcbi8vICAgICBjb25zdHJ1Y3RvcigpIHt9XG4vLyAgICAgYXN5bmMgZ2V0Q2FwdGNoYShjdHgpIHtcbi8vICAgICAgICAgY29uc3QgYm9keSA9IGN0eC5yZXF1ZXN0LnF1ZXJ5XG4vLyAgICAgICAgIGNvbnNvbGUubG9nKGJvZHkuc2lkKVxuLy8gICAgICAgICBjb25zdCBuZXdDYXB0Y2hhPXN2Z0NhcHRjaGEuY3JlYXRlKHtcbi8vICAgICAgICAgICAgIHNpemU6IDQsXG4vLyAgICAgICAgICAgICBpZ25vcmVDaGFyczogJzBvbGlsJyxcbi8vICAgICAgICAgICAgIGNvbG9yOiB0cnVlLFxuLy8gICAgICAgICAgICAgbm9pc2U6IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpLFxuLy8gICAgICAgICAgICAgd2lkdGg6IDE1MCxcbi8vICAgICAgICAgICAgIGhlaWdodDogNTBcbi8vICAgICAgICAgfSlcbi8vICAgICAgICAgLy8gY29uc29sZS5sb2cobmV3Q2FwdGNoYSlcbi8vICAgICAgICAgY3R4LmJvZHk9e1xuLy8gICAgICAgICAgICAgY29kZTogMjAwLFxuLy8gICAgICAgICAgICAgZGF0YTogbmV3Q2FwdGNoYS5kYXRhLFxuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxubW9kdWxlLmV4cG9ydHM9ZnVuY3Rpb24oY3R4KXtcbiAgICBjb25zdCBib2R5ID0gY3R4LnJlcXVlc3QucXVlcnlcbiAgICBjb25zb2xlLmxvZyhib2R5LnNpZClcbiAgICBjb25zdCBuZXdDYXB0Y2hhPXN2Z0NhcHRjaGEuY3JlYXRlKHtcbiAgICAgICAgc2l6ZTogNCxcbiAgICAgICAgaWdub3JlQ2hhcnM6ICcwb2xpbCcsXG4gICAgICAgIGNvbG9yOiB0cnVlLFxuICAgICAgICBub2lzZTogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNSksXG4gICAgICAgIHdpZHRoOiAxNTAsXG4gICAgICAgIGhlaWdodDogNTBcbiAgICB9KVxuICAgIC8vIGNvbnNvbGUubG9nKG5ld0NhcHRjaGEpXG4gICAgcmVkaXNDb25maWcuc2V0VmFsdWUoYm9keS5zaWQsIG5ld0NhcHRjaGEudGV4dCwxMCAqIDYwKSAvL3NhdmUgZm9yIDEwbVxuICAgIC8vIHJlZGlzQ29uZmlnLmdldFZhbHVlKGJvZHkuc2lkKS50aGVuKChyZXMpID0+IHtcbiAgICAvLyAgICAgY29uc29sZS5sb2cocmVzKVxuICAgIC8vIH0pXG4gICAgY3R4LmJvZHk9e1xuICAgICAgICBjb2RlOjIwMCxcbiAgICAgICAgZGF0YTpuZXdDYXB0Y2hhLmRhdGEsXG4gICAgfVxufSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "PublicController.js"
      ],
      "names": [
        "svgCaptcha",
        "require",
        "redisConfig",
        "module",
        "exports",
        "ctx",
        "body",
        "request",
        "query",
        "console",
        "log",
        "sid",
        "newCaptcha",
        "create",
        "size",
        "ignoreChars",
        "color",
        "noise",
        "Math",
        "floor",
        "random",
        "width",
        "height",
        "setValue",
        "text",
        "code",
        "data"
      ],
      "mappings": ";;AAAA,MAAMA,UAAU,GAACC,OAAO,CAAC,aAAD,CAAxB;;AACA,MAAMC,WAAW,GAACD,OAAO,CAAC,uBAAD,CAAzB,C,CACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAE,MAAM,CAACC,OAAP,GAAe,UAASC,GAAT,EAAa;AACxB,QAAMC,IAAI,GAAGD,GAAG,CAACE,OAAJ,CAAYC,KAAzB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYJ,IAAI,CAACK,GAAjB;AACA,QAAMC,UAAU,GAACZ,UAAU,CAACa,MAAX,CAAkB;AAC/BC,IAAAA,IAAI,EAAE,CADyB;AAE/BC,IAAAA,WAAW,EAAE,OAFkB;AAG/BC,IAAAA,KAAK,EAAE,IAHwB;AAI/BC,IAAAA,KAAK,EAAEC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,CAA3B,CAJwB;AAK/BC,IAAAA,KAAK,EAAE,GALwB;AAM/BC,IAAAA,MAAM,EAAE;AANuB,GAAlB,CAAjB,CAHwB,CAWxB;;AACApB,EAAAA,WAAW,CAACqB,QAAZ,CAAqBjB,IAAI,CAACK,GAA1B,EAA+BC,UAAU,CAACY,IAA1C,EAA+C,KAAK,EAApD,EAZwB,CAYgC;AACxD;AACA;AACA;;AACAnB,EAAAA,GAAG,CAACC,IAAJ,GAAS;AACLmB,IAAAA,IAAI,EAAC,GADA;AAELC,IAAAA,IAAI,EAACd,UAAU,CAACc;AAFX,GAAT;AAIH,CApBD",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "const svgCaptcha=require('svg-captcha')\nconst redisConfig=require('../config/RedisConfig')\n// const redisConfig=require('@/config/RedisConfig')\n// import svgCaptcha from 'svg-captcha'     es6\n\n\n// class PublicController{\n//     constructor() {}\n//     async getCaptcha(ctx) {\n//         const body = ctx.request.query\n//         console.log(body.sid)\n//         const newCaptcha=svgCaptcha.create({\n//             size: 4,\n//             ignoreChars: '0olil',\n//             color: true,\n//             noise: Math.floor(Math.random() * 5),\n//             width: 150,\n//             height: 50\n//         })\n//         // console.log(newCaptcha)\n//         ctx.body={\n//             code: 200,\n//             data: newCaptcha.data,\n//         }\n//     }\n// }\nmodule.exports=function(ctx){\n    const body = ctx.request.query\n    console.log(body.sid)\n    const newCaptcha=svgCaptcha.create({\n        size: 4,\n        ignoreChars: '0olil',\n        color: true,\n        noise: Math.floor(Math.random() * 5),\n        width: 150,\n        height: 50\n    })\n    // console.log(newCaptcha)\n    redisConfig.setValue(body.sid, newCaptcha.text,10 * 60) //save for 10m\n    // redisConfig.getValue(body.sid).then((res) => {\n    //     console.log(res)\n    // })\n    ctx.body={\n        code:200,\n        data:newCaptcha.data,\n    }\n}"
      ]
    },
    "sourceType": "script",
    "mtime": 1584437157098
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/RedisConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/RedisConfig.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/RedisConfig.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/RedisConfig.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "RedisConfig.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// for es5: const => var\nconst redis = require(\"redis\"); // import redis from 'redis'\n// const config = require(\"./index\")\n\n\nvar Promise = require('bluebird');\n\nvar DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb';\nvar REDIS = {\n  host: '47.99.202.255',\n  port: 15001,\n  password: '123456'\n};\nvar options = {\n  host: REDIS.host,\n  port: REDIS.port,\n  password: REDIS.password,\n  detect_buffers: true,\n  retry_strategy: function (options) {\n    if (options.error && options.error.code === 'ECONNREFUSED') {\n      return new Error('The server refused the connection');\n    }\n\n    if (options.total_retry_time > 1000 * 60 * 60) {\n      return new Error('Retry time exhausted');\n    }\n\n    if (options.attempt > 10) {\n      return undefined;\n    }\n\n    return Math.min(options.attempt * 100, 3000);\n  }\n};\nconst client = Promise.promisifyAll(redis.createClient(options)); // const client = redis.createClient(options)\n\nclient.on('error', function (err) {\n  console.log('Redis Client Error:' + err);\n});\n\nfunction setValue(key, value, time) {\n  if (typeof value === 'undefined' || value == null || value === '') {\n    return;\n  }\n\n  if (typeof value === 'string') {\n    if (typeof time !== 'undefined') {\n      client.set(key, value, 'EX', time);\n    } else {\n      client.set(key, value);\n    }\n  } else if (typeof value === 'object') {\n    Object.keys(value).forEach(item => {\n      client.hset(key, item, value[item], redis.print);\n    });\n  }\n} // setValue('id','24')\n\n\nfunction getValue(key) {\n  return client.getAsync(key);\n}\n\nvar getHValue = key => {\n  return client.hgetallAsync(key);\n};\n\nvar delValue = key => {\n  client.del(key, (err, res) => {\n    if (res === 1) {\n      console.log('delete successfully');\n    } else {\n      console.log('delete redis key error:' + err);\n    }\n  });\n}; // export {\n//     client,\n//     setValue,\n//     getValue,\n//     getHValue,\n//     delValue\n// }\n\n\nmodule.exports = {\n  client,\n  setValue,\n  getValue,\n  getHValue,\n  delValue\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlZGlzQ29uZmlnLmpzIl0sIm5hbWVzIjpbInJlZGlzIiwicmVxdWlyZSIsIlByb21pc2UiLCJEQl9VUkwiLCJSRURJUyIsImhvc3QiLCJwb3J0IiwicGFzc3dvcmQiLCJvcHRpb25zIiwiZGV0ZWN0X2J1ZmZlcnMiLCJyZXRyeV9zdHJhdGVneSIsImVycm9yIiwiY29kZSIsIkVycm9yIiwidG90YWxfcmV0cnlfdGltZSIsImF0dGVtcHQiLCJ1bmRlZmluZWQiLCJNYXRoIiwibWluIiwiY2xpZW50IiwicHJvbWlzaWZ5QWxsIiwiY3JlYXRlQ2xpZW50Iiwib24iLCJlcnIiLCJjb25zb2xlIiwibG9nIiwic2V0VmFsdWUiLCJrZXkiLCJ2YWx1ZSIsInRpbWUiLCJzZXQiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsIml0ZW0iLCJoc2V0IiwicHJpbnQiLCJnZXRWYWx1ZSIsImdldEFzeW5jIiwiZ2V0SFZhbHVlIiwiaGdldGFsbEFzeW5jIiwiZGVsVmFsdWUiLCJkZWwiLCJyZXMiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBO0FBRUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFyQixDLENBQ0E7QUFDQTs7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFFQSxJQUFJRSxNQUFNLEdBQUMsa0RBQVg7QUFDQSxJQUFJQyxLQUFLLEdBQUc7QUFDUkMsRUFBQUEsSUFBSSxFQUFFLGVBREU7QUFFUkMsRUFBQUEsSUFBSSxFQUFFLEtBRkU7QUFHUkMsRUFBQUEsUUFBUSxFQUFFO0FBSEYsQ0FBWjtBQU1BLElBQUlDLE9BQU8sR0FBRztBQUNWSCxFQUFBQSxJQUFJLEVBQUVELEtBQUssQ0FBQ0MsSUFERjtBQUVWQyxFQUFBQSxJQUFJLEVBQUVGLEtBQUssQ0FBQ0UsSUFGRjtBQUdWQyxFQUFBQSxRQUFRLEVBQUVILEtBQUssQ0FBQ0csUUFITjtBQUlWRSxFQUFBQSxjQUFjLEVBQUUs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QUMxQixFQUFBQSxNQUFEO0FBQVFPLEVBQUFBLFFBQVI7QUFBaUJXLEVBQUFBLFFBQWpCO0FBQTBCRSxFQUFBQSxTQUExQjtBQUFvQ0UsRUFBQUE7QUFBcEMsQ0FBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyIvLyBmb3IgZXM1OiBjb25zdCA9PiB2YXJcblxuY29uc3QgcmVkaXMgPSByZXF1aXJlKFwicmVkaXNcIilcbi8vIGltcG9ydCByZWRpcyBmcm9tICdyZWRpcydcbi8vIGNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoXCIuL2luZGV4XCIpXG52YXIgUHJvbWlzZSA9IHJlcXVpcmUoJ2JsdWViaXJkJylcblxudmFyIERCX1VSTD0nbW9uZ29kYjovL3Rlc3Q6MTIzNDU2QDQ3Ljk5LjIwMi4yNTU6MTUwMDEvdGVzdGRiJ1xudmFyIFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAxNTAwMSxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cblxudmFyIG9wdGlvbnMgPSB7XG4gICAgaG9zdDogUkVESVMuaG9zdCxcbiAgICBwb3J0OiBSRURJUy5wb3J0LFxuICAgIHBhc3N3b3JkOiBSRURJUy5wYXNzd29yZCxcbiAgICBkZXRlY3RfYnVmZmVyczogdHJ1ZSxcbiAgICByZXRyeV9zdHJhdGVneTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuZXJyb3IgJiYgb3B0aW9ucy5lcnJvci5jb2RlID09PSAnRUNPTk5SRUZVU0VEJykge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBFcnJvcignVGhlIHNlcnZlciByZWZ1c2VkIHRoZSBjb25uZWN0aW9uJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMudG90YWxfcmV0cnlfdGltZSA+IDEwMDAgKiA2MCAqIDYwKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKCdSZXRyeSB0aW1lIGV4aGF1c3RlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmF0dGVtcHQgPiAxMCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTWF0aC5taW4ob3B0aW9ucy5hdHRlbXB0ICogMTAwLCAzMDAwKTtcbiAgICB9XG59XG5cbmNvbnN0IGNsaWVudCA9IFByb21pc2UucHJvbWlzaWZ5QWxsKHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKSlcbi8vIGNvbnN0IGNsaWVudCA9IHJlZGlzLmNyZWF0ZUNsaWVudChvcHRpb25zKVxuXG5jbGllbnQub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycikge1xuICAgIGNvbnNvbGUubG9nKCdSZWRpcyBDbGllbnQgRXJyb3I6JyArIGVycilcbn0pXG5cbmZ1bmN0aW9uIHNldFZhbHVlIChrZXksIHZhbHVlLCB0aW1lKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgdmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSA9PT0gJycpe1xuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYodHlwZW9mIHRpbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjbGllbnQuc2V0KGtleSx2YWx1ZSwnRVgnLHRpbWUpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjbGllbnQuc2V0KGtleSx2YWx1ZSlcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jyl7XG4gICAgICAgIE9iamVjdC5rZXlzKHZhbHVlKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgICAgICBjbGllbnQuaHNldChrZXksIGl0ZW0sIHZhbHVlW2l0ZW1dLCByZWRpcy5wcmludClcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbi8vIHNldFZhbHVlKCdpZCcsJzI0JylcblxuZnVuY3Rpb24gZ2V0VmFsdWUgKGtleSkge1xuICAgIHJldHVybiBjbGllbnQuZ2V0QXN5bmMoa2V5KVxufVxuXG52YXIgZ2V0SFZhbHVlID0gKGtleSkgPT4ge1xuICAgIHJldHVybiBjbGllbnQuaGdldGFsbEFzeW5jKGtleSlcbn1cblxudmFyIGRlbFZhbHVlID0gKGtleSkgPT4ge1xuICAgIGNsaWVudC5kZWwoa2V5LCAoZXJyLCByZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcz09PTEpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0ZSBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGUgcmVkaXMga2V5IGVycm9yOicgKyBlcnIpXG4gICAgICAgIH1cbiAgICB9KVxufVxuXG4vLyBleHBvcnQge1xuLy8gICAgIGNsaWVudCxcbi8vICAgICBzZXRWYWx1ZSxcbi8vICAgICBnZXRWYWx1ZSxcbi8vICAgICBnZXRIVmFsdWUsXG4vLyAgICAgZGVsVmFsdWVcbi8vIH1cbm1vZHVsZS5leHBvcnRzPXtjbGllbnQsc2V0VmFsdWUsZ2V0VmFsdWUsZ2V0SFZhbHVlLGRlbFZhbHVlfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "RedisConfig.js"
      ],
      "names": [
        "redis",
        "require",
        "Promise",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "options",
        "detect_buffers",
        "retry_strategy",
        "error",
        "code",
        "Error",
        "total_retry_time",
        "attempt",
        "undefined",
        "Math",
        "min",
        "client",
        "promisifyAll",
        "createClient",
        "on",
        "err",
        "console",
        "log",
        "setValue",
        "key",
        "value",
        "time",
        "set",
        "Object",
        "keys",
        "forEach",
        "item",
        "hset",
        "print",
        "getValue",
        "getAsync",
        "getHValue",
        "hgetallAsync",
        "delValue",
        "del",
        "res",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "// for es5: const => var\n\nconst redis = require(\"redis\")\n// import redis from 'redis'\n// const config = require(\"./index\")\nvar Promise = require('bluebird')\n\nvar DB_URL='mongodb://test:123456@47.99.202.255:15001/testdb'\nvar REDIS = {\n    host: '47.99.202.255',\n    port: 15001,\n    password: '123456'\n}\n\nvar options = {\n    host: REDIS.host,\n    port: REDIS.port,\n    password: REDIS.password,\n    detect_buffers: true,\n    retry_strategy: function (options) {\n        if (options.error && options.error.code === 'ECONNREFUSED') {\n            return new Error('The server refused the connection');\n        }\n        if (options.total_retry_time > 1000 * 60 * 60) {\n            return new Error('Retry time exhausted');\n        }\n        if (options.attempt > 10) {\n            return undefined;\n        }\n        return Math.min(options.attempt * 100, 3000);\n    }\n}\n\nconst client = Promise.promisifyAll(redis.createClient(options))\n// const client = redis.createClient(options)\n\nclient.on('error', function (err) {\n    console.log('Redis Client Error:' + err)\n})\n\nfunction setValue (key, value, time) {\n    if (typeof value === 'undefined' || value == null || value === ''){\n        return\n    }\n    if (typeof value === 'string') {\n        if(typeof time !== 'undefined') {\n            client.set(key,value,'EX',time)\n        } else {\n            client.set(key,value)\n        }\n    } else if (typeof value === 'object'){\n        Object.keys(value).forEach((item) => {\n            client.hset(key, item, value[item], redis.print)\n        })\n    }\n}\n\n// setValue('id','24')\n\nfunction getValue (key) {\n    return client.getAsync(key)\n}\n\nvar getHValue = (key) => {\n    return client.hgetallAsync(key)\n}\n\nvar delValue = (key) => {\n    client.del(key, (err, res) => {\n        if (res===1){\n            console.log('delete successfully');\n        } else {\n            console.log('delete redis key error:' + err)\n        }\n    })\n}\n\n// export {\n//     client,\n//     setValue,\n//     getValue,\n//     getHValue,\n//     delValue\n// }\nmodule.exports={client,setValue,getValue,getHValue,delValue}"
      ]
    },
    "sourceType": "script",
    "mtime": 1582788906050
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/ContentController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/ContentController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/ContentController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/ContentController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "ContentController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import Post from '../model/Post'\nconst Post = require('../model/Post');\n\nconst config = require('../config/index');\n\nconst User = require('../model/User'); // const Comments = require('../model/Comments')\n\n\nconst {\n  checkCode,\n  getJWTPayload\n} = require('../common/Utils');\n\nconst UserCollect = require('../model/UserCollect');\n\nconst moment = require('dayjs');\n\nconst mkdir = require('make-dir');\n\nconst uuid = require(\"uuid/v4\");\n\nconst fs = require('fs');\n\nasync function getPostList(ctx) {\n  // const post = new Post({\n  //     uid:'5e6db4551418c95ecec41ac8',  //现在插入需要 uid ，之前不知道是怎么插入成功的\n  //     title:'test title5',\n  //     content:'test content 1',\n  //     catalog:'share',\n  //     fav:20,\n  //     isEnd:'0',\n  //     reads:'0',\n  //     answer:'0',\n  //     status:'0',\n  //     isTop:'0',\n  //     sort:'0',\n  //     tags:[{\n  //         name:'精华',\n  //         class: ''\n  //     }]\n  // })\n  // const tmp=await post.save()\n  // console.log(\"module.exports -> tmp\", tmp)\n  const body = ctx.query;\n  const sort = body.sort ? body.sort : 'created';\n  const page = body.page ? parseInt(body.page) : 0;\n  const limit = body.limit ? parseInt(body.limit) : 20;\n  const options = {};\n\n  if (typeof body.catalog !== 'undefined' && body.catalog !== '') {\n    options.catalog = body.catalog;\n  }\n\n  if (typeof body.isTop !== 'undefined') {\n    options.isTop = body.isTop;\n  }\n\n  if (typeof body.status !== 'undefined' && body.status !== '') {\n    options.isEnd = body.status;\n  }\n\n  if (typeof body.tag !== 'undefined' && body.tag !== '') {\n    options.tags = {\n      $elemMatch: {\n        name: body.tag\n      }\n    };\n  } // const result = await Post.getList(options, sort, page, limit)\n  // const result = Post.getList(options, sort, page, limit)\n\n\n  const result = await Post.getList(options, sort, page, limit);\n  console.log(result);\n  ctx.body = {\n    code: 200,\n    data: result,\n    msg: '获取文章列表成功'\n  };\n}\n\nasync function uploadImg(ctx) {\n  const file = ctx.request.files.file;\n  console.log(\"uploadImg -> file\", file);\n  const ext = file.name.split('.').pop(); //删除并返回最后一个元素\n\n  const dir = `${config.uploadPath}/${moment().format('YYYYMMDD')}`;\n  await mkdir(dir);\n  const picname = uuid();\n  const destPath = `${dir}/${picname}.${ext}`;\n  const reader = fs.createReadStream(file.path); //文件路径\n\n  const upStream = fs.createWriteStream(destPath); //目标路径\n\n  const filePath = `/${moment().format('YYYYMMDD')}/${picname}.${ext}`; //日期/uuid.png\n\n  reader.pipe(upStream);\n  ctx.body = {\n    code: 200,\n    msg: '图片上传成功',\n    data: filePath\n  };\n}\n\nasync function addPost(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"addPost -> body\", body);\n  const sid = body.sid;\n  const code = body.code;\n  const result = await checkCode(sid, code);\n\n  if (result) {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const user = await User.findById({\n      _id: obj._id\n    });\n    console.log(\"addPost -> user\", user);\n\n    if (user.favs < body.fav) {\n      ctx.body = {\n        code: 501,\n        msg: '积分不足'\n      };\n      return;\n    } else {\n      await User.updateOne({\n        _id: obj._id\n      }, {\n        $inc: {\n          favs: -body.fav\n        }\n      });\n    }\n\n    const newPost = new Post(body);\n    newPost.uid = obj._id;\n    const result = await newPost.save();\n    ctx.body = {\n      code: 200,\n      msg: '成功保存的文章',\n      date: result\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '图片验证码验证失败'\n    };\n  }\n}\n\nasync function getPostDetail(ctx) {\n  const params = ctx.query;\n\n  if (!params.tid) {\n    ctx.body = {\n      code: 500,\n      msg: '文章id为空'\n    };\n    return;\n  }\n\n  const post = await Post.findByTid(params.tid);\n  let isFav = 0;\n\n  if (typeof ctx.header.authorization !== 'undefined' && ctx.header.authorization !== '') {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const userCollect = await UserCollect.findOne({\n      uid: obj._id,\n      tid: params.tid\n    });\n\n    if (userCollect && userCollect.tid) {\n      isFav = 1;\n    }\n  }\n\n  const newPost = post.toJSON();\n  newPost.isFav = isFav;\n  const result = await Post.updateOne({\n    _id: params.tid\n  }, {\n    $inc: {\n      reads: 1\n    }\n  });\n\n  if (post._id && result.ok === 1) {\n    ctx.body = {\n      code: 200,\n      data: newPost,\n      msg: '查询文章详情成功'\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '获取文章详情失败'\n    };\n  }\n}\n\nasync function getPostListByUid(ctx) {\n  const params = ctx.query;\n  const page = params.page ? parseInt(params.page) : 0;\n  const limit = params.limit ? parseInt(params.limit) : 20;\n  const obj = await getJWTPayload(ctx.header.authorization);\n  const userId = obj._id;\n  const result = await Post.getListByUid(userId, page, limit);\n  const nums = await Post.countByUid(userId);\n\n  if (result.length >= 0) {\n    ctx.body = {\n      code: 200,\n      data: result,\n      nums,\n      msg: '成功获取用户的文章列表'\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '无法获取用户的文章'\n    };\n  }\n}\n\nasync function deletePostByUid() {}\n\nmodule.exports = {\n  getPostList,\n  uploadImg,\n  addPost,\n  getPostDetail,\n  getPostListByUid,\n  deletePostByUid\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbnRlbnRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlBvc3QiLCJyZXF1aXJlIiwiY29uZmlnIiwiVXNlciIsImNoZWNrQ29kZSIsImdldEpXVFBheWxvYWQiLCJVc2VyQ29sbGVjdCIsIm1vbWVudCIsIm1rZGlyIiwidXVpZCIsImZzIiwiZ2V0UG9zdExpc3QiLCJjdHgiLCJib2R5IiwicXVlcnkiLCJzb3J0IiwicGFnZSIsInBhcnNlSW50IiwibGltaXQiLCJvcHRpb25zIiwiY2F0YWxvZyIsImlzVG9wIiwic3RhdHVzIiwiaXNFbmQiLCJ0YWciLCJ0YWdzIiwiJGVsZW1NYXRjaCIsIm5hbWUiLCJyZXN1bHQiLCJnZXRMaXN0IiwiY29uc29sZSIsImxvZyIsImNvZGUiLCJkYXRhIiwibXNnIiwidXBsb2FkSW1nIiwiZmlsZSIsInJlcXVlc3QiLCJmaWxlcyIsImV4dCIsInNwbGl0IiwicG9wIiwiZGlyIiwidXBsb2FkUGF0aCIsImZvcm1hdCIsInBpY25hbWUiLCJkZXN0UGF0aCIsInJlYWRlciIsImNyZWF0ZVJlYWRTdHJlYW0iLCJwYXRoIiwidXBTdHJlYW0iLCJjcmVhdGVXcml0ZVN0cmVhbSIsImZpbGVQYXRoIiwicGlwZSIsImFkZFBvc3QiLCJzaWQiLCJvYmoiLCJoZWFkZXIiLCJhdXRob3JpemF0aW9uIiwidXNlciIsImZpbmRCeUlkIiwiX2lkIiwiZmF2cyIsImZhdiIsInVwZGF0ZU9uZSIsIiRpbmMiLCJuZXdQb3N0IiwidWlkIiwic2F2ZSIsImRhdGUiLCJnZXRQb3N0RGV0YWlsIiwicGFyYW1zIiwidGlkIiwicG9zdCIsImZpbmRCeVRpZCIsImlzRmF2IiwidXNlckNvbGxlY3QiLCJmaW5kT25lIiwidG9KU09OIiwicmVhZHMiLCJvayIsImdldFBvc3RMaXN0QnlVaWQiLCJ1c2VySWQiLCJnZXRMaXN0QnlVaWQiLCJudW1zIiwiY291bnRCeVVpZCIsImxlbmd0aCIsImRlbGV0ZVBvc3RCeVVpZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQSxNQUFNQSxJQUFJLEdBQUdDLE9BQU8sQ0FBQyxlQUFELENBQXBCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLGlCQUFELENBQXRCOztBQUNBLE1BQU1FLElBQUksR0FBR0YsT0FBTyxDQUFDLGVBQUQsQ0FBcEIsQyxDQUNBOzs7QUFDQSxNQUFNO0FBQUVHLEVBQUFBLFNBQUY7QUFBYUMsRUFBQUE7QUFBYixJQUErQkosT0FBTyxDQUFDLGlCQUFELENBQTVDOztBQUNBLE1BQU1LLFdBQVcsR0FBR0wsT0FBTyxDQUFDLHNCQUFELENBQTNCOztBQUVBLE1BQU1NLE1BQU0sR0FBR04sT0FBTyxDQUFDLE9BQUQsQ0FBdEI7O0FBQ0EsTUFBTU8sS0FBSyxHQUFHUCxPQUFPLENBQUMsVUFBRCxDQUFyQjs7QUFDQSxNQUFNUSxJQUFJLEdBQUdSLE9BQU8sQ0FBQyxTQUFELENBQXBCOztBQUNBLE1BQU1TLEVBQUUsR0FBR1QsT0FBTyxDQUFDLElBQUQsQ0FBbEI7O0FBRUEsZUFBZVUsV0FBZixDQUE0QkMsR0FBNUIsRUFBaUM7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQSxRQUFNQyxJQUFJLEdBQUdELEdBQUcsQ0FBQ0UsS0FBakI7QUFDQSxRQUFNQyxJQUFJLEdBQUdGLElBQUksQ0FBQ0UsSUFBTCxHQUFZRixJQUFJLENBQUNFLElBQWpCLEdBQXdCLFNBQXJDO0FBQ0EsUUFBTUMsSUFBSSxHQUFHSCxJQUFJLENBQUNHLElBQUwsR0FBWUMsUUFBUSxDQUFDSixJQUFJLENBQUNHLElBQU4sQ0FBcEIsR0FBa0MsQ0FBL0M7QUFDQSxRQUFNRSxLQUFLLEdBQUdMLElBQUksQ0FBQ0ssS0FBTCxHQUFhRCxRQUFRLENBQUNKLElBQUksQ0FBQ0ssS0FBTixDQUFyQixHQUFvQyxFQUFsRDtBQUNBLFFBQU1DLE9BQU8sR0FBRyxFQUFoQjs7QUFFQSxNQUFJLE9BQU9OLElBQUksQ0FBQ08sT0FBWixLQUF3QixXQUF4QixJQUF1Q1AsSUFBSSxDQUFDTyxPQUFMLEtBQWlCLEVBQTVELEVBQWdFO0FBQzVERCxJQUFBQSxPQUFPLENBQUNDLE9BQVIsR0FBa0JQLElBQUksQ0FBQ08sT0FBdkI7QUFDSDs7QUFDRCxNQUFJLE9BQU9QLElBQUksQ0FBQ1EsS0FBWixLQUFzQixXQUExQixFQUF1QztBQUNuQ0YsSUFBQUEsT0FBTyxDQUFDRSxLQUFSLEdBQWdCUixJQUFJLENBQUNRLEtBQXJCO0FBQ0g7O0FBQ0QsTUFBSSxPQUFPUixJQUFJLENBQUNTLE1BQVosS0FBdUIsV0FBdkIsSUFBc0NULElBQUksQ0FBQ1MsTUFBTCxLQUFnQixFQUExRCxFQUE4RDtBQUMxREgsSUFBQUEsT0FBTyxDQUFDSSxLQUFSLEdBQWdCVixJQUFJLENBQUNTLE1BQXJCO0FBQ0g7O0FBQ0QsTUFBSSxPQUFPVCxJQUFJLENBQUNXLEdBQVosS0FBb0IsV0FBcEIsSUFBbUNYLElBQUksQ0FBQ1csR0FBTCxLQUFhLEVBQXBELEVBQXdEO0FBQ3BETCxJQUFBQSxPQUFPLENBQUNNLElBQVIsR0FBZTtBQUFFQyxNQUFBQSxVQUFVLEVBQUU7QUFBRUMsUUFBQUEsSUFBSSxFQUFFZCxJQUFJLENBQUNXO0FBQWI7QUFBZCxLQUFmO0FBQ0gsR0F2QzRCLENBd0M3QjtBQUNBOzs7QUFDQSxRQUFNSSxNQUFNLEdBQUcsTUFBTTVCLElBQUksQ0FBQzZCLE9BQUwsQ0FBYVYsT0FBYixFQUFzQkosSUFBdEIsRUFBNEJDLElBQTVCLEVBQWtDRSxLQUFsQyxDQUFyQjtBQUNBWSxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUgsTUFBWjtBQUVBaEIsRUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUG1CLElBQUFBLElBQUksRUFBRSxHQURDO0FBRVBDLElBQUFBLElBQUksRUFBRUwsTUFGQztBQUdQTSxJQUFBQSxHQUFHLEVBQUU7QUFIRSxHQUFYO0FBS0g7O0FBRUQsZUFBZUMsU0FBZixDQUEwQnZCLEdBQTFCLEVBQStCO0FBQzNCLFFBQU13QixJQUFJLEdBQUd4QixHQUFHLENBQUN5QixPQUFKLENBQVlDLEtBQVosQ0FBa0JGLElBQS9CO0FBQ0FOLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLG1CQUFaLEVBQWlDSyxJQUFqQztBQUNBLFFBQU1HLEdBQUcsR0FBR0gsSUFBSSxDQUFDVCxJQUFMLENBQVVhLEtBQVYsQ0FBZ0IsR0FBaEIsRUFBcUJDLEdBQXJCLEVBQVosQ0FIMkIsQ0FHWTs7QUFDdkMsUUFBTUMsR0FBRyxHQUFJLEdBQUV4QyxNQUFNLENBQUN5QyxVQUFXLElBQUdwQyxNQUFNLEdBQUdxQyxNQUFULENBQWdCLFVBQWhCLENBQTRCLEVBQWhFO0FBQ0EsUUFBTXBDLEtBQUssQ0FBQ2tDLEdBQUQsQ0FBWDtBQUNBLFFBQU1HLE9BQU8sR0FBR3BDLElBQUksRUFBcEI7QUFDQSxRQUFNcUMsUUFBUSxHQUFJLEdBQUVKLEdBQUksSUFBR0csT0FBUSxJQUFHTixHQUFJLEVBQTFDO0FBQ0EsUUFBTVEsTUFBTSxHQUFHckMsRUFBRSxDQUFDc0MsZ0JBQUgsQ0FBb0JaLElBQUksQ0FBQ2EsSUFBekIsQ0FBZixDQVIyQixDQVFvQjs7QUFDL0MsUUFBTUMsUUFBUSxHQUFHeEMsRUFBRSxDQUFDeUMsaUJBQUgsQ0FBcUJMLFFBQXJCLENBQWpCLENBVDJCLENBU3FCOztBQUNoRCxRQUFNTSxRQUFRLEdBQUksSUFBRzdDLE1BQU0sR0FBR3FDLE1BQVQsQ0FBZ0IsVUFBaEIsQ0FBNEIsSUFBR0MsT0FBUSxJQUFHTixHQUFJLEVBQW5FLENBVjJCLENBVTJDOztBQUN0RVEsRUFBQUEsTUFBTSxDQUFDTSxJQUFQLENBQVlILFFBQVo7QUFDQXRDLEVBQUFBLEdBQUcsQ0FBQ0MsSUFBSixHQUFXO0FBQ1BtQixJQUFBQSxJQUFJLEVBQUUsR0FEQztBQUVQRSxJQUFBQSxHQUFHLEVBQUUsUUFGRTtBQUdQRCxJQUFBQSxJQUFJLEVBQUVtQjtBQUhDLEdBQVg7QUFLSDs7QUFFRCxlQUFlRSxPQUFmLENBQXdCMUMsR0FBeEIsRUFBNkI7QUFDekIsUUFBTTtBQUFFQyxJQUFBQTtBQUFGLE1BQVdELEdBQUcsQ0FBQ3lCLE9BQXJCO0FBQ0FQLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGlCQUFaLEVBQStCbEIsSUFBL0I7QUFDQSxRQUFNMEMsR0FBRyxHQUFHMUMsSUFBSSxDQUFDMEMsR0FBakI7QUFDQSxRQUFNdkIsSUFBSSxHQUFHbkIsSUFBSSxDQUFDbUIsSUFBbEI7QUFDQSxRQUFNSixNQUFNLEdBQUcsTUFBTXhCLFNBQVMsQ0FBQ21ELEdBQUQsRUFBTXZCLElBQU4sQ0FBOUI7O0FBQ0EsTUFBSUosTUFBSixFQUFZO0FBQ1IsVUFBTTRCLEdBQUcsR0FBRyxNQUFNbkQsYUFBYSxDQUFDTyxHQUFHLENBQUM2QyxNQUFKLENBQVdDLGFBQVosQ0FBL0I7QUFDQSxVQUFNQyxJQUFJLEdBQUcsTUFBTXhELElBQUksQ0FBQ3lELFFBQUwsQ0FBYztBQUFFQyxNQUFBQSxHQUFHLEVBQUVMLEdBQUcsQ0FBQ0s7QUFBWCxLQUFkLENBQW5CO0FBQ0EvQixJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQkFBWixFQUErQjRCLElBQS9COztBQUNBLFFBQUlBLElBQUksQ0FBQ0csSUFBTCxHQUFZakQsSUFBSSxDQUFDa0QsR0FBckIsRUFBMEI7QUFDdEJuRCxNQUFBQSxHQUFHLENBQUNDLElBQUosR0FBVztBQUNQbUIsUUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUEUsUUFBQUEsR0FBRyxFQUFFO0FBRkUsT0FBWDtBQUlBO0FBQ0gsS0FORCxNQU1PO0FBQ0gsWUFBTS9CLElBQUksQ0FBQzZELFNBQUwsQ0FBZTtBQUFFSCxRQUFBQSxHQUFHLEVBQUVMLEdBQUcsQ0FBQ0s7QUFBWCxPQUFmLEVBQWlDO0FBQUVJLFFBQUFBLElBQUksRUFBRTtBQUFFSCxVQUFBQSxJQUFJLEVBQUUsQ0FBQ2pELElBQUksQ0FBQ2tEO0FBQWQ7QUFBUixPQUFqQyxDQUFOO0FBQ0g7O0FBQ0QsVUFBTUcsT0FBTyxHQUFHLElBQUlsRSxJQUFKLENBQVNhLElBQVQsQ0FBaEI7QUFDQXFELElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixHQUFjWCxHQUFHLENBQUNLLEdBQWxCO0FBQ0EsVUFBTWpDLE1BQU0sR0FBRyxNQUFNc0MsT0FBTyxDQUFDRSxJQUFSLEVBQXJCO0FBQ0F4RCxJQUFBQSxHQUFHLENBQUNDLElBQUosR0FBVztBQUNQbUIsTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUEUsTUFBQUEsR0FBRyxFQUFFLFNBRkU7QUFHUG1DLE1BQUFBLElBQUksRUFBRXpDO0FBSEMsS0FBWDtBQUtILEdBckJELE1BcUJPO0FBQ0hoQixJQUFBQSxHQUFHLENBQUNDLElBQUosR0FBVztBQUNQbUIsTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUEUsTUFBQUEsR0FBRyxFQUFFO0FBRkUsS0FBWDtBQUtIO0FBQ0o7O0FBRUQsZUFBZW9DLGFBQWYsQ0FBOEIxRCxHQUE5QixFQUFtQztBQUMvQixRQUFNMkQsTUFBTSxHQUFHM0QsR0FBRyxDQUFDRSxLQUFuQjs7QUFDQSxNQUFJLENBQUN5RCxNQUFNLENBQUNDLEdBQVosRUFBaUI7QUFDYjVELElBQUFBLEdBQUcsQ0FBQ0MsSUFBSixHQUFXO0FBQ1BtQixNQUFBQSxJQUFJLEVBQUUsR0FEQztBQUVQRSxNQUFBQSxHQUFHLEVBQUU7QUFGRSxLQUFYO0FBSUE7QUFDSDs7QUFDRCxRQUFNdUMsSUFBSSxHQUFHLE1BQU16RSxJQUFJLENBQUMwRSxTQUFMLENBQWVILE1BQU0sQ0FBQ0MsR0FBdEIsQ0FBbkI7QUFDQSxNQUFJRyxLQUFLLEdBQUcsQ0FBWjs7QUFDQSxNQUNJLE9BQU8vRCxHQUFHLENBQUM2QyxNQUFKLENBQVdDLGFBQWxCLEtBQW9DLFdBQXBDLElBQW1EOUMsR0FBRyxDQUFDNkMsTUFBSixDQUFXQyxhQUFYLEtBQTZCLEVBRHBGLEVBRUU7QUFDRSxVQUFNRixHQUFHLEdBQUcsTUFBTW5ELGFBQWEsQ0FBQ08sR0FBRyxDQUFDNkMsTUFBSixDQUFXQyxhQUFaLENBQS9CO0FBQ0EsVUFBTWtCLFdBQVcsR0FBRyxNQUFNdEUsV0FBVyxDQUFDdUUsT0FBWixDQUFvQjtBQUMxQ1YsTUFBQUEsR0FBRyxFQUFFWCxHQUFHLENBQUNLLEdBRGlDO0FBRTFDVyxNQUFBQSxHQUFHLEVBQUVELE1BQU0sQ0FBQ0M7QUFGOEIsS0FBcEIsQ0FBMUI7O0FBSUEsUUFBSUksV0FBVyxJQUFJQSxXQUFXLENBQUNKLEdBQS9CLEVBQW9DO0FBQ2hDRyxNQUFBQSxLQUFLLEdBQUcsQ0FBUjtBQUNIO0FBQ0o7O0FBQ0QsUUFBTVQsT0FBTyxHQUFHTyxJQUFJLENBQUNLLE1BQUwsRUFBaEI7QUFDQVosRUFBQUEsT0FBTyxDQUFDUyxLQUFSLEdBQWdCQSxLQUFoQjtBQUNBLFFBQU0vQyxNQUFNLEdBQUcsTUFBTTVCLElBQUksQ0FBQ2dFLFNBQUwsQ0FDakI7QUFBRUgsSUFBQUEsR0FBRyxFQUFFVSxNQUFNLENBQUNDO0FBQWQsR0FEaUIsRUFFakI7QUFBRVAsSUFBQUEsSUFBSSxFQUFFO0FBQUVjLE1BQUFBLEtBQUssRUFBRTtBQUFUO0FBQVIsR0FGaUIsQ0FBckI7O0FBSUEsTUFBSU4sSUFBSSxDQUFDWixHQUFMLElBQVlqQyxNQUFNLENBQUNvRCxFQUFQLEtBQWMsQ0FBOUIsRUFBaUM7QUFDN0JwRSxJQUFBQSxHQUFHLENBQUNDLElBQUosR0FBVztBQUNQbUIsTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUEMsTUFBQUEsSUFBSSxFQUFFaUMsT0FGQztBQUdQaEMsTUFBQUEsR0FBRyxFQUFFO0FBSEUsS0FBWDtBQUtILEdBTkQsTUFNTztBQUNIdEIsSUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUG1CLE1BQUFBLElBQUksRUFBRSxHQURDO0FBRVBFLE1BQUFBLEdBQUcsRUFBRTtBQUZFLEtBQVg7QUFJSDtBQUNKOztBQUVELGVBQWUrQyxnQkFBZixDQUFnQ3JFLEdBQWhDLEVBQW9DO0FBQ2hDLFFBQU0yRCxNQUFNLEdBQUMzRCxHQUFHLENBQUNFLEtBQWpCO0FBQ0EsUUFBTUUsSUFBSSxHQUFDdUQsTUFBTSxDQUFDdkQsSUFBUCxHQUFZQyxRQUFRLENBQUNzRCxNQUFNLENBQUN2RCxJQUFSLENBQXBCLEdBQWtDLENBQTdDO0FBQ0EsUUFBTUUsS0FBSyxHQUFDcUQsTUFBTSxDQUFDckQsS0FBUCxHQUFhRCxRQUFRLENBQUNzRCxNQUFNLENBQUNyRCxLQUFSLENBQXJCLEdBQW9DLEVBQWhEO0FBQ0EsUUFBTXNDLEdBQUcsR0FBQyxNQUFNbkQsYUFBYSxDQUFDTyxHQUFHLENBQUM2QyxNQUFKLENBQVdDLGFBQVosQ0FBN0I7QUFDQSxRQUFNd0IsTUFBTSxHQUFDMUIsR0FBRyxDQUFDSyxHQUFqQjtBQUVBLFFBQU1qQyxNQUFNLEdBQUMsTUFBTTVCLElBQUksQ0FBQ21GLFlBQUwsQ0FBa0JELE1BQWxCLEVBQXlCbEUsSUFBekIsRUFBOEJFLEtBQTlCLENBQW5CO0FBQ0EsUUFBTWtFLElBQUksR0FBQyxNQUFNcEYsSUFBSSxDQUFDcUYsVUFBTCxDQUFnQkgsTUFBaEIsQ0FBakI7O0FBRUEsTUFBR3RELE1BQU0sQ0FBQzBELE1BQVAsSUFBZSxDQUFsQixFQUFvQjtBQUNoQjFFLElBQUFBLEdBQUcsQ0FBQ0MsSUFBSixHQUFTO0FBQ0xtQixNQUFBQSxJQUFJLEVBQUMsR0FEQTtBQUVMQyxNQUFBQSxJQUFJLEVBQUNMLE1BRkE7QUFHTHdELE1BQUFBLElBSEs7QUFJTGxELE1BQUFBLEdBQUcsRUFBQztBQUpDLEtBQVQ7QUFNSCxHQVBELE1BT087QUFDSHRCLElBQUFBLEdBQUcsQ0FBQ0MsSUFBSixHQUFTO0FBQ0xtQixNQUFBQSxJQUFJLEVBQUMsR0FEQTtBQUVMRSxNQUFBQSxHQUFHLEVBQUM7QUFGQyxLQUFUO0FBSUg7QUFDSjs7QUFFRCxlQUFlcUQsZUFBZixHQUFnQyxDQUUvQjs7QUFHREMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQUU5RSxFQUFBQSxXQUFGO0FBQWV3QixFQUFBQSxTQUFmO0FBQTBCbUIsRUFBQUEsT0FBMUI7QUFBbUNnQixFQUFBQSxhQUFuQztBQUFrRFcsRUFBQUEsZ0JBQWxEO0FBQW1FTSxFQUFBQTtBQUFuRSxDQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9hcGkiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgUG9zdCBmcm9tICcuLi9tb2RlbC9Qb3N0J1xuY29uc3QgUG9zdCA9IHJlcXVpcmUoJy4uL21vZGVsL1Bvc3QnKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4JylcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbC9Vc2VyJylcbi8vIGNvbnN0IENvbW1lbnRzID0gcmVxdWlyZSgnLi4vbW9kZWwvQ29tbWVudHMnKVxuY29uc3QgeyBjaGVja0NvZGUsIGdldEpXVFBheWxvYWQgfSA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG5jb25zdCBVc2VyQ29sbGVjdCA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXJDb2xsZWN0JylcblxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuY29uc3QgbWtkaXIgPSByZXF1aXJlKCdtYWtlLWRpcicpXG5jb25zdCB1dWlkID0gcmVxdWlyZShcInV1aWQvdjRcIilcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0TGlzdCAoY3R4KSB7XG4gICAgLy8gY29uc3QgcG9zdCA9IG5ldyBQb3N0KHtcbiAgICAvLyAgICAgdWlkOic1ZTZkYjQ1NTE0MThjOTVlY2VjNDFhYzgnLCAgLy/njrDlnKjmj5LlhaXpnIDopoEgdWlkIO+8jOS5i+WJjeS4jeefpemBk+aYr+aAjuS5iOaPkuWFpeaIkOWKn+eahFxuICAgIC8vICAgICB0aXRsZTondGVzdCB0aXRsZTUnLFxuICAgIC8vICAgICBjb250ZW50Oid0ZXN0IGNvbnRlbnQgMScsXG4gICAgLy8gICAgIGNhdGFsb2c6J3NoYXJlJyxcbiAgICAvLyAgICAgZmF2OjIwLFxuICAgIC8vICAgICBpc0VuZDonMCcsXG4gICAgLy8gICAgIHJlYWRzOicwJyxcbiAgICAvLyAgICAgYW5zd2VyOicwJyxcbiAgICAvLyAgICAgc3RhdHVzOicwJyxcbiAgICAvLyAgICAgaXNUb3A6JzAnLFxuICAgIC8vICAgICBzb3J0OicwJyxcbiAgICAvLyAgICAgdGFnczpbe1xuICAgIC8vICAgICAgICAgbmFtZTon57K+5Y2OJyxcbiAgICAvLyAgICAgICAgIGNsYXNzOiAnJ1xuICAgIC8vICAgICB9XVxuICAgIC8vIH0pXG4gICAgLy8gY29uc3QgdG1wPWF3YWl0IHBvc3Quc2F2ZSgpXG4gICAgLy8gY29uc29sZS5sb2coXCJtb2R1bGUuZXhwb3J0cyAtPiB0bXBcIiwgdG1wKVxuXG5cbiAgICBjb25zdCBib2R5ID0gY3R4LnF1ZXJ5XG4gICAgY29uc3Qgc29ydCA9IGJvZHkuc29ydCA/IGJvZHkuc29ydCA6ICdjcmVhdGVkJ1xuICAgIGNvbnN0IHBhZ2UgPSBib2R5LnBhZ2UgPyBwYXJzZUludChib2R5LnBhZ2UpIDogMFxuICAgIGNvbnN0IGxpbWl0ID0gYm9keS5saW1pdCA/IHBhcnNlSW50KGJvZHkubGltaXQpIDogMjBcbiAgICBjb25zdCBvcHRpb25zID0ge31cblxuICAgIGlmICh0eXBlb2YgYm9keS5jYXRhbG9nICE9PSAndW5kZWZpbmVkJyAmJiBib2R5LmNhdGFsb2cgIT09ICcnKSB7XG4gICAgICAgIG9wdGlvbnMuY2F0YWxvZyA9IGJvZHkuY2F0YWxvZ1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGJvZHkuaXNUb3AgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIG9wdGlvbnMuaXNUb3AgPSBib2R5LmlzVG9wXG4gICAgfVxuICAgIGlmICh0eXBlb2YgYm9keS5zdGF0dXMgIT09ICd1bmRlZmluZWQnICYmIGJvZHkuc3RhdHVzICE9PSAnJykge1xuICAgICAgICBvcHRpb25zLmlzRW5kID0gYm9keS5zdGF0dXNcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBib2R5LnRhZyAhPT0gJ3VuZGVmaW5lZCcgJiYgYm9keS50YWcgIT09ICcnKSB7XG4gICAgICAgIG9wdGlvbnMudGFncyA9IHsgJGVsZW1NYXRjaDogeyBuYW1lOiBib2R5LnRhZyB9IH1cbiAgICB9XG4gICAgLy8gY29uc3QgcmVzdWx0ID0gYXdhaXQgUG9zdC5nZXRMaXN0KG9wdGlvbnMsIHNvcnQsIHBhZ2UsIGxpbWl0KVxuICAgIC8vIGNvbnN0IHJlc3VsdCA9IFBvc3QuZ2V0TGlzdChvcHRpb25zLCBzb3J0LCBwYWdlLCBsaW1pdClcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBQb3N0LmdldExpc3Qob3B0aW9ucywgc29ydCwgcGFnZSwgbGltaXQpXG4gICAgY29uc29sZS5sb2cocmVzdWx0KVxuXG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICBtc2c6ICfojrflj5bmlofnq6DliJfooajmiJDlip8nXG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiB1cGxvYWRJbWcgKGN0eCkge1xuICAgIGNvbnN0IGZpbGUgPSBjdHgucmVxdWVzdC5maWxlcy5maWxlXG4gICAgY29uc29sZS5sb2coXCJ1cGxvYWRJbWcgLT4gZmlsZVwiLCBmaWxlKVxuICAgIGNvbnN0IGV4dCA9IGZpbGUubmFtZS5zcGxpdCgnLicpLnBvcCgpIC8v5Yig6Zmk5bm26L+U5Zue5pyA5ZCO5LiA5Liq5YWD57SgXG4gICAgY29uc3QgZGlyID0gYCR7Y29uZmlnLnVwbG9hZFBhdGh9LyR7bW9tZW50KCkuZm9ybWF0KCdZWVlZTU1ERCcpfWBcbiAgICBhd2FpdCBta2RpcihkaXIpXG4gICAgY29uc3QgcGljbmFtZSA9IHV1aWQoKVxuICAgIGNvbnN0IGRlc3RQYXRoID0gYCR7ZGlyfS8ke3BpY25hbWV9LiR7ZXh0fWBcbiAgICBjb25zdCByZWFkZXIgPSBmcy5jcmVhdGVSZWFkU3RyZWFtKGZpbGUucGF0aCkgIC8v5paH5Lu26Lev5b6EXG4gICAgY29uc3QgdXBTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShkZXN0UGF0aCkgLy/nm67moIfot6/lvoRcbiAgICBjb25zdCBmaWxlUGF0aCA9IGAvJHttb21lbnQoKS5mb3JtYXQoJ1lZWVlNTUREJyl9LyR7cGljbmFtZX0uJHtleHR9YCAgLy/ml6XmnJ8vdXVpZC5wbmdcbiAgICByZWFkZXIucGlwZSh1cFN0cmVhbSlcbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICBtc2c6ICflm77niYfkuIrkvKDmiJDlip8nLFxuICAgICAgICBkYXRhOiBmaWxlUGF0aFxuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gYWRkUG9zdCAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwiYWRkUG9zdCAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgc2lkID0gYm9keS5zaWRcbiAgICBjb25zdCBjb2RlID0gYm9keS5jb2RlXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tDb2RlKHNpZCwgY29kZSlcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh7IF9pZDogb2JqLl9pZCB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcImFkZFBvc3QgLT4gdXNlclwiLCB1c2VyKVxuICAgICAgICBpZiAodXNlci5mYXZzIDwgYm9keS5mYXYpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDUwMSxcbiAgICAgICAgICAgICAgICBtc2c6ICfnp6/liIbkuI3otrMnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF3YWl0IFVzZXIudXBkYXRlT25lKHsgX2lkOiBvYmouX2lkIH0sIHsgJGluYzogeyBmYXZzOiAtYm9keS5mYXYgfSB9KVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5ld1Bvc3QgPSBuZXcgUG9zdChib2R5KVxuICAgICAgICBuZXdQb3N0LnVpZCA9IG9iai5faWRcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbmV3UG9zdC5zYXZlKClcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBtc2c6ICfmiJDlip/kv53lrZjnmoTmlofnq6AnLFxuICAgICAgICAgICAgZGF0ZTogcmVzdWx0XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggemqjOivgeWksei0pSdcblxuICAgICAgICB9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRQb3N0RGV0YWlsIChjdHgpIHtcbiAgICBjb25zdCBwYXJhbXMgPSBjdHgucXVlcnlcbiAgICBpZiAoIXBhcmFtcy50aWQpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmlofnq6BpZOS4uuepuidcbiAgICAgICAgfVxuICAgICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgcG9zdCA9IGF3YWl0IFBvc3QuZmluZEJ5VGlkKHBhcmFtcy50aWQpXG4gICAgbGV0IGlzRmF2ID0gMFxuICAgIGlmIChcbiAgICAgICAgdHlwZW9mIGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbiAhPT0gJ3VuZGVmaW5lZCcgJiYgY3R4LmhlYWRlci5hdXRob3JpemF0aW9uICE9PSAnJ1xuICAgICkge1xuICAgICAgICBjb25zdCBvYmogPSBhd2FpdCBnZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICAgICAgY29uc3QgdXNlckNvbGxlY3QgPSBhd2FpdCBVc2VyQ29sbGVjdC5maW5kT25lKHtcbiAgICAgICAgICAgIHVpZDogb2JqLl9pZCxcbiAgICAgICAgICAgIHRpZDogcGFyYW1zLnRpZFxuICAgICAgICB9KVxuICAgICAgICBpZiAodXNlckNvbGxlY3QgJiYgdXNlckNvbGxlY3QudGlkKSB7XG4gICAgICAgICAgICBpc0ZhdiA9IDFcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBuZXdQb3N0ID0gcG9zdC50b0pTT04oKVxuICAgIG5ld1Bvc3QuaXNGYXYgPSBpc0ZhdlxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IFBvc3QudXBkYXRlT25lKFxuICAgICAgICB7IF9pZDogcGFyYW1zLnRpZCB9LFxuICAgICAgICB7ICRpbmM6IHsgcmVhZHM6IDEgfSB9XG4gICAgKVxuICAgIGlmIChwb3N0Ll9pZCAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICBkYXRhOiBuZXdQb3N0LFxuICAgICAgICAgICAgbXNnOiAn5p+l6K+i5paH56ug6K+m5oOF5oiQ5YqfJ1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfojrflj5bmlofnq6Dor6bmg4XlpLHotKUnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldFBvc3RMaXN0QnlVaWQoY3R4KXtcbiAgICBjb25zdCBwYXJhbXM9Y3R4LnF1ZXJ5XG4gICAgY29uc3QgcGFnZT1wYXJhbXMucGFnZT9wYXJzZUludChwYXJhbXMucGFnZSk6MFxuICAgIGNvbnN0IGxpbWl0PXBhcmFtcy5saW1pdD9wYXJzZUludChwYXJhbXMubGltaXQpOjIwXG4gICAgY29uc3Qgb2JqPWF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgIGNvbnN0IHVzZXJJZD1vYmouX2lkXG5cbiAgICBjb25zdCByZXN1bHQ9YXdhaXQgUG9zdC5nZXRMaXN0QnlVaWQodXNlcklkLHBhZ2UsbGltaXQpXG4gICAgY29uc3QgbnVtcz1hd2FpdCBQb3N0LmNvdW50QnlVaWQodXNlcklkKVxuXG4gICAgaWYocmVzdWx0Lmxlbmd0aD49MCl7XG4gICAgICAgIGN0eC5ib2R5PXtcbiAgICAgICAgICAgIGNvZGU6MjAwLFxuICAgICAgICAgICAgZGF0YTpyZXN1bHQsXG4gICAgICAgICAgICBudW1zLFxuICAgICAgICAgICAgbXNnOifmiJDlip/ojrflj5bnlKjmiLfnmoTmlofnq6DliJfooagnXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keT17XG4gICAgICAgICAgICBjb2RlOjUwMCxcbiAgICAgICAgICAgIG1zZzon5peg5rOV6I635Y+W55So5oi355qE5paH56ugJ1xuICAgICAgICB9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBkZWxldGVQb3N0QnlVaWQoKXtcblxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0geyBnZXRQb3N0TGlzdCwgdXBsb2FkSW1nLCBhZGRQb3N0LCBnZXRQb3N0RGV0YWlsLCBnZXRQb3N0TGlzdEJ5VWlkLGRlbGV0ZVBvc3RCeVVpZCB9Il19",
    "map": {
      "version": 3,
      "sources": [
        "ContentController.js"
      ],
      "names": [
        "Post",
        "require",
        "config",
        "User",
        "checkCode",
        "getJWTPayload",
        "UserCollect",
        "moment",
        "mkdir",
        "uuid",
        "fs",
        "getPostList",
        "ctx",
        "body",
        "query",
        "sort",
        "page",
        "parseInt",
        "limit",
        "options",
        "catalog",
        "isTop",
        "status",
        "isEnd",
        "tag",
        "tags",
        "$elemMatch",
        "name",
        "result",
        "getList",
        "console",
        "log",
        "code",
        "data",
        "msg",
        "uploadImg",
        "file",
        "request",
        "files",
        "ext",
        "split",
        "pop",
        "dir",
        "uploadPath",
        "format",
        "picname",
        "destPath",
        "reader",
        "createReadStream",
        "path",
        "upStream",
        "createWriteStream",
        "filePath",
        "pipe",
        "addPost",
        "sid",
        "obj",
        "header",
        "authorization",
        "user",
        "findById",
        "_id",
        "favs",
        "fav",
        "updateOne",
        "$inc",
        "newPost",
        "uid",
        "save",
        "date",
        "getPostDetail",
        "params",
        "tid",
        "post",
        "findByTid",
        "isFav",
        "userCollect",
        "findOne",
        "toJSON",
        "reads",
        "ok",
        "getPostListByUid",
        "userId",
        "getListByUid",
        "nums",
        "countByUid",
        "length",
        "deletePostByUid",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA;AACA,MAAMA,IAAI,GAAGC,OAAO,CAAC,eAAD,CAApB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,iBAAD,CAAtB;;AACA,MAAME,IAAI,GAAGF,OAAO,CAAC,eAAD,CAApB,C,CACA;;;AACA,MAAM;AAAEG,EAAAA,SAAF;AAAaC,EAAAA;AAAb,IAA+BJ,OAAO,CAAC,iBAAD,CAA5C;;AACA,MAAMK,WAAW,GAAGL,OAAO,CAAC,sBAAD,CAA3B;;AAEA,MAAMM,MAAM,GAAGN,OAAO,CAAC,OAAD,CAAtB;;AACA,MAAMO,KAAK,GAAGP,OAAO,CAAC,UAAD,CAArB;;AACA,MAAMQ,IAAI,GAAGR,OAAO,CAAC,SAAD,CAApB;;AACA,MAAMS,EAAE,GAAGT,OAAO,CAAC,IAAD,CAAlB;;AAEA,eAAeU,WAAf,CAA4BC,GAA5B,EAAiC;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA,QAAMC,IAAI,GAAGD,GAAG,CAACE,KAAjB;AACA,QAAMC,IAAI,GAAGF,IAAI,CAACE,IAAL,GAAYF,IAAI,CAACE,IAAjB,GAAwB,SAArC;AACA,QAAMC,IAAI,GAAGH,IAAI,CAACG,IAAL,GAAYC,QAAQ,CAACJ,IAAI,CAACG,IAAN,CAApB,GAAkC,CAA/C;AACA,QAAME,KAAK,GAAGL,IAAI,CAACK,KAAL,GAAaD,QAAQ,CAACJ,IAAI,CAACK,KAAN,CAArB,GAAoC,EAAlD;AACA,QAAMC,OAAO,GAAG,EAAhB;;AAEA,MAAI,OAAON,IAAI,CAACO,OAAZ,KAAwB,WAAxB,IAAuCP,IAAI,CAACO,OAAL,KAAiB,EAA5D,EAAgE;AAC5DD,IAAAA,OAAO,CAACC,OAAR,GAAkBP,IAAI,CAACO,OAAvB;AACH;;AACD,MAAI,OAAOP,IAAI,CAACQ,KAAZ,KAAsB,WAA1B,EAAuC;AACnCF,IAAAA,OAAO,CAACE,KAAR,GAAgBR,IAAI,CAACQ,KAArB;AACH;;AACD,MAAI,OAAOR,IAAI,CAACS,MAAZ,KAAuB,WAAvB,IAAsCT,IAAI,CAACS,MAAL,KAAgB,EAA1D,EAA8D;AAC1DH,IAAAA,OAAO,CAACI,KAAR,GAAgBV,IAAI,CAACS,MAArB;AACH;;AACD,MAAI,OAAOT,IAAI,CAACW,GAAZ,KAAoB,WAApB,IAAmCX,IAAI,CAACW,GAAL,KAAa,EAApD,EAAwD;AACpDL,IAAAA,OAAO,CAACM,IAAR,GAAe;AAAEC,MAAAA,UAAU,EAAE;AAAEC,QAAAA,IAAI,EAAEd,IAAI,CAACW;AAAb;AAAd,KAAf;AACH,GAvC4B,CAwC7B;AACA;;;AACA,QAAMI,MAAM,GAAG,MAAM5B,IAAI,CAAC6B,OAAL,CAAaV,OAAb,EAAsBJ,IAAtB,EAA4BC,IAA5B,EAAkCE,KAAlC,CAArB;AACAY,EAAAA,OAAO,CAACC,GAAR,CAAYH,MAAZ;AAEAhB,EAAAA,GAAG,CAACC,IAAJ,GAAW;AACPmB,IAAAA,IAAI,EAAE,GADC;AAEPC,IAAAA,IAAI,EAAEL,MAFC;AAGPM,IAAAA,GAAG,EAAE;AAHE,GAAX;AAKH;;AAED,eAAeC,SAAf,CAA0BvB,GAA1B,EAA+B;AAC3B,QAAMwB,IAAI,GAAGxB,GAAG,CAACyB,OAAJ,CAAYC,KAAZ,CAAkBF,IAA/B;AACAN,EAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiCK,IAAjC;AACA,QAAMG,GAAG,GAAGH,IAAI,CAACT,IAAL,CAAUa,KAAV,CAAgB,GAAhB,EAAqBC,GAArB,EAAZ,CAH2B,CAGY;;AACvC,QAAMC,GAAG,GAAI,GAAExC,MAAM,CAACyC,UAAW,IAAGpC,MAAM,GAAGqC,MAAT,CAAgB,UAAhB,CAA4B,EAAhE;AACA,QAAMpC,KAAK,CAACkC,GAAD,CAAX;AACA,QAAMG,OAAO,GAAGpC,IAAI,EAApB;AACA,QAAMqC,QAAQ,GAAI,GAAEJ,GAAI,IAAGG,OAAQ,IAAGN,GAAI,EAA1C;AACA,QAAMQ,MAAM,GAAGrC,EAAE,CAACsC,gBAAH,CAAoBZ,IAAI,CAACa,IAAzB,CAAf,CAR2B,CAQoB;;AAC/C,QAAMC,QAAQ,GAAGxC,EAAE,CAACyC,iBAAH,CAAqBL,QAArB,CAAjB,CAT2B,CASqB;;AAChD,QAAMM,QAAQ,GAAI,IAAG7C,MAAM,GAAGqC,MAAT,CAAgB,UAAhB,CAA4B,IAAGC,OAAQ,IAAGN,GAAI,EAAnE,CAV2B,CAU2C;;AACtEQ,EAAAA,MAAM,CAACM,IAAP,CAAYH,QAAZ;AACAtC,EAAAA,GAAG,CAACC,IAAJ,GAAW;AACPmB,IAAAA,IAAI,EAAE,GADC;AAEPE,IAAAA,GAAG,EAAE,QAFE;AAGPD,IAAAA,IAAI,EAAEmB;AAHC,GAAX;AAKH;;AAED,eAAeE,OAAf,CAAwB1C,GAAxB,EAA6B;AACzB,QAAM;AAAEC,IAAAA;AAAF,MAAWD,GAAG,CAACyB,OAArB;AACAP,EAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BlB,IAA/B;AACA,QAAM0C,GAAG,GAAG1C,IAAI,CAAC0C,GAAjB;AACA,QAAMvB,IAAI,GAAGnB,IAAI,CAACmB,IAAlB;AACA,QAAMJ,MAAM,GAAG,MAAMxB,SAAS,CAACmD,GAAD,EAAMvB,IAAN,CAA9B;;AACA,MAAIJ,MAAJ,EAAY;AACR,UAAM4B,GAAG,GAAG,MAAMnD,aAAa,CAACO,GAAG,CAAC6C,MAAJ,CAAWC,aAAZ,CAA/B;AACA,UAAMC,IAAI,GAAG,MAAMxD,IAAI,CAACyD,QAAL,CAAc;AAAEC,MAAAA,GAAG,EAAEL,GAAG,CAACK;AAAX,KAAd,CAAnB;AACA/B,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+B4B,IAA/B;;AACA,QAAIA,IAAI,CAACG,IAAL,GAAYjD,IAAI,CAACkD,GAArB,EAA0B;AACtBnD,MAAAA,GAAG,CAACC,IAAJ,GAAW;AACPmB,QAAAA,IAAI,EAAE,GADC;AAEPE,QAAAA,GAAG,EAAE;AAFE,OAAX;AAIA;AACH,KAND,MAMO;AACH,YAAM/B,IAAI,CAAC6D,SAAL,CAAe;AAAEH,QAAAA,GAAG,EAAEL,GAAG,CAACK;AAAX,OAAf,EAAiC;AAAEI,QAAAA,IAAI,EAAE;AAAEH,UAAAA,IAAI,EAAE,CAACjD,IAAI,CAACkD;AAAd;AAAR,OAAjC,CAAN;AACH;;AACD,UAAMG,OAAO,GAAG,IAAIlE,IAAJ,CAASa,IAAT,CAAhB;AACAqD,IAAAA,OAAO,CAACC,GAAR,GAAcX,GAAG,CAACK,GAAlB;AACA,UAAMjC,MAAM,GAAG,MAAMsC,OAAO,CAACE,IAAR,EAArB;AACAxD,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPmB,MAAAA,IAAI,EAAE,GADC;AAEPE,MAAAA,GAAG,EAAE,SAFE;AAGPmC,MAAAA,IAAI,EAAEzC;AAHC,KAAX;AAKH,GArBD,MAqBO;AACHhB,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPmB,MAAAA,IAAI,EAAE,GADC;AAEPE,MAAAA,GAAG,EAAE;AAFE,KAAX;AAKH;AACJ;;AAED,eAAeoC,aAAf,CAA8B1D,GAA9B,EAAmC;AAC/B,QAAM2D,MAAM,GAAG3D,GAAG,CAACE,KAAnB;;AACA,MAAI,CAACyD,MAAM,CAACC,GAAZ,EAAiB;AACb5D,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPmB,MAAAA,IAAI,EAAE,GADC;AAEPE,MAAAA,GAAG,EAAE;AAFE,KAAX;AAIA;AACH;;AACD,QAAMuC,IAAI,GAAG,MAAMzE,IAAI,CAAC0E,SAAL,CAAeH,MAAM,CAACC,GAAtB,CAAnB;AACA,MAAIG,KAAK,GAAG,CAAZ;;AACA,MACI,OAAO/D,GAAG,CAAC6C,MAAJ,CAAWC,aAAlB,KAAoC,WAApC,IAAmD9C,GAAG,CAAC6C,MAAJ,CAAWC,aAAX,KAA6B,EADpF,EAEE;AACE,UAAMF,GAAG,GAAG,MAAMnD,aAAa,CAACO,GAAG,CAAC6C,MAAJ,CAAWC,aAAZ,CAA/B;AACA,UAAMkB,WAAW,GAAG,MAAMtE,WAAW,CAACuE,OAAZ,CAAoB;AAC1CV,MAAAA,GAAG,EAAEX,GAAG,CAACK,GADiC;AAE1CW,MAAAA,GAAG,EAAED,MAAM,CAACC;AAF8B,KAApB,CAA1B;;AAIA,QAAII,WAAW,IAAIA,WAAW,CAACJ,GAA/B,EAAoC;AAChCG,MAAAA,KAAK,GAAG,CAAR;AACH;AACJ;;AACD,QAAMT,OAAO,GAAGO,IAAI,CAACK,MAAL,EAAhB;AACAZ,EAAAA,OAAO,CAACS,KAAR,GAAgBA,KAAhB;AACA,QAAM/C,MAAM,GAAG,MAAM5B,IAAI,CAACgE,SAAL,CACjB;AAAEH,IAAAA,GAAG,EAAEU,MAAM,CAACC;AAAd,GADiB,EAEjB;AAAEP,IAAAA,IAAI,EAAE;AAAEc,MAAAA,KAAK,EAAE;AAAT;AAAR,GAFiB,CAArB;;AAIA,MAAIN,IAAI,CAACZ,GAAL,IAAYjC,MAAM,CAACoD,EAAP,KAAc,CAA9B,EAAiC;AAC7BpE,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPmB,MAAAA,IAAI,EAAE,GADC;AAEPC,MAAAA,IAAI,EAAEiC,OAFC;AAGPhC,MAAAA,GAAG,EAAE;AAHE,KAAX;AAKH,GAND,MAMO;AACHtB,IAAAA,GAAG,CAACC,IAAJ,GAAW;AACPmB,MAAAA,IAAI,EAAE,GADC;AAEPE,MAAAA,GAAG,EAAE;AAFE,KAAX;AAIH;AACJ;;AAED,eAAe+C,gBAAf,CAAgCrE,GAAhC,EAAoC;AAChC,QAAM2D,MAAM,GAAC3D,GAAG,CAACE,KAAjB;AACA,QAAME,IAAI,GAACuD,MAAM,CAACvD,IAAP,GAAYC,QAAQ,CAACsD,MAAM,CAACvD,IAAR,CAApB,GAAkC,CAA7C;AACA,QAAME,KAAK,GAACqD,MAAM,CAACrD,KAAP,GAAaD,QAAQ,CAACsD,MAAM,CAACrD,KAAR,CAArB,GAAoC,EAAhD;AACA,QAAMsC,GAAG,GAAC,MAAMnD,aAAa,CAACO,GAAG,CAAC6C,MAAJ,CAAWC,aAAZ,CAA7B;AACA,QAAMwB,MAAM,GAAC1B,GAAG,CAACK,GAAjB;AAEA,QAAMjC,MAAM,GAAC,MAAM5B,IAAI,CAACmF,YAAL,CAAkBD,MAAlB,EAAyBlE,IAAzB,EAA8BE,KAA9B,CAAnB;AACA,QAAMkE,IAAI,GAAC,MAAMpF,IAAI,CAACqF,UAAL,CAAgBH,MAAhB,CAAjB;;AAEA,MAAGtD,MAAM,CAAC0D,MAAP,IAAe,CAAlB,EAAoB;AAChB1E,IAAAA,GAAG,CAACC,IAAJ,GAAS;AACLmB,MAAAA,IAAI,EAAC,GADA;AAELC,MAAAA,IAAI,EAACL,MAFA;AAGLwD,MAAAA,IAHK;AAILlD,MAAAA,GAAG,EAAC;AAJC,KAAT;AAMH,GAPD,MAOO;AACHtB,IAAAA,GAAG,CAACC,IAAJ,GAAS;AACLmB,MAAAA,IAAI,EAAC,GADA;AAELE,MAAAA,GAAG,EAAC;AAFC,KAAT;AAIH;AACJ;;AAED,eAAeqD,eAAf,GAAgC,CAE/B;;AAGDC,MAAM,CAACC,OAAP,GAAiB;AAAE9E,EAAAA,WAAF;AAAewB,EAAAA,SAAf;AAA0BmB,EAAAA,OAA1B;AAAmCgB,EAAAA,aAAnC;AAAkDW,EAAAA,gBAAlD;AAAmEM,EAAAA;AAAnE,CAAjB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "// import Post from '../model/Post'\nconst Post = require('../model/Post')\nconst config = require('../config/index')\nconst User = require('../model/User')\n// const Comments = require('../model/Comments')\nconst { checkCode, getJWTPayload } = require('../common/Utils')\nconst UserCollect = require('../model/UserCollect')\n\nconst moment = require('dayjs')\nconst mkdir = require('make-dir')\nconst uuid = require(\"uuid/v4\")\nconst fs = require('fs')\n\nasync function getPostList (ctx) {\n    // const post = new Post({\n    //     uid:'5e6db4551418c95ecec41ac8',  //现在插入需要 uid ，之前不知道是怎么插入成功的\n    //     title:'test title5',\n    //     content:'test content 1',\n    //     catalog:'share',\n    //     fav:20,\n    //     isEnd:'0',\n    //     reads:'0',\n    //     answer:'0',\n    //     status:'0',\n    //     isTop:'0',\n    //     sort:'0',\n    //     tags:[{\n    //         name:'精华',\n    //         class: ''\n    //     }]\n    // })\n    // const tmp=await post.save()\n    // console.log(\"module.exports -> tmp\", tmp)\n\n\n    const body = ctx.query\n    const sort = body.sort ? body.sort : 'created'\n    const page = body.page ? parseInt(body.page) : 0\n    const limit = body.limit ? parseInt(body.limit) : 20\n    const options = {}\n\n    if (typeof body.catalog !== 'undefined' && body.catalog !== '') {\n        options.catalog = body.catalog\n    }\n    if (typeof body.isTop !== 'undefined') {\n        options.isTop = body.isTop\n    }\n    if (typeof body.status !== 'undefined' && body.status !== '') {\n        options.isEnd = body.status\n    }\n    if (typeof body.tag !== 'undefined' && body.tag !== '') {\n        options.tags = { $elemMatch: { name: body.tag } }\n    }\n    // const result = await Post.getList(options, sort, page, limit)\n    // const result = Post.getList(options, sort, page, limit)\n    const result = await Post.getList(options, sort, page, limit)\n    console.log(result)\n\n    ctx.body = {\n        code: 200,\n        data: result,\n        msg: '获取文章列表成功'\n    }\n}\n\nasync function uploadImg (ctx) {\n    const file = ctx.request.files.file\n    console.log(\"uploadImg -> file\", file)\n    const ext = file.name.split('.').pop() //删除并返回最后一个元素\n    const dir = `${config.uploadPath}/${moment().format('YYYYMMDD')}`\n    await mkdir(dir)\n    const picname = uuid()\n    const destPath = `${dir}/${picname}.${ext}`\n    const reader = fs.createReadStream(file.path)  //文件路径\n    const upStream = fs.createWriteStream(destPath) //目标路径\n    const filePath = `/${moment().format('YYYYMMDD')}/${picname}.${ext}`  //日期/uuid.png\n    reader.pipe(upStream)\n    ctx.body = {\n        code: 200,\n        msg: '图片上传成功',\n        data: filePath\n    }\n}\n\nasync function addPost (ctx) {\n    const { body } = ctx.request\n    console.log(\"addPost -> body\", body)\n    const sid = body.sid\n    const code = body.code\n    const result = await checkCode(sid, code)\n    if (result) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const user = await User.findById({ _id: obj._id })\n        console.log(\"addPost -> user\", user)\n        if (user.favs < body.fav) {\n            ctx.body = {\n                code: 501,\n                msg: '积分不足'\n            }\n            return\n        } else {\n            await User.updateOne({ _id: obj._id }, { $inc: { favs: -body.fav } })\n        }\n        const newPost = new Post(body)\n        newPost.uid = obj._id\n        const result = await newPost.save()\n        ctx.body = {\n            code: 200,\n            msg: '成功保存的文章',\n            date: result\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '图片验证码验证失败'\n\n        }\n    }\n}\n\nasync function getPostDetail (ctx) {\n    const params = ctx.query\n    if (!params.tid) {\n        ctx.body = {\n            code: 500,\n            msg: '文章id为空'\n        }\n        return\n    }\n    const post = await Post.findByTid(params.tid)\n    let isFav = 0\n    if (\n        typeof ctx.header.authorization !== 'undefined' && ctx.header.authorization !== ''\n    ) {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const userCollect = await UserCollect.findOne({\n            uid: obj._id,\n            tid: params.tid\n        })\n        if (userCollect && userCollect.tid) {\n            isFav = 1\n        }\n    }\n    const newPost = post.toJSON()\n    newPost.isFav = isFav\n    const result = await Post.updateOne(\n        { _id: params.tid },\n        { $inc: { reads: 1 } }\n    )\n    if (post._id && result.ok === 1) {\n        ctx.body = {\n            code: 200,\n            data: newPost,\n            msg: '查询文章详情成功'\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '获取文章详情失败'\n        }\n    }\n}\n\nasync function getPostListByUid(ctx){\n    const params=ctx.query\n    const page=params.page?parseInt(params.page):0\n    const limit=params.limit?parseInt(params.limit):20\n    const obj=await getJWTPayload(ctx.header.authorization)\n    const userId=obj._id\n\n    const result=await Post.getListByUid(userId,page,limit)\n    const nums=await Post.countByUid(userId)\n\n    if(result.length>=0){\n        ctx.body={\n            code:200,\n            data:result,\n            nums,\n            msg:'成功获取用户的文章列表'\n        }\n    } else {\n        ctx.body={\n            code:500,\n            msg:'无法获取用户的文章'\n        }\n    }\n}\n\nasync function deletePostByUid(){\n\n}\n\n\nmodule.exports = { getPostList, uploadImg, addPost, getPostDetail, getPostListByUid,deletePostByUid }"
      ]
    },
    "sourceType": "script",
    "mtime": 1586401951537
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Post.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Post.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Post.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Post.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "Post.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\n// import mongoose from '@/config/DBHelpler'\n// import moment from 'dayjs'\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst PostSchema = new Schema({\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  title: {\n    type: String\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  catalog: {\n    type: String\n  },\n  fav: {\n    type: String,\n    default: ''\n  },\n  isEnd: {\n    type: String,\n    default: '0'\n  },\n  reads: {\n    type: Number,\n    default: 0\n  },\n  answer: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '0'\n  },\n  isTop: {\n    type: String,\n    default: '0'\n  },\n  sort: {\n    type: String,\n    default: 100\n  },\n  tags: {\n    type: Array,\n    default: [// {\n      //   name: '',\n      //   class: ''\n      // }\n    ]\n  }\n});\nPostSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n});\nPostSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss');\n  next();\n});\nPostSchema.statics = {\n  /**\n   * 获取文章列表数据\n   * @param {Object} options 筛选条件\n   * @param {String} sort 排序方式\n   * @param {Number} page 分页页数\n   * @param {Number} limit 分页条数\n   */\n  // getList: function (options, sort, page, limit) {\n  //   return this.find(options)\n  //     .sort({ [sort]: -1 })\n  //     .skip(page * limit)\n  //     .limit(limit)\n  //     // .populate({\n  //     //   path: 'uid',\n  //     //   select: 'name isVip pic'\n  //     // })\n  // },\n  // 通过 sort，skip，limit，populate 去查询文章，其中 populate 可以查询到 user 的信息\n  getList: function (options, sort, page, limit) {\n    return this.find(options).sort({\n      [sort]: -1\n    }).skip(page * limit).limit(limit).populate({\n      path: 'uid',\n      select: 'name isVip pic'\n    });\n  },\n  getTopWeek: function () {\n    return this.find({\n      created: {\n        $gte: moment().subtract(7, 'days')\n      }\n    }, {\n      answer: 1,\n      title: 1\n    }).sort({\n      answer: -1\n    }).limit(15);\n  },\n  findByTid: function (id) {\n    return this.findOne({\n      _id: id\n    }).populate({\n      path: 'uid',\n      select: 'name pic isVip _id'\n    });\n  },\n  getListByUid: function (id, page, limit) {\n    return this.find({\n      uid: id\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  countByUid: function (id) {\n    return this.find({\n      uid: id\n    }).countDocuments();\n  }\n};\nconst PostModel = mongoose.model('post', PostSchema); // export default PostModel\n\nmodule.exports = PostModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBvc3QuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiUG9zdFNjaGVtYSIsInVpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJ0aXRsZSIsImNvbnRlbnQiLCJjcmVhdGVkIiwiRGF0ZSIsImNhdGFsb2ciLCJmYXYiLCJkZWZhdWx0IiwiaXNFbmQiLCJyZWFkcyIsIk51bWJlciIsImFuc3dlciIsInN0YXR1cyIsImlzVG9wIiwic29ydCIsInRhZ3MiLCJBcnJheSIsInZpcnR1YWwiLCJsb2NhbEZpZWxkIiwiZm9yZWlnbkZpZWxkIiwicHJlIiwibmV4dCIsImZvcm1hdCIsInN0YXRpY3MiLCJnZXRMaXN0Iiwib3B0aW9ucyIsInBhZ2UiLCJsaW1pdCIsImZpbmQiLCJza2lwIiwicG9wdWxhdGUiLCJwYXRoIiwic2VsZWN0IiwiZ2V0VG9wV2VlayIsIiRndGUiLCJzdWJ0cmFjdCIsImZpbmRCeVRpZCIsImlkIiwiZmluZE9uZSIsIl9pZCIsImdldExpc3RCeVVpZCIsImNvdW50QnlVaWQiLCJjb3VudERvY3VtZW50cyIsIlBvc3RNb2RlbCIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0EsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsb0JBQUQsQ0FBeEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsT0FBRCxDQUF0Qjs7QUFFQSxNQUFNRSxNQUFNLEdBQUdILFFBQVEsQ0FBQ0csTUFBeEI7QUFFQSxNQUFNQyxVQUFVLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQzVCRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEdUI7QUFFNUJDLEVBQUFBLEtBQUssRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FGcUI7QUFHNUJHLEVBQUFBLE9B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SSxDQU9DO0FBQUVILE1BQUFBLE1BQU0sRUFBRSxDQUFDO0FBQVgsS0FQRCxFQVFKZ0IsS0FSSSxDQVFFLEVBUkYsQ0FBUDtBQVNELEdBeENrQjtBQXlDbkJTLEVBQUFBLFNBQVMsRUFBRSxVQUFVQyxFQUFWLEVBQWM7QUFDdkIsV0FBTyxLQUFLQyxPQUFMLENBQWE7QUFBRUMsTUFBQUEsR0FBRyxFQUFFRjtBQUFQLEtBQWIsRUFBMEJQLFFBQTFCLENBQW1DO0FBQ3hDQyxNQUFBQSxJQUFJLEVBQUUsS0FEa0M7QUFFeENDLE1BQUFBLE1BQU0sRUFBRTtBQUZnQyxLQUFuQyxDQUFQO0FBSUQsR0E5Q2tCO0FBK0NuQlEsRUFBQUEsWUFBWSxFQUFFLFVBQVVILEVBQVYsRUFBY1gsSUFBZCxFQUFvQkMsS0FBcEIsRUFBMkI7QUFDdkMsV0FBTyxLQUFLQyxJQUFMLENBQVU7QUFBRS9CLE1BQUFBLEdBQUcsRUFBRXdDO0FBQVAsS0FBVixFQUNKUixJQURJLENBQ0NILElBQUksR0FBR0MsS0FEUixFQUVKQSxLQUZJLENBRUVBLEtBRkYsRUFHSmIsSUFISSxDQUdDO0FBQUVYLE1BQUFBLE9BQU8sRUFBRSxDQUFDO0FBQVosS0FIRCxDQUFQO0FBSUQsR0FwRGtCO0FBcURuQnNDLEVBQUFBLFVBQVUsRUFBRSxVQUFVSixFQUFWLEVBQWM7QUFDeEIsV0FBTyxLQUFLVCxJQUFMLENBQVU7QUFBRS9CLE1BQUFBLEdBQUcsRUFBRXdDO0FBQVAsS0FBVixFQUF1QkssY0FBdkIsRUFBUDtBQUNEO0FBdkRrQixDQUFyQjtBQTBEQSxNQUFNQyxTQUFTLEdBQUduRCxRQUFRLENBQUNvRCxLQUFULENBQWUsTUFBZixFQUF1QmhELFVBQXZCLENBQWxCLEMsQ0FFQTs7QUFDQWlELE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQkgsU0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgbW9uZ29vc2UgZnJvbSAnQC9jb25maWcvREJIZWxwbGVyJ1xuLy8gaW1wb3J0IG1vbWVudCBmcm9tICdkYXlqcydcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnLi4vY29uZmlnL0RCSGVscGVyJylcbmNvbnN0IG1vbWVudCA9IHJlcXVpcmUoJ2RheWpzJylcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IFBvc3RTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIHRpdGxlOiB7IHR5cGU6IFN0cmluZyB9LFxuICBjb250ZW50OiB7IHR5cGU6IFN0cmluZyB9LFxuICBjcmVhdGVkOiB7IHR5cGU6IERhdGUgfSxcbiAgY2F0YWxvZzogeyB0eXBlOiBTdHJpbmcgfSxcbiAgZmF2OiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDonJyB9LFxuICBpc0VuZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9LFxuICByZWFkczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcbiAgYW5zd2VyOiB7IHR5cGU6IE51bWJlciwgZGVmYXVsdDogMCB9LFxuICBzdGF0dXM6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfSxcbiAgaXNUb3A6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfSxcbiAgc29ydDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6IDEwMCB9LFxuICB0YWdzOiB7XG4gICAgdHlwZTogQXJyYXksXG4gICAgZGVmYXVsdDogW1xuICAgICAgLy8ge1xuICAgICAgLy8gICBuYW1lOiAnJyxcbiAgICAgIC8vICAgY2xhc3M6ICcnXG4gICAgICAvLyB9XG4gICAgXVxuICB9XG59KVxuXG5Qb3N0U2NoZW1hLnZpcnR1YWwoJ3VzZXInLCB7XG4gIHJlZjogJ3VzZXJzJyxcbiAgbG9jYWxGaWVsZDogJ3VpZCcsXG4gIGZvcmVpZ25GaWVsZDogJ19pZCdcbn0pXG5cblBvc3RTY2hlbWEucHJlKCdzYXZlJywgZnVuY3Rpb24gKG5leHQpIHtcbiAgdGhpcy5jcmVhdGVkID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgbmV4dCgpXG59KVxuXG5Qb3N0U2NoZW1hLnN0YXRpY3MgPSB7XG4gIC8qKlxuICAgKiDojrflj5bmlofnq6DliJfooajmlbDmja5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMg562b6YCJ5p2h5Lu2XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzb3J0IOaOkuW6j+aWueW8j1xuICAgKiBAcGFyYW0ge051bWJlcn0gcGFnZSDliIbpobXpobXmlbBcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGxpbWl0IOWIhumhteadoeaVsFxuICAgKi9cbiAgLy8gZ2V0TGlzdDogZnVuY3Rpb24gKG9wdGlvbnMsIHNvcnQsIHBhZ2UsIGxpbWl0KSB7XG4gIC8vICAgcmV0dXJuIHRoaXMuZmluZChvcHRpb25zKVxuICAvLyAgICAgLnNvcnQoeyBbc29ydF06IC0xIH0pXG4gIC8vICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gIC8vICAgICAubGltaXQobGltaXQpXG4gIC8vICAgICAvLyAucG9wdWxhdGUoe1xuICAvLyAgICAgLy8gICBwYXRoOiAndWlkJyxcbiAgLy8gICAgIC8vICAgc2VsZWN0OiAnbmFtZSBpc1ZpcCBwaWMnXG4gIC8vICAgICAvLyB9KVxuICAvLyB9LFxuXG4gIC8vIOmAmui/hyBzb3J077yMc2tpcO+8jGxpbWl077yMcG9wdWxhdGUg5Y675p+l6K+i5paH56ug77yM5YW25LitIHBvcHVsYXRlIOWPr+S7peafpeivouWIsCB1c2VyIOeahOS/oeaBr1xuICBnZXRMaXN0OiBmdW5jdGlvbiAob3B0aW9ucywgc29ydCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKG9wdGlvbnMpXG4gICAgLnNvcnQoe1tzb3J0XTotMX0pXG4gICAgLnNraXAocGFnZSpsaW1pdClcbiAgICAubGltaXQobGltaXQpXG4gICAgLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6J3VpZCcsICAgICAgICBcbiAgICAgIHNlbGVjdDonbmFtZSBpc1ZpcCBwaWMnXG4gICAgfSlcbiAgfSxcbiAgZ2V0VG9wV2VlazogZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoe1xuICAgICAgY3JlYXRlZDoge1xuICAgICAgICAkZ3RlOiBtb21lbnQoKS5zdWJ0cmFjdCg3LCAnZGF5cycpXG4gICAgICB9XG4gICAgfSwge1xuICAgICAgYW5zd2VyOiAxLFxuICAgICAgdGl0bGU6IDFcbiAgICB9KS5zb3J0KHsgYW5zd2VyOiAtMSB9KVxuICAgICAgLmxpbWl0KDE1KVxuICB9LFxuICBmaW5kQnlUaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmRPbmUoeyBfaWQ6IGlkIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICd1aWQnLFxuICAgICAgc2VsZWN0OiAnbmFtZSBwaWMgaXNWaXAgX2lkJ1xuICAgIH0pXG4gIH0sXG4gIGdldExpc3RCeVVpZDogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pXG4gICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG4gIGNvdW50QnlVaWQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pLmNvdW50RG9jdW1lbnRzKClcbiAgfVxufVxuXG5jb25zdCBQb3N0TW9kZWwgPSBtb25nb29zZS5tb2RlbCgncG9zdCcsIFBvc3RTY2hlbWEpXG5cbi8vIGV4cG9ydCBkZWZhdWx0IFBvc3RNb2RlbFxubW9kdWxlLmV4cG9ydHMgPSBQb3N0TW9kZWwiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Post.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "PostSchema",
        "uid",
        "type",
        "String",
        "ref",
        "title",
        "content",
        "created",
        "Date",
        "catalog",
        "fav",
        "default",
        "isEnd",
        "reads",
        "Number",
        "answer",
        "status",
        "isTop",
        "sort",
        "tags",
        "Array",
        "virtual",
        "localField",
        "foreignField",
        "pre",
        "next",
        "format",
        "statics",
        "getList",
        "options",
        "page",
        "limit",
        "find",
        "skip",
        "populate",
        "path",
        "select",
        "getTopWeek",
        "$gte",
        "subtract",
        "findByTid",
        "id",
        "findOne",
        "_id",
        "getListByUid",
        "countByUid",
        "countDocuments",
        "PostModel",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "// import mongoose from '@/config/DBHelpler'\n// import moment from 'dayjs'\nconst mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\n\nconst Schema = mongoose.Schema\n\nconst PostSchema = new Schema({\n  uid: { type: String, ref: 'users' },\n  title: { type: String },\n  content: { type: String },\n  created: { type: Date },\n  catalog: { type: String },\n  fav: { type: String, default:'' },\n  isEnd: { type: String, default: '0' },\n  reads: { type: Number, default: 0 },\n  answer: { type: Number, default: 0 },\n  status: { type: String, default: '0' },\n  isTop: { type: String, default: '0' },\n  sort: { type: String, default: 100 },\n  tags: {\n    type: Array,\n    default: [\n      // {\n      //   name: '',\n      //   class: ''\n      // }\n    ]\n  }\n})\n\nPostSchema.virtual('user', {\n  ref: 'users',\n  localField: 'uid',\n  foreignField: '_id'\n})\n\nPostSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss')\n  next()\n})\n\nPostSchema.statics = {\n  /**\n   * 获取文章列表数据\n   * @param {Object} options 筛选条件\n   * @param {String} sort 排序方式\n   * @param {Number} page 分页页数\n   * @param {Number} limit 分页条数\n   */\n  // getList: function (options, sort, page, limit) {\n  //   return this.find(options)\n  //     .sort({ [sort]: -1 })\n  //     .skip(page * limit)\n  //     .limit(limit)\n  //     // .populate({\n  //     //   path: 'uid',\n  //     //   select: 'name isVip pic'\n  //     // })\n  // },\n\n  // 通过 sort，skip，limit，populate 去查询文章，其中 populate 可以查询到 user 的信息\n  getList: function (options, sort, page, limit) {\n    return this.find(options)\n    .sort({[sort]:-1})\n    .skip(page*limit)\n    .limit(limit)\n    .populate({\n      path:'uid',        \n      select:'name isVip pic'\n    })\n  },\n  getTopWeek: function () {\n    return this.find({\n      created: {\n        $gte: moment().subtract(7, 'days')\n      }\n    }, {\n      answer: 1,\n      title: 1\n    }).sort({ answer: -1 })\n      .limit(15)\n  },\n  findByTid: function (id) {\n    return this.findOne({ _id: id }).populate({\n      path: 'uid',\n      select: 'name pic isVip _id'\n    })\n  },\n  getListByUid: function (id, page, limit) {\n    return this.find({ uid: id })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  countByUid: function (id) {\n    return this.find({ uid: id }).countDocuments()\n  }\n}\n\nconst PostModel = mongoose.model('post', PostSchema)\n\n// export default PostModel\nmodule.exports = PostModel"
      ]
    },
    "sourceType": "script",
    "mtime": 1585706466117
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/DBHelper.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/DBHelper.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/DBHelper.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/DBHelper.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "DBHelper.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('mongoose'); // const config = require('./index')\n\n\nmongoose.set('useCreateIndex', true);\nconst DB_URL = 'mongodb://echo:123456@47.99.202.255:27018/testdb';\nconst REDIS = {\n  host: '47.99.202.255',\n  port: 27017,\n  password: '123456'\n};\nmongoose.connect(DB_URL, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\nmongoose.connection.on('connected', () => {\n  console.log('Mongoose connection open to ' + DB_URL);\n});\nmongoose.connection.on('error', err => {\n  console.log('Mongoose connection error: ' + err);\n});\nmongoose.connection.on('disconnected', () => {\n  console.log('Mongoose connection disconnected');\n});\nmodule.exports = mongoose;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRCSGVscGVyLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsInNldCIsIkRCX1VSTCIsIlJFRElTIiwiaG9zdCIsInBvcnQiLCJwYXNzd29yZCIsImNvbm5lY3QiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJjb25uZWN0aW9uIiwib24iLCJjb25zb2xlIiwibG9nIiwiZXJyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFELENBQXhCLEMsQ0FDQTs7O0FBRUFELFFBQVEsQ0FBQ0UsR0FBVCxDQUFhLGdCQUFiLEVBQThCLElBQTlCO0FBRUEsTUFBTUMsTUFBTSxHQUFDLGtEQUFiO0FBQ0EsTUFBTUMsS0FBSyxHQUFHO0FBQ1ZDLEVBQUFBLElBQUksRUFBRSxlQURJO0FBRVZDLEVBQUFBLElBQUksRUFBRSxLQUZJO0FBR1ZDLEVBQUFBLFFBQVEsRUFBRTtBQUhBLENBQWQ7QUFNQVAsUUFBUSxDQUFDUSxPQUFULENBQWlCTCxNQUFqQixFQUF3QjtBQUNwQk0sRUFBQUEsZUFBZSxFQUFFLElBREc7QUFFcEJDLEVBQUFBLGtCQUFrQixFQUFFO0FBRkEsQ0FBeEI7QUFLQVYsUUFBUSxDQUFDVyxVQUFULENBQW9CQyxFQUFwQixDQUF1QixXQUF2QixFQUFvQyxNQUFNO0FBQ3RDQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxpQ0FBK0JYLE1BQTNDO0FBQ0gsQ0FGRDtBQUlBSCxRQUFRLENBQUNXLFVBQVQsQ0FBb0JDLEVBQXBCLENBQXVCLE9BQXZCLEVBQWlDRyxHQUFELElBQVM7QUFDckNGLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdDQUE4QkMsR0FBMUM7QUFDSCxDQUZEO0FBSUFmLFFBQVEsQ0FBQ1csVUFBVCxDQUFvQkMsRUFBcEIsQ0FBdUIsY0FBdkIsRUFBdUMsTUFBTTtBQUN6Q0MsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksa0NBQVo7QUFDSCxDQUZEO0FBSUFFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlakIsUUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJylcbi8vIGNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4vaW5kZXgnKVxuXG5tb25nb29zZS5zZXQoJ3VzZUNyZWF0ZUluZGV4Jyx0cnVlKVxuXG5jb25zdCBEQl9VUkw9J21vbmdvZGI6Ly9lY2hvOjEyMzQ1NkA0Ny45OS4yMDIuMjU1OjI3MDE4L3Rlc3RkYidcbmNvbnN0IFJFRElTID0ge1xuICAgIGhvc3Q6ICc0Ny45OS4yMDIuMjU1JyxcbiAgICBwb3J0OiAyNzAxNyxcbiAgICBwYXNzd29yZDogJzEyMzQ1Nidcbn1cblxubW9uZ29vc2UuY29ubmVjdChEQl9VUkwse1xuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWVcbn0pXG5cbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oJ2Nvbm5lY3RlZCcsICgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnTW9uZ29vc2UgY29ubmVjdGlvbiBvcGVuIHRvICcrREJfVVJMKTtcbn0pXG5cbm1vbmdvb3NlLmNvbm5lY3Rpb24ub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdNb25nb29zZSBjb25uZWN0aW9uIGVycm9yOiAnK2Vycik7XG59KVxuXG5tb25nb29zZS5jb25uZWN0aW9uLm9uKCdkaXNjb25uZWN0ZWQnLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ01vbmdvb3NlIGNvbm5lY3Rpb24gZGlzY29ubmVjdGVkJylcbn0pXG5cbm1vZHVsZS5leHBvcnRzPW1vbmdvb3NlIl19",
    "map": {
      "version": 3,
      "sources": [
        "DBHelper.js"
      ],
      "names": [
        "mongoose",
        "require",
        "set",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "connect",
        "useNewUrlParser",
        "useUnifiedTopology",
        "connection",
        "on",
        "console",
        "log",
        "err",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB,C,CACA;;;AAEAD,QAAQ,CAACE,GAAT,CAAa,gBAAb,EAA8B,IAA9B;AAEA,MAAMC,MAAM,GAAC,kDAAb;AACA,MAAMC,KAAK,GAAG;AACVC,EAAAA,IAAI,EAAE,eADI;AAEVC,EAAAA,IAAI,EAAE,KAFI;AAGVC,EAAAA,QAAQ,EAAE;AAHA,CAAd;AAMAP,QAAQ,CAACQ,OAAT,CAAiBL,MAAjB,EAAwB;AACpBM,EAAAA,eAAe,EAAE,IADG;AAEpBC,EAAAA,kBAAkB,EAAE;AAFA,CAAxB;AAKAV,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,WAAvB,EAAoC,MAAM;AACtCC,EAAAA,OAAO,CAACC,GAAR,CAAY,iCAA+BX,MAA3C;AACH,CAFD;AAIAH,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,OAAvB,EAAiCG,GAAD,IAAS;AACrCF,EAAAA,OAAO,CAACC,GAAR,CAAY,gCAA8BC,GAA1C;AACH,CAFD;AAIAf,QAAQ,CAACW,UAAT,CAAoBC,EAApB,CAAuB,cAAvB,EAAuC,MAAM;AACzCC,EAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ;AACH,CAFD;AAIAE,MAAM,CAACC,OAAP,GAAejB,QAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "const mongoose = require('mongoose')\n// const config = require('./index')\n\nmongoose.set('useCreateIndex',true)\n\nconst DB_URL='mongodb://echo:123456@47.99.202.255:27018/testdb'\nconst REDIS = {\n    host: '47.99.202.255',\n    port: 27017,\n    password: '123456'\n}\n\nmongoose.connect(DB_URL,{\n    useNewUrlParser: true,\n    useUnifiedTopology: true\n})\n\nmongoose.connection.on('connected', () => {\n    console.log('Mongoose connection open to '+DB_URL);\n})\n\nmongoose.connection.on('error', (err) => {\n    console.log('Mongoose connection error: '+err);\n})\n\nmongoose.connection.on('disconnected', () => {\n    console.log('Mongoose connection disconnected')\n})\n\nmodule.exports=mongoose"
      ]
    },
    "sourceType": "script",
    "mtime": 1583598900525
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/index.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/index.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/index.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst path = require('path');\n\nconst DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb';\nconst REDIS = {\n  host: '47.99.202.255',\n  port: 15001,\n  password: '123456'\n};\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'none' : 'http://localhost:8080';\nconst uploadPath = process.env.NODE_ENV === 'production' ? '/app/public' : path.join(path.resolve(__dirname), '../../public');\nconst JWT_SECRET = 'onedaythisismyfuture'; // 本来是一个编码后的值，这里使用了随机写的字母\n// export default {\n//     DB_URL,\n//     REDIS\n// }\n\nconst wsPort = 3001;\nmodule.exports = {\n  DB_URL,\n  REDIS,\n  uploadPath,\n  JWT_SECRET,\n  baseUrl,\n  wsPort\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInBhdGgiLCJyZXF1aXJlIiwiREJfVVJMIiwiUkVESVMiLCJob3N0IiwicG9ydCIsInBhc3N3b3JkIiwiYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsInVwbG9hZFBhdGgiLCJqb2luIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsIkpXVF9TRUNSRVQiLCJ3c1BvcnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBRUEsTUFBTUMsTUFBTSxHQUFHLGtEQUFmO0FBQ0EsTUFBTUMsS0FBSyxHQUFHO0FBQ1ZDLEVBQUFBLElBQUksRUFBRSxlQURJO0FBRVZDLEVBQUFBLElBQUksRUFBRSxLQUZJO0FBR1ZDLEVBQUFBLFFBQVEsRUFBRTtBQUhBLENBQWQ7QUFLQSxNQUFNQyxPQUFPLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxRQUFaLEtBQXlCLFlBQXpCLEdBQXdDLE1BQXhDLEdBQWlELHVCQUFqRTtBQUNBLE1BQU1DLFVBQVUsR0FBR0gsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFFBQVosS0FBeUIsWUFBekIsR0FBd0MsYUFBeEMsR0FBd0RWLElBQUksQ0FBQ1ksSUFBTCxDQUFVWixJQUFJLENBQUNhLE9BQUwsQ0FBYUMsU0FBYixDQUFWLEVBQW1DLGNBQW5DLENBQTNFO0FBQ0EsTUFBTUMsVUFBVSxHQUFHLHNCQUFuQixDLENBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBOztBQUNBLE1BQU1DLE1BQU0sR0FBRyxJQUFmO0FBRUFDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUFFaEIsRUFBQUEsTUFBRjtBQUFVQyxFQUFBQSxLQUFWO0FBQWlCUSxFQUFBQSxVQUFqQjtBQUE2QkksRUFBQUEsVUFBN0I7QUFBeUNSLEVBQUFBLE9BQXpDO0FBQWtEUyxFQUFBQTtBQUFsRCxDQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpXG5cbmNvbnN0IERCX1VSTCA9ICdtb25nb2RiOi8vdGVzdDoxMjM0NTZANDcuOTkuMjAyLjI1NToxNTAwMS90ZXN0ZGInXG5jb25zdCBSRURJUyA9IHtcbiAgICBob3N0OiAnNDcuOTkuMjAyLjI1NScsXG4gICAgcG9ydDogMTUwMDEsXG4gICAgcGFzc3dvcmQ6ICcxMjM0NTYnXG59XG5jb25zdCBiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdub25lJyA6ICdodHRwOi8vbG9jYWxob3N0OjgwODAnXG5jb25zdCB1cGxvYWRQYXRoID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICcvYXBwL3B1YmxpYycgOiBwYXRoLmpvaW4ocGF0aC5yZXNvbHZlKF9fZGlybmFtZSksICcuLi8uLi9wdWJsaWMnKVxuY29uc3QgSldUX1NFQ1JFVCA9ICdvbmVkYXl0aGlzaXNteWZ1dHVyZScgIC8vIOacrOadpeaYr+S4gOS4que8lueggeWQjueahOWAvO+8jOi/memHjOS9v+eUqOS6humaj+acuuWGmeeahOWtl+avjVxuLy8gZXhwb3J0IGRlZmF1bHQge1xuLy8gICAgIERCX1VSTCxcbi8vICAgICBSRURJU1xuLy8gfVxuY29uc3Qgd3NQb3J0ID0gMzAwMVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgREJfVVJMLCBSRURJUywgdXBsb2FkUGF0aCwgSldUX1NFQ1JFVCwgYmFzZVVybCwgd3NQb3J0IH0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "path",
        "require",
        "DB_URL",
        "REDIS",
        "host",
        "port",
        "password",
        "baseUrl",
        "process",
        "env",
        "NODE_ENV",
        "uploadPath",
        "join",
        "resolve",
        "__dirname",
        "JWT_SECRET",
        "wsPort",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AAEA,MAAMC,MAAM,GAAG,kDAAf;AACA,MAAMC,KAAK,GAAG;AACVC,EAAAA,IAAI,EAAE,eADI;AAEVC,EAAAA,IAAI,EAAE,KAFI;AAGVC,EAAAA,QAAQ,EAAE;AAHA,CAAd;AAKA,MAAMC,OAAO,GAAGC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,MAAxC,GAAiD,uBAAjE;AACA,MAAMC,UAAU,GAAGH,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,aAAxC,GAAwDV,IAAI,CAACY,IAAL,CAAUZ,IAAI,CAACa,OAAL,CAAaC,SAAb,CAAV,EAAmC,cAAnC,CAA3E;AACA,MAAMC,UAAU,GAAG,sBAAnB,C,CAA2C;AAC3C;AACA;AACA;AACA;;AACA,MAAMC,MAAM,GAAG,IAAf;AAEAC,MAAM,CAACC,OAAP,GAAiB;AAAEhB,EAAAA,MAAF;AAAUC,EAAAA,KAAV;AAAiBQ,EAAAA,UAAjB;AAA6BI,EAAAA,UAA7B;AAAyCR,EAAAA,OAAzC;AAAkDS,EAAAA;AAAlD,CAAjB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "const path = require('path')\n\nconst DB_URL = 'mongodb://test:123456@47.99.202.255:15001/testdb'\nconst REDIS = {\n    host: '47.99.202.255',\n    port: 15001,\n    password: '123456'\n}\nconst baseUrl = process.env.NODE_ENV === 'production' ? 'none' : 'http://localhost:8080'\nconst uploadPath = process.env.NODE_ENV === 'production' ? '/app/public' : path.join(path.resolve(__dirname), '../../public')\nconst JWT_SECRET = 'onedaythisismyfuture'  // 本来是一个编码后的值，这里使用了随机写的字母\n// export default {\n//     DB_URL,\n//     REDIS\n// }\nconst wsPort = 3001\n\nmodule.exports = { DB_URL, REDIS, uploadPath, JWT_SECRET, baseUrl, wsPort }"
      ]
    },
    "sourceType": "script",
    "mtime": 1586661426170
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/User.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/User.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/User.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/User.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "User.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst UserSchema = new Schema({\n  username: {\n    type: String,\n    index: {\n      unique: true\n    },\n    sparse: true\n  },\n  name: {\n    type: String\n  },\n  password: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  updated: {\n    type: Date\n  },\n  favs: {\n    type: Number,\n    default: 100\n  },\n  gender: {\n    type: String,\n    default: ''\n  },\n  roles: {\n    type: Array,\n    default: ['user']\n  },\n  pic: {\n    type: String,\n    default: '/img/bear-200-200.jpg'\n  },\n  // 使用的是前端的图片地址\n  mobile: {\n    type: String,\n    match: /^1[3-9](\\d{9})$/,\n    default: ''\n  },\n  status: {\n    type: String,\n    default: '0'\n  },\n  regmark: {\n    type: String,\n    default: ''\n  },\n  location: {\n    type: String,\n    default: ''\n  },\n  isVip: {\n    type: String,\n    default: '0'\n  },\n  count: {\n    type: Number,\n    default: 0\n  }\n});\nUserSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH-mm:ss');\n  next();\n});\nUserSchema.pre('update', function (next) {\n  this.updated = moment().format('YYYY-MM-DD HH-mm:ss');\n  next();\n});\nUserSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MogoError' && error.code === 11000) {\n    next(new Error('Error:Mongoose has a duplicate key.'));\n  } else {\n    next(error);\n  }\n});\nUserSchema.statics = {\n  findByID: function (id) {\n    return this.findOne({\n      _id: id\n    }, {\n      password: 0,\n      username: 0,\n      mobile: 0\n    });\n  }\n};\nconst UserModel = mongoose.model('users', UserSchema);\nmodule.exports = UserModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiVXNlclNjaGVtYSIsInVzZXJuYW1lIiwidHlwZSIsIlN0cmluZyIsImluZGV4IiwidW5pcXVlIiwic3BhcnNlIiwibmFtZSIsInBhc3N3b3JkIiwiY3JlYXRlZCIsIkRhdGUiLCJ1cGRhdGVkIiwiZmF2cyIsIk51bWJlciIsImRlZmF1bHQiLCJnZW5kZXIiLCJyb2xlcyIsIkFycmF5IiwicGljIiwibW9iaWxlIiwibWF0Y2giLCJzdGF0dXMiLCJyZWdtYXJrIiwibG9jYXRpb24iLCJpc1ZpcCIsImNvdW50IiwicHJlIiwibmV4dCIsImZvcm1hdCIsInBvc3QiLCJlcnJvciIsImRvYyIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJmaW5kQnlJRCIsImlkIiwiZmluZE9uZSIsIl9pZCIsIlVzZXJNb2RlbCIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxvQkFBRCxDQUF4Qjs7QUFDQSxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxPQUFELENBQXRCOztBQUNBLE1BQU1FLE1BQU0sR0FBQ0gsUUFBUSxDQUFDRyxNQUF0QjtBQUVBLE1BQU1DLFVBQVUsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDMUJFLEVBQUFBLFFBQVEsRUFBQztBQUFDQyxJQUFBQSxJQUFJLEVBQUNDLE1BQU47QUFBYUMsSUFBQUEsS0FBSyxFQUFDO0FBQUVDLE1BQUFBLE1BQU0sRUFBQztBQUFULEtBQW5CO0FBQWtDQyxJQUFBQSxNQUFNLEVBQUM7QUFBekMsR0FEaUI7QUFFMUJDLEVBQUFBLElBQUksRUFBQztBQUFDTCxJQUFBQSxJQUFJLEVBQUNDO0FBQU4sR0FGcUI7QUFHMUJLLEVBQUFBLFFBQVEsRUFBQztBQUFDTixJQUFBQSxJQUFJLEVBQUNDO0FBQU4sR0FIaUI7QUFJMUJNLEVBQUFB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QUhrQixLQUF0QixDQUFQO0FBS0g7QUFQZ0IsQ0FBckI7QUFVQSxNQUFNb0IsU0FBUyxHQUFDM0MsUUFBUSxDQUFDNEMsS0FBVCxDQUFlLE9BQWYsRUFBdUJ4QyxVQUF2QixDQUFoQjtBQUNBeUMsTUFBTSxDQUFDQyxPQUFQLEdBQWVILFNBQWYiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9EQkhlbHBlcicpXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCBTY2hlbWE9bW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgICB1c2VybmFtZTp7dHlwZTpTdHJpbmcsaW5kZXg6eyB1bmlxdWU6dHJ1ZX0sc3BhcnNlOnRydWV9LFxuICAgIG5hbWU6e3R5cGU6U3RyaW5nfSxcbiAgICBwYXNzd29yZDp7dHlwZTpTdHJpbmd9LFxuICAgIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIHVwZGF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIGZhdnM6IHsgdHlwZTogTnVtYmVyLGRlZmF1bHQ6MTAwIH0sXG4gICAgZ2VuZGVyOiB7IHR5cGU6IFN0cmluZyxkZWZhdWx0OicnIH0sXG4gICAgcm9sZXM6IHsgdHlwZTogQXJyYXksZGVmYXVsdDpbJ3VzZXInXSB9LFxuICAgIHBpYzogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonL2ltZy9iZWFyLTIwMC0yMDAuanBnJyB9LCAgLy8g5L2/55So55qE5piv5YmN56uv55qE5Zu+54mH5Zyw5Z2AXG4gICAgbW9iaWxlOiB7IHR5cGU6IFN0cmluZyxtYXRjaDovXjFbMy05XShcXGR7OX0pJC8sZGVmYXVsdDonJyB9LFxuICAgIHN0YXR1czogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonMCcgfSxcbiAgICByZWdtYXJrOiB7IHR5cGU6IFN0cmluZyxkZWZhdWx0OicnIH0sXG4gICAgbG9jYXRpb246IHsgdHlwZTogU3RyaW5nLGRlZmF1bHQ6JycgfSxcbiAgICBpc1ZpcDogeyB0eXBlOiBTdHJpbmcsZGVmYXVsdDonMCcgfSxcbiAgICBjb3VudDogeyB0eXBlOiBOdW1iZXIsZGVmYXVsdDowIH0sXG59KVxuXG5Vc2VyU2NoZW1hLnByZSgnc2F2ZScsZnVuY3Rpb24obmV4dCl7XG4gICAgdGhpcy5jcmVhdGVkPW1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCBISC1tbTpzcycpXG4gICAgbmV4dCgpXG59KVxuXG5Vc2VyU2NoZW1hLnByZSgndXBkYXRlJyxmdW5jdGlvbihuZXh0KXtcbiAgICB0aGlzLnVwZGF0ZWQ9bW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhILW1tOnNzJylcbiAgICBuZXh0KClcbn0pXG5cblVzZXJTY2hlbWEucG9zdCgnc2F2ZScsZnVuY3Rpb24oZXJyb3IsZG9jLG5leHQpe1xuICAgIGlmKGVycm9yLm5hbWUgPT09ICdNb2dvRXJyb3InICYmIGVycm9yLmNvZGU9PT0xMTAwMCl7XG4gICAgICAgIG5leHQobmV3IEVycm9yKCdFcnJvcjpNb25nb29zZSBoYXMgYSBkdXBsaWNhdGUga2V5LicpKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIG5leHQoZXJyb3IpXG4gICAgfVxufSlcblxuVXNlclNjaGVtYS5zdGF0aWNzID0ge1xuICAgIGZpbmRCeUlEOiBmdW5jdGlvbihpZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5maW5kT25lKHtfaWQ6aWR9LHtcbiAgICAgICAgICAgIHBhc3N3b3JkOiAwLFxuICAgICAgICAgICAgdXNlcm5hbWU6MCxcbiAgICAgICAgICAgIG1vYmlsZTowXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5jb25zdCBVc2VyTW9kZWw9bW9uZ29vc2UubW9kZWwoJ3VzZXJzJyxVc2VyU2NoZW1hKVxubW9kdWxlLmV4cG9ydHM9VXNlck1vZGVsIl19",
    "map": {
      "version": 3,
      "sources": [
        "User.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "UserSchema",
        "username",
        "type",
        "String",
        "index",
        "unique",
        "sparse",
        "name",
        "password",
        "created",
        "Date",
        "updated",
        "favs",
        "Number",
        "default",
        "gender",
        "roles",
        "Array",
        "pic",
        "mobile",
        "match",
        "status",
        "regmark",
        "location",
        "isVip",
        "count",
        "pre",
        "next",
        "format",
        "post",
        "error",
        "doc",
        "code",
        "Error",
        "statics",
        "findByID",
        "id",
        "findOne",
        "_id",
        "UserModel",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\nconst Schema=mongoose.Schema\n\nconst UserSchema = new Schema({\n    username:{type:String,index:{ unique:true},sparse:true},\n    name:{type:String},\n    password:{type:String},\n    created: { type: Date },\n    updated: { type: Date },\n    favs: { type: Number,default:100 },\n    gender: { type: String,default:'' },\n    roles: { type: Array,default:['user'] },\n    pic: { type: String,default:'/img/bear-200-200.jpg' },  // 使用的是前端的图片地址\n    mobile: { type: String,match:/^1[3-9](\\d{9})$/,default:'' },\n    status: { type: String,default:'0' },\n    regmark: { type: String,default:'' },\n    location: { type: String,default:'' },\n    isVip: { type: String,default:'0' },\n    count: { type: Number,default:0 },\n})\n\nUserSchema.pre('save',function(next){\n    this.created=moment().format('YYYY-MM-DD HH-mm:ss')\n    next()\n})\n\nUserSchema.pre('update',function(next){\n    this.updated=moment().format('YYYY-MM-DD HH-mm:ss')\n    next()\n})\n\nUserSchema.post('save',function(error,doc,next){\n    if(error.name === 'MogoError' && error.code===11000){\n        next(new Error('Error:Mongoose has a duplicate key.'))\n    } else {\n        next(error)\n    }\n})\n\nUserSchema.statics = {\n    findByID: function(id) {\n        return this.findOne({_id:id},{\n            password: 0,\n            username:0,\n            mobile:0\n        })\n    }\n}\n\nconst UserModel=mongoose.model('users',UserSchema)\nmodule.exports=UserModel"
      ]
    },
    "sourceType": "script",
    "mtime": 1586353993439
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/Utils.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/Utils.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/Utils.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/Utils.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
        "sourceFileName": "Utils.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst redisConfig = require('../config/RedisConfig');\n\nconst config = require('../config/index');\n\nconst jwt = require('jsonwebtoken');\n\nvar getJWTPayload = function (token) {\n  console.log(\"secret->secret\", token.split('')[1]);\n  return jwt.verify(token.split(' ')[1], config.JWT_SECRET);\n};\n\nasync function checkCode(key, value) {\n  console.log(\"checkCode -> checkCode\", checkCode);\n  const redisData = await redisConfig.getValue(key);\n  console.log(\"checkCode -> redisData\", redisData);\n\n  if (redisData != null) {\n    debugger;\n\n    if (redisData.toLowerCase() === value.toLowerCase()) {\n      return true;\n    } else {\n      return false;\n    }\n  } else {\n    return false;\n  }\n}\n\nexports.getJWTPayload = getJWTPayload;\nexports.checkCode = checkCode;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlV0aWxzLmpzIl0sIm5hbWVzIjpbInJlZGlzQ29uZmlnIiwicmVxdWlyZSIsImNvbmZpZyIsImp3dCIsImdldEpXVFBheWxvYWQiLCJ0b2tlbiIsImNvbnNvbGUiLCJsb2ciLCJzcGxpdCIsInZlcmlmeSIsIkpXVF9TRUNSRVQiLCJjaGVja0NvZGUiLCJrZXkiLCJ2YWx1ZSIsInJlZGlzRGF0YSIsImdldFZhbHVlIiwidG9Mb3dlckNhc2UiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFdBQVcsR0FBR0MsT0FBTyxDQUFDLHVCQUFELENBQTNCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLGlCQUFELENBQXRCOztBQUNBLE1BQU1FLEdBQUcsR0FBR0YsT0FBTyxDQUFDLGNBQUQsQ0FBbkI7O0FBRUEsSUFBSUcsYUFBYSxHQUFHLFVBQVVDLEtBQVYsRUFBaUI7QUFDakNDLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLGdCQUFaLEVBQThCRixLQUFLLENBQUNHLEtBQU4sQ0FBWSxFQUFaLEVBQWdCLENBQWhCLENBQTlCO0FBQ0EsU0FBT0wsR0FBRyxDQUFDTSxNQUFKLENBQVdKLEtBQUssQ0FBQ0csS0FBTixDQUFZLEdBQVosRUFBaUIsQ0FBakIsQ0FBWCxFQUFnQ04sTUFBTSxDQUFDUSxVQUF2QyxDQUFQO0FBQ0gsQ0FIRDs7QUFLQSxlQUFlQyxTQUFmLENBQTBCQyxHQUExQixFQUErQkMsS0FBL0IsRUFBc0M7QUFDbENQLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaLEVBQXNDSSxTQUF0QztBQUNBLFFBQU1HLFNBQVMsR0FBRyxNQUFNZCxXQUFXLENBQUNlLFFBQVosQ0FBcUJILEdBQXJCLENBQXhCO0FBQ0FOLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHdCQUFaLEVBQXNDTyxTQUF0Qzs7QUFDQSxNQUFJQSxTQUFTLElBQUksSUFBakIsRUFBdUI7QUFDbkI7O0FBQ0EsUUFBSUEsU0FBUyxDQUFDRSxXQUFWLE9BQTRCSCxLQUFLLENBQUNHLFdBQU4sRUFBaEMsRUFBcUQ7QUFDakQsYUFBTyxJQUFQO0FBQ0gsS0FGRCxNQUVPO0FBQ0gsYUFBTyxLQUFQO0FBQ0g7QUFDSixHQVBELE1BT087QUFDSCxXQUFPLEtBQVA7QUFDSDtBQUNKOztBQUVEQyxPQUFPLENBQUNiLGFBQVIsR0FBd0JBLGFBQXhCO0FBQ0FhLE9BQU8sQ0FBQ04sU0FBUixHQUFvQkEsU0FBcEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvY29tbW9uIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcmVkaXNDb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcvUmVkaXNDb25maWcnKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4JylcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpXG5cbnZhciBnZXRKV1RQYXlsb2FkID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgY29uc29sZS5sb2coXCJzZWNyZXQtPnNlY3JldFwiLCB0b2tlbi5zcGxpdCgnJylbMV0pXG4gICAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4uc3BsaXQoJyAnKVsxXSwgY29uZmlnLkpXVF9TRUNSRVQpXG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNoZWNrQ29kZSAoa2V5LCB2YWx1ZSkge1xuICAgIGNvbnNvbGUubG9nKFwiY2hlY2tDb2RlIC0+IGNoZWNrQ29kZVwiLCBjaGVja0NvZGUpXG4gICAgY29uc3QgcmVkaXNEYXRhID0gYXdhaXQgcmVkaXNDb25maWcuZ2V0VmFsdWUoa2V5KVxuICAgIGNvbnNvbGUubG9nKFwiY2hlY2tDb2RlIC0+IHJlZGlzRGF0YVwiLCByZWRpc0RhdGEpXG4gICAgaWYgKHJlZGlzRGF0YSAhPSBudWxsKSB7XG4gICAgICAgIGRlYnVnZ2VyXG4gICAgICAgIGlmIChyZWRpc0RhdGEudG9Mb3dlckNhc2UoKSA9PT0gdmFsdWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxufVxuXG5leHBvcnRzLmdldEpXVFBheWxvYWQgPSBnZXRKV1RQYXlsb2FkO1xuZXhwb3J0cy5jaGVja0NvZGUgPSBjaGVja0NvZGU7Il19",
    "map": {
      "version": 3,
      "sources": [
        "Utils.js"
      ],
      "names": [
        "redisConfig",
        "require",
        "config",
        "jwt",
        "getJWTPayload",
        "token",
        "console",
        "log",
        "split",
        "verify",
        "JWT_SECRET",
        "checkCode",
        "key",
        "value",
        "redisData",
        "getValue",
        "toLowerCase",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,WAAW,GAAGC,OAAO,CAAC,uBAAD,CAA3B;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,iBAAD,CAAtB;;AACA,MAAME,GAAG,GAAGF,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAIG,aAAa,GAAG,UAAUC,KAAV,EAAiB;AACjCC,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,KAAK,CAACG,KAAN,CAAY,EAAZ,EAAgB,CAAhB,CAA9B;AACA,SAAOL,GAAG,CAACM,MAAJ,CAAWJ,KAAK,CAACG,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAX,EAAgCN,MAAM,CAACQ,UAAvC,CAAP;AACH,CAHD;;AAKA,eAAeC,SAAf,CAA0BC,GAA1B,EAA+BC,KAA/B,EAAsC;AAClCP,EAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCI,SAAtC;AACA,QAAMG,SAAS,GAAG,MAAMd,WAAW,CAACe,QAAZ,CAAqBH,GAArB,CAAxB;AACAN,EAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsCO,SAAtC;;AACA,MAAIA,SAAS,IAAI,IAAjB,EAAuB;AACnB;;AACA,QAAIA,SAAS,CAACE,WAAV,OAA4BH,KAAK,CAACG,WAAN,EAAhC,EAAqD;AACjD,aAAO,IAAP;AACH,KAFD,MAEO;AACH,aAAO,KAAP;AACH;AACJ,GAPD,MAOO;AACH,WAAO,KAAP;AACH;AACJ;;AAEDC,OAAO,CAACb,aAAR,GAAwBA,aAAxB;AACAa,OAAO,CAACN,SAAR,GAAoBA,SAApB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
      "sourcesContent": [
        "const redisConfig = require('../config/RedisConfig')\nconst config = require('../config/index')\nconst jwt = require('jsonwebtoken')\n\nvar getJWTPayload = function (token) {\n    console.log(\"secret->secret\", token.split('')[1])\n    return jwt.verify(token.split(' ')[1], config.JWT_SECRET)\n}\n\nasync function checkCode (key, value) {\n    console.log(\"checkCode -> checkCode\", checkCode)\n    const redisData = await redisConfig.getValue(key)\n    console.log(\"checkCode -> redisData\", redisData)\n    if (redisData != null) {\n        debugger\n        if (redisData.toLowerCase() === value.toLowerCase()) {\n            return true\n        } else {\n            return false\n        }\n    } else {\n        return false\n    }\n}\n\nexports.getJWTPayload = getJWTPayload;\nexports.checkCode = checkCode;"
      ]
    },
    "sourceType": "script",
    "mtime": 1584589663148
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/UserCollect.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/UserCollect.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/UserCollect.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/UserCollect.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "UserCollect.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst moogoose = require('../config/DBHelper');\n\nconst Schema = moogoose.Schema;\nconst UserCollectSchema = new Schema({\n  uid: {\n    type: String\n  },\n  tid: {\n    type: String\n  },\n  title: {\n    type: String\n  },\n  created: {\n    type: Date\n  }\n});\nUserCollectSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nUserCollectSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nUserCollectSchema.statics = {\n  getListByUid: function (id, page, limit) {\n    return this.find({\n      uid: id\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  countByUid: function (id) {\n    return this.find({\n      uid: id\n    }).countDocuments();\n  }\n};\nconst UserCollect = moogoose.model('user_collect', UserCollectSchema);\nmodule.exports = UserCollect;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb2xsZWN0LmpzIl0sIm5hbWVzIjpbIm1vb2dvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIlVzZXJDb2xsZWN0U2NoZW1hIiwidWlkIiwidHlwZSIsIlN0cmluZyIsInRpZCIsInRpdGxlIiwiY3JlYXRlZCIsIkRhdGUiLCJwcmUiLCJuZXh0IiwicG9zdCIsImVycm9yIiwiZG9jIiwibmFtZSIsImNvZGUiLCJFcnJvciIsInN0YXRpY3MiLCJnZXRMaXN0QnlVaWQiLCJpZCIsInBhZ2UiLCJsaW1pdCIsImZpbmQiLCJza2lwIiwic29ydCIsImNvdW50QnlVaWQiLCJjb3VudERvY3VtZW50cyIsIlVzZXJDb2xsZWN0IiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFELENBQXhCOztBQUVBLE1BQU1DLE1BQU0sR0FBR0YsUUFBUSxDQUFDRSxNQUF4QjtBQUVBLE1BQU1DLGlCQUFpQixHQUFHLElBQUlELE1BQUosQ0FBVztBQUNqQ0UsRUFBQUEsR0FBRyxFQUFFO0FBQUVDLElBQUFBLElBQUksRUFBRUM7QUFBUixHQUQ0QjtBQUVqQ0MsRUFBQUEsR0FBRyxFQUFFO0FBQUVGLElBQUFBLElBQUksRUFBRUM7QUFBUixHQUY0QjtBQUdqQ0UsRUFBQUEsS0FBSyxFQUFFO0FBQUVILElBQUFBLElBQUksRUFBRUM7QUFBUixHQUgwQjtBQUlqQ0csRUFBQUEsT0FBTyxFQUFFO0FBQUVKLElBQUFBLElBQUksRUFBRUs7QUFBUjtBQUp3QixDQUFYLENBQTFCO0FBT0FQLGlCQUFpQixDQUFDUSxHQUFsQixDQUFzQixNQUF0QixFQUE4QixVQUFVQyxJQUFWLEVBQWdCO0FBQzFDLE9BQUtILE9BQUwsR0FBZSxJQUFJQyxJQUFKLEVBQWY7QUFDQUUsRUFBQUEsSUFBSTtBQUNQLENBSEQ7QUFLQVQsaUJBQWlCLENBQUNVLElBQWxCLENBQXVCLE1BQXZCLEVBQStCLFVBQVVDLEtBQVYsRUFBaUJDLEdBQWpCLEVBQXNCSCxJQUF0QixFQUE0QjtBQUN2RCxNQUFJRSxLQUFLLENBQUNFLElBQU4sS0FBZSxZQUFmLElBQStCRixLQUFLLENBQUNHLElBQU4sS0FBZSxLQUFsRCxFQUF5RDtBQUNyREwsSUFBQUEsSUFBSSxDQUFDLElBQUlNLEtBQUosQ0FBVSxpQ0FBVixDQUFELENBQUo7QUFDSCxHQUZELE1BRU87QUFDSE4sSUFBQUEsSUFBSSxDQUFDRSxLQUFELENBQUo7QUFDSDtBQUNKLENBTkQ7QUFRQVgsaUJBQWlCLENBQUNnQixPQUFsQixHQUE0QjtBQUN4QkMsRUFBQUEsWUFBWSxFQUFFLFVBQVVDLEVBQVYsRUFBY0MsSUFBZCxFQUFvQkMsS0FBcEIsRUFBMkI7QUFDckMsV0FBTyxLQUFLQyxJQUFMLENBQVU7QUFBRXBCLE1BQUFBLEdBQUcsRUFBRWlCO0FBQVAsS0FBVixFQUNGSSxJQURFLENBQ0dGLEtBQUssR0FBR0QsSUFEWCxFQUVGQyxLQUZFLENBRUlBLEtBRkosRUFHRkcsSUFIRSxDQUdHO0FBQUVqQixNQUFBQSxPQUFPLEVBQUUsQ0FBQztBQUFaLEtBSEgsQ0FBUDtBQUlILEdBTnVCO0FBT3hCa0IsRUFBQUEsVUFBVSxFQUFFLFVBQVVOLEVBQVYsRUFBYztBQUN0QixXQUFPLEtBQUtHLElBQUwsQ0FBVTtBQUFFcEIsTUFBQUEsR0FBRyxFQUFFaUI7QUFBUCxLQUFWLEVBQXVCTyxjQUF2QixFQUFQO0FBQ0g7QUFUdUIsQ0FBNUI7QUFXQSxNQUFNQyxXQUFXLEdBQUc3QixRQUFRLENBQUM4QixLQUFULENBQWUsY0FBZixFQUErQjNCLGlCQUEvQixDQUFwQjtBQUVBNEIsTUFBTSxDQUFDQyxPQUFQLEdBQWVILFdBQWYiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvbW9kZWwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb29nb29zZSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9EQkhlbHBlcicpXG5cbmNvbnN0IFNjaGVtYSA9IG1vb2dvb3NlLlNjaGVtYVxuXG5jb25zdCBVc2VyQ29sbGVjdFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHVpZDogeyB0eXBlOiBTdHJpbmcgfSxcbiAgICB0aWQ6IHsgdHlwZTogU3RyaW5nIH0sXG4gICAgdGl0bGU6IHsgdHlwZTogU3RyaW5nIH0sXG4gICAgY3JlYXRlZDogeyB0eXBlOiBEYXRlIH0sXG59KVxuXG5Vc2VyQ29sbGVjdFNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICAgIHRoaXMuY3JlYXRlZCA9IG5ldyBEYXRlKClcbiAgICBuZXh0KClcbn0pXG5cblVzZXJDb2xsZWN0U2NoZW1hLnBvc3QoJ3NhdmUnLCBmdW5jdGlvbiAoZXJyb3IsIGRvYywgbmV4dCkge1xuICAgIGlmIChlcnJvci5uYW1lID09PSAnTW9uZ29FcnJvcicgJiYgZXJyb3IuY29kZSA9PT0gMTEwMDApIHtcbiAgICAgICAgbmV4dChuZXcgRXJyb3IoJ1RoZXJlIHdhcyBhIGR1cGxpY2F0ZSBrZXkgZXJyb3InKSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0KGVycm9yKVxuICAgIH1cbn0pXG5cblVzZXJDb2xsZWN0U2NoZW1hLnN0YXRpY3MgPSB7XG4gICAgZ2V0TGlzdEJ5VWlkOiBmdW5jdGlvbiAoaWQsIHBhZ2UsIGxpbWl0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkIH0pXG4gICAgICAgICAgICAuc2tpcChsaW1pdCAqIHBhZ2UpXG4gICAgICAgICAgICAubGltaXQobGltaXQpXG4gICAgICAgICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gICAgfSxcbiAgICBjb3VudEJ5VWlkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZCh7IHVpZDogaWQgfSkuY291bnREb2N1bWVudHMoKVxuICAgIH1cbn1cbmNvbnN0IFVzZXJDb2xsZWN0ID0gbW9vZ29vc2UubW9kZWwoJ3VzZXJfY29sbGVjdCcsIFVzZXJDb2xsZWN0U2NoZW1hKVxuXG5tb2R1bGUuZXhwb3J0cz1Vc2VyQ29sbGVjdCJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "UserCollect.js"
      ],
      "names": [
        "moogoose",
        "require",
        "Schema",
        "UserCollectSchema",
        "uid",
        "type",
        "String",
        "tid",
        "title",
        "created",
        "Date",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "getListByUid",
        "id",
        "page",
        "limit",
        "find",
        "skip",
        "sort",
        "countByUid",
        "countDocuments",
        "UserCollect",
        "model",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AAEA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AAEA,MAAMC,iBAAiB,GAAG,IAAID,MAAJ,CAAW;AACjCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC;AAAR,GAD4B;AAEjCC,EAAAA,GAAG,EAAE;AAAEF,IAAAA,IAAI,EAAEC;AAAR,GAF4B;AAGjCE,EAAAA,KAAK,EAAE;AAAEH,IAAAA,IAAI,EAAEC;AAAR,GAH0B;AAIjCG,EAAAA,OAAO,EAAE;AAAEJ,IAAAA,IAAI,EAAEK;AAAR;AAJwB,CAAX,CAA1B;AAOAP,iBAAiB,CAACQ,GAAlB,CAAsB,MAAtB,EAA8B,UAAUC,IAAV,EAAgB;AAC1C,OAAKH,OAAL,GAAe,IAAIC,IAAJ,EAAf;AACAE,EAAAA,IAAI;AACP,CAHD;AAKAT,iBAAiB,CAACU,IAAlB,CAAuB,MAAvB,EAA+B,UAAUC,KAAV,EAAiBC,GAAjB,EAAsBH,IAAtB,EAA4B;AACvD,MAAIE,KAAK,CAACE,IAAN,KAAe,YAAf,IAA+BF,KAAK,CAACG,IAAN,KAAe,KAAlD,EAAyD;AACrDL,IAAAA,IAAI,CAAC,IAAIM,KAAJ,CAAU,iCAAV,CAAD,CAAJ;AACH,GAFD,MAEO;AACHN,IAAAA,IAAI,CAACE,KAAD,CAAJ;AACH;AACJ,CAND;AAQAX,iBAAiB,CAACgB,OAAlB,GAA4B;AACxBC,EAAAA,YAAY,EAAE,UAAUC,EAAV,EAAcC,IAAd,EAAoBC,KAApB,EAA2B;AACrC,WAAO,KAAKC,IAAL,CAAU;AAAEpB,MAAAA,GAAG,EAAEiB;AAAP,KAAV,EACFI,IADE,CACGF,KAAK,GAAGD,IADX,EAEFC,KAFE,CAEIA,KAFJ,EAGFG,IAHE,CAGG;AAAEjB,MAAAA,OAAO,EAAE,CAAC;AAAZ,KAHH,CAAP;AAIH,GANuB;AAOxBkB,EAAAA,UAAU,EAAE,UAAUN,EAAV,EAAc;AACtB,WAAO,KAAKG,IAAL,CAAU;AAAEpB,MAAAA,GAAG,EAAEiB;AAAP,KAAV,EAAuBO,cAAvB,EAAP;AACH;AATuB,CAA5B;AAWA,MAAMC,WAAW,GAAG7B,QAAQ,CAAC8B,KAAT,CAAe,cAAf,EAA+B3B,iBAA/B,CAApB;AAEA4B,MAAM,CAACC,OAAP,GAAeH,WAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "const moogoose = require('../config/DBHelper')\n\nconst Schema = moogoose.Schema\n\nconst UserCollectSchema = new Schema({\n    uid: { type: String },\n    tid: { type: String },\n    title: { type: String },\n    created: { type: Date },\n})\n\nUserCollectSchema.pre('save', function (next) {\n    this.created = new Date()\n    next()\n})\n\nUserCollectSchema.post('save', function (error, doc, next) {\n    if (error.name === 'MongoError' && error.code === 11000) {\n        next(new Error('There was a duplicate key error'))\n    } else {\n        next(error)\n    }\n})\n\nUserCollectSchema.statics = {\n    getListByUid: function (id, page, limit) {\n        return this.find({ uid: id })\n            .skip(limit * page)\n            .limit(limit)\n            .sort({ created: -1 })\n    },\n    countByUid: function (id) {\n        return this.find({ uid: id }).countDocuments()\n    }\n}\nconst UserCollect = moogoose.model('user_collect', UserCollectSchema)\n\nmodule.exports=UserCollect"
      ]
    },
    "sourceType": "script",
    "mtime": 1586009564419
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/CommentController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/CommentController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/CommentController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/CommentController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "CommentController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst {\n  checkCode,\n  getJWTPayload\n} = require('../common/Utils'); // const User = require('../model/User')\n\n\nconst Comments = require('../model/Comments');\n\nconst Post = require('../model/Post');\n\nasync function addComment(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"addComment -> body\", body);\n  const sid = body.sid;\n  const code = body.code;\n  const result = await checkCode(sid, code);\n\n  if (result) {\n    const newComments = new Comments(body);\n    const obj = await getJWTPayload(ctx.header.authorization);\n    newComments.cuid = obj._id;\n    const post = await Post.findOne({\n      _id: body.tid\n    });\n    newComments.uid = post.uid;\n    const comment = await newComments.save(); // const num = await Comments.getTotal(post.uid)\n\n    const updatePostresult = await Post.updateOne({\n      _id: body.tid\n    }, {\n      $inc: {\n        answer: 1\n      }\n    }); // const user = await User.findById({ _id: obj._id })\n    // if(user.favs<body.fav) {\n    //     ctx.body = {\n    //         code:501,\n    //         msg:'积分不足'\n    //     }\n    //     return \n    // } else {\n    //     await User.updateOne({_id:obj._id},{$inc:{favs:-body.fav}})\n    // }\n\n    if (comment._id && updatePostresult.ok === 1) {\n      ctx.body = {\n        code: 200,\n        msg: '成功发表评论',\n        date: comment\n      };\n    } else {\n      ctx.body = {\n        code: 500,\n        msg: '评论失败'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '图片验证码验证失败'\n    };\n  }\n} // 获取评论列表\n\n\nasync function getComments(ctx) {\n  console.log('getComments');\n  const params = ctx.query;\n  const tid = params.tid;\n  console.log(\"getComments -> tid\", tid);\n  const page = params.page ? params.page : 0;\n  const limit = params.limit ? parseInt(params.limit) : 10;\n  let result = await Comments.getCommentsList(tid, page, limit);\n  console.log(\"getComments -> result\", result); // 判断用户是否登录，已登录的用户才去判断点赞信息\n  // let obj = {}\n  // if (typeof ctx.header.authorization !== 'undefined') {\n  //     obj = await getJWTPayload(ctx.header.authorization)\n  // }\n  // if (typeof obj._id !== 'undefined') {\n  //     result = result.map(item => item.toJSON())\n  //     for (let i = 0; i < result.length; i++) {\n  //         let item = result[i]\n  //         item.handed = '0'\n  //         const commentsHands = await CommentsHands.findOne({ cid: item._id, uid: obj._id })\n  //         if (commentsHands && commentsHands.cid) {\n  //             if (commentsHands.uid === obj._id) {\n  //                 item.handed = '1'\n  //             }\n  //         }\n  //     }\n  // }\n\n  const total = await Comments.queryCount(tid);\n  console.log(\"getComments -> total\", total);\n  ctx.body = {\n    code: 200,\n    total,\n    data: result,\n    msg: '查询成功'\n  };\n}\n\nmodule.exports = {\n  addComment,\n  getComments\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnRDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImNoZWNrQ29kZSIsImdldEpXVFBheWxvYWQiLCJyZXF1aXJlIiwiQ29tbWVudHMiLCJQb3N0IiwiYWRkQ29tbWVudCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsInNpZCIsImNvZGUiLCJyZXN1bHQiLCJuZXdDb21tZW50cyIsIm9iaiIsImhlYWRlciIsImF1dGhvcml6YXRpb24iLCJjdWlkIiwiX2lkIiwicG9zdCIsImZpbmRPbmUiLCJ0aWQiLCJ1aWQiLCJjb21tZW50Iiwic2F2ZSIsInVwZGF0ZVBvc3RyZXN1bHQiLCJ1cGRhdGVPbmUiLCIkaW5jIiwiYW5zd2VyIiwib2siLCJtc2ciLCJkYXRlIiwiZ2V0Q29tbWVudHMiLCJwYXJhbXMiLCJxdWVyeSIsInBhZ2UiLCJsaW1pdCIsInBhcnNlSW50IiwiZ2V0Q29tbWVudHNMaXN0IiwidG90YWwiLCJxdWVyeUNvdW50IiwiZGF0YSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTTtBQUFFQSxFQUFBQSxTQUFGO0FBQWFDLEVBQUFBO0FBQWIsSUFBK0JDLE9BQU8sQ0FBQyxpQkFBRCxDQUE1QyxDLENBQ0E7OztBQUNBLE1BQU1DLFFBQVEsR0FBR0QsT0FBTyxDQUFDLG1CQUFELENBQXhCOztBQUNBLE1BQU1FLElBQUksR0FBR0YsT0FBTyxDQUFDLGVBQUQsQ0FBcEI7O0FBRUEsZUFBZUcsVUFBZixDQUEyQkMsR0FBM0IsRUFBZ0M7QUFDNUIsUUFBTTtBQUFFQyxJQUFBQTtBQUFGLE1BQVdELEdBQUcsQ0FBQ0UsT0FBckI7QUFDQUMsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksb0JBQVosRUFBa0NILElBQWxDO0FBQ0EsUUFBTUksR0FBRyxHQUFHSixJQUFJLENBQUNJLEdBQWpCO0FBQ0EsUUFBTUMsSUFBSSxHQUFHTCxJQUFJLENBQUNLLElBQWxCO0FBQ0EsUUFBTUMsTUFBTSxHQUFH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TyxDQUFDQyxHQUFSLENBQVksc0JBQVosRUFBb0M4QixLQUFwQztBQUNBbEMsRUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEssSUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUDRCLElBQUFBLEtBRk87QUFHUEUsSUFBQUEsSUFBSSxFQUFFN0IsTUFIQztBQUlQa0IsSUFBQUEsR0FBRyxFQUFFO0FBSkUsR0FBWDtBQU1IOztBQUVEWSxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRXZDLEVBQUFBLFVBQUY7QUFBYzRCLEVBQUFBO0FBQWQsQ0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvYXBpIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBjaGVja0NvZGUsIGdldEpXVFBheWxvYWQgfSA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG4vLyBjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vbW9kZWwvVXNlcicpXG5jb25zdCBDb21tZW50cyA9IHJlcXVpcmUoJy4uL21vZGVsL0NvbW1lbnRzJylcbmNvbnN0IFBvc3QgPSByZXF1aXJlKCcuLi9tb2RlbC9Qb3N0JylcblxuYXN5bmMgZnVuY3Rpb24gYWRkQ29tbWVudCAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwiYWRkQ29tbWVudCAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgc2lkID0gYm9keS5zaWRcbiAgICBjb25zdCBjb2RlID0gYm9keS5jb2RlXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hlY2tDb2RlKHNpZCwgY29kZSlcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IG5ld0NvbW1lbnRzID0gbmV3IENvbW1lbnRzKGJvZHkpXG4gICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgICAgICBuZXdDb21tZW50cy5jdWlkID0gb2JqLl9pZFxuXG4gICAgICAgIGNvbnN0IHBvc3QgPSBhd2FpdCBQb3N0LmZpbmRPbmUoeyBfaWQ6IGJvZHkudGlkIH0pXG4gICAgICAgIG5ld0NvbW1lbnRzLnVpZCA9IHBvc3QudWlkXG4gICAgICAgIGNvbnN0IGNvbW1lbnQgPSBhd2FpdCBuZXdDb21tZW50cy5zYXZlKClcbiAgICAgICAgLy8gY29uc3QgbnVtID0gYXdhaXQgQ29tbWVudHMuZ2V0VG90YWwocG9zdC51aWQpXG5cbiAgICAgICAgY29uc3QgdXBkYXRlUG9zdHJlc3VsdCA9IGF3YWl0IFBvc3QudXBkYXRlT25lKHsgX2lkOiBib2R5LnRpZCB9LCB7ICRpbmM6IHsgYW5zd2VyOiAxIH0gfSlcblxuICAgICAgICAvLyBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJZCh7IF9pZDogb2JqLl9pZCB9KVxuICAgICAgICAvLyBpZih1c2VyLmZhdnM8Ym9keS5mYXYpIHtcbiAgICAgICAgLy8gICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAvLyAgICAgICAgIGNvZGU6NTAxLFxuICAgICAgICAvLyAgICAgICAgIG1zZzon56ev5YiG5LiN6LazJ1xuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyAgICAgcmV0dXJuIFxuICAgICAgICAvLyB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgYXdhaXQgVXNlci51cGRhdGVPbmUoe19pZDpvYmouX2lkfSx7JGluYzp7ZmF2czotYm9keS5mYXZ9fSlcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIGlmIChjb21tZW50Ll9pZCAmJiB1cGRhdGVQb3N0cmVzdWx0Lm9rID09PSAxKSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICAgICAgbXNnOiAn5oiQ5Yqf5Y+R6KGo6K+E6K66JyxcbiAgICAgICAgICAgICAgICBkYXRlOiBjb21tZW50XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICAgICAgbXNnOiAn6K+E6K665aSx6LSlJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICflm77niYfpqozor4HnoIHpqozor4HlpLHotKUnXG5cbiAgICAgICAgfVxuICAgIH1cbn1cblxuLy8g6I635Y+W6K+E6K665YiX6KGoXG5hc3luYyBmdW5jdGlvbiBnZXRDb21tZW50cyAoY3R4KSB7XG4gICAgY29uc29sZS5sb2coJ2dldENvbW1lbnRzJylcbiAgICBjb25zdCBwYXJhbXMgPSBjdHgucXVlcnlcbiAgICBjb25zdCB0aWQgPSBwYXJhbXMudGlkXG4gICAgY29uc29sZS5sb2coXCJnZXRDb21tZW50cyAtPiB0aWRcIiwgdGlkKVxuICAgIGNvbnN0IHBhZ2UgPSBwYXJhbXMucGFnZSA/IHBhcmFtcy5wYWdlIDogMFxuICAgIGNvbnN0IGxpbWl0ID0gcGFyYW1zLmxpbWl0ID8gcGFyc2VJbnQocGFyYW1zLmxpbWl0KSA6IDEwXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IENvbW1lbnRzLmdldENvbW1lbnRzTGlzdCh0aWQsIHBhZ2UsIGxpbWl0KVxuICAgIGNvbnNvbGUubG9nKFwiZ2V0Q29tbWVudHMgLT4gcmVzdWx0XCIsIHJlc3VsdClcbiAgICAvLyDliKTmlq3nlKjmiLfmmK/lkKbnmbvlvZXvvIzlt7LnmbvlvZXnmoTnlKjmiLfmiY3ljrvliKTmlq3ngrnotZ7kv6Hmga9cbiAgICAvLyBsZXQgb2JqID0ge31cbiAgICAvLyBpZiAodHlwZW9mIGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyAgICAgb2JqID0gYXdhaXQgZ2V0SldUUGF5bG9hZChjdHguaGVhZGVyLmF1dGhvcml6YXRpb24pXG4gICAgLy8gfVxuICAgIC8vIGlmICh0eXBlb2Ygb2JqLl9pZCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyAgICAgcmVzdWx0ID0gcmVzdWx0Lm1hcChpdGVtID0+IGl0ZW0udG9KU09OKCkpXG4gICAgLy8gICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gICAgICAgICBsZXQgaXRlbSA9IHJlc3VsdFtpXVxuICAgIC8vICAgICAgICAgaXRlbS5oYW5kZWQgPSAnMCdcbiAgICAvLyAgICAgICAgIGNvbnN0IGNvbW1lbnRzSGFuZHMgPSBhd2FpdCBDb21tZW50c0hhbmRzLmZpbmRPbmUoeyBjaWQ6IGl0ZW0uX2lkLCB1aWQ6IG9iai5faWQgfSlcbiAgICAvLyAgICAgICAgIGlmIChjb21tZW50c0hhbmRzICYmIGNvbW1lbnRzSGFuZHMuY2lkKSB7XG4gICAgLy8gICAgICAgICAgICAgaWYgKGNvbW1lbnRzSGFuZHMudWlkID09PSBvYmouX2lkKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgIGl0ZW0uaGFuZGVkID0gJzEnXG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICB9XG4gICAgLy8gfVxuICAgIGNvbnN0IHRvdGFsID0gYXdhaXQgQ29tbWVudHMucXVlcnlDb3VudCh0aWQpXG4gICAgY29uc29sZS5sb2coXCJnZXRDb21tZW50cyAtPiB0b3RhbFwiLCB0b3RhbClcbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICB0b3RhbCxcbiAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICBtc2c6ICfmn6Xor6LmiJDlip8nXG4gICAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHsgYWRkQ29tbWVudCwgZ2V0Q29tbWVudHMgfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "CommentController.js"
      ],
      "names": [
        "checkCode",
        "getJWTPayload",
        "require",
        "Comments",
        "Post",
        "addComment",
        "ctx",
        "body",
        "request",
        "console",
        "log",
        "sid",
        "code",
        "result",
        "newComments",
        "obj",
        "header",
        "authorization",
        "cuid",
        "_id",
        "post",
        "findOne",
        "tid",
        "uid",
        "comment",
        "save",
        "updatePostresult",
        "updateOne",
        "$inc",
        "answer",
        "ok",
        "msg",
        "date",
        "getComments",
        "params",
        "query",
        "page",
        "limit",
        "parseInt",
        "getCommentsList",
        "total",
        "queryCount",
        "data",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "const { checkCode, getJWTPayload } = require('../common/Utils')\n// const User = require('../model/User')\nconst Comments = require('../model/Comments')\nconst Post = require('../model/Post')\n\nasync function addComment (ctx) {\n    const { body } = ctx.request\n    console.log(\"addComment -> body\", body)\n    const sid = body.sid\n    const code = body.code\n    const result = await checkCode(sid, code)\n    if (result) {\n        const newComments = new Comments(body)\n        const obj = await getJWTPayload(ctx.header.authorization)\n        newComments.cuid = obj._id\n\n        const post = await Post.findOne({ _id: body.tid })\n        newComments.uid = post.uid\n        const comment = await newComments.save()\n        // const num = await Comments.getTotal(post.uid)\n\n        const updatePostresult = await Post.updateOne({ _id: body.tid }, { $inc: { answer: 1 } })\n\n        // const user = await User.findById({ _id: obj._id })\n        // if(user.favs<body.fav) {\n        //     ctx.body = {\n        //         code:501,\n        //         msg:'积分不足'\n        //     }\n        //     return \n        // } else {\n        //     await User.updateOne({_id:obj._id},{$inc:{favs:-body.fav}})\n        // }\n\n        if (comment._id && updatePostresult.ok === 1) {\n            ctx.body = {\n                code: 200,\n                msg: '成功发表评论',\n                date: comment\n            }\n        } else {\n            ctx.body = {\n                code: 500,\n                msg: '评论失败'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '图片验证码验证失败'\n\n        }\n    }\n}\n\n// 获取评论列表\nasync function getComments (ctx) {\n    console.log('getComments')\n    const params = ctx.query\n    const tid = params.tid\n    console.log(\"getComments -> tid\", tid)\n    const page = params.page ? params.page : 0\n    const limit = params.limit ? parseInt(params.limit) : 10\n    let result = await Comments.getCommentsList(tid, page, limit)\n    console.log(\"getComments -> result\", result)\n    // 判断用户是否登录，已登录的用户才去判断点赞信息\n    // let obj = {}\n    // if (typeof ctx.header.authorization !== 'undefined') {\n    //     obj = await getJWTPayload(ctx.header.authorization)\n    // }\n    // if (typeof obj._id !== 'undefined') {\n    //     result = result.map(item => item.toJSON())\n    //     for (let i = 0; i < result.length; i++) {\n    //         let item = result[i]\n    //         item.handed = '0'\n    //         const commentsHands = await CommentsHands.findOne({ cid: item._id, uid: obj._id })\n    //         if (commentsHands && commentsHands.cid) {\n    //             if (commentsHands.uid === obj._id) {\n    //                 item.handed = '1'\n    //             }\n    //         }\n    //     }\n    // }\n    const total = await Comments.queryCount(tid)\n    console.log(\"getComments -> total\", total)\n    ctx.body = {\n        code: 200,\n        total,\n        data: result,\n        msg: '查询成功'\n    }\n}\n\nmodule.exports = { addComment, getComments }"
      ]
    },
    "sourceType": "script",
    "mtime": 1586017612454
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Comments.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Comments.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Comments.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/Comments.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "Comments.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst Schema = mongoose.Schema;\nconst CommentsSchema = new Schema({\n  tid: {\n    type: String,\n    ref: 'post'\n  },\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  cuid: {\n    type: String,\n    ref: 'users'\n  },\n  content: {\n    type: String\n  },\n  created: {\n    type: Date\n  },\n  hands: {\n    type: Number,\n    default: 0\n  },\n  status: {\n    type: String,\n    default: '1'\n  },\n  isRead: {\n    type: String,\n    default: '0'\n  },\n  isBest: {\n    type: String,\n    default: '0'\n  }\n}, {\n  toJSON: {\n    virtuals: true\n  }\n});\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date();\n  next();\n});\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'));\n  } else {\n    next(error);\n  }\n});\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({\n      tid: id\n    });\n  },\n  findByCid: function (id) {\n    return this.findOne({\n      _id: id\n    });\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({\n      tid: id\n    }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: {\n        status: {\n          $eq: '0'\n        }\n      }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit);\n  },\n  queryCount: function (id) {\n    return this.find({\n      tid: id\n    }).countDocuments();\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({\n      cuid: id\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).skip(page * limit).limit(limit).sort({\n      created: -1\n    });\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      // cuid: { $ne: id },\n      cuid: id,\n      isRead: {\n        $eq: '0'\n      },\n      // 未读状态\n      status: {\n        $eq: '1'\n      } // 是否显示\n\n    }).populate({\n      path: 'tid',\n      select: '_id title'\n    }).populate({\n      path: 'uid',\n      select: '_id name'\n    }).populate({\n      path: 'cuid',\n      select: '_id name'\n    }).skip(limit * page).limit(limit).sort({\n      created: -1\n    });\n  },\n  getTotal: function (id) {\n    return this.find({\n      uid: id,\n      isRead: '0',\n      status: '1'\n    }).countDocuments();\n  } // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n\n};\nconst Comments = mongoose.model('comments', CommentsSchema);\nmodule.exports = Comments;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbW1lbnRzLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIkNvbW1lbnRzU2NoZW1hIiwidGlkIiwidHlwZSIsIlN0cmluZyIsInJlZiIsInVpZCIsImN1aWQiLCJjb250ZW50IiwiY3JlYXRlZCIsIkRhdGUiLCJoYW5kcyIsIk51bWJlciIsImRlZmF1bHQiLCJzdGF0dXMiLCJpc1JlYWQiLCJpc0Jlc3QiLCJ0b0pTT04iLCJ2aXJ0dWFscyIsInByZSIsIm5leHQiLCJwb3N0IiwiZXJyb3IiLCJkb2MiLCJuYW1lIiwiY29kZSIsIkVycm9yIiwic3RhdGljcyIsImZpbmRCeVRpZCIsImlkIiwiZmluZCIsImZpbmRCeUNpZCIsImZpbmRPbmUiLCJfaWQiLCJnZXRDb21tZW50c0xpc3QiLCJwYWdlIiwibGltaXQiLCJwb3B1bGF0ZSIsInBhdGgiLCJzZWxlY3QiLCJtYXRjaCIsIiRlcSIsInNraXAiLCJxdWVyeUNvdW50IiwiY291bnREb2N1bWVudHMiLCJnZXRDb21tZXRzUHVibGljIiwic29ydCIsImdldE1zZ0xpc3QiLCJnZXRUb3RhbCIsIkNvbW1lbnRzIiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFELENBQXhCOztBQUVBLE1BQU1DLE1BQU0sR0FBR0YsUUFBUSxDQUFDRSxNQUF4QjtBQUVBLE1BQU1DLGNBQWMsR0FBRyxJQUFJRCxNQUFKLENBQVc7QUFDaENFLEVBQUFBLEdBQUcsRUFBRTtBQUFFQyxJQUFBQSxJQUFJLEVBQUVDLE1BQVI7QUFBZ0JDLElBQUFBLEdBQUcsRUFBRTtBQUFyQixHQUQyQjtBQUVoQ0MsRUFBQUEsR0FBRyxFQUFFO0FBQUVILElBQUFBLElBQUksRUFBRUMsTUFBUjtBQUFnQkMsSUFBQUEsR0FBRyxFQUFFO0FBQXJCLEdBRjJCO0FBR2hDRSxFQUFBQSxJQUFJLEVBQUU7QUFBRUosSUFBQUEsSUFB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QUFHRCxJQW5CVCxFQW9CSkMsS0FwQkksQ0FvQkVBLEtBcEJGLEVBcUJKVSxJQXJCSSxDQXFCQztBQUFFckMsTUFBQUEsT0FBTyxFQUFFLENBQUM7QUFBWixLQXJCRCxDQUFQO0FBc0JELEdBckRzQjtBQXVEdkJ1QyxFQUFBQSxRQUFRLEVBQUUsVUFBVW5CLEVBQVYsRUFBYztBQUN0QixXQUFPLEtBQUtDLElBQUwsQ0FBVTtBQUFFeEIsTUFBQUEsR0FBRyxFQUFFdUIsRUFBUDtBQUFXZCxNQUFBQSxNQUFNLEVBQUUsR0FBbkI7QUFBd0JELE1BQUFBLE1BQU0sRUFBRTtBQUFoQyxLQUFWLEVBQWlEOEIsY0FBakQsRUFBUDtBQUNELEdBekRzQixDQTBEdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQTFGdUIsQ0FBekI7QUE2RkEsTUFBTUssUUFBUSxHQUFHbkQsUUFBUSxDQUFDb0QsS0FBVCxDQUFlLFVBQWYsRUFBMkJqRCxjQUEzQixDQUFqQjtBQUVBa0QsTUFBTSxDQUFDQyxPQUFQLEdBQWlCSCxRQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9tb2RlbCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnLi4vY29uZmlnL0RCSGVscGVyJylcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hXG5cbmNvbnN0IENvbW1lbnRzU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gIHRpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3Bvc3QnIH0sXG4gIHVpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3VzZXJzJyB9LFxuICBjdWlkOiB7IHR5cGU6IFN0cmluZywgcmVmOiAndXNlcnMnIH0sXG4gIGNvbnRlbnQ6IHsgdHlwZTogU3RyaW5nIH0sXG4gIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICBoYW5kczogeyB0eXBlOiBOdW1iZXIsIGRlZmF1bHQ6IDAgfSxcbiAgc3RhdHVzOiB7IHR5cGU6IFN0cmluZywgZGVmYXVsdDogJzEnIH0sXG4gIGlzUmVhZDogeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcwJyB9LFxuICBpc0Jlc3Q6IHsgdHlwZTogU3RyaW5nLCBkZWZhdWx0OiAnMCcgfVxufSwgeyB0b0pTT046IHsgdmlydHVhbHM6IHRydWUgfSB9KVxuXG5Db21tZW50c1NjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbiAobmV4dCkge1xuICB0aGlzLmNyZWF0ZWQgPSBuZXcgRGF0ZSgpXG4gIG5leHQoKVxufSlcblxuQ29tbWVudHNTY2hlbWEucG9zdCgnc2F2ZScsIGZ1bmN0aW9uIChlcnJvciwgZG9jLCBuZXh0KSB7XG4gIGlmIChlcnJvci5uYW1lID09PSAnTW9uZ29FcnJvcicgJiYgZXJyb3IuY29kZSA9PT0gMTEwMDApIHtcbiAgICBuZXh0KG5ldyBFcnJvcignVGhlcmUgd2FzIGEgZHVwbGljYXRlIGtleSBlcnJvcicpKVxuICB9IGVsc2Uge1xuICAgIG5leHQoZXJyb3IpXG4gIH1cbn0pXG5cbkNvbW1lbnRzU2NoZW1hLnN0YXRpY3MgPSB7XG4gIGZpbmRCeVRpZDogZnVuY3Rpb24gKGlkKSB7XG4gICAgcmV0dXJuIHRoaXMuZmluZCh7IHRpZDogaWQgfSlcbiAgfSxcbiAgZmluZEJ5Q2lkOiBmdW5jdGlvbiAoaWQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHsgX2lkOiBpZCB9KVxuICB9LFxuICBnZXRDb21tZW50c0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHsgdGlkOiBpZCB9KS5wb3B1bGF0ZSh7XG4gICAgICBwYXRoOiAnY3VpZCcsXG4gICAgICBzZWxlY3Q6ICdfaWQgbmFtZSBwaWMgaXNWaXAnLFxuICAgICAgbWF0Y2g6IHsgc3RhdHVzOiB7ICRlcTogJzAnIH0gfVxuICAgIH0pLnBvcHVsYXRlKHtcbiAgICAgIHBhdGg6ICd0aWQnLFxuICAgICAgc2VsZWN0OiAnX2lkIHRpdGxlIHN0YXR1cydcbiAgICB9KS5za2lwKHBhZ2UgKiBsaW1pdCkubGltaXQobGltaXQpXG4gIH0sXG4gIHF1ZXJ5Q291bnQ6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB0aWQ6IGlkIH0pLmNvdW50RG9jdW1lbnRzKClcbiAgfSxcbiAgZ2V0Q29tbWV0c1B1YmxpYzogZnVuY3Rpb24gKGlkLCBwYWdlLCBsaW1pdCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyBjdWlkOiBpZCB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ3RpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCB0aXRsZSdcbiAgICAgIH0pXG4gICAgICAuc2tpcChwYWdlICogbGltaXQpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG4gIGdldE1zZ0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kKHtcbiAgICAgIHVpZDogaWQsXG4gICAgICAvLyBjdWlkOiB7ICRuZTogaWQgfSxcbiAgICAgIGN1aWQ6aWQsXG4gICAgICBpc1JlYWQ6IHsgJGVxOiAnMCcgfSwgLy8g5pyq6K+754q25oCBXG4gICAgICBzdGF0dXM6IHsgJGVxOiAnMScgfSAvLyDmmK/lkKbmmL7npLpcbiAgICB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ3RpZCcsXG4gICAgICAgIHNlbGVjdDogJ19pZCB0aXRsZSdcbiAgICAgIH0pXG4gICAgICAucG9wdWxhdGUoe1xuICAgICAgICBwYXRoOiAndWlkJyxcbiAgICAgICAgc2VsZWN0OiAnX2lkIG5hbWUnXG4gICAgICB9KVxuICAgICAgLnBvcHVsYXRlKHtcbiAgICAgICAgcGF0aDogJ2N1aWQnLFxuICAgICAgICBzZWxlY3Q6ICdfaWQgbmFtZSdcbiAgICAgIH0pXG4gICAgICAuc2tpcChsaW1pdCAqIHBhZ2UpXG4gICAgICAubGltaXQobGltaXQpXG4gICAgICAuc29ydCh7IGNyZWF0ZWQ6IC0xIH0pXG4gIH0sXG5cbiAgZ2V0VG90YWw6IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiB0aGlzLmZpbmQoeyB1aWQ6IGlkLCBpc1JlYWQ6ICcwJywgc3RhdHVzOiAnMScgfSkuY291bnREb2N1bWVudHMoKVxuICB9XG4gIC8vIGdldE1zZ0xpc3Q6IGZ1bmN0aW9uIChpZCwgcGFnZSwgbGltaXQpIHtcbiAgLy8gICByZXR1cm4gdGhpcy5hZ2dyZWdhdGUoW1xuICAvLyAgICAge1xuICAvLyAgICAgICAkbG9va3VwOiB7XG4gIC8vICAgICAgICAgZnJvbTogJ3Bvc3RzJyxcbiAgLy8gICAgICAgICBsZXQ6IHsgcGlkOiB7ICR0b09iamVjdElkOiAnJHRpZCcgfSB9LFxuICAvLyAgICAgICAgIHBpcGVsaW5lOiBbXG4gIC8vICAgICAgICAgICB7ICRtYXRjaDogeyAkZXhwcjogeyAkZXE6IFsnJF9pZCcsICckJHBpZCddIH0gfSB9LFxuICAvLyAgICAgICAgICAgeyAkcHJvamVjdDogeyBfaWQ6IDEsIHVpZDogMSwgY29udGVudDogMSB9IH1cbiAgLy8gICAgICAgICBdLFxuICAvLyAgICAgICAgIGFzOiAncG9zdCdcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfSxcbiAgLy8gICAgIHtcbiAgLy8gICAgICAgJHJlcGxhY2VSb290OiB7XG4gIC8vICAgICAgICAgbmV3Um9vdDoge1xuICAvLyAgICAgICAgICAgJG1lcmdlT2JqZWN0czogW3sgJGFycmF5RWxlbUF0OiBbJyRwb3N0JywgMF0gfSwgJyQkUk9PVCddXG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICB9XG4gIC8vICAgICB9LFxuICAvLyAgICAgeyAkYWRkRmllbGRzOiB7IHVzZXJJZDogeyAkdG9PYmplY3RJZDogJyR1aWQnIH0gfSB9LFxuICAvLyAgICAgeyAkbG9va3VwOiB7IGZyb206ICd1c2VycycsIGxvY2FsRmllbGQ6ICd1c2VySWQnLCBmb3JlaWduRmllbGQ6ICdfaWQnLCBhczogJ3R1aWQnIH0gfSxcbiAgLy8gICAgIHsgJHVud2luZDogJyR0dWlkJyB9LFxuICAvLyAgICAgeyAkYWRkRmllbGRzOiB7IGZ1c2VySWQ6IHsgJHRvT2JqZWN0SWQ6ICckY3VpZCcgfSB9IH0sXG4gIC8vICAgICB7ICRsb29rdXA6IHsgZnJvbTogJ3VzZXJzJywgbG9jYWxGaWVsZDogJ2Z1c2VySWQnLCBmb3JlaWduRmllbGQ6ICdfaWQnLCBhczogJ2Z1aWQnIH0gfSxcbiAgLy8gICAgIHsgJHVud2luZDogJyRmdWlkJyB9LFxuICAvLyAgICAgeyAkcHJvamVjdDogeyBwb3N0OiAwLCB0dWlkOiB7IHVzZXJuYW1lOiAwLCBwYXNzd29yZDogMCB9LCBmdWlkOiB7IHVzZXJuYW1lOiAwLCBwYXNzd29yZDogMCB9LCB1c2VySWQ6IDAsIGZ1c2VySWQ6IDAsIHRpZDogMCwgY3VpZDogMCB9IH0sXG4gIC8vICAgICB7ICRtYXRjaDogeyB1aWQ6IGlkLCBzdGF0dXM6ICcxJywgaXNSZWFkOiAnMCcgfSB9XG4gIC8vICAgXSlcbiAgLy8gICAgIC5za2lwKGxpbWl0ICogcGFnZSlcbiAgLy8gICAgIC5saW1pdChsaW1pdClcbiAgLy8gICAgIC5zb3J0KHsgY3JlYXRlZDogLTEgfSlcbiAgLy8gfVxufVxuXG5jb25zdCBDb21tZW50cyA9IG1vbmdvb3NlLm1vZGVsKCdjb21tZW50cycsIENvbW1lbnRzU2NoZW1hKVxuXG5tb2R1bGUuZXhwb3J0cyA9IENvbW1lbnRzXG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "Comments.js"
      ],
      "names": [
        "mongoose",
        "require",
        "Schema",
        "CommentsSchema",
        "tid",
        "type",
        "String",
        "ref",
        "uid",
        "cuid",
        "content",
        "created",
        "Date",
        "hands",
        "Number",
        "default",
        "status",
        "isRead",
        "isBest",
        "toJSON",
        "virtuals",
        "pre",
        "next",
        "post",
        "error",
        "doc",
        "name",
        "code",
        "Error",
        "statics",
        "findByTid",
        "id",
        "find",
        "findByCid",
        "findOne",
        "_id",
        "getCommentsList",
        "page",
        "limit",
        "populate",
        "path",
        "select",
        "match",
        "$eq",
        "skip",
        "queryCount",
        "countDocuments",
        "getCommetsPublic",
        "sort",
        "getMsgList",
        "getTotal",
        "Comments",
        "model",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\n\nconst Schema = mongoose.Schema\n\nconst CommentsSchema = new Schema({\n  tid: { type: String, ref: 'post' },\n  uid: { type: String, ref: 'users' },\n  cuid: { type: String, ref: 'users' },\n  content: { type: String },\n  created: { type: Date },\n  hands: { type: Number, default: 0 },\n  status: { type: String, default: '1' },\n  isRead: { type: String, default: '0' },\n  isBest: { type: String, default: '0' }\n}, { toJSON: { virtuals: true } })\n\nCommentsSchema.pre('save', function (next) {\n  this.created = new Date()\n  next()\n})\n\nCommentsSchema.post('save', function (error, doc, next) {\n  if (error.name === 'MongoError' && error.code === 11000) {\n    next(new Error('There was a duplicate key error'))\n  } else {\n    next(error)\n  }\n})\n\nCommentsSchema.statics = {\n  findByTid: function (id) {\n    return this.find({ tid: id })\n  },\n  findByCid: function (id) {\n    return this.findOne({ _id: id })\n  },\n  getCommentsList: function (id, page, limit) {\n    return this.find({ tid: id }).populate({\n      path: 'cuid',\n      select: '_id name pic isVip',\n      match: { status: { $eq: '0' } }\n    }).populate({\n      path: 'tid',\n      select: '_id title status'\n    }).skip(page * limit).limit(limit)\n  },\n  queryCount: function (id) {\n    return this.find({ tid: id }).countDocuments()\n  },\n  getCommetsPublic: function (id, page, limit) {\n    return this.find({ cuid: id })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .skip(page * limit)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n  getMsgList: function (id, page, limit) {\n    return this.find({\n      uid: id,\n      // cuid: { $ne: id },\n      cuid:id,\n      isRead: { $eq: '0' }, // 未读状态\n      status: { $eq: '1' } // 是否显示\n    })\n      .populate({\n        path: 'tid',\n        select: '_id title'\n      })\n      .populate({\n        path: 'uid',\n        select: '_id name'\n      })\n      .populate({\n        path: 'cuid',\n        select: '_id name'\n      })\n      .skip(limit * page)\n      .limit(limit)\n      .sort({ created: -1 })\n  },\n\n  getTotal: function (id) {\n    return this.find({ uid: id, isRead: '0', status: '1' }).countDocuments()\n  }\n  // getMsgList: function (id, page, limit) {\n  //   return this.aggregate([\n  //     {\n  //       $lookup: {\n  //         from: 'posts',\n  //         let: { pid: { $toObjectId: '$tid' } },\n  //         pipeline: [\n  //           { $match: { $expr: { $eq: ['$_id', '$$pid'] } } },\n  //           { $project: { _id: 1, uid: 1, content: 1 } }\n  //         ],\n  //         as: 'post'\n  //       }\n  //     },\n  //     {\n  //       $replaceRoot: {\n  //         newRoot: {\n  //           $mergeObjects: [{ $arrayElemAt: ['$post', 0] }, '$$ROOT']\n  //         }\n  //       }\n  //     },\n  //     { $addFields: { userId: { $toObjectId: '$uid' } } },\n  //     { $lookup: { from: 'users', localField: 'userId', foreignField: '_id', as: 'tuid' } },\n  //     { $unwind: '$tuid' },\n  //     { $addFields: { fuserId: { $toObjectId: '$cuid' } } },\n  //     { $lookup: { from: 'users', localField: 'fuserId', foreignField: '_id', as: 'fuid' } },\n  //     { $unwind: '$fuid' },\n  //     { $project: { post: 0, tuid: { username: 0, password: 0 }, fuid: { username: 0, password: 0 }, userId: 0, fuserId: 0, tid: 0, cuid: 0 } },\n  //     { $match: { uid: id, status: '1', isRead: '0' } }\n  //   ])\n  //     .skip(limit * page)\n  //     .limit(limit)\n  //     .sort({ created: -1 })\n  // }\n}\n\nconst Comments = mongoose.model('comments', CommentsSchema)\n\nmodule.exports = Comments\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1586250029582
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/userRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/userRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/userRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/userRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "userRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require(\"koa-router\");\n\nconst {\n  userSign,\n  updateUserInfo,\n  changePassword,\n  getMsg,\n  setMsg\n} = require('../../api/UserController');\n\nconst {\n  getPostListByUid,\n  deletePostByUid\n} = require('../../api/ContentController');\n\nconst router = new Router();\nrouter.prefix('/user');\nrouter.get('/fav', userSign);\nrouter.post('/basic', updateUserInfo);\nrouter.post('/changePassword', changePassword);\nrouter.get('/getMsg', getMsg);\nrouter.get('/setMsg', setMsg);\nrouter.get('/post', getPostListByUid);\nrouter.post('/deletePost', deletePostByUid); // router.get('/account',userController.userAccount)\n// router.get('/permission',userController.userPermission)\n\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXJSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsInVzZXJTaWduIiwidXBkYXRlVXNlckluZm8iLCJjaGFuZ2VQYXNzd29yZCIsImdldE1zZyIsInNldE1zZyIsImdldFBvc3RMaXN0QnlVaWQiLCJkZWxldGVQb3N0QnlVaWQiLCJyb3V0ZXIiLCJwcmVmaXgiLCJnZXQiLCJwb3N0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxZQUFELENBQXRCOztBQUNBLE1BQU07QUFBRUMsRUFBQUEsUUFBRjtBQUFZQyxFQUFBQSxjQUFaO0FBQTRCQyxFQUFBQSxjQUE1QjtBQUE0Q0MsRUFBQUEsTUFBNUM7QUFBb0RDLEVBQUFBO0FBQXBELElBQWdFTCxPQUFPLENBQUMsMEJBQUQsQ0FBN0U7O0FBQ0EsTUFBTTtBQUFDTSxFQUFBQSxnQkFBRDtBQUFrQkMsRUFBQUE7QUFBbEIsSUFBb0NQLE9BQU8sQ0FBQyw2QkFBRCxDQUFqRDs7QUFFQSxNQUFNUSxNQUFNLEdBQUcsSUFBSVQsTUFBSixFQUFmO0FBQ0FTLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLE9BQWQ7QUFDQUQsTUFBTSxDQUFDRSxHQUFQLENBQVcsTUFBWCxFQUFtQlQsUUFBbkI7QUFFQU8sTUFBTSxDQUFDRyxJQUFQLENBQVksUUFBWixFQUFzQlQsY0FBdEI7QUFDQU0sTUFBTSxDQUFDRyxJQUFQLENBQVksaUJBQVosRUFBK0JSLGNBQS9CO0FBRUFLLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLFNBQVgsRUFBcUJOLE1BQXJCO0FBQ0FJLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLFNBQVgsRUFBcUJMLE1BQXJCO0FBRUFHLE1BQU0sQ0FBQ0UsR0FBUCxDQUFXLE9BQVgsRUFBbUJKLGdCQUFuQjtBQUNBRSxNQUFNLENBQUNHLElBQVAsQ0FBWSxhQUFaLEVBQTBCSixlQUExQixFLENBRUE7QUFDQTs7QUFFQUssTUFBTSxDQUFDQyxPQUFQLEdBQWlCTCxNQUFqQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlciA9IHJlcXVpcmUoXCJrb2Etcm91dGVyXCIpXG5jb25zdCB7IHVzZXJTaWduLCB1cGRhdGVVc2VySW5mbywgY2hhbmdlUGFzc3dvcmQsIGdldE1zZywgc2V0TXNnICB9ID0gcmVxdWlyZSgnLi4vLi4vYXBpL1VzZXJDb250cm9sbGVyJylcbmNvbnN0IHtnZXRQb3N0TGlzdEJ5VWlkLGRlbGV0ZVBvc3RCeVVpZH0gPXJlcXVpcmUoJy4uLy4uL2FwaS9Db250ZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlciA9IG5ldyBSb3V0ZXIoKVxucm91dGVyLnByZWZpeCgnL3VzZXInKVxucm91dGVyLmdldCgnL2ZhdicsIHVzZXJTaWduKVxuXG5yb3V0ZXIucG9zdCgnL2Jhc2ljJywgdXBkYXRlVXNlckluZm8pXG5yb3V0ZXIucG9zdCgnL2NoYW5nZVBhc3N3b3JkJywgY2hhbmdlUGFzc3dvcmQpXG5cbnJvdXRlci5nZXQoJy9nZXRNc2cnLGdldE1zZylcbnJvdXRlci5nZXQoJy9zZXRNc2cnLHNldE1zZylcblxucm91dGVyLmdldCgnL3Bvc3QnLGdldFBvc3RMaXN0QnlVaWQpXG5yb3V0ZXIucG9zdCgnL2RlbGV0ZVBvc3QnLGRlbGV0ZVBvc3RCeVVpZClcblxuLy8gcm91dGVyLmdldCgnL2FjY291bnQnLHVzZXJDb250cm9sbGVyLnVzZXJBY2NvdW50KVxuLy8gcm91dGVyLmdldCgnL3Blcm1pc3Npb24nLHVzZXJDb250cm9sbGVyLnVzZXJQZXJtaXNzaW9uKVxuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlciJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "userRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "userSign",
        "updateUserInfo",
        "changePassword",
        "getMsg",
        "setMsg",
        "getPostListByUid",
        "deletePostByUid",
        "router",
        "prefix",
        "get",
        "post",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,YAAD,CAAtB;;AACA,MAAM;AAAEC,EAAAA,QAAF;AAAYC,EAAAA,cAAZ;AAA4BC,EAAAA,cAA5B;AAA4CC,EAAAA,MAA5C;AAAoDC,EAAAA;AAApD,IAAgEL,OAAO,CAAC,0BAAD,CAA7E;;AACA,MAAM;AAACM,EAAAA,gBAAD;AAAkBC,EAAAA;AAAlB,IAAoCP,OAAO,CAAC,6BAAD,CAAjD;;AAEA,MAAMQ,MAAM,GAAG,IAAIT,MAAJ,EAAf;AACAS,MAAM,CAACC,MAAP,CAAc,OAAd;AACAD,MAAM,CAACE,GAAP,CAAW,MAAX,EAAmBT,QAAnB;AAEAO,MAAM,CAACG,IAAP,CAAY,QAAZ,EAAsBT,cAAtB;AACAM,MAAM,CAACG,IAAP,CAAY,iBAAZ,EAA+BR,cAA/B;AAEAK,MAAM,CAACE,GAAP,CAAW,SAAX,EAAqBN,MAArB;AACAI,MAAM,CAACE,GAAP,CAAW,SAAX,EAAqBL,MAArB;AAEAG,MAAM,CAACE,GAAP,CAAW,OAAX,EAAmBJ,gBAAnB;AACAE,MAAM,CAACG,IAAP,CAAY,aAAZ,EAA0BJ,eAA1B,E,CAEA;AACA;;AAEAK,MAAM,CAACC,OAAP,GAAiBL,MAAjB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router = require(\"koa-router\")\nconst { userSign, updateUserInfo, changePassword, getMsg, setMsg  } = require('../../api/UserController')\nconst {getPostListByUid,deletePostByUid} =require('../../api/ContentController')\n\nconst router = new Router()\nrouter.prefix('/user')\nrouter.get('/fav', userSign)\n\nrouter.post('/basic', updateUserInfo)\nrouter.post('/changePassword', changePassword)\n\nrouter.get('/getMsg',getMsg)\nrouter.get('/setMsg',setMsg)\n\nrouter.get('/post',getPostListByUid)\nrouter.post('/deletePost',deletePostByUid)\n\n// router.get('/account',userController.userAccount)\n// router.get('/permission',userController.userPermission)\n\nmodule.exports = router"
      ]
    },
    "sourceType": "script",
    "mtime": 1586401610851
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/UserController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/UserController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/UserController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/UserController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "UserController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst SignRecord = require('../model/SignRecord');\n\nconst User = require('../model/User');\n\nconst Utils = require('../common/Utils');\n\nconst {\n  setValue\n} = require('../config/RedisConfig');\n\nconst {\n  send\n} = require('../config/MailConfig');\n\nconst config = require('../config/index');\n\nconst {\n  getJWTPayload\n} = require('../common/Utils');\n\nconst Comments = require('../model/Comments');\n\nconst moment = require('dayjs');\n\nconst uuid = require('uuid/v4');\n\nconst jwt = require('jsonwebtoken');\n\nconst bcrypt = require('bcrypt');\n\nasync function userSign(ctx) {\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  const record = await SignRecord.findByUid(obj._id);\n  console.log(\"userSign -> record\", record);\n  const user = await User.findByID(obj._id);\n  let newRecord = {};\n  let result = '';\n  record.created = '2020-03-14T02:54:41.000Z';\n\n  if (record !== null) {\n    if (moment(record.created).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD')) {\n      ctx.body = {\n        code: 500,\n        favs: user.favs,\n        count: user.count,\n        lastSign: record.created,\n        msg: '用户已经签到'\n      };\n      return;\n    } else {\n      let count = user.count;\n      console.log(\"userSign -> count\", count);\n      let fav = 0;\n\n      if (moment(record.created).format('YYYY-MM-DD') === moment().subtract(1, 'days').format('YYYY-MM-DD')) {\n        count += 1;\n\n        if (count < 5) {\n          fav = 5;\n        } else if (count >= 5 && count < 15) {\n          fav = 10;\n        } else if (count >= 15 && count < 30) {\n          fav = 15;\n        } else if (count >= 30 && count < 100) {\n          fav = 20;\n        } else if (count >= 100 && count < 365) {\n          fav = 30;\n        } else if (count >= 365) {\n          fav = 50;\n        }\n\n        await User.updateOne({\n          _id: obj._id\n        }, {\n          $inc: {\n            favs: fav,\n            count: 1\n          }\n        });\n        result = {\n          favs: user.favs + fav,\n          count: user.count + 1\n        };\n      } else {\n        fav = 5;\n        await User.updateOne({\n          _id: obj._id\n        }, {\n          $set: {\n            count: 1\n          },\n          $inc: {\n            favs: fav\n          }\n        });\n        result = {\n          favs: user.favs + fav,\n          count: 1\n        };\n      }\n\n      newRecord = new SignRecord({\n        uid: obj._id,\n        favs: fav\n      });\n      await newRecord.save();\n    }\n  } else {\n    await User.updateOne({\n      _id: obj._id\n    }, {\n      $set: {\n        count: 1\n      },\n      $inc: {\n        favs: 5\n      }\n    });\n    newRecord = new SignRecord({\n      uid: obj._id,\n      favs: 5 // lastSign: moment().format('YYYY-MM-DD HH:mm:ss')\n\n    });\n    await newRecord.save();\n    result = {\n      favs: user.favs + 5,\n      count: 1\n    };\n  }\n\n  ctx.body = {\n    code: 200,\n    msg: '请求成功',\n    ...result,\n    lastSign: newRecord.created\n  };\n}\n\nasync function updateUserInfo(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"updateUserInfo -> body\", body);\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  console.log(\"updateUserInfo -> obj\", obj);\n  const user = await User.findOne({\n    _id: obj._id\n  });\n  console.log(\"updateUserInfo -> user\", user);\n  let msg = '';\n\n  if (body.username && body.username !== user.username) {\n    const tmpUser = await User.findOne({\n      username: body.username\n    });\n    console.log(\"updateUserInfo -> tmpUser\", tmpUser);\n\n    if (tmpUser && tmpUser.password) {\n      ctx.body = {\n        code: 501,\n        msg: '邮箱已经注册'\n      };\n      return;\n    }\n\n    const key = uuid();\n    setValue(key, jwt.sign({\n      _id: obj._id\n    }, config.JWT_SECRET, {\n      expiresIn: '30m'\n    }));\n    await send({\n      type: 'email',\n      data: {\n        key: key,\n        username: body.username\n      },\n      code: '',\n      expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n      email: user.username,\n      user: user.name\n    });\n    msg = '更新基本资料成功，账号修改需要邮件确认，请查收邮件';\n  }\n\n  const arr = ['username', 'mobile', 'password'];\n  arr.map(item => {\n    delete body[item];\n  });\n  const result = await User.updateOne({\n    _id: obj._id\n  }, body);\n  console.log(\"result\", result);\n\n  if (result.n === 1 && result.ok === 1) {\n    ctx.body = {\n      code: 200,\n      msg: msg === '' ? '更新成功' : msg\n    };\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '更新失败'\n    };\n  }\n}\n\nasync function changePassword(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"changePassword -> body\", body);\n  const obj = await Utils.getJWTPayload(ctx.header.authorization);\n  const user = await User.findOne({\n    _id: obj._id\n  });\n  console.log(\"changePassword -> user\", user);\n  let msg = '';\n\n  if (await bcrypt.compare(body.oldPassword, user.password)) {\n    body.newPassword = await bcrypt.hash(body.newPassword, 5);\n    console.log(\"changePassword ->  body.newPassword\", body.newPassword);\n    const result = await User.updateOne({\n      _id: obj._id\n    }, {\n      password: body.newPassword\n    });\n    console.log(\"result\", result);\n\n    if (result.n === 1 && result.ok === 1) {\n      ctx.body = {\n        code: 200,\n        msg: msg === '' ? '更新成功' : msg\n      };\n    } else {\n      ctx.body = {\n        code: 500,\n        msg: '更新失败'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 501,\n      msg: '原来的密码填写错误'\n    };\n    return;\n  }\n}\n\nasync function getMsg(ctx) {\n  const params = ctx.query;\n  const page = params.page ? params.page : 0;\n  const limit = params.limit ? parseInt(params.limit) : 0;\n  const obj = await getJWTPayload(ctx.header.authorization);\n  const result = await Comments.getMsgList(obj._id, page, limit);\n  const num = await Comments.getTotal(obj._id);\n  console.log(\"getMsg -> result\", result);\n  ctx.body = {\n    code: 200,\n    data: result,\n    total: num\n  };\n}\n\nasync function setMsg(ctx) {\n  const params = ctx.query;\n\n  if (params.id) {\n    const result = await Comments.updateOne({\n      _id: params.id\n    }, {\n      isRead: '1'\n    });\n\n    if (result.ok === 1) {\n      ctx.body = {\n        code: 200\n      };\n    }\n  } else {\n    const obj = await getJWTPayload(ctx.header.authorization);\n    const result = await Comments.updateMany({\n      uid: obj._id\n    }, {\n      isRead: '1'\n    });\n\n    if (result.ok === 1) {\n      ctx.body = {\n        code: 200\n      };\n    }\n  }\n}\n\nmodule.exports = {\n  userSign,\n  updateUserInfo,\n  changePassword,\n  getMsg,\n  setMsg\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbIlNpZ25SZWNvcmQiLCJyZXF1aXJlIiwiVXNlciIsIlV0aWxzIiwic2V0VmFsdWUiLCJzZW5kIiwiY29uZmlnIiwiZ2V0SldUUGF5bG9hZCIsIkNvbW1lbnRzIiwibW9tZW50IiwidXVpZCIsImp3dCIsImJjcnlwdCIsInVzZXJTaWduIiwiY3R4Iiwib2JqIiwiaGVhZGVyIiwiYXV0aG9yaXphdGlvbiIsInJlY29yZCIsImZpbmRCeVVpZCIsIl9pZCIsImNvbnNvbGUiLCJsb2ciLCJ1c2VyIiwiZmluZEJ5SUQiLCJuZXdSZWNvcmQiLCJyZXN1bHQiLCJjcmVhdGVkIiwiZm9ybWF0IiwiYm9keSIsImNvZGUiLCJmYXZzIiwiY291bnQiLCJsYXN0U2lnbiIsIm1zZyIsImZhdiIsInN1YnRyYWN0IiwidXBkYXRlT25lIiwiJGluYyIsIiRzZXQiLCJ1aWQiLCJzYXZlIiwidXBkYXRlVXNlckluZm8iLCJyZXF1ZXN0IiwiZmluZE9uZSIsInVzZXJuYW1lIiwidG1wVXNlciIsInBhc3N3b3JkIiwia2V5Iiwic2lnbiIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJ0eXBlIiwiZGF0YSIsImV4cGlyZSIsImFkZCIsImVtYWlsIiwibmFtZSIsImFyciIsIm1hcCIsIml0ZW0iLCJuIiwib2siLCJjaGFuZ2VQYXNzd29yZCIsImNvbXBhcmUiLCJvbGRQYXNzd29yZCIsIm5ld1Bhc3N3b3JkIiwiaGFzaCIsImdldE1zZyIsInBhcmFtcyIsInF1ZXJ5IiwicGFnZSIsImxpbWl0IiwicGFyc2VJbnQiLCJnZXRNc2dMaXN0IiwibnVtIiwiZ2V0VG90YWwiLCJ0b3RhbCIsInNldE1zZyIsImlkIiwiaXNSZWFkIiwidXBkYXRlTWFueSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsVUFBVSxHQUFHQyxPQUFPLENBQUMscUJBQUQsQ0FBMUI7O0FBQ0EsTUFBTUMsSUFBSSxHQUFHRCxPQUFP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Q08sR0FBRyxDQUFDRSxNQUFKLENBQVdDLGFBQVosQ0FBL0I7QUFDQSxVQUFNUyxNQUFNLEdBQUcsTUFBTWxCLFFBQVEsQ0FBQ3lFLFVBQVQsQ0FDakI7QUFBRXpDLE1BQUFBLEdBQUcsRUFBRXpCLEdBQUcsQ0FBQ0s7QUFBWCxLQURpQixFQUVqQjtBQUFFNEQsTUFBQUEsTUFBTSxFQUFFO0FBQVYsS0FGaUIsQ0FBckI7O0FBSUEsUUFBSXRELE1BQU0sQ0FBQ29DLEVBQVAsS0FBYyxDQUFsQixFQUFxQjtBQUNqQmhELE1BQUFBLEdBQUcsQ0FBQ2UsSUFBSixHQUFXO0FBQ1BDLFFBQUFBLElBQUksRUFBRTtBQURDLE9BQVg7QUFHSDtBQUNKO0FBQ0o7O0FBR0RvRCxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRXRFLEVBQUFBLFFBQUY7QUFBWTZCLEVBQUFBLGNBQVo7QUFBNEJxQixFQUFBQSxjQUE1QjtBQUE0Q0ssRUFBQUEsTUFBNUM7QUFBb0RVLEVBQUFBO0FBQXBELENBQWpCIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjL2FwaSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFNpZ25SZWNvcmQgPSByZXF1aXJlKCcuLi9tb2RlbC9TaWduUmVjb3JkJylcbmNvbnN0IFVzZXIgPSByZXF1aXJlKCcuLi9tb2RlbC9Vc2VyJylcbmNvbnN0IFV0aWxzID0gcmVxdWlyZSgnLi4vY29tbW9uL1V0aWxzJylcbmNvbnN0IHsgc2V0VmFsdWUgfSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9SZWRpc0NvbmZpZycpXG5jb25zdCB7IHNlbmQgfSA9IHJlcXVpcmUoJy4uL2NvbmZpZy9NYWlsQ29uZmlnJylcbmNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4uL2NvbmZpZy9pbmRleCcpXG5jb25zdCB7IGdldEpXVFBheWxvYWQgfSA9IHJlcXVpcmUoJy4uL2NvbW1vbi9VdGlscycpXG5jb25zdCBDb21tZW50cyA9IHJlcXVpcmUoJy4uL21vZGVsL0NvbW1lbnRzJylcblxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuY29uc3QgdXVpZCA9IHJlcXVpcmUoJ3V1aWQvdjQnKVxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpXG5cbmFzeW5jIGZ1bmN0aW9uIHVzZXJTaWduIChjdHgpIHtcbiAgICBjb25zdCBvYmogPSBhd2FpdCBVdGlscy5nZXRKV1RQYXlsb2FkKGN0eC5oZWFkZXIuYXV0aG9yaXphdGlvbilcbiAgICBjb25zdCByZWNvcmQgPSBhd2FpdCBTaWduUmVjb3JkLmZpbmRCeVVpZChvYmouX2lkKVxuICAgIGNvbnNvbGUubG9nKFwidXNlclNpZ24gLT4gcmVjb3JkXCIsIHJlY29yZClcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kQnlJRChvYmouX2lkKVxuICAgIGxldCBuZXdSZWNvcmQgPSB7fVxuICAgIGxldCByZXN1bHQgPSAnJ1xuICAgIHJlY29yZC5jcmVhdGVkID0gJzIwMjAtMDMtMTRUMDI6NTQ6NDEuMDAwWidcbiAgICBpZiAocmVjb3JkICE9PSBudWxsKSB7XG4gICAgICAgIGlmIChtb21lbnQocmVjb3JkLmNyZWF0ZWQpLmZvcm1hdCgnWVlZWS1NTS1ERCcpID09PSBtb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQnKSkge1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIGZhdnM6IHVzZXIuZmF2cyxcbiAgICAgICAgICAgICAgICBjb3VudDogdXNlci5jb3VudCxcbiAgICAgICAgICAgICAgICBsYXN0U2lnbjogcmVjb3JkLmNyZWF0ZWQsXG4gICAgICAgICAgICAgICAgbXNnOiAn55So5oi35bey57uP562+5YiwJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgY291bnQgPSB1c2VyLmNvdW50XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXJTaWduIC0+IGNvdW50XCIsIGNvdW50KVxuICAgICAgICAgICAgbGV0IGZhdiA9IDBcbiAgICAgICAgICAgIGlmIChtb21lbnQocmVjb3JkLmNyZWF0ZWQpLmZvcm1hdCgnWVlZWS1NTS1ERCcpID09PSBtb21lbnQoKS5zdWJ0cmFjdCgxLCAnZGF5cycpLmZvcm1hdCgnWVlZWS1NTS1ERCcpKSB7XG4gICAgICAgICAgICAgICAgY291bnQgKz0gMVxuICAgICAgICAgICAgICAgIGlmIChjb3VudCA8IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gNVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQgPj0gNSAmJiBjb3VudCA8IDE1KSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdiA9IDEwXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSAxNSAmJiBjb3VudCA8IDMwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdiA9IDE1XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSAzMCAmJiBjb3VudCA8IDEwMCkge1xuICAgICAgICAgICAgICAgICAgICBmYXYgPSAyMFxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnQgPj0gMTAwICYmIGNvdW50IDwgMzY1KSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdiA9IDMwXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudCA+PSAzNjUpIHtcbiAgICAgICAgICAgICAgICAgICAgZmF2ID0gNTBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXdhaXQgVXNlci51cGRhdGVPbmUoXG4gICAgICAgICAgICAgICAgICAgIHsgX2lkOiBvYmouX2lkIH0sXG4gICAgICAgICAgICAgICAgICAgIHsgJGluYzogeyBmYXZzOiBmYXYsIGNvdW50OiAxIH0gfVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdnM6IHVzZXIuZmF2cyArIGZhdixcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IHVzZXIuY291bnQgKyAxXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmYXYgPSA1XG4gICAgICAgICAgICAgICAgYXdhaXQgVXNlci51cGRhdGVPbmUoXG4gICAgICAgICAgICAgICAgICAgIHsgX2lkOiBvYmouX2lkIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzZXQ6IHsgY291bnQ6IDEgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICRpbmM6IHsgZmF2czogZmF2IH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGZhdnM6IHVzZXIuZmF2cyArIGZhdixcbiAgICAgICAgICAgICAgICAgICAgY291bnQ6IDFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdSZWNvcmQgPSBuZXcgU2lnblJlY29yZCh7XG4gICAgICAgICAgICAgICAgdWlkOiBvYmouX2lkLFxuICAgICAgICAgICAgICAgIGZhdnM6IGZhdlxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGF3YWl0IG5ld1JlY29yZC5zYXZlKClcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IFVzZXIudXBkYXRlT25lKHtcbiAgICAgICAgICAgIF9pZDogb2JqLl9pZFxuICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICRzZXQ6IHsgY291bnQ6IDEgfSxcbiAgICAgICAgICAgICAgICAkaW5jOiB7IGZhdnM6IDUgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgbmV3UmVjb3JkID0gbmV3IFNpZ25SZWNvcmQoe1xuICAgICAgICAgICAgdWlkOiBvYmouX2lkLFxuICAgICAgICAgICAgZmF2czogNVxuICAgICAgICAgICAgLy8gbGFzdFNpZ246IG1vbWVudCgpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpXG4gICAgICAgIH0pXG4gICAgICAgIGF3YWl0IG5ld1JlY29yZC5zYXZlKClcbiAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgZmF2czogdXNlci5mYXZzICsgNSxcbiAgICAgICAgICAgIGNvdW50OiAxXG4gICAgICAgIH1cbiAgICB9XG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgbXNnOiAn6K+35rGC5oiQ5YqfJyxcbiAgICAgICAgLi4ucmVzdWx0LFxuICAgICAgICBsYXN0U2lnbjogbmV3UmVjb3JkLmNyZWF0ZWRcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVVzZXJJbmZvIChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJ1cGRhdGVVc2VySW5mbyAtPiBib2R5XCIsIGJvZHkpXG4gICAgY29uc3Qgb2JqID0gYXdhaXQgVXRpbHMuZ2V0SldUUGF5bG9hZChjdHguaGVhZGVyLmF1dGhvcml6YXRpb24pXG4gICAgY29uc29sZS5sb2coXCJ1cGRhdGVVc2VySW5mbyAtPiBvYmpcIiwgb2JqKVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBfaWQ6IG9iai5faWQgfSlcbiAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVVzZXJJbmZvIC0+IHVzZXJcIiwgdXNlcilcbiAgICBsZXQgbXNnID0gJydcbiAgICBpZiAoYm9keS51c2VybmFtZSAmJiBib2R5LnVzZXJuYW1lICE9PSB1c2VyLnVzZXJuYW1lKSB7XG4gICAgICAgIGNvbnN0IHRtcFVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogYm9keS51c2VybmFtZSB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcInVwZGF0ZVVzZXJJbmZvIC0+IHRtcFVzZXJcIiwgdG1wVXNlcilcbiAgICAgICAgaWYgKHRtcFVzZXIgJiYgdG1wVXNlci5wYXNzd29yZCkge1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAxLFxuICAgICAgICAgICAgICAgIG1zZzogJ+mCrueuseW3sue7j+azqOWGjCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGtleSA9IHV1aWQoKVxuICAgICAgICBzZXRWYWx1ZShcbiAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgIGp3dC5zaWduKHsgX2lkOiBvYmouX2lkIH0sIGNvbmZpZy5KV1RfU0VDUkVULCB7XG4gICAgICAgICAgICAgICAgZXhwaXJlc0luOiAnMzBtJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgICBhd2FpdCBzZW5kKHtcbiAgICAgICAgICAgIHR5cGU6ICdlbWFpbCcsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb2RlOiAnJyxcbiAgICAgICAgICAgIGV4cGlyZTogbW9tZW50KCkuYWRkKDMwLCAnbWludXRlcycpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpLFxuICAgICAgICAgICAgZW1haWw6IHVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICB1c2VyOiB1c2VyLm5hbWVcbiAgICAgICAgfSlcbiAgICAgICAgbXNnID0gJ+abtOaWsOWfuuacrOi1hOaWmeaIkOWKn++8jOi0puWPt+S/ruaUuemcgOimgemCruS7tuehruiupO+8jOivt+afpeaUtumCruS7tidcbiAgICB9XG4gICAgY29uc3QgYXJyID0gWyd1c2VybmFtZScsICdtb2JpbGUnLCAncGFzc3dvcmQnXVxuICAgIGFyci5tYXAoaXRlbSA9PiB7XG4gICAgICAgIGRlbGV0ZSBib2R5W2l0ZW1dXG4gICAgfSlcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBVc2VyLnVwZGF0ZU9uZSh7IF9pZDogb2JqLl9pZCB9LCBib2R5KVxuICAgIGNvbnNvbGUubG9nKFwicmVzdWx0XCIsIHJlc3VsdClcbiAgICBpZiAocmVzdWx0Lm4gPT09IDEgJiYgcmVzdWx0Lm9rID09PSAxKSB7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgY29kZTogMjAwLFxuICAgICAgICAgICAgbXNnOiBtc2cgPT09ICcnID8gJ+abtOaWsOaIkOWKnycgOiBtc2dcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgbXNnOiAn5pu05paw5aSx6LSlJ1xuICAgICAgICB9XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjaGFuZ2VQYXNzd29yZCAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlUGFzc3dvcmQgLT4gYm9keVwiLCBib2R5KVxuICAgIGNvbnN0IG9iaiA9IGF3YWl0IFV0aWxzLmdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyBfaWQ6IG9iai5faWQgfSlcbiAgICBjb25zb2xlLmxvZyhcImNoYW5nZVBhc3N3b3JkIC0+IHVzZXJcIiwgdXNlcilcbiAgICBsZXQgbXNnID0gJydcbiAgICBpZiAoYXdhaXQgYmNyeXB0LmNvbXBhcmUoYm9keS5vbGRQYXNzd29yZCwgdXNlci5wYXNzd29yZCkpIHtcbiAgICAgICAgYm9keS5uZXdQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKGJvZHkubmV3UGFzc3dvcmQsIDUpXG4gICAgICAgIGNvbnNvbGUubG9nKFwiY2hhbmdlUGFzc3dvcmQgLT4gIGJvZHkubmV3UGFzc3dvcmRcIiwgYm9keS5uZXdQYXNzd29yZClcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgVXNlci51cGRhdGVPbmUoeyBfaWQ6IG9iai5faWQgfSwgeyBwYXNzd29yZDogYm9keS5uZXdQYXNzd29yZCB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcInJlc3VsdFwiLCByZXN1bHQpXG4gICAgICAgIGlmIChyZXN1bHQubiA9PT0gMSAmJiByZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBtc2c6IG1zZyA9PT0gJycgPyAn5pu05paw5oiQ5YqfJyA6IG1zZ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIG1zZzogJ+abtOaWsOWksei0pSdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgY29kZTogNTAxLFxuICAgICAgICAgICAgbXNnOiAn5Y6f5p2l55qE5a+G56CB5aGr5YaZ6ZSZ6K+vJ1xuICAgICAgICB9XG4gICAgICAgIHJldHVyblxuICAgIH1cblxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRNc2cgKGN0eCkge1xuICAgIGNvbnN0IHBhcmFtcyA9IGN0eC5xdWVyeVxuICAgIGNvbnN0IHBhZ2UgPSBwYXJhbXMucGFnZSA/IHBhcmFtcy5wYWdlIDogMFxuICAgIGNvbnN0IGxpbWl0ID0gcGFyYW1zLmxpbWl0ID8gcGFyc2VJbnQocGFyYW1zLmxpbWl0KSA6IDBcblxuICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IENvbW1lbnRzLmdldE1zZ0xpc3Qob2JqLl9pZCwgcGFnZSwgbGltaXQpXG4gICAgY29uc3QgbnVtID0gYXdhaXQgQ29tbWVudHMuZ2V0VG90YWwob2JqLl9pZClcblxuICAgIGNvbnNvbGUubG9nKFwiZ2V0TXNnIC0+IHJlc3VsdFwiLCByZXN1bHQpXG5cbiAgICBjdHguYm9keSA9IHtcbiAgICAgICAgY29kZTogMjAwLFxuICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgIHRvdGFsOiBudW1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNldE1zZyAoY3R4KSB7XG4gICAgY29uc3QgcGFyYW1zID0gY3R4LnF1ZXJ5XG4gICAgaWYgKHBhcmFtcy5pZCkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDb21tZW50cy51cGRhdGVPbmUoXG4gICAgICAgICAgICB7IF9pZDogcGFyYW1zLmlkIH0sXG4gICAgICAgICAgICB7IGlzUmVhZDogJzEnIH1cbiAgICAgICAgKVxuICAgICAgICBpZiAocmVzdWx0Lm9rID09PSAxKSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiAyMDBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IGF3YWl0IGdldEpXVFBheWxvYWQoY3R4LmhlYWRlci5hdXRob3JpemF0aW9uKVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDb21tZW50cy51cGRhdGVNYW55KFxuICAgICAgICAgICAgeyB1aWQ6IG9iai5faWQgfSxcbiAgICAgICAgICAgIHsgaXNSZWFkOiAnMScgfVxuICAgICAgICApXG4gICAgICAgIGlmIChyZXN1bHQub2sgPT09IDEpIHtcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMFxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5cbm1vZHVsZS5leHBvcnRzID0geyB1c2VyU2lnbiwgdXBkYXRlVXNlckluZm8sIGNoYW5nZVBhc3N3b3JkLCBnZXRNc2csIHNldE1zZyB9Il19",
    "map": {
      "version": 3,
      "sources": [
        "UserController.js"
      ],
      "names": [
        "SignRecord",
        "require",
        "User",
        "Utils",
        "setValue",
        "send",
        "config",
        "getJWTPayload",
        "Comments",
        "moment",
        "uuid",
        "jwt",
        "bcrypt",
        "userSign",
        "ctx",
        "obj",
        "header",
        "authorization",
        "record",
        "findByUid",
        "_id",
        "console",
        "log",
        "user",
        "findByID",
        "newRecord",
        "result",
        "created",
        "format",
        "body",
        "code",
        "favs",
        "count",
        "lastSign",
        "msg",
        "fav",
        "subtract",
        "updateOne",
        "$inc",
        "$set",
        "uid",
        "save",
        "updateUserInfo",
        "request",
        "findOne",
        "username",
        "tmpUser",
        "password",
        "key",
        "sign",
        "JWT_SECRET",
        "expiresIn",
        "type",
        "data",
        "expire",
        "add",
        "email",
        "name",
        "arr",
        "map",
        "item",
        "n",
        "ok",
        "changePassword",
        "compare",
        "oldPassword",
        "newPassword",
        "hash",
        "getMsg",
        "params",
        "query",
        "page",
        "limit",
        "parseInt",
        "getMsgList",
        "num",
        "getTotal",
        "total",
        "setMsg",
        "id",
        "isRead",
        "updateMany",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "const SignRecord = require('../model/SignRecord')\nconst User = require('../model/User')\nconst Utils = require('../common/Utils')\nconst { setValue } = require('../config/RedisConfig')\nconst { send } = require('../config/MailConfig')\nconst config = require('../config/index')\nconst { getJWTPayload } = require('../common/Utils')\nconst Comments = require('../model/Comments')\n\nconst moment = require('dayjs')\nconst uuid = require('uuid/v4')\nconst jwt = require('jsonwebtoken')\nconst bcrypt = require('bcrypt')\n\nasync function userSign (ctx) {\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    const record = await SignRecord.findByUid(obj._id)\n    console.log(\"userSign -> record\", record)\n    const user = await User.findByID(obj._id)\n    let newRecord = {}\n    let result = ''\n    record.created = '2020-03-14T02:54:41.000Z'\n    if (record !== null) {\n        if (moment(record.created).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD')) {\n            ctx.body = {\n                code: 500,\n                favs: user.favs,\n                count: user.count,\n                lastSign: record.created,\n                msg: '用户已经签到'\n            }\n            return\n        } else {\n            let count = user.count\n            console.log(\"userSign -> count\", count)\n            let fav = 0\n            if (moment(record.created).format('YYYY-MM-DD') === moment().subtract(1, 'days').format('YYYY-MM-DD')) {\n                count += 1\n                if (count < 5) {\n                    fav = 5\n                } else if (count >= 5 && count < 15) {\n                    fav = 10\n                } else if (count >= 15 && count < 30) {\n                    fav = 15\n                } else if (count >= 30 && count < 100) {\n                    fav = 20\n                } else if (count >= 100 && count < 365) {\n                    fav = 30\n                } else if (count >= 365) {\n                    fav = 50\n                }\n                await User.updateOne(\n                    { _id: obj._id },\n                    { $inc: { favs: fav, count: 1 } }\n                )\n                result = {\n                    favs: user.favs + fav,\n                    count: user.count + 1\n                }\n            } else {\n                fav = 5\n                await User.updateOne(\n                    { _id: obj._id },\n                    {\n                        $set: { count: 1 },\n                        $inc: { favs: fav }\n                    }\n                )\n                result = {\n                    favs: user.favs + fav,\n                    count: 1\n                }\n            }\n            newRecord = new SignRecord({\n                uid: obj._id,\n                favs: fav\n            })\n            await newRecord.save()\n        }\n    } else {\n        await User.updateOne({\n            _id: obj._id\n        },\n            {\n                $set: { count: 1 },\n                $inc: { favs: 5 }\n            })\n        newRecord = new SignRecord({\n            uid: obj._id,\n            favs: 5\n            // lastSign: moment().format('YYYY-MM-DD HH:mm:ss')\n        })\n        await newRecord.save()\n        result = {\n            favs: user.favs + 5,\n            count: 1\n        }\n    }\n    ctx.body = {\n        code: 200,\n        msg: '请求成功',\n        ...result,\n        lastSign: newRecord.created\n    }\n}\n\nasync function updateUserInfo (ctx) {\n    const { body } = ctx.request\n    console.log(\"updateUserInfo -> body\", body)\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    console.log(\"updateUserInfo -> obj\", obj)\n    const user = await User.findOne({ _id: obj._id })\n    console.log(\"updateUserInfo -> user\", user)\n    let msg = ''\n    if (body.username && body.username !== user.username) {\n        const tmpUser = await User.findOne({ username: body.username })\n        console.log(\"updateUserInfo -> tmpUser\", tmpUser)\n        if (tmpUser && tmpUser.password) {\n            ctx.body = {\n                code: 501,\n                msg: '邮箱已经注册'\n            }\n            return\n        }\n        const key = uuid()\n        setValue(\n            key,\n            jwt.sign({ _id: obj._id }, config.JWT_SECRET, {\n                expiresIn: '30m'\n            })\n        )\n        await send({\n            type: 'email',\n            data: {\n                key: key,\n                username: body.username\n            },\n            code: '',\n            expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n            email: user.username,\n            user: user.name\n        })\n        msg = '更新基本资料成功，账号修改需要邮件确认，请查收邮件'\n    }\n    const arr = ['username', 'mobile', 'password']\n    arr.map(item => {\n        delete body[item]\n    })\n    const result = await User.updateOne({ _id: obj._id }, body)\n    console.log(\"result\", result)\n    if (result.n === 1 && result.ok === 1) {\n        ctx.body = {\n            code: 200,\n            msg: msg === '' ? '更新成功' : msg\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '更新失败'\n        }\n    }\n}\n\nasync function changePassword (ctx) {\n    const { body } = ctx.request\n    console.log(\"changePassword -> body\", body)\n    const obj = await Utils.getJWTPayload(ctx.header.authorization)\n    const user = await User.findOne({ _id: obj._id })\n    console.log(\"changePassword -> user\", user)\n    let msg = ''\n    if (await bcrypt.compare(body.oldPassword, user.password)) {\n        body.newPassword = await bcrypt.hash(body.newPassword, 5)\n        console.log(\"changePassword ->  body.newPassword\", body.newPassword)\n        const result = await User.updateOne({ _id: obj._id }, { password: body.newPassword })\n        console.log(\"result\", result)\n        if (result.n === 1 && result.ok === 1) {\n            ctx.body = {\n                code: 200,\n                msg: msg === '' ? '更新成功' : msg\n            }\n        } else {\n            ctx.body = {\n                code: 500,\n                msg: '更新失败'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 501,\n            msg: '原来的密码填写错误'\n        }\n        return\n    }\n\n}\n\nasync function getMsg (ctx) {\n    const params = ctx.query\n    const page = params.page ? params.page : 0\n    const limit = params.limit ? parseInt(params.limit) : 0\n\n    const obj = await getJWTPayload(ctx.header.authorization)\n    const result = await Comments.getMsgList(obj._id, page, limit)\n    const num = await Comments.getTotal(obj._id)\n\n    console.log(\"getMsg -> result\", result)\n\n    ctx.body = {\n        code: 200,\n        data: result,\n        total: num\n    }\n}\n\nasync function setMsg (ctx) {\n    const params = ctx.query\n    if (params.id) {\n        const result = await Comments.updateOne(\n            { _id: params.id },\n            { isRead: '1' }\n        )\n        if (result.ok === 1) {\n            ctx.body = {\n                code: 200\n            }\n        }\n    } else {\n        const obj = await getJWTPayload(ctx.header.authorization)\n        const result = await Comments.updateMany(\n            { uid: obj._id },\n            { isRead: '1' }\n        )\n        if (result.ok === 1) {\n            ctx.body = {\n                code: 200\n            }\n        }\n    }\n}\n\n\nmodule.exports = { userSign, updateUserInfo, changePassword, getMsg, setMsg }"
      ]
    },
    "sourceType": "script",
    "mtime": 1586314181597
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/SignRecord.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/SignRecord.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/SignRecord.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model/SignRecord.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
        "sourceFileName": "SignRecord.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst mongoose = require('../config/DBHelper');\n\nconst moment = require('dayjs');\n\nconst Schema = mongoose.Schema;\nconst SignRecordSchema = new Schema({\n  uid: {\n    type: String,\n    ref: 'users'\n  },\n  created: {\n    type: Date\n  },\n  favs: {\n    type: Number\n  },\n  lastSign: {\n    type: Date\n  }\n});\nSignRecordSchema.pre('save', function (next) {\n  this.created = moment().format('YYYY-MM-DD HH:mm:ss');\n  next();\n});\nSignRecordSchema.statics = {\n  findByUid: function (uid) {\n    return this.findOne({\n      uid: uid\n    }).sort({\n      created: -1\n    });\n  }\n};\nconst SignRecord = mongoose.model('sign_record', SignRecordSchema);\nmodule.exports = SignRecord;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNpZ25SZWNvcmQuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwibW9tZW50IiwiU2NoZW1hIiwiU2lnblJlY29yZFNjaGVtYSIsInVpZCIsInR5cGUiLCJTdHJpbmciLCJyZWYiLCJjcmVhdGVkIiwiRGF0ZSIsImZhdnMiLCJOdW1iZXIiLCJsYXN0U2lnbiIsInByZSIsIm5leHQiLCJmb3JtYXQiLCJzdGF0aWNzIiwiZmluZEJ5VWlkIiwiZmluZE9uZSIsInNvcnQiLCJTaWduUmVjb3JkIiwibW9kZWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLG9CQUFELENBQXhCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0QsT0FBTyxDQUFDLE9BQUQsQ0FBdEI7O0FBRUEsTUFBTUUsTUFBTSxHQUFHSCxRQUFRLENBQUNHLE1BQXhCO0FBRUEsTUFBTUMsZ0JBQWdCLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQ2hDRSxFQUFBQSxHQUFHLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQyxNQUFSO0FBQWdCQyxJQUFBQSxHQUFHLEVBQUU7QUFBckIsR0FEMkI7QUFFaENDLEVBQUFBLE9BQU8sRUFBRTtBQUFFSCxJQUFBQSxJQUFJLEVBQUVJO0FBQVIsR0FGdUI7QUFHaENDLEVBQUFBLElBQUksRUFBRTtBQUFFTCxJQUFBQSxJQUFJLEVBQUVNO0FBQVIsR0FIMEI7QUFJaENDLEVBQUFBLFFBQVEsRUFBRTtBQUFFUCxJQUFBQSxJQUFJLEVBQUVJO0FBQVI7QUFKc0IsQ0FBWCxDQUF6QjtBQU9BTixnQkFBZ0IsQ0FBQ1UsR0FBakIsQ0FBcUIsTUFBckIsRUFBNkIsVUFBVUMsSUFBVixFQUFnQjtBQUN6QyxPQUFLTixPQUFMLEdBQWVQLE1BQU0sR0FBR2MsTUFBVCxDQUFnQixxQkFBaEIsQ0FBZjtBQUNBRCxFQUFBQSxJQUFJO0FBQ1AsQ0FIRDtBQUtBWCxnQkFBZ0IsQ0FBQ2EsT0FBakIsR0FBMkI7QUFDdkJDLEVBQUFBLFNBQVMsRUFBRSxVQUFVYixHQUFWLEVBQWU7QUFDdEIsV0FBTyxLQUFLYyxPQUFMLENBQWE7QUFBQ2QsTUFBQUEsR0FBRyxFQUFDQTtBQUFMLEtBQWIsRUFBd0JlLElBQXhCLENBQTZCO0FBQUNYLE1BQUFBLE9BQU8sRUFBQyxDQUFDO0FBQVYsS0FBN0IsQ0FBUDtBQUNIO0FBSHNCLENBQTNCO0FBTUEsTUFBTVksVUFBVSxHQUFHckIsUUFBUSxDQUFDc0IsS0FBVCxDQUFlLGFBQWYsRUFBOEJsQixnQkFBOUIsQ0FBbkI7QUFFQW1CLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlSCxVQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjL21vZGVsIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCcuLi9jb25maWcvREJIZWxwZXInKVxuY29uc3QgbW9tZW50ID0gcmVxdWlyZSgnZGF5anMnKVxuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWFcblxuY29uc3QgU2lnblJlY29yZFNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIHVpZDogeyB0eXBlOiBTdHJpbmcsIHJlZjogJ3VzZXJzJyB9LFxuICAgIGNyZWF0ZWQ6IHsgdHlwZTogRGF0ZSB9LFxuICAgIGZhdnM6IHsgdHlwZTogTnVtYmVyIH0sXG4gICAgbGFzdFNpZ246IHsgdHlwZTogRGF0ZSB9XG59KVxuXG5TaWduUmVjb3JkU2NoZW1hLnByZSgnc2F2ZScsIGZ1bmN0aW9uIChuZXh0KSB7XG4gICAgdGhpcy5jcmVhdGVkID0gbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICBuZXh0KClcbn0pXG5cblNpZ25SZWNvcmRTY2hlbWEuc3RhdGljcyA9IHtcbiAgICBmaW5kQnlVaWQ6IGZ1bmN0aW9uICh1aWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmluZE9uZSh7dWlkOnVpZH0pLnNvcnQoe2NyZWF0ZWQ6LTF9KVxuICAgIH1cbn1cblxuY29uc3QgU2lnblJlY29yZCA9IG1vbmdvb3NlLm1vZGVsKCdzaWduX3JlY29yZCcsIFNpZ25SZWNvcmRTY2hlbWEpXG5cbm1vZHVsZS5leHBvcnRzPVNpZ25SZWNvcmQiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "SignRecord.js"
      ],
      "names": [
        "mongoose",
        "require",
        "moment",
        "Schema",
        "SignRecordSchema",
        "uid",
        "type",
        "String",
        "ref",
        "created",
        "Date",
        "favs",
        "Number",
        "lastSign",
        "pre",
        "next",
        "format",
        "statics",
        "findByUid",
        "findOne",
        "sort",
        "SignRecord",
        "model",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAC,OAAD,CAAtB;;AAEA,MAAME,MAAM,GAAGH,QAAQ,CAACG,MAAxB;AAEA,MAAMC,gBAAgB,GAAG,IAAID,MAAJ,CAAW;AAChCE,EAAAA,GAAG,EAAE;AAAEC,IAAAA,IAAI,EAAEC,MAAR;AAAgBC,IAAAA,GAAG,EAAE;AAArB,GAD2B;AAEhCC,EAAAA,OAAO,EAAE;AAAEH,IAAAA,IAAI,EAAEI;AAAR,GAFuB;AAGhCC,EAAAA,IAAI,EAAE;AAAEL,IAAAA,IAAI,EAAEM;AAAR,GAH0B;AAIhCC,EAAAA,QAAQ,EAAE;AAAEP,IAAAA,IAAI,EAAEI;AAAR;AAJsB,CAAX,CAAzB;AAOAN,gBAAgB,CAACU,GAAjB,CAAqB,MAArB,EAA6B,UAAUC,IAAV,EAAgB;AACzC,OAAKN,OAAL,GAAeP,MAAM,GAAGc,MAAT,CAAgB,qBAAhB,CAAf;AACAD,EAAAA,IAAI;AACP,CAHD;AAKAX,gBAAgB,CAACa,OAAjB,GAA2B;AACvBC,EAAAA,SAAS,EAAE,UAAUb,GAAV,EAAe;AACtB,WAAO,KAAKc,OAAL,CAAa;AAACd,MAAAA,GAAG,EAACA;AAAL,KAAb,EAAwBe,IAAxB,CAA6B;AAACX,MAAAA,OAAO,EAAC,CAAC;AAAV,KAA7B,CAAP;AACH;AAHsB,CAA3B;AAMA,MAAMY,UAAU,GAAGrB,QAAQ,CAACsB,KAAT,CAAe,aAAf,EAA8BlB,gBAA9B,CAAnB;AAEAmB,MAAM,CAACC,OAAP,GAAeH,UAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/model",
      "sourcesContent": [
        "const mongoose = require('../config/DBHelper')\nconst moment = require('dayjs')\n\nconst Schema = mongoose.Schema\n\nconst SignRecordSchema = new Schema({\n    uid: { type: String, ref: 'users' },\n    created: { type: Date },\n    favs: { type: Number },\n    lastSign: { type: Date }\n})\n\nSignRecordSchema.pre('save', function (next) {\n    this.created = moment().format('YYYY-MM-DD HH:mm:ss')\n    next()\n})\n\nSignRecordSchema.statics = {\n    findByUid: function (uid) {\n        return this.findOne({uid:uid}).sort({created:-1})\n    }\n}\n\nconst SignRecord = mongoose.model('sign_record', SignRecordSchema)\n\nmodule.exports=SignRecord"
      ]
    },
    "sourceType": "script",
    "mtime": 1584200712828
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/MailConfig.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/MailConfig.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/MailConfig.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/MailConfig.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "MailConfig.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst nodemailer = require('nodemailer');\n\nconst config = require('./index');\n\nconst qs = require('qs'); // async..await is not allowed in global scope, must use a wrapper\n\n\nasync function send(sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount()\n  // create reusable transporter object using the default SMTP transport\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.163.com',\n    port: 465,\n    secure: true,\n    // true for 465, false for other ports\n    auth: {\n      user: 'leedawnm@163.com',\n      // generated ethereal user\n      pass: '93thing51' // generated ethereal password\n\n    }\n  }); // let sendInfo = {\n  //   code: '1234',\n  //   expire: '2019-10-01',\n  //   email: 'imoocbrian@qq.com',\n  //   user: 'Brian',\n  // }\n\n  const baseUrl = config.baseUrl;\n  const route = sendInfo.type === 'email' ? '/confirm' : '/reset';\n  const url = `${baseUrl}/#${route}?` + qs.stringify(sendInfo.data); // send mail with defined transport object\n\n  const info = await transporter.sendMail({\n    from: '\"认证邮件\" <leedawnm@163.com>',\n    // sender address\n    to: sendInfo.email,\n    // list of receivers\n    subject: sendInfo.user !== '' && sendInfo.type !== 'email' ? `你好开发者，${sendInfo.user}！《慕课网前端全栈实践》注册码` : '论坛系统密码确认修改链接',\n    // Subject line\n    text: `您在《慕课网前端全栈实践》课程中注册，您的邀请码是${sendInfo.code},邀请码的过期时间: ${sendInfo.expire}`,\n    // plain text body\n    html: `\n  \n        <div style=\"border: 1px solid #dcdcdc;color: #676767;width: 600px; margin: 0 auto; padding-bottom: 50px;position: relative;\">\n        <div style=\"height: 60px; background: #393d49; line-height: 60px; color: #58a36f; font-size: 18px;padding-left: 10px;\">Imooc社区——欢迎来到官方社区</div>\n        <div style=\"padding: 25px\">\n          <div>您好，${sendInfo.user}童鞋，重置链接有效时间30分钟，请在${sendInfo.expire}之前${sendInfo.code ? '重置您的密码' : '修改您的邮箱为：' + sendInfo.data.username}：</div>\n          <a href=\"${url}\" style=\"padding: 10px 20px; color: #fff; background: #009e94; display: inline-block;margin: 15px 0;\">${sendInfo.code ? '立即重置密码' : '确认设置邮箱'}</a>\n          <div style=\"padding: 5px; background: #f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定。</div>\n        </div>\n        <div style=\"background: #fafafa; color: #b4b4b4;text-align: center; line-height: 45px; height: 45px; position: absolute; left: 0; bottom: 0;width: 100%;\">系统邮件，请勿直接回复</div>\n    </div>\n    ` // html body\n\n  });\n  return `Message sent: %s, ${info.messageId}`; // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n  // Preview only available when sending through an Ethereal account\n  // console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n} // main().catch(console.error)\n\n\nmodule.exports = send;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1haWxDb25maWcuanMiXSwibmFtZXMiOlsibm9kZW1haWxlciIsInJlcXVpcmUiLCJjb25maWciLCJxcyIsInNlbmQiLCJzZW5kSW5mbyIsInRyYW5zcG9ydGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwidXNlciIsInBhc3MiLCJiYXNlVXJsIiwicm91dGUiLCJ0eXBlIiwidXJsIiwic3RyaW5naWZ5IiwiZGF0YSIsImluZm8iLCJzZW5kTWFpbCIsImZyb20iLCJ0byIsImVtYWlsIiwic3ViamVjdCIsInRleHQiLCJjb2RlIiwiZXhwaXJlIiwiaHRtbCIsInVzZXJuYW1lIiwibWVzc2FnZUlkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxVQUFVLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXhCOztBQUNBLE1BQU1DLE1BQU0sR0FBQ0QsT0FBTyxDQUFDLFNBQUQsQ0FBcEI7O0FBQ0EsTUFBTUUsRUFBRSxHQUFDRixPQUFPLENBQUMsSUFBRCxDQUFoQixDLENBRUE7OztBQUNBLGVBQWVHLElBQWYsQ0FBcUJDLFFBQXJCLEVBQStCO0FBQzdCO0FBQ0E7QUFDQTtBQUVBO0FBQ0EsUUFBTUMsV0FBVyxHQUFHTixVQUFVLENBQUNPLGVBQVgsQ0FBMkI7QUFDN0NDLElBQUFBLElBQUksRUFBRSxjQUR1QztBQUU3Q0MsSUFBQUEsSUFBSSxFQUFFLEdBRnVDO0FBRzdDQyxJQUFBQSxNQUFNLEVBQUUsSUFIcUM7QUFHL0I7QUFDZEMsSUFBQUEsSUFBSSxFQUFFO0FBQ0pDLE1BQUFBLElBQUksRUFBRSxrQkFERjtBQUNzQjtBQUMxQkMsTUFBQUEsSUFBSSxFQUFFLFdBRkYsQ0FFYzs7QUFGZDtBQUp1QyxHQUEzQixDQUFwQixDQU42QixDQWdCN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFFBQU1DLE9BQU8sR0FBR1osTUFBTSxDQUFDWSxPQUF2QjtBQUNBLFFBQU1DLEtBQUssR0FBR1YsUUFBUSxDQUFDVyxJQUFULEtBQWtCLE9BQWxCLEdBQTRCLFVBQTVCLEdBQXlDLFFBQXZEO0FBQ0EsUUFBTUMsR0FBRyxHQUFJLEdBQUVILE9BQVEsS0FBSUMsS0FBTSxHQUFyQixHQUEwQlosRUFBRSxDQUFDZSxTQUFILENBQWFiLFFBQVEsQ0FBQ2MsSUFBdEIsQ0FBdEMsQ0F4QjZCLENBMEI3Qjs7QUFDQSxRQUFNQyxJQUFJLEdBQUcsTUFBTWQsV0FBVyxDQUFDZSxRQUFaLENBQXFCO0FBQ3RDQyxJQUFBQSxJQUFJLEVBQUUsMkJBRGdDO0FBQ0g7QUFDbkNDLElBQUFBLEVBQUUsRUFBRWxCLFFBQVEsQ0FBQ21CLEtBRnlCO0FBRWxCO0FBQ3BCQyxJQUFBQSxPQUFPLEVBQ0xwQixRQUFRLENBQUNPLElBQVQsS0FBa0IsRUFBbEIsSUFBd0JQLFFBQVEsQ0FBQ1csSUFBVCxLQUFpQixPQUF6QyxHQUNLLFNBQVFYLFFBQVEsQ0FBQ08sSUFBSyxpQkFEM0IsR0FFSSxjQU5nQztBQU1oQjtBQUN0QmMsSUFBQUEsSUFBSSxFQUFHLDRCQUNMckIsUUFBUSxDQUFDc0IsSUFDUixjQUFhdEIsUUFBUSxDQUFDdUIsTUFBTyxFQVRNO0FBU0g7QUFDbkNDLElBQUFBLElBQUksRUFBRzs7Ozs7b0JBS1N4QixRQUFRLENBQUNPLElBQUsscUJBQzVCUCxRQUFRLENBQUN1QixNQUNSLEtBQUl2QixRQUFRLENBQUNzQixJQUFULEdBQWdCLFFBQWhCLEdBQTJCLGFBQWF0QixRQUFRLENBQUNjLElBQVQsQ0FBY1csUUFBUztxQkFDckRiLEdBQUkseUdBQXdHWixRQUFRLENBQUNzQixJQUFULEdBQWdCLFFBQWhCLEdBQTJCLFFBQVM7Ozs7O0tBbEIzSCxDQXVCcEM7O0FBdkJvQyxHQUFyQixDQUFuQjtBQTBCQSxTQUFRLHFCQUFvQlAsSUFBSSxDQUFDVyxTQUFVLEVBQTNDLENBckQ2QixDQXNEN0I7QUFFQTtBQUNBO0FBQ0E7QUFDRCxDLENBRUQ7OztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBZ0I3QixJQUFoQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBub2RlbWFpbGVyPXJlcXVpcmUoJ25vZGVtYWlsZXInKVxuY29uc3QgY29uZmlnPXJlcXVpcmUoJy4vaW5kZXgnKVxuY29uc3QgcXM9cmVxdWlyZSgncXMnKVxuXG4vLyBhc3luYy4uYXdhaXQgaXMgbm90IGFsbG93ZWQgaW4gZ2xvYmFsIHNjb3BlLCBtdXN0IHVzZSBhIHdyYXBwZXJcbmFzeW5jIGZ1bmN0aW9uIHNlbmQgKHNlbmRJbmZvKSB7XG4gIC8vIEdlbmVyYXRlIHRlc3QgU01UUCBzZXJ2aWNlIGFjY291bnQgZnJvbSBldGhlcmVhbC5lbWFpbFxuICAvLyBPbmx5IG5lZWRlZCBpZiB5b3UgZG9uJ3QgaGF2ZSBhIHJlYWwgbWFpbCBhY2NvdW50IGZvciB0ZXN0aW5nXG4gIC8vIGxldCB0ZXN0QWNjb3VudCA9IGF3YWl0IG5vZGVtYWlsZXIuY3JlYXRlVGVzdEFjY291bnQoKVxuXG4gIC8vIGNyZWF0ZSByZXVzYWJsZSB0cmFuc3BvcnRlciBvYmplY3QgdXNpbmcgdGhlIGRlZmF1bHQgU01UUCB0cmFuc3BvcnRcbiAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgaG9zdDogJ3NtdHAuMTYzLmNvbScsXG4gICAgcG9ydDogNDY1LFxuICAgIHNlY3VyZTogdHJ1ZSwgLy8gdHJ1ZSBmb3IgNDY1LCBmYWxzZSBmb3Igb3RoZXIgcG9ydHNcbiAgICBhdXRoOiB7XG4gICAgICB1c2VyOiAnbGVlZGF3bm1AMTYzLmNvbScsIC8vIGdlbmVyYXRlZCBldGhlcmVhbCB1c2VyXG4gICAgICBwYXNzOiAnOTN0aGluZzUxJyAvLyBnZW5lcmF0ZWQgZXRoZXJlYWwgcGFzc3dvcmRcbiAgICB9XG4gIH0pXG5cbiAgLy8gbGV0IHNlbmRJbmZvID0ge1xuICAvLyAgIGNvZGU6ICcxMjM0JyxcbiAgLy8gICBleHBpcmU6ICcyMDE5LTEwLTAxJyxcbiAgLy8gICBlbWFpbDogJ2ltb29jYnJpYW5AcXEuY29tJyxcbiAgLy8gICB1c2VyOiAnQnJpYW4nLFxuICAvLyB9XG4gIGNvbnN0IGJhc2VVcmwgPSBjb25maWcuYmFzZVVybFxuICBjb25zdCByb3V0ZSA9IHNlbmRJbmZvLnR5cGUgPT09ICdlbWFpbCcgPyAnL2NvbmZpcm0nIDogJy9yZXNldCdcbiAgY29uc3QgdXJsID0gYCR7YmFzZVVybH0vIyR7cm91dGV9P2AgKyBxcy5zdHJpbmdpZnkoc2VuZEluZm8uZGF0YSlcblxuICAvLyBzZW5kIG1haWwgd2l0aCBkZWZpbmVkIHRyYW5zcG9ydCBvYmplY3RcbiAgY29uc3QgaW5mbyA9IGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKHtcbiAgICBmcm9tOiAnXCLorqTor4Hpgq7ku7ZcIiA8bGVlZGF3bm1AMTYzLmNvbT4nLCAvLyBzZW5kZXIgYWRkcmVzc1xuICAgIHRvOiBzZW5kSW5mby5lbWFpbCwgLy8gbGlzdCBvZiByZWNlaXZlcnNcbiAgICBzdWJqZWN0OlxuICAgICAgc2VuZEluZm8udXNlciAhPT0gJycgJiYgc2VuZEluZm8udHlwZSAhPT0nZW1haWwnXG4gICAgICAgID8gYOS9oOWlveW8gOWPkeiAhe+8jCR7c2VuZEluZm8udXNlcn3vvIHjgIrmhZXor77nvZHliY3nq6/lhajmoIjlrp7ot7XjgIvms6jlhoznoIFgXG4gICAgICAgIDogJ+iuuuWdm+ezu+e7n+WvhueggeehruiupOS/ruaUuemTvuaOpScsIC8vIFN1YmplY3QgbGluZVxuICAgIHRleHQ6IGDmgqjlnKjjgIrmhZXor77nvZHliY3nq6/lhajmoIjlrp7ot7XjgIvor77nqIvkuK3ms6jlhozvvIzmgqjnmoTpgoDor7fnoIHmmK8ke1xuICAgICAgc2VuZEluZm8uY29kZVxuICAgICAgfSzpgoDor7fnoIHnmoTov4fmnJ/ml7bpl7Q6ICR7c2VuZEluZm8uZXhwaXJlfWAsIC8vIHBsYWluIHRleHQgYm9keVxuICAgIGh0bWw6IGBcbiAgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJib3JkZXI6IDFweCBzb2xpZCAjZGNkY2RjO2NvbG9yOiAjNjc2NzY3O3dpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmctYm90dG9tOiA1MHB4O3Bvc2l0aW9uOiByZWxhdGl2ZTtcIj5cbiAgICAgICAgPGRpdiBzdHlsZT1cImhlaWdodDogNjBweDsgYmFja2dyb3VuZDogIzM5M2Q0OTsgbGluZS1oZWlnaHQ6IDYwcHg7IGNvbG9yOiAjNThhMzZmOyBmb250LXNpemU6IDE4cHg7cGFkZGluZy1sZWZ0OiAxMHB4O1wiPkltb29j56S+5Yy64oCU4oCU5qyi6L+O5p2l5Yiw5a6Y5pa556S+5Yy6PC9kaXY+XG4gICAgICAgIDxkaXYgc3R5bGU9XCJwYWRkaW5nOiAyNXB4XCI+XG4gICAgICAgICAgPGRpdj7mgqjlpb3vvIwke3NlbmRJbmZvLnVzZXJ956ul6Z6L77yM6YeN572u6ZO+5o6l5pyJ5pWI5pe26Ze0MzDliIbpkp/vvIzor7flnKgke1xuICAgICAgc2VuZEluZm8uZXhwaXJlXG4gICAgICB95LmL5YmNJHtzZW5kSW5mby5jb2RlID8gJ+mHjee9ruaCqOeahOWvhueggScgOiAn5L+u5pS55oKo55qE6YKu566x5Li677yaJyArIHNlbmRJbmZvLmRhdGEudXNlcm5hbWV977yaPC9kaXY+XG4gICAgICAgICAgPGEgaHJlZj1cIiR7dXJsfVwiIHN0eWxlPVwicGFkZGluZzogMTBweCAyMHB4OyBjb2xvcjogI2ZmZjsgYmFja2dyb3VuZDogIzAwOWU5NDsgZGlzcGxheTogaW5saW5lLWJsb2NrO21hcmdpbjogMTVweCAwO1wiPiR7c2VuZEluZm8uY29kZSA/ICfnq4vljbPph43nva7lr4bnoIEnIDogJ+ehruiupOiuvue9rumCrueusSd9PC9hPlxuICAgICAgICAgIDxkaXYgc3R5bGU9XCJwYWRkaW5nOiA1cHg7IGJhY2tncm91bmQ6ICNmMmYyZjI7XCI+5aaC5p6c6K+l6YKu5Lu25LiN5piv55Sx5L2g5pys5Lq65pON5L2c77yM6K+35Yu/6L+b6KGM5r+A5rS777yB5ZCm5YiZ5L2g55qE6YKu566x5bCG5Lya6KKr5LuW5Lq657uR5a6a44CCPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZDogI2ZhZmFmYTsgY29sb3I6ICNiNGI0YjQ7dGV4dC1hbGlnbjogY2VudGVyOyBsaW5lLWhlaWdodDogNDVweDsgaGVpZ2h0OiA0NXB4OyBwb3NpdGlvbjogYWJzb2x1dGU7IGxlZnQ6IDA7IGJvdHRvbTogMDt3aWR0aDogMTAwJTtcIj7ns7vnu5/pgq7ku7bvvIzor7fli7/nm7TmjqXlm57lpI08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICBgIC8vIGh0bWwgYm9keVxuICB9KVxuXG4gIHJldHVybiBgTWVzc2FnZSBzZW50OiAlcywgJHtpbmZvLm1lc3NhZ2VJZH1gXG4gIC8vIE1lc3NhZ2Ugc2VudDogPGI2NThmOGNhLTYyOTYtY2NmNC04MzA2LTg3ZDU3YTBiNDMyMUBleGFtcGxlLmNvbT5cblxuICAvLyBQcmV2aWV3IG9ubHkgYXZhaWxhYmxlIHdoZW4gc2VuZGluZyB0aHJvdWdoIGFuIEV0aGVyZWFsIGFjY291bnRcbiAgLy8gY29uc29sZS5sb2coJ1ByZXZpZXcgVVJMOiAlcycsIG5vZGVtYWlsZXIuZ2V0VGVzdE1lc3NhZ2VVcmwoaW5mbykpXG4gIC8vIFByZXZpZXcgVVJMOiBodHRwczovL2V0aGVyZWFsLmVtYWlsL21lc3NhZ2UvV2FRS01nS2RkeFFEb291Li4uXG59XG5cbi8vIG1haW4oKS5jYXRjaChjb25zb2xlLmVycm9yKVxuXG5tb2R1bGUuZXhwb3J0cz0gc2VuZFxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "MailConfig.js"
      ],
      "names": [
        "nodemailer",
        "require",
        "config",
        "qs",
        "send",
        "sendInfo",
        "transporter",
        "createTransport",
        "host",
        "port",
        "secure",
        "auth",
        "user",
        "pass",
        "baseUrl",
        "route",
        "type",
        "url",
        "stringify",
        "data",
        "info",
        "sendMail",
        "from",
        "to",
        "email",
        "subject",
        "text",
        "code",
        "expire",
        "html",
        "username",
        "messageId",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,UAAU,GAACC,OAAO,CAAC,YAAD,CAAxB;;AACA,MAAMC,MAAM,GAACD,OAAO,CAAC,SAAD,CAApB;;AACA,MAAME,EAAE,GAACF,OAAO,CAAC,IAAD,CAAhB,C,CAEA;;;AACA,eAAeG,IAAf,CAAqBC,QAArB,EAA+B;AAC7B;AACA;AACA;AAEA;AACA,QAAMC,WAAW,GAAGN,UAAU,CAACO,eAAX,CAA2B;AAC7CC,IAAAA,IAAI,EAAE,cADuC;AAE7CC,IAAAA,IAAI,EAAE,GAFuC;AAG7CC,IAAAA,MAAM,EAAE,IAHqC;AAG/B;AACdC,IAAAA,IAAI,EAAE;AACJC,MAAAA,IAAI,EAAE,kBADF;AACsB;AAC1BC,MAAAA,IAAI,EAAE,WAFF,CAEc;;AAFd;AAJuC,GAA3B,CAApB,CAN6B,CAgB7B;AACA;AACA;AACA;AACA;AACA;;AACA,QAAMC,OAAO,GAAGZ,MAAM,CAACY,OAAvB;AACA,QAAMC,KAAK,GAAGV,QAAQ,CAACW,IAAT,KAAkB,OAAlB,GAA4B,UAA5B,GAAyC,QAAvD;AACA,QAAMC,GAAG,GAAI,GAAEH,OAAQ,KAAIC,KAAM,GAArB,GAA0BZ,EAAE,CAACe,SAAH,CAAab,QAAQ,CAACc,IAAtB,CAAtC,CAxB6B,CA0B7B;;AACA,QAAMC,IAAI,GAAG,MAAMd,WAAW,CAACe,QAAZ,CAAqB;AACtCC,IAAAA,IAAI,EAAE,2BADgC;AACH;AACnCC,IAAAA,EAAE,EAAElB,QAAQ,CAACmB,KAFyB;AAElB;AACpBC,IAAAA,OAAO,EACLpB,QAAQ,CAACO,IAAT,KAAkB,EAAlB,IAAwBP,QAAQ,CAACW,IAAT,KAAiB,OAAzC,GACK,SAAQX,QAAQ,CAACO,IAAK,iBAD3B,GAEI,cANgC;AAMhB;AACtBc,IAAAA,IAAI,EAAG,4BACLrB,QAAQ,CAACsB,IACR,cAAatB,QAAQ,CAACuB,MAAO,EATM;AASH;AACnCC,IAAAA,IAAI,EAAG;;;;;oBAKSxB,QAAQ,CAACO,IAAK,qBAC5BP,QAAQ,CAACuB,MACR,KAAIvB,QAAQ,CAACsB,IAAT,GAAgB,QAAhB,GAA2B,aAAatB,QAAQ,CAACc,IAAT,CAAcW,QAAS;qBACrDb,GAAI,yGAAwGZ,QAAQ,CAACsB,IAAT,GAAgB,QAAhB,GAA2B,QAAS;;;;;KAlB3H,CAuBpC;;AAvBoC,GAArB,CAAnB;AA0BA,SAAQ,qBAAoBP,IAAI,CAACW,SAAU,EAA3C,CArD6B,CAsD7B;AAEA;AACA;AACA;AACD,C,CAED;;;AAEAC,MAAM,CAACC,OAAP,GAAgB7B,IAAhB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "const nodemailer=require('nodemailer')\nconst config=require('./index')\nconst qs=require('qs')\n\n// async..await is not allowed in global scope, must use a wrapper\nasync function send (sendInfo) {\n  // Generate test SMTP service account from ethereal.email\n  // Only needed if you don't have a real mail account for testing\n  // let testAccount = await nodemailer.createTestAccount()\n\n  // create reusable transporter object using the default SMTP transport\n  const transporter = nodemailer.createTransport({\n    host: 'smtp.163.com',\n    port: 465,\n    secure: true, // true for 465, false for other ports\n    auth: {\n      user: 'leedawnm@163.com', // generated ethereal user\n      pass: '93thing51' // generated ethereal password\n    }\n  })\n\n  // let sendInfo = {\n  //   code: '1234',\n  //   expire: '2019-10-01',\n  //   email: 'imoocbrian@qq.com',\n  //   user: 'Brian',\n  // }\n  const baseUrl = config.baseUrl\n  const route = sendInfo.type === 'email' ? '/confirm' : '/reset'\n  const url = `${baseUrl}/#${route}?` + qs.stringify(sendInfo.data)\n\n  // send mail with defined transport object\n  const info = await transporter.sendMail({\n    from: '\"认证邮件\" <leedawnm@163.com>', // sender address\n    to: sendInfo.email, // list of receivers\n    subject:\n      sendInfo.user !== '' && sendInfo.type !=='email'\n        ? `你好开发者，${sendInfo.user}！《慕课网前端全栈实践》注册码`\n        : '论坛系统密码确认修改链接', // Subject line\n    text: `您在《慕课网前端全栈实践》课程中注册，您的邀请码是${\n      sendInfo.code\n      },邀请码的过期时间: ${sendInfo.expire}`, // plain text body\n    html: `\n  \n        <div style=\"border: 1px solid #dcdcdc;color: #676767;width: 600px; margin: 0 auto; padding-bottom: 50px;position: relative;\">\n        <div style=\"height: 60px; background: #393d49; line-height: 60px; color: #58a36f; font-size: 18px;padding-left: 10px;\">Imooc社区——欢迎来到官方社区</div>\n        <div style=\"padding: 25px\">\n          <div>您好，${sendInfo.user}童鞋，重置链接有效时间30分钟，请在${\n      sendInfo.expire\n      }之前${sendInfo.code ? '重置您的密码' : '修改您的邮箱为：' + sendInfo.data.username}：</div>\n          <a href=\"${url}\" style=\"padding: 10px 20px; color: #fff; background: #009e94; display: inline-block;margin: 15px 0;\">${sendInfo.code ? '立即重置密码' : '确认设置邮箱'}</a>\n          <div style=\"padding: 5px; background: #f2f2f2;\">如果该邮件不是由你本人操作，请勿进行激活！否则你的邮箱将会被他人绑定。</div>\n        </div>\n        <div style=\"background: #fafafa; color: #b4b4b4;text-align: center; line-height: 45px; height: 45px; position: absolute; left: 0; bottom: 0;width: 100%;\">系统邮件，请勿直接回复</div>\n    </div>\n    ` // html body\n  })\n\n  return `Message sent: %s, ${info.messageId}`\n  // Message sent: <b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com>\n\n  // Preview only available when sending through an Ethereal account\n  // console.log('Preview URL: %s', nodemailer.getTestMessageUrl(info))\n  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...\n}\n\n// main().catch(console.error)\n\nmodule.exports= send\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1585366695740
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/loginRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/loginRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/loginRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/loginRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "loginRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst loginController = require('../../api/LoginController');\n\nconst router = new Router();\nrouter.prefix('/login'); // router.post('/forget',loginController.forget)\n\nrouter.post('/login', loginController.login);\nrouter.post('/reg', loginController.reg);\nrouter.post('/forget', loginController.forget);\nrouter.post('/reset', loginController.reset);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luUm91dGVyLmpzIl0sIm5hbWVzIjpbIlJvdXRlciIsInJlcXVpcmUiLCJsb2dpbkNvbnRyb2xsZXIiLCJyb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibG9naW4iLCJyZWciLCJmb3JnZXQiLCJyZXNldCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsTUFBTSxHQUFDQyxPQUFPLENBQUMsWUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxlQUFlLEdBQUNELE9BQU8sQ0FBQywyQkFBRCxDQUE3Qjs7QUFFQSxNQUFNRSxNQUFNLEdBQUMsSUFBSUgsTUFBSixFQUFiO0FBRUFHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFFBQWQsRSxDQUNBOztBQUNBRCxNQUFNLENBQUNFLElBQVAsQ0FBWSxRQUFaLEVBQXFCSCxlQUFlLENBQUNJLEtBQXJDO0FBQ0FILE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLE1BQVosRUFBbUJILGVBQWUsQ0FBQ0ssR0FBbkM7QUFDQUosTUFBTSxDQUFDRSxJQUFQLENBQVksU0FBWixFQUFzQkgsZUFBZSxDQUFDTSxNQUF0QztBQUNBTCxNQUFNLENBQUNFLElBQVAsQ0FBWSxRQUFaLEVBQXFCSCxlQUFlLENBQUNPLEtBQXJDO0FBRUFDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFnQlIsTUFBaEIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvcm91dGVzL21vZHVsZXMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBSb3V0ZXI9cmVxdWlyZSgna29hLXJvdXRlcicpXG5jb25zdCBsb2dpbkNvbnRyb2xsZXI9cmVxdWlyZSgnLi4vLi4vYXBpL0xvZ2luQ29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcblxucm91dGVyLnByZWZpeCgnL2xvZ2luJylcbi8vIHJvdXRlci5wb3N0KCcvZm9yZ2V0Jyxsb2dpbkNvbnRyb2xsZXIuZm9yZ2V0KVxucm91dGVyLnBvc3QoJy9sb2dpbicsbG9naW5Db250cm9sbGVyLmxvZ2luKVxucm91dGVyLnBvc3QoJy9yZWcnLGxvZ2luQ29udHJvbGxlci5yZWcpXG5yb3V0ZXIucG9zdCgnL2ZvcmdldCcsbG9naW5Db250cm9sbGVyLmZvcmdldClcbnJvdXRlci5wb3N0KCcvcmVzZXQnLGxvZ2luQ29udHJvbGxlci5yZXNldClcblxubW9kdWxlLmV4cG9ydHM9IHJvdXRlciJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "loginRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "loginController",
        "router",
        "prefix",
        "post",
        "login",
        "reg",
        "forget",
        "reset",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,eAAe,GAACD,OAAO,CAAC,2BAAD,CAA7B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AAEAG,MAAM,CAACC,MAAP,CAAc,QAAd,E,CACA;;AACAD,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,eAAe,CAACI,KAArC;AACAH,MAAM,CAACE,IAAP,CAAY,MAAZ,EAAmBH,eAAe,CAACK,GAAnC;AACAJ,MAAM,CAACE,IAAP,CAAY,SAAZ,EAAsBH,eAAe,CAACM,MAAtC;AACAL,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,eAAe,CAACO,KAArC;AAEAC,MAAM,CAACC,OAAP,GAAgBR,MAAhB",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst loginController=require('../../api/LoginController')\n\nconst router=new Router()\n\nrouter.prefix('/login')\n// router.post('/forget',loginController.forget)\nrouter.post('/login',loginController.login)\nrouter.post('/reg',loginController.reg)\nrouter.post('/forget',loginController.forget)\nrouter.post('/reset',loginController.reset)\n\nmodule.exports= router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585404263267
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/LoginController.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/LoginController.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/LoginController.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api/LoginController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
        "sourceFileName": "LoginController.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst send = require('../config/MailConfig.js');\n\nconst bcrypt = require('bcrypt');\n\nconst moment = require('dayjs');\n\nconst jsonwebtoken = require('jsonwebtoken');\n\nconst config = require('../config/index'); // const checkCode=require('../common/Utils')\n\n\nconst Utils = require('../common/Utils');\n\nconst User = require('../model/User');\n\nconst forget = function (ctx) {\n  const {\n    body\n  } = ctx.request;\n\n  if (typeof body.username !== 'undefined') {\n    try {\n      let result = send({\n        code: '1234',\n        expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n        email: body.username,\n        user: 'echo'\n      });\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: '邮件发送成功'\n      };\n    } catch (e) {\n      console.log(e);\n    }\n  } else {\n    ctx.body = {\n      code: 500,\n      msg: '服务器异常'\n    };\n  }\n};\n\nasync function login(ctx) {\n  const {\n    body\n  } = ctx.request;\n  let sid = body.sid;\n  let code = body.code;\n  let result = await Utils.checkCode(sid, code);\n  console.log(result);\n\n  if (result) {\n    let checkUserPasswd = false;\n    let user = await User.findOne({\n      username: body.username\n    });\n\n    if (await bcrypt.compare(body.password, user.password)) {\n      checkUserPasswd = true;\n    }\n\n    if (checkUserPasswd) {\n      const userObj = user.toJSON();\n      const arr = ['password']; //和源码有不同，这里没有删除邮箱了。\n\n      arr.map(item => {\n        delete userObj[item];\n      });\n      let token = jsonwebtoken.sign({\n        _id: userObj._id\n      }, config.JWT_SECRET, {\n        expiresIn: '1d'\n      }); //\n\n      ctx.body = {\n        code: 200,\n        data: userObj,\n        token: token\n      };\n    } else {\n      ctx.body = {\n        code: 404,\n        msg: '用户名或密码错误'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 401,\n      msg: '图片验证码不正确，请检查！'\n    };\n  }\n}\n\nasync function reg(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"reg -> body\", body);\n  let sid = body.sid;\n  let code = body.code;\n  let msg = {};\n  let result = await Utils.checkCode(sid, code);\n  console.log(\"result:\" + result);\n  let check = true;\n\n  if (result) {\n    let user1 = await User.findOne({\n      username: body.username\n    });\n\n    if (user1 !== null && typeof user1.username !== 'undefined') {\n      console.log(\"user1\" + user1);\n      msg.username = ['此邮箱已经被注册，可以通过邮箱找回密码'];\n      check = false;\n    }\n\n    check = true;\n    let user2 = await User.findOne({\n      name: body.name\n    });\n\n    if (user2 !== null && typeof user2.name !== 'undefined') {\n      msg.name = ['此昵称已经被注册，请修改'];\n      check = false;\n    }\n\n    if (check) {\n      body.password = await bcrypt.hash(body.password, 5);\n      let user = new User({\n        username: body.username,\n        name: body.name,\n        password: body.password,\n        created: moment().format('YYYY-MM-DD HH:mm:ss')\n      });\n      let result = await user.save();\n      ctx.body = {\n        code: 200,\n        data: result,\n        msg: '注册成功'\n      };\n      return;\n    }\n  } else {\n    msg.code = ['验证码已经失效，请重新获取！'];\n  }\n\n  ctx.body = {\n    code: 500,\n    msg: msg\n  };\n}\n\nasync function reset(ctx) {\n  const {\n    body\n  } = ctx.request;\n  console.log(\"reset -> body\", body, body.username);\n  let sid = body.sid;\n  let code = body.code;\n  let msg = {};\n  const result = await Utils.checkCode(sid, code);\n\n  if (result) {\n    let user = await User.findOne({\n      username: body.username\n    });\n\n    if (user === null && user.username === 'undefined') {\n      msg.username = ['此邮箱未注册，请确认'];\n      ctx.body = {\n        code: 500,\n        msg: msg\n      };\n    } else {\n      user.password = await bcrypt.hash(body.password, 5);\n      user.updated = moment().format('YYYY-MM-DD HH:mm:ss');\n      let result = await user.save();\n      const userObj = result.toJSON();\n      const arr = ['password'];\n      arr.map(item => {\n        delete userObj[item];\n      });\n      let token = jsonwebtoken.sign({\n        _id: userObj._id\n      }, config.JWT_SECRET, {\n        expiresIn: '1d'\n      }); //\n\n      ctx.body = {\n        code: 200,\n        data: userObj,\n        token: token,\n        msg: '更新密码成功！'\n      };\n    }\n  } else {\n    ctx.body = {\n      code: 401,\n      msg: '图片验证码不正确，请检查！'\n    };\n  }\n}\n\nmodule.exports = {\n  forget,\n  login,\n  reg,\n  reset\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkxvZ2luQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJzZW5kIiwicmVxdWlyZSIsImJjcnlwdCIsIm1vbWVudCIsImpzb253ZWJ0b2tlbiIsImNvbmZpZyIsIlV0aWxzIiwiVXNlciIsImZvcmdldCIsImN0eCIsImJvZHkiLCJyZXF1ZXN0IiwidXNlcm5hbWUiLCJyZXN1bHQiLCJjb2RlIiwiZXhwaXJlIiwiYWRkIiwiZm9ybWF0IiwiZW1haWwiLCJ1c2VyIiwiZGF0YSIsIm1zZyIsImUiLCJjb25zb2xlIiwibG9nIiwibG9naW4iLCJzaWQiLCJjaGVja0NvZGUiLCJjaGVja1VzZXJQYXNzd2QiLCJmaW5kT25lIiwiY29tcGFyZSIsInBhc3N3b3JkIiwidXNlck9iaiIsInRvSlNPTiIsImFyciIsIm1hcCIsIml0ZW0iLCJ0b2tlbiIsInNpZ24iLCJfaWQiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwicmVnIiwiY2hlY2siLCJ1c2VyMSIsInVzZXIyIiwibmFtZSIsImhhc2giLCJjcmVhdGVkIiwic2F2ZSIsInJlc2V0IiwidXBkYXRlZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMseUJBQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxPQUFELENBQXRCOztBQUNBLE1BQU1HLFlBQVksR0FBR0gsT0FBTyxDQUFDLGNBQUQsQ0FBNUI7O0FBQ0EsTUFBTUksTUFBTSxHQUFHSixPQUFPLENBQUMsaUJBQUQsQ0FBdEIsQyxDQUNBOzs7QUFDQSxNQUFNSyxLQUFLLEdBQUdMLE9BQU8sQ0FBQyxpQkFBRCxDQUFyQjs7QUFDQSxNQUFNTSxJQUFJLEdBQUdOLE9BQU8sQ0FBQyxlQUFELENBQXBCOztBQUVBLE1BQU1PLE1BQU0sR0FBRyxVQUFVQyxHQUFWLEVBQWU7QUFDMUIsUUFBTTtB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R2MsTUFBVCxDQUFnQixxQkFBaEIsQ0FBYjtBQUNBLFVBQUlKLE1BQU0sR0FBRyxNQUFNTSxJQUFJLENBQUM4QixJQUFMLEVBQW5CO0FBQ0EsWUFBTWpCLE9BQU8sR0FBR25CLE1BQU0sQ0FBQ29CLE1BQVAsRUFBaEI7QUFDQSxZQUFNQyxHQUFHLEdBQUcsQ0FBQyxVQUFELENBQVo7QUFDQUEsTUFBQUEsR0FBRyxDQUFDQyxHQUFKLENBQVNDLElBQUQsSUFBVTtBQUNkLGVBQU9KLE9BQU8sQ0FBQ0ksSUFBRCxDQUFkO0FBQ0gsT0FGRDtBQUdBLFVBQUlDLEtBQUssR0FBR2pDLFlBQVksQ0FBQ2tDLElBQWIsQ0FBa0I7QUFBRUMsUUFBQUEsR0FBRyxFQUFFUCxPQUFPLENBQUNPO0FBQWYsT0FBbEIsRUFBd0NsQyxNQUFNLENBQUNtQyxVQUEvQyxFQUEyRDtBQUFFQyxRQUFBQSxTQUFTLEVBQUU7QUFBYixPQUEzRCxDQUFaLENBVEcsQ0FTeUY7O0FBQzVGaEMsTUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEksUUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUE0sUUFBQUEsSUFBSSxFQUFFWSxPQUZDO0FBR1BLLFFBQUFBLEtBQUssRUFBRUEsS0FIQTtBQUlQaEIsUUFBQUEsR0FBRyxFQUFDO0FBSkcsT0FBWDtBQU1IO0FBQ0osR0F6QkQsTUF5Qk87QUFDSFosSUFBQUEsR0FBRyxDQUFDQyxJQUFKLEdBQVc7QUFDUEksTUFBQUEsSUFBSSxFQUFFLEdBREM7QUFFUE8sTUFBQUEsR0FBRyxFQUFFO0FBRkUsS0FBWDtBQUlIO0FBQ0o7O0FBRUQrQixNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFBRTdDLEVBQUFBLE1BQUY7QUFBVWlCLEVBQUFBLEtBQVY7QUFBaUJpQixFQUFBQSxHQUFqQjtBQUFzQlEsRUFBQUE7QUFBdEIsQ0FBakIiLCJzb3VyY2VSb290IjoiL1VzZXJzL2FkbWluL0RvY3VtZW50cy9teS1naXRodWIvcmFuZ2VsYW5kL3JhbmdlbGFuZC1zZXJ2ZS9zcmMvYXBpIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2VuZCA9IHJlcXVpcmUoJy4uL2NvbmZpZy9NYWlsQ29uZmlnLmpzJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpXG5jb25zdCBtb21lbnQgPSByZXF1aXJlKCdkYXlqcycpXG5jb25zdCBqc29ud2VidG9rZW4gPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKVxuY29uc3QgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnL2luZGV4Jylcbi8vIGNvbnN0IGNoZWNrQ29kZT1yZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXRpbHMgPSByZXF1aXJlKCcuLi9jb21tb24vVXRpbHMnKVxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVsL1VzZXInKVxuXG5jb25zdCBmb3JnZXQgPSBmdW5jdGlvbiAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGlmICh0eXBlb2YgYm9keS51c2VybmFtZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBzZW5kKHtcbiAgICAgICAgICAgICAgICBjb2RlOiAnMTIzNCcsXG4gICAgICAgICAgICAgICAgZXhwaXJlOiBtb21lbnQoKS5hZGQoMzAsICdtaW51dGVzJykuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyksXG4gICAgICAgICAgICAgICAgZW1haWw6IGJvZHkudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgdXNlcjogJ2VjaG8nLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgbXNnOiAn6YKu5Lu25Y+R6YCB5oiQ5YqfJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA1MDAsXG4gICAgICAgICAgICBtc2c6ICfmnI3liqHlmajlvILluLgnXG4gICAgICAgIH1cbiAgICB9XG59XG5hc3luYyBmdW5jdGlvbiBsb2dpbiAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGxldCBzaWQgPSBib2R5LnNpZFxuICAgIGxldCBjb2RlID0gYm9keS5jb2RlXG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IFV0aWxzLmNoZWNrQ29kZShzaWQsIGNvZGUpXG4gICAgY29uc29sZS5sb2cocmVzdWx0KVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgbGV0IGNoZWNrVXNlclBhc3N3ZCA9IGZhbHNlXG4gICAgICAgIGxldCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgdXNlcm5hbWU6IGJvZHkudXNlcm5hbWUgfSlcbiAgICAgICAgaWYgKGF3YWl0IGJjcnlwdC5jb21wYXJlKGJvZHkucGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpKSB7XG4gICAgICAgICAgICBjaGVja1VzZXJQYXNzd2QgPSB0cnVlXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNoZWNrVXNlclBhc3N3ZCkge1xuICAgICAgICAgICAgY29uc3QgdXNlck9iaiA9IHVzZXIudG9KU09OKClcbiAgICAgICAgICAgIGNvbnN0IGFyciA9IFsncGFzc3dvcmQnXSAvL+WSjOa6kOeggeacieS4jeWQjO+8jOi/memHjOayoeacieWIoOmZpOmCrueuseS6huOAglxuICAgICAgICAgICAgYXJyLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB1c2VyT2JqW2l0ZW1dXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgbGV0IHRva2VuID0ganNvbndlYnRva2VuLnNpZ24oeyBfaWQ6IHVzZXJPYmouX2lkIH0sIGNvbmZpZy5KV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogJzFkJyB9KSAvL1xuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogMjAwLFxuICAgICAgICAgICAgICAgIGRhdGE6IHVzZXJPYmosXG4gICAgICAgICAgICAgICAgdG9rZW46IHRva2VuXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiA0MDQsXG4gICAgICAgICAgICAgICAgbXNnOiAn55So5oi35ZCN5oiW5a+G56CB6ZSZ6K+vJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICBjb2RlOiA0MDEsXG4gICAgICAgICAgICBtc2c6ICflm77niYfpqozor4HnoIHkuI3mraPnoa7vvIzor7fmo4Dmn6XvvIEnXG4gICAgICAgIH1cbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlZyAoY3R4KSB7XG4gICAgY29uc3QgeyBib2R5IH0gPSBjdHgucmVxdWVzdFxuICAgIGNvbnNvbGUubG9nKFwicmVnIC0+IGJvZHlcIiwgYm9keSlcbiAgICBsZXQgc2lkID0gYm9keS5zaWRcbiAgICBsZXQgY29kZSA9IGJvZHkuY29kZVxuICAgIGxldCBtc2cgPSB7fVxuICAgIGxldCByZXN1bHQgPSBhd2FpdCBVdGlscy5jaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGNvbnNvbGUubG9nKFwicmVzdWx0OlwiICsgcmVzdWx0KVxuICAgIGxldCBjaGVjayA9IHRydWVcbiAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIGxldCB1c2VyMSA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IHVzZXJuYW1lOiBib2R5LnVzZXJuYW1lIH0pXG4gICAgICAgIGlmICh1c2VyMSAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjEudXNlcm5hbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIxXCIgKyB1c2VyMSlcbiAgICAgICAgICAgIG1zZy51c2VybmFtZSA9IFsn5q2k6YKu566x5bey57uP6KKr5rOo5YaM77yM5Y+v5Lul6YCa6L+H6YKu566x5om+5Zue5a+G56CBJ11cbiAgICAgICAgICAgIGNoZWNrID0gZmFsc2VcbiAgICAgICAgfVxuICAgICAgICBjaGVjayA9IHRydWVcbiAgICAgICAgbGV0IHVzZXIyID0gYXdhaXQgVXNlci5maW5kT25lKHsgbmFtZTogYm9keS5uYW1lIH0pXG4gICAgICAgIGlmICh1c2VyMiAhPT0gbnVsbCAmJiB0eXBlb2YgdXNlcjIubmFtZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIG1zZy5uYW1lID0gWyfmraTmmLXnp7Dlt7Lnu4/ooqvms6jlhozvvIzor7fkv67mlLknXVxuICAgICAgICAgICAgY2hlY2sgPSBmYWxzZVxuICAgICAgICB9XG4gICAgICAgIGlmIChjaGVjaykge1xuICAgICAgICAgICAgYm9keS5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKGJvZHkucGFzc3dvcmQsIDUpXG4gICAgICAgICAgICBsZXQgdXNlciA9IG5ldyBVc2VyKHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogYm9keS51c2VybmFtZSxcbiAgICAgICAgICAgICAgICBuYW1lOiBib2R5Lm5hbWUsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGJvZHkucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgY3JlYXRlZDogbW9tZW50KCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJylcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdXNlci5zYXZlKClcbiAgICAgICAgICAgIGN0eC5ib2R5ID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IDIwMCxcbiAgICAgICAgICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgICAgICAgICAgbXNnOiAn5rOo5YaM5oiQ5YqfJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBtc2cuY29kZSA9IFsn6aqM6K+B56CB5bey57uP5aSx5pWI77yM6K+36YeN5paw6I635Y+W77yBJ11cbiAgICB9XG4gICAgY3R4LmJvZHkgPSB7XG4gICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgbXNnOiBtc2dcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJlc2V0IChjdHgpIHtcbiAgICBjb25zdCB7IGJvZHkgfSA9IGN0eC5yZXF1ZXN0XG4gICAgY29uc29sZS5sb2coXCJyZXNldCAtPiBib2R5XCIsIGJvZHksIGJvZHkudXNlcm5hbWUpXG4gICAgbGV0IHNpZCA9IGJvZHkuc2lkXG4gICAgbGV0IGNvZGUgPSBib2R5LmNvZGVcbiAgICBsZXQgbXNnID0ge31cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBVdGlscy5jaGVja0NvZGUoc2lkLCBjb2RlKVxuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgbGV0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRPbmUoeyB1c2VybmFtZTogYm9keS51c2VybmFtZSB9KVxuICAgICAgICBpZiAodXNlciA9PT0gbnVsbCAmJiB1c2VyLnVzZXJuYW1lID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgbXNnLnVzZXJuYW1lID0gWyfmraTpgq7nrrHmnKrms6jlhozvvIzor7fnoa7orqQnXVxuICAgICAgICAgICAgY3R4LmJvZHkgPSB7XG4gICAgICAgICAgICAgICAgY29kZTogNTAwLFxuICAgICAgICAgICAgICAgIG1zZzogbXNnXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1c2VyLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2goYm9keS5wYXNzd29yZCwgNSlcbiAgICAgICAgICAgIHVzZXIudXBkYXRlZD1tb21lbnQoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKVxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IHVzZXIuc2F2ZSgpXG4gICAgICAgICAgICBjb25zdCB1c2VyT2JqID0gcmVzdWx0LnRvSlNPTigpXG4gICAgICAgICAgICBjb25zdCBhcnIgPSBbJ3Bhc3N3b3JkJ10gXG4gICAgICAgICAgICBhcnIubWFwKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHVzZXJPYmpbaXRlbV1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBsZXQgdG9rZW4gPSBqc29ud2VidG9rZW4uc2lnbih7IF9pZDogdXNlck9iai5faWQgfSwgY29uZmlnLkpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnMWQnIH0pIC8vXG4gICAgICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiAyMDAsXG4gICAgICAgICAgICAgICAgZGF0YTogdXNlck9iaixcbiAgICAgICAgICAgICAgICB0b2tlbjogdG9rZW4sXG4gICAgICAgICAgICAgICAgbXNnOifmm7TmlrDlr4bnoIHmiJDlip/vvIEnXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBjdHguYm9keSA9IHtcbiAgICAgICAgICAgIGNvZGU6IDQwMSxcbiAgICAgICAgICAgIG1zZzogJ+WbvueJh+mqjOivgeeggeS4jeato+ehru+8jOivt+ajgOafpe+8gSdcbiAgICAgICAgfVxuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7IGZvcmdldCwgbG9naW4sIHJlZywgcmVzZXQgfSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "LoginController.js"
      ],
      "names": [
        "send",
        "require",
        "bcrypt",
        "moment",
        "jsonwebtoken",
        "config",
        "Utils",
        "User",
        "forget",
        "ctx",
        "body",
        "request",
        "username",
        "result",
        "code",
        "expire",
        "add",
        "format",
        "email",
        "user",
        "data",
        "msg",
        "e",
        "console",
        "log",
        "login",
        "sid",
        "checkCode",
        "checkUserPasswd",
        "findOne",
        "compare",
        "password",
        "userObj",
        "toJSON",
        "arr",
        "map",
        "item",
        "token",
        "sign",
        "_id",
        "JWT_SECRET",
        "expiresIn",
        "reg",
        "check",
        "user1",
        "user2",
        "name",
        "hash",
        "created",
        "save",
        "reset",
        "updated",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/api",
      "sourcesContent": [
        "const send = require('../config/MailConfig.js')\nconst bcrypt = require('bcrypt')\nconst moment = require('dayjs')\nconst jsonwebtoken = require('jsonwebtoken')\nconst config = require('../config/index')\n// const checkCode=require('../common/Utils')\nconst Utils = require('../common/Utils')\nconst User = require('../model/User')\n\nconst forget = function (ctx) {\n    const { body } = ctx.request\n    if (typeof body.username !== 'undefined') {\n        try {\n            let result = send({\n                code: '1234',\n                expire: moment().add(30, 'minutes').format('YYYY-MM-DD HH:mm:ss'),\n                email: body.username,\n                user: 'echo',\n            })\n            ctx.body = {\n                code: 200,\n                data: result,\n                msg: '邮件发送成功'\n            }\n        } catch (e) {\n            console.log(e)\n        }\n    } else {\n        ctx.body = {\n            code: 500,\n            msg: '服务器异常'\n        }\n    }\n}\nasync function login (ctx) {\n    const { body } = ctx.request\n    let sid = body.sid\n    let code = body.code\n    let result = await Utils.checkCode(sid, code)\n    console.log(result)\n    if (result) {\n        let checkUserPasswd = false\n        let user = await User.findOne({ username: body.username })\n        if (await bcrypt.compare(body.password, user.password)) {\n            checkUserPasswd = true\n        }\n        if (checkUserPasswd) {\n            const userObj = user.toJSON()\n            const arr = ['password'] //和源码有不同，这里没有删除邮箱了。\n            arr.map((item) => {\n                delete userObj[item]\n            })\n            let token = jsonwebtoken.sign({ _id: userObj._id }, config.JWT_SECRET, { expiresIn: '1d' }) //\n            ctx.body = {\n                code: 200,\n                data: userObj,\n                token: token\n            }\n        } else {\n            ctx.body = {\n                code: 404,\n                msg: '用户名或密码错误'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 401,\n            msg: '图片验证码不正确，请检查！'\n        }\n    }\n}\n\nasync function reg (ctx) {\n    const { body } = ctx.request\n    console.log(\"reg -> body\", body)\n    let sid = body.sid\n    let code = body.code\n    let msg = {}\n    let result = await Utils.checkCode(sid, code)\n    console.log(\"result:\" + result)\n    let check = true\n    if (result) {\n        let user1 = await User.findOne({ username: body.username })\n        if (user1 !== null && typeof user1.username !== 'undefined') {\n            console.log(\"user1\" + user1)\n            msg.username = ['此邮箱已经被注册，可以通过邮箱找回密码']\n            check = false\n        }\n        check = true\n        let user2 = await User.findOne({ name: body.name })\n        if (user2 !== null && typeof user2.name !== 'undefined') {\n            msg.name = ['此昵称已经被注册，请修改']\n            check = false\n        }\n        if (check) {\n            body.password = await bcrypt.hash(body.password, 5)\n            let user = new User({\n                username: body.username,\n                name: body.name,\n                password: body.password,\n                created: moment().format('YYYY-MM-DD HH:mm:ss')\n            })\n            let result = await user.save()\n            ctx.body = {\n                code: 200,\n                data: result,\n                msg: '注册成功'\n            }\n            return\n        }\n    } else {\n        msg.code = ['验证码已经失效，请重新获取！']\n    }\n    ctx.body = {\n        code: 500,\n        msg: msg\n    }\n}\n\nasync function reset (ctx) {\n    const { body } = ctx.request\n    console.log(\"reset -> body\", body, body.username)\n    let sid = body.sid\n    let code = body.code\n    let msg = {}\n    const result = await Utils.checkCode(sid, code)\n    if (result) {\n        let user = await User.findOne({ username: body.username })\n        if (user === null && user.username === 'undefined') {\n            msg.username = ['此邮箱未注册，请确认']\n            ctx.body = {\n                code: 500,\n                msg: msg\n            }\n        } else {\n            user.password = await bcrypt.hash(body.password, 5)\n            user.updated=moment().format('YYYY-MM-DD HH:mm:ss')\n            let result = await user.save()\n            const userObj = result.toJSON()\n            const arr = ['password'] \n            arr.map((item) => {\n                delete userObj[item]\n            })\n            let token = jsonwebtoken.sign({ _id: userObj._id }, config.JWT_SECRET, { expiresIn: '1d' }) //\n            ctx.body = {\n                code: 200,\n                data: userObj,\n                token: token,\n                msg:'更新密码成功！'\n            }\n        }\n    } else {\n        ctx.body = {\n            code: 401,\n            msg: '图片验证码不正确，请检查！'\n        }\n    }\n}\n\nmodule.exports = { forget, login, reg, reset }"
      ]
    },
    "sourceType": "script",
    "mtime": 1585409595258
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/contentRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/contentRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/contentRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/contentRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "contentRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst contentController = require('../../api/ContentController');\n\nconst router = new Router();\nrouter.prefix('/content');\nrouter.post('/upload', contentController.uploadImg);\nrouter.post('/add', contentController.addPost);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRlbnRSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsImNvbnRlbnRDb250cm9sbGVyIiwicm91dGVyIiwicHJlZml4IiwicG9zdCIsInVwbG9hZEltZyIsImFkZFBvc3QiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLE1BQU0sR0FBQ0MsT0FBTyxDQUFDLFlBQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsaUJBQWlCLEdBQUNELE9BQU8sQ0FBQyw2QkFBRCxDQUEvQjs7QUFFQSxNQUFNRSxNQUFNLEdBQUMsSUFBSUgsTUFBSixFQUFiO0FBQ0FHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjLFVBQWQ7QUFFQUQsTUFBTSxDQUFDRSxJQUFQLENBQVksU0FBWixFQUFzQkgsaUJBQWlCLENBQUNJLFNBQXhDO0FBRUFILE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLE1BQVosRUFBbUJILGlCQUFpQixDQUFDSyxPQUFyQztBQUNBQyxNQUFNLENBQUNDLE9BQVAsR0FBZU4sTUFBZiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9yb3V0ZXMvbW9kdWxlcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJvdXRlcj1yZXF1aXJlKCdrb2Etcm91dGVyJylcbmNvbnN0IGNvbnRlbnRDb250cm9sbGVyPXJlcXVpcmUoJy4uLy4uL2FwaS9Db250ZW50Q29udHJvbGxlcicpXG5cbmNvbnN0IHJvdXRlcj1uZXcgUm91dGVyKClcbnJvdXRlci5wcmVmaXgoJy9jb250ZW50Jylcblxucm91dGVyLnBvc3QoJy91cGxvYWQnLGNvbnRlbnRDb250cm9sbGVyLnVwbG9hZEltZylcblxucm91dGVyLnBvc3QoJy9hZGQnLGNvbnRlbnRDb250cm9sbGVyLmFkZFBvc3QpXG5tb2R1bGUuZXhwb3J0cz1yb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "contentRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "contentController",
        "router",
        "prefix",
        "post",
        "uploadImg",
        "addPost",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAMC,iBAAiB,GAACD,OAAO,CAAC,6BAAD,CAA/B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AACAG,MAAM,CAACC,MAAP,CAAc,UAAd;AAEAD,MAAM,CAACE,IAAP,CAAY,SAAZ,EAAsBH,iBAAiB,CAACI,SAAxC;AAEAH,MAAM,CAACE,IAAP,CAAY,MAAZ,EAAmBH,iBAAiB,CAACK,OAArC;AACAC,MAAM,CAACC,OAAP,GAAeN,MAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst contentController=require('../../api/ContentController')\n\nconst router=new Router()\nrouter.prefix('/content')\n\nrouter.post('/upload',contentController.uploadImg)\n\nrouter.post('/add',contentController.addPost)\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1584971949775
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/commentRouter.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/commentRouter.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/commentRouter.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules/commentRouter.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
        "sourceFileName": "commentRouter.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nconst Router = require('koa-router');\n\nconst {\n  addComment\n} = require('../../api/CommentController');\n\nconst router = new Router();\nrouter.prefix('/comments');\nrouter.post('/reply', addComment);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1lbnRSb3V0ZXIuanMiXSwibmFtZXMiOlsiUm91dGVyIiwicmVxdWlyZSIsImFkZENvbW1lbnQiLCJyb3V0ZXIiLCJwcmVmaXgiLCJwb3N0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNQSxNQUFNLEdBQUNDLE9BQU8sQ0FBQyxZQUFELENBQXBCOztBQUNBLE1BQU07QUFBRUMsRUFBQUE7QUFBRixJQUFlRCxPQUFPLENBQUMsNkJBQUQsQ0FBNUI7O0FBRUEsTUFBTUUsTUFBTSxHQUFDLElBQUlILE1BQUosRUFBYjtBQUVBRyxNQUFNLENBQUNDLE1BQVAsQ0FBYyxXQUFkO0FBQ0FELE1BQU0sQ0FBQ0UsSUFBUCxDQUFZLFFBQVosRUFBcUJILFVBQXJCO0FBRUFJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFlSixNQUFmIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9hZG1pbi9Eb2N1bWVudHMvbXktZ2l0aHViL3JhbmdlbGFuZC9yYW5nZWxhbmQtc2VydmUvc3JjL3JvdXRlcy9tb2R1bGVzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgUm91dGVyPXJlcXVpcmUoJ2tvYS1yb3V0ZXInKVxuY29uc3QgeyBhZGRDb21tZW50IH09cmVxdWlyZSgnLi4vLi4vYXBpL0NvbW1lbnRDb250cm9sbGVyJylcblxuY29uc3Qgcm91dGVyPW5ldyBSb3V0ZXIoKVxuXG5yb3V0ZXIucHJlZml4KCcvY29tbWVudHMnKVxucm91dGVyLnBvc3QoJy9yZXBseScsYWRkQ29tbWVudClcblxubW9kdWxlLmV4cG9ydHM9cm91dGVyIl19",
    "map": {
      "version": 3,
      "sources": [
        "commentRouter.js"
      ],
      "names": [
        "Router",
        "require",
        "addComment",
        "router",
        "prefix",
        "post",
        "module",
        "exports"
      ],
      "mappings": ";;AAAA,MAAMA,MAAM,GAACC,OAAO,CAAC,YAAD,CAApB;;AACA,MAAM;AAAEC,EAAAA;AAAF,IAAeD,OAAO,CAAC,6BAAD,CAA5B;;AAEA,MAAME,MAAM,GAAC,IAAIH,MAAJ,EAAb;AAEAG,MAAM,CAACC,MAAP,CAAc,WAAd;AACAD,MAAM,CAACE,IAAP,CAAY,QAAZ,EAAqBH,UAArB;AAEAI,MAAM,CAACC,OAAP,GAAeJ,MAAf",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/routes/modules",
      "sourcesContent": [
        "const Router=require('koa-router')\nconst { addComment }=require('../../api/CommentController')\n\nconst router=new Router()\n\nrouter.prefix('/comments')\nrouter.post('/reply',addComment)\n\nmodule.exports=router"
      ]
    },
    "sourceType": "script",
    "mtime": 1585712631350
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/ErrorHandle.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/ErrorHandle.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/ErrorHandle.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common/ErrorHandle.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
        "sourceFileName": "ErrorHandle.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nmodule.exports = (ctx, next) => {\n  return next().catch(err => {\n    if (401 == err.status) {\n      ctx.status = 401;\n      ctx.body = {\n        code: 401,\n        msg: 'Protected resource,use Authorization header to get access\\n'\n      };\n    } else {\n      ctx.status = err.status || 500;\n      ctx.body = Object.assign({\n        code: 500,\n        msg: err.message\n      }, process.env.NODE_ENV === 'development' ? {\n        stack: err.statck\n      } : {});\n    }\n  });\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkVycm9ySGFuZGxlLmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJjdHgiLCJuZXh0IiwiY2F0Y2giLCJlcnIiLCJzdGF0dXMiLCJib2R5IiwiY29kZSIsIm1zZyIsIk9iamVjdCIsImFzc2lnbiIsIm1lc3NhZ2UiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJzdGFjayIsInN0YXRjayJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsTUFBTSxDQUFDQyxPQUFQLEdBQWdCLENBQUNDLEdBQUQsRUFBS0MsSUFBTCxLQUFjO0FBQzFCLFNBQU9BLElBQUksR0FBR0MsS0FBUCxDQUFjQyxHQUFELElBQU87QUFDdkIsUUFBRyxPQUFLQSxHQUFHLENBQUNDLE1BQVosRUFBb0I7QUFDaEJKLE1BQUFBLEdBQUcsQ0FBQ0ksTUFBSixHQUFXLEdBQVg7QUFDQUosTUFBQUEsR0FBRyxDQUFDSyxJQUFKLEdBQVM7QUFDTEMsUUFBQUEsSUFBSSxFQUFDLEdBREE7QUFFTEMsUUFBQUEsR0FBRyxFQUFDO0FBRkMsT0FBVDtBQUlILEtBTkQsTUFNTztBQUNIUCxNQUFBQSxHQUFHLENBQUNJLE1BQUosR0FBYUQsR0FBRyxDQUFDQyxNQUFKLElBQWMsR0FBM0I7QUFDQUosTUFBQUEsR0FBRyxDQUFDSyxJQUFKLEdBQVdHLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjO0FBQ3JCSCxRQUFBQSxJQUFJLEVBQUUsR0FEZTtBQUVyQkMsUUFBQUEsR0FBRyxFQUFFSixHQUFHLENBQUNPO0FBRlksT0FBZCxFQUdUQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsUUFBWixLQUF1QixhQUF2QixHQUFxQztBQUFDQyxRQUFBQSxLQUFLLEVBQUNYLEdBQUcsQ0FBQ1k7QUFBWCxPQUFyQyxHQUF3RCxFQUgvQyxDQUFYO0FBSUg7QUFDSixHQWRNLENBQVA7QUFlSCxDQWhCRCIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb21tb24iLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cz0gKGN0eCxuZXh0KSA9PiB7XG4gICAgcmV0dXJuIG5leHQoKS5jYXRjaCgoZXJyKT0+e1xuICAgICAgICBpZig0MDE9PWVyci5zdGF0dXMpIHtcbiAgICAgICAgICAgIGN0eC5zdGF0dXM9NDAxO1xuICAgICAgICAgICAgY3R4LmJvZHk9e1xuICAgICAgICAgICAgICAgIGNvZGU6NDAxLFxuICAgICAgICAgICAgICAgIG1zZzonUHJvdGVjdGVkIHJlc291cmNlLHVzZSBBdXRob3JpemF0aW9uIGhlYWRlciB0byBnZXQgYWNjZXNzXFxuJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3R4LnN0YXR1cyA9IGVyci5zdGF0dXMgfHwgNTAwXG4gICAgICAgICAgICBjdHguYm9keSA9IE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgICAgIGNvZGU6IDUwMCxcbiAgICAgICAgICAgICAgICBtc2c6IGVyci5tZXNzYWdlXG4gICAgICAgICAgICB9LHByb2Nlc3MuZW52Lk5PREVfRU5WPT09J2RldmVsb3BtZW50Jz97c3RhY2s6ZXJyLnN0YXRja306e30pXG4gICAgICAgIH1cbiAgICB9KTtcbn0iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "ErrorHandle.js"
      ],
      "names": [
        "module",
        "exports",
        "ctx",
        "next",
        "catch",
        "err",
        "status",
        "body",
        "code",
        "msg",
        "Object",
        "assign",
        "message",
        "process",
        "env",
        "NODE_ENV",
        "stack",
        "statck"
      ],
      "mappings": ";;AAAAA,MAAM,CAACC,OAAP,GAAgB,CAACC,GAAD,EAAKC,IAAL,KAAc;AAC1B,SAAOA,IAAI,GAAGC,KAAP,CAAcC,GAAD,IAAO;AACvB,QAAG,OAAKA,GAAG,CAACC,MAAZ,EAAoB;AAChBJ,MAAAA,GAAG,CAACI,MAAJ,GAAW,GAAX;AACAJ,MAAAA,GAAG,CAACK,IAAJ,GAAS;AACLC,QAAAA,IAAI,EAAC,GADA;AAELC,QAAAA,GAAG,EAAC;AAFC,OAAT;AAIH,KAND,MAMO;AACHP,MAAAA,GAAG,CAACI,MAAJ,GAAaD,GAAG,CAACC,MAAJ,IAAc,GAA3B;AACAJ,MAAAA,GAAG,CAACK,IAAJ,GAAWG,MAAM,CAACC,MAAP,CAAc;AACrBH,QAAAA,IAAI,EAAE,GADe;AAErBC,QAAAA,GAAG,EAAEJ,GAAG,CAACO;AAFY,OAAd,EAGTC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAuB,aAAvB,GAAqC;AAACC,QAAAA,KAAK,EAACX,GAAG,CAACY;AAAX,OAArC,GAAwD,EAH/C,CAAX;AAIH;AACJ,GAdM,CAAP;AAeH,CAhBD",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/common",
      "sourcesContent": [
        "module.exports= (ctx,next) => {\n    return next().catch((err)=>{\n        if(401==err.status) {\n            ctx.status=401;\n            ctx.body={\n                code:401,\n                msg:'Protected resource,use Authorization header to get access\\n'\n            }\n        } else {\n            ctx.status = err.status || 500\n            ctx.body = Object.assign({\n                code: 500,\n                msg: err.message\n            },process.env.NODE_ENV==='development'?{stack:err.statck}:{})\n        }\n    });\n}"
      ]
    },
    "sourceType": "script",
    "mtime": 1581480640837
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/WebSocket.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/WebSocket.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/WebSocket.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/WebSocket.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "WebSocket.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _ws = _interopRequireDefault(require(\"ws\"));\n\nvar _Utils = require(\"@/common/Utils\");\n\nvar _Comments = _interopRequireDefault(require(\"@/model/Comments\"));\n\nvar _index = _interopRequireDefault(require(\"./index\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nclass WebSocketServer {\n  constructor(config = {}) {\n    const defaultConfig = {\n      port: _index.default.wsPort,\n      timeInterval: 5 * 1000,\n      isAuth: true\n    }; // 最终配置\n\n    const finalConfig = { ...defaultConfig,\n      ...config\n    };\n    this.wss = {};\n    this.timeInterval = finalConfig.timeInterval;\n    this.isAuth = finalConfig.isAuth;\n    this.port = finalConfig.port;\n    this.options = config.options || {};\n  } // 初始化webscoekt服务\n\n\n  init() {\n    this.wss = new _ws.default.Server({\n      port: this.port,\n      ...this.options\n    }); // 连接信息\n\n    this.wss.on('connection', ws => {\n      // 连接上之后随即发送一次心跳检测\n      ws.isAlive = true;\n      ws.send(JSON.stringify({\n        event: 'heartbeat',\n        message: 'ping'\n      }));\n      ws.on('message', msg => this.onMessage(ws, msg));\n      ws.on('close', () => this.onClose(ws));\n    }); // 心跳检测\n\n    this.heartbeat();\n  }\n\n  onMessage(ws, msg) {\n    // 用户鉴权 -> token -> _id\n    // 心跳检测\n    // 消息发送\n    const msgObj = JSON.parse(msg);\n    const events = {\n      auth: async () => {\n        try {\n          const obj = await (0, _Utils.getJWTPayload)(msgObj.message);\n\n          if (obj) {\n            ws.isAuth = true;\n            ws._id = obj._id;\n            const num = await _Comments.default.getTotal(obj._id);\n            ws.send(JSON.stringify({\n              event: 'message',\n              message: num\n            }));\n          }\n        } catch (error) {\n          ws.send(JSON.stringify({\n            event: 'noauth',\n            message: 'please auth again'\n          }));\n        }\n      },\n      heartbeat: () => {\n        if (msgObj.message === 'pong') {\n          ws.isAlive = true;\n        }\n      },\n      message: () => {// 鉴权拦截\n        // if (!ws.isAuth && this.isAuth) {\n        //   return\n        // }\n        // 消息广播\n        // this.wss.clients.forEach((client) => {\n        //   if (client.readyState === WebSocket.OPEN && client._id === ws._id) {\n        //     this.send(msg)\n        //   }\n        // })\n      }\n    };\n    events[msgObj.event]();\n  } // 点对点的消息发送\n\n\n  send(uid, msg) {\n    this.wss.clients.forEach(client => {\n      if (client.readyState === _ws.default.OPEN && client._id === uid) {\n        client.send(msg);\n      }\n    });\n  } // 广播消息 -> 推送系统消息\n\n\n  broadcast(msg) {\n    this.wss.clients.forEach(client => {\n      if (client.readyState === _ws.default.OPEN) {\n        client.send(msg);\n      }\n    });\n  }\n\n  onClose(ws) {} // 心跳检测\n\n\n  heartbeat() {\n    clearInterval(this.interval);\n    this.interval = setInterval(() => {\n      this.wss.clients.forEach(ws => {\n        if (!ws.isAlive) {\n          return ws.terminate();\n        } // 主动发送心跳检测请求\n        // 当客户端返回了消息之后，主动设置flag为在线\n\n\n        ws.isAlive = false;\n        ws.send(JSON.stringify({\n          event: 'heartbeat',\n          message: 'ping'\n        }));\n      });\n    }, this.timeInterval);\n  }\n\n}\n\nvar _default = WebSocketServer;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIldlYlNvY2tldC5qcyJdLCJuYW1lcyI6WyJXZWJTb2NrZXRTZXJ2ZXIiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsImRlZmF1bHRDb25maWciLCJwb3J0IiwiY29uZmlnZmlsZSIsIndzUG9ydCIsInRpbWVJbnRlcnZhbCIsImlzQXV0aCIsImZpbmFsQ29uZmlnIiwid3NzIiwib3B0aW9ucyIsImluaXQiLCJXZWJTb2NrZXQiLCJTZXJ2ZXIiLCJvbiIsIndzIiwiaXNBbGl2ZSIsInNlbmQiLCJKU09OIiwic3RyaW5naWZ5IiwiZXZlbnQiLCJtZXNzYWdlIiwibXNnIiwib25NZXNzYWdlIiwib25DbG9zZSIsImhlYXJ0YmVhdCIsIm1zZ09iaiIsInBhcnNlIiwiZXZlbnRzIiwiYXV0aCIsIm9iaiIsIl9pZCIsIm51bSIsIkNvbW1lbnRzIiwiZ2V0VG90YWwiLCJlcnJvciIsInVpZCIsImNsaWVudHMiLCJmb3JFYWNoIiwiY2xpZW50IiwicmVhZHlTdGF0ZSIsIk9QRU4iLCJicm9hZGNhc3QiLCJjbGVhckludGVydmFsIiwiaW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInRlcm1pbmF0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBQ0E7QUFDQSxNQUFNQSxlQUFOLENBQXNCO0FBQ3BCQyxFQUFBQSxXQUFXLENBQUVDLE1BQU0sR0FBRyxFQUFYLEVBQWU7QUFDeEIsVUFBTUMsYUFBYSxHQUFHO0FBQ3BCQyxNQUFBQSxJQUFJLEVBQUVDLGVBQVdDLE1BREc7QUFFcEJDLE1BQUFBLFlBQVksRUFBRSxJQUFJLElBRkU7QUFHcEJDLE1BQUFBLE1BQU0sRUFBRTtBQUhZLEtBQXRCLENBRHdCLENBTXhCOztBQUNBLFVBQU1DLFdBQVcsR0FBRyxFQUFFLEdBQUdOLGFBQUw7QUFBb0IsU0FBR0Q7QUFBdkIsS0FBcEI7QUFDQSxTQUFLUSxHQUFMLEdBQVcsRUFBWDtBQUNBLFNBQUtILFlBQUwsR0FBb0JFLFdBQVcsQ0FBQ0YsWUFB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eEIsS0FBS2YsWUFibUIsQ0FBM0I7QUFjRDs7QUF6SG1COztlQTRIUFAsZSIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgV2ViU29ja2V0IGZyb20gJ3dzJ1xuaW1wb3J0IHsgZ2V0SldUUGF5bG9hZCB9IGZyb20gJ0AvY29tbW9uL1V0aWxzJ1xuaW1wb3J0IENvbW1lbnRzIGZyb20gJ0AvbW9kZWwvQ29tbWVudHMnXG5pbXBvcnQgY29uZmlnZmlsZSBmcm9tICcuL2luZGV4J1xuLy9cbmNsYXNzIFdlYlNvY2tldFNlcnZlciB7XG4gIGNvbnN0cnVjdG9yIChjb25maWcgPSB7fSkge1xuICAgIGNvbnN0IGRlZmF1bHRDb25maWcgPSB7XG4gICAgICBwb3J0OiBjb25maWdmaWxlLndzUG9ydCxcbiAgICAgIHRpbWVJbnRlcnZhbDogNSAqIDEwMDAsXG4gICAgICBpc0F1dGg6IHRydWVcbiAgICB9XG4gICAgLy8g5pyA57uI6YWN572uXG4gICAgY29uc3QgZmluYWxDb25maWcgPSB7IC4uLmRlZmF1bHRDb25maWcsIC4uLmNvbmZpZyB9XG4gICAgdGhpcy53c3MgPSB7fVxuICAgIHRoaXMudGltZUludGVydmFsID0gZmluYWxDb25maWcudGltZUludGVydmFsXG4gICAgdGhpcy5pc0F1dGggPSBmaW5hbENvbmZpZy5pc0F1dGhcbiAgICB0aGlzLnBvcnQgPSBmaW5hbENvbmZpZy5wb3J0XG4gICAgdGhpcy5vcHRpb25zID0gY29uZmlnLm9wdGlvbnMgfHwge31cbiAgfVxuXG4gIC8vIOWIneWni+WMlndlYnNjb2VrdOacjeWKoVxuICBpbml0ICgpIHtcbiAgICB0aGlzLndzcyA9IG5ldyBXZWJTb2NrZXQuU2VydmVyKHsgcG9ydDogdGhpcy5wb3J0LCAuLi50aGlzLm9wdGlvbnMgfSlcblxuICAgIC8vIOi/nuaOpeS/oeaBr1xuICAgIHRoaXMud3NzLm9uKCdjb25uZWN0aW9uJywgKHdzKSA9PiB7XG4gICAgICAvLyDov57mjqXkuIrkuYvlkI7pmo/ljbPlj5HpgIHkuIDmrKHlv4Pot7Pmo4DmtYtcbiAgICAgIHdzLmlzQWxpdmUgPSB0cnVlXG4gICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgZXZlbnQ6ICdoZWFydGJlYXQnLFxuICAgICAgICBtZXNzYWdlOiAncGluZydcbiAgICAgIH0pKVxuICAgICAgd3Mub24oJ21lc3NhZ2UnLCAobXNnKSA9PiB0aGlzLm9uTWVzc2FnZSh3cywgbXNnKSlcbiAgICAgIHdzLm9uKCdjbG9zZScsICgpID0+IHRoaXMub25DbG9zZSh3cykpXG4gICAgfSlcblxuICAgIC8vIOW/g+i3s+ajgOa1i1xuICAgIHRoaXMuaGVhcnRiZWF0KClcbiAgfVxuXG4gIG9uTWVzc2FnZSAod3MsIG1zZykge1xuICAgIC8vIOeUqOaIt+mJtOadgyAtPiB0b2tlbiAtPiBfaWRcbiAgICAvLyDlv4Pot7Pmo4DmtYtcbiAgICAvLyDmtojmga/lj5HpgIFcbiAgICBjb25zdCBtc2dPYmogPSBKU09OLnBhcnNlKG1zZylcbiAgICBjb25zdCBldmVudHMgPSB7XG4gICAgICBhdXRoOiBhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgb2JqID0gYXdhaXQgZ2V0SldUUGF5bG9hZChtc2dPYmoubWVzc2FnZSlcbiAgICAgICAgICBpZiAob2JqKSB7XG4gICAgICAgICAgICB3cy5pc0F1dGggPSB0cnVlXG4gICAgICAgICAgICB3cy5faWQgPSBvYmouX2lkXG4gICAgICAgICAgICBjb25zdCBudW0gPSBhd2FpdCBDb21tZW50cy5nZXRUb3RhbChvYmouX2lkKVxuICAgICAgICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgIGV2ZW50OiAnbWVzc2FnZScsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IG51bVxuICAgICAgICAgICAgfSkpXG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgZXZlbnQ6ICdub2F1dGgnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ3BsZWFzZSBhdXRoIGFnYWluJ1xuICAgICAgICAgIH0pKVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgaGVhcnRiZWF0OiAoKSA9PiB7XG4gICAgICAgIGlmIChtc2dPYmoubWVzc2FnZSA9PT0gJ3BvbmcnKSB7XG4gICAgICAgICAgd3MuaXNBbGl2ZSA9IHRydWVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG1lc3NhZ2U6ICgpID0+IHtcbiAgICAgICAgLy8g6Ym05p2D5oum5oiqXG4gICAgICAgIC8vIGlmICghd3MuaXNBdXRoICYmIHRoaXMuaXNBdXRoKSB7XG4gICAgICAgIC8vICAgcmV0dXJuXG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8g5raI5oGv5bm/5pKtXG4gICAgICAgIC8vIHRoaXMud3NzLmNsaWVudHMuZm9yRWFjaCgoY2xpZW50KSA9PiB7XG4gICAgICAgIC8vICAgaWYgKGNsaWVudC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTiAmJiBjbGllbnQuX2lkID09PSB3cy5faWQpIHtcbiAgICAgICAgLy8gICAgIHRoaXMuc2VuZChtc2cpXG4gICAgICAgIC8vICAgfVxuICAgICAgICAvLyB9KVxuICAgICAgfVxuICAgIH1cbiAgICBldmVudHNbbXNnT2JqLmV2ZW50XSgpXG4gIH1cblxuICAvLyDngrnlr7nngrnnmoTmtojmga/lj5HpgIFcbiAgc2VuZCAodWlkLCBtc2cpIHtcbiAgICB0aGlzLndzcy5jbGllbnRzLmZvckVhY2goKGNsaWVudCkgPT4ge1xuICAgICAgaWYgKGNsaWVudC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTiAmJiBjbGllbnQuX2lkID09PSB1aWQpIHtcbiAgICAgICAgY2xpZW50LnNlbmQobXNnKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvLyDlub/mkq3mtojmga8gLT4g5o6o6YCB57O757uf5raI5oGvXG4gIGJyb2FkY2FzdCAobXNnKSB7XG4gICAgdGhpcy53c3MuY2xpZW50cy5mb3JFYWNoKChjbGllbnQpID0+IHtcbiAgICAgIGlmIChjbGllbnQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0Lk9QRU4pIHtcbiAgICAgICAgY2xpZW50LnNlbmQobXNnKVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBvbkNsb3NlICh3cykge1xuXG4gIH1cblxuICAvLyDlv4Pot7Pmo4DmtYtcbiAgaGVhcnRiZWF0ICgpIHtcbiAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpXG4gICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMud3NzLmNsaWVudHMuZm9yRWFjaCgod3MpID0+IHtcbiAgICAgICAgaWYgKCF3cy5pc0FsaXZlKSB7XG4gICAgICAgICAgcmV0dXJuIHdzLnRlcm1pbmF0ZSgpXG4gICAgICAgIH1cbiAgICAgICAgLy8g5Li75Yqo5Y+R6YCB5b+D6Lez5qOA5rWL6K+35rGCXG4gICAgICAgIC8vIOW9k+WuouaIt+err+i/lOWbnuS6hua2iOaBr+S5i+WQju+8jOS4u+WKqOiuvue9rmZsYWfkuLrlnKjnur9cbiAgICAgICAgd3MuaXNBbGl2ZSA9IGZhbHNlXG4gICAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGV2ZW50OiAnaGVhcnRiZWF0JyxcbiAgICAgICAgICBtZXNzYWdlOiAncGluZydcbiAgICAgICAgfSkpXG4gICAgICB9KVxuICAgIH0sIHRoaXMudGltZUludGVydmFsKVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFdlYlNvY2tldFNlcnZlclxuIl19",
    "map": {
      "version": 3,
      "sources": [
        "WebSocket.js"
      ],
      "names": [
        "WebSocketServer",
        "constructor",
        "config",
        "defaultConfig",
        "port",
        "configfile",
        "wsPort",
        "timeInterval",
        "isAuth",
        "finalConfig",
        "wss",
        "options",
        "init",
        "WebSocket",
        "Server",
        "on",
        "ws",
        "isAlive",
        "send",
        "JSON",
        "stringify",
        "event",
        "message",
        "msg",
        "onMessage",
        "onClose",
        "heartbeat",
        "msgObj",
        "parse",
        "events",
        "auth",
        "obj",
        "_id",
        "num",
        "Comments",
        "getTotal",
        "error",
        "uid",
        "clients",
        "forEach",
        "client",
        "readyState",
        "OPEN",
        "broadcast",
        "clearInterval",
        "interval",
        "setInterval",
        "terminate"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "import WebSocket from 'ws'\nimport { getJWTPayload } from '@/common/Utils'\nimport Comments from '@/model/Comments'\nimport configfile from './index'\n//\nclass WebSocketServer {\n  constructor (config = {}) {\n    const defaultConfig = {\n      port: configfile.wsPort,\n      timeInterval: 5 * 1000,\n      isAuth: true\n    }\n    // 最终配置\n    const finalConfig = { ...defaultConfig, ...config }\n    this.wss = {}\n    this.timeInterval = finalConfig.timeInterval\n    this.isAuth = finalConfig.isAuth\n    this.port = finalConfig.port\n    this.options = config.options || {}\n  }\n\n  // 初始化webscoekt服务\n  init () {\n    this.wss = new WebSocket.Server({ port: this.port, ...this.options })\n\n    // 连接信息\n    this.wss.on('connection', (ws) => {\n      // 连接上之后随即发送一次心跳检测\n      ws.isAlive = true\n      ws.send(JSON.stringify({\n        event: 'heartbeat',\n        message: 'ping'\n      }))\n      ws.on('message', (msg) => this.onMessage(ws, msg))\n      ws.on('close', () => this.onClose(ws))\n    })\n\n    // 心跳检测\n    this.heartbeat()\n  }\n\n  onMessage (ws, msg) {\n    // 用户鉴权 -> token -> _id\n    // 心跳检测\n    // 消息发送\n    const msgObj = JSON.parse(msg)\n    const events = {\n      auth: async () => {\n        try {\n          const obj = await getJWTPayload(msgObj.message)\n          if (obj) {\n            ws.isAuth = true\n            ws._id = obj._id\n            const num = await Comments.getTotal(obj._id)\n            ws.send(JSON.stringify({\n              event: 'message',\n              message: num\n            }))\n          }\n        } catch (error) {\n          ws.send(JSON.stringify({\n            event: 'noauth',\n            message: 'please auth again'\n          }))\n        }\n      },\n      heartbeat: () => {\n        if (msgObj.message === 'pong') {\n          ws.isAlive = true\n        }\n      },\n      message: () => {\n        // 鉴权拦截\n        // if (!ws.isAuth && this.isAuth) {\n        //   return\n        // }\n        // 消息广播\n        // this.wss.clients.forEach((client) => {\n        //   if (client.readyState === WebSocket.OPEN && client._id === ws._id) {\n        //     this.send(msg)\n        //   }\n        // })\n      }\n    }\n    events[msgObj.event]()\n  }\n\n  // 点对点的消息发送\n  send (uid, msg) {\n    this.wss.clients.forEach((client) => {\n      if (client.readyState === WebSocket.OPEN && client._id === uid) {\n        client.send(msg)\n      }\n    })\n  }\n\n  // 广播消息 -> 推送系统消息\n  broadcast (msg) {\n    this.wss.clients.forEach((client) => {\n      if (client.readyState === WebSocket.OPEN) {\n        client.send(msg)\n      }\n    })\n  }\n\n  onClose (ws) {\n\n  }\n\n  // 心跳检测\n  heartbeat () {\n    clearInterval(this.interval)\n    this.interval = setInterval(() => {\n      this.wss.clients.forEach((ws) => {\n        if (!ws.isAlive) {\n          return ws.terminate()\n        }\n        // 主动发送心跳检测请求\n        // 当客户端返回了消息之后，主动设置flag为在线\n        ws.isAlive = false\n        ws.send(JSON.stringify({\n          event: 'heartbeat',\n          message: 'ping'\n        }))\n      })\n    }, this.timeInterval)\n  }\n}\n\nexport default WebSocketServer\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1586661429421
  },
  "{\"sourceRoot\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"filename\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/WebSocket.js\",\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/admin/Documents/my-github/rangeland/rangeland-serve\",\"plugins\":[{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"loose\":false,\"useBuiltIns\":false}}],\"presets\":[]}:7.8.7": {
    "metadata": {},
    "options": {
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/WebSocket.js",
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "/Users/admin/Documents/my-github/rangeland/rangeland-serve",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [
        {
          "key": "proposal-nullish-coalescing-operator",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "LogicalExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-optional-chaining",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "OptionalCallExpression": {
              "enter": [
                null
              ]
            },
            "OptionalMemberExpression": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-json-strings",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-optional-catch-binding",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-async-generators",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "syntax-object-rest-spread",
          "visitor": {
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "transform-modules-commonjs",
          "visitor": {
            "CallExpression": {
              "enter": [
                null
              ]
            },
            "Program": {
              "exit": [
                null
              ]
            },
            "_exploded": true,
            "_verified": true
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        },
        {
          "key": "proposal-dynamic-import",
          "visitor": {
            "_exploded": {},
            "_verified": {},
            "Program": {
              "enter": [
                null
              ]
            }
          },
          "options": {
            "spec": false,
            "loose": false,
            "useBuiltIns": false
          }
        }
      ],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/WebSocket.js",
        "plugins": [
          "nullishCoalescingOperator",
          "optionalChaining",
          "jsonStrings",
          "optionalCatchBinding",
          "asyncGenerators",
          "objectRestSpread",
          "dynamicImport"
        ]
      },
      "generatorOpts": {
        "filename": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config/WebSocket.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
        "sourceFileName": "WebSocket.js"
      }
    },
    "ast": null,
    "code": "\"use strict\";\n\nvar _ws = _interopRequireDefault(require(\"ws\"));\n\nvar _Utils = require(\"../common/Utils\");\n\nvar _Comments = _interopRequireDefault(require(\"../model/Comments\"));\n\nvar _index = _interopRequireDefault(require(\"./index\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n//\nclass WebSocketServer {\n  constructor(config = {}) {\n    const defaultConfig = {\n      port: _index.default.wsPort,\n      timeInterval: 5 * 1000,\n      isAuth: true\n    }; // 最终配置\n\n    const finalConfig = { ...defaultConfig,\n      ...config\n    };\n    this.wss = {};\n    this.timeInterval = finalConfig.timeInterval;\n    this.isAuth = finalConfig.isAuth;\n    this.port = finalConfig.port;\n    this.options = config.options || {};\n  } // 初始化webscoekt服务\n\n\n  init() {\n    this.wss = new _ws.default.Server({\n      port: this.port,\n      ...this.options\n    }); // 连接信息\n\n    this.wss.on('connection', ws => {\n      // 连接上之后随即发送一次心跳检测\n      ws.isAlive = true;\n      ws.send(JSON.stringify({\n        event: 'heartbeat',\n        message: 'ping'\n      }));\n      ws.on('message', msg => this.onMessage(ws, msg));\n      ws.on('close', () => this.onClose(ws));\n    }); // 心跳检测\n\n    this.heartbeat();\n  }\n\n  onMessage(ws, msg) {\n    // 用户鉴权 -> token -> _id\n    // 心跳检测\n    // 消息发送\n    const msgObj = JSON.parse(msg);\n    const events = {\n      auth: async () => {\n        try {\n          const obj = await (0, _Utils.getJWTPayload)(msgObj.message);\n\n          if (obj) {\n            ws.isAuth = true;\n            ws._id = obj._id;\n            const num = await _Comments.default.getTotal(obj._id);\n            ws.send(JSON.stringify({\n              event: 'message',\n              message: num\n            }));\n          }\n        } catch (error) {\n          ws.send(JSON.stringify({\n            event: 'noauth',\n            message: 'please auth again'\n          }));\n        }\n      },\n      heartbeat: () => {\n        if (msgObj.message === 'pong') {\n          ws.isAlive = true;\n        }\n      },\n      message: () => {// 鉴权拦截\n        // if (!ws.isAuth && this.isAuth) {\n        //   return\n        // }\n        // 消息广播\n        // this.wss.clients.forEach((client) => {\n        //   if (client.readyState === WebSocket.OPEN && client._id === ws._id) {\n        //     this.send(msg)\n        //   }\n        // })\n      }\n    };\n    events[msgObj.event]();\n  } // 点对点的消息发送\n\n\n  send(uid, msg) {\n    this.wss.clients.forEach(client => {\n      if (client.readyState === _ws.default.OPEN && client._id === uid) {\n        client.send(msg);\n      }\n    });\n  } // 广播消息 -> 推送系统消息\n\n\n  broadcast(msg) {\n    this.wss.clients.forEach(client => {\n      if (client.readyState === _ws.default.OPEN) {\n        client.send(msg);\n      }\n    });\n  }\n\n  onClose() {} // 心跳检测\n\n\n  heartbeat() {\n    clearInterval(this.interval);\n    this.interval = setInterval(() => {\n      this.wss.clients.forEach(ws => {\n        if (!ws.isAlive) {\n          return ws.terminate();\n        } // 主动发送心跳检测请求\n        // 当客户端返回了消息之后，主动设置flag为在线\n\n\n        ws.isAlive = false;\n        ws.send(JSON.stringify({\n          event: 'heartbeat',\n          message: 'ping'\n        }));\n      });\n    }, this.timeInterval);\n  }\n\n}\n\nmodule.exports = WebSocketServer;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIldlYlNvY2tldC5qcyJdLCJuYW1lcyI6WyJXZWJTb2NrZXRTZXJ2ZXIiLCJjb25zdHJ1Y3RvciIsImNvbmZpZyIsImRlZmF1bHRDb25maWciLCJwb3J0IiwiY29uZmlnZmlsZSIsIndzUG9ydCIsInRpbWVJbnRlcnZhbCIsImlzQXV0aCIsImZpbmFsQ29uZmlnIiwid3NzIiwib3B0aW9ucyIsImluaXQiLCJXZWJTb2NrZXQiLCJTZXJ2ZXIiLCJvbiIsIndzIiwiaXNBbGl2ZSIsInNlbmQiLCJKU09OIiwic3RyaW5naWZ5IiwiZXZlbnQiLCJtZXNzYWdlIiwibXNnIiwib25NZXNzYWdlIiwib25DbG9zZSIsImhlYXJ0YmVhdCIsIm1zZ09iaiIsInBhcnNlIiwiZXZlbnRzIiwiYXV0aCIsIm9iaiIsIl9pZCIsIm51bSIsIkNvbW1lbnRzIiwiZ2V0VG90YWwiLCJlcnJvciIsInVpZCIsImNsaWVudHMiLCJmb3JFYWNoIiwiY2xpZW50IiwicmVhZHlTdGF0ZSIsIk9QRU4iLCJicm9hZGNhc3QiLCJjbGVhckludGVydmFsIiwiaW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInRlcm1pbmF0ZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFDQTtBQUNBLE1BQU1BLGVBQU4sQ0FBc0I7QUFDcEJDLEVBQUFBLFdBQVcsQ0FBRUMsTUFBTSxHQUFHLEVBQVgsRUFBZTtBQUN4QixVQUFNQyxhQUFhLEdBQUc7QUFDcEJDLE1BQUFBLElBQUksRUFBRUMsZUFBV0MsTUFERztBQUVwQkMsTUFBQUEsWUFBWSxFQUFFLElBQUksSUFGRTtBQUdwQkMsTUFBQUEsTUFBTSxFQUFFO0FBSFksS0FBdEIsQ0FEd0IsQ0FNeEI7O0FBQ0EsVUFBTUMsV0FBVyxHQUFHLEVBQUUsR0FBR04sYUFBTDtBQUFvQixTQUFHRDtBQUF2QixLQUFwQjtBQUNBLFNBQUtRLEdBQUwsR0FBVyxFQUFYO0FBQ0EsU0FBS0gsWUFBTCxHQUFvQkUs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RUFheEIsS0FBS2YsWUFibUIsQ0FBM0I7QUFjRDs7QUF6SG1COztBQTRIdEJ5QyxNQUFNLENBQUNDLE9BQVAsR0FBZ0JqRCxlQUFoQiIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYWRtaW4vRG9jdW1lbnRzL215LWdpdGh1Yi9yYW5nZWxhbmQvcmFuZ2VsYW5kLXNlcnZlL3NyYy9jb25maWciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgV2ViU29ja2V0IGZyb20gJ3dzJ1xuaW1wb3J0IHsgZ2V0SldUUGF5bG9hZCB9IGZyb20gJy4uL2NvbW1vbi9VdGlscydcbmltcG9ydCBDb21tZW50cyBmcm9tICcuLi9tb2RlbC9Db21tZW50cydcbmltcG9ydCBjb25maWdmaWxlIGZyb20gJy4vaW5kZXgnXG4vL1xuY2xhc3MgV2ViU29ja2V0U2VydmVyIHtcbiAgY29uc3RydWN0b3IgKGNvbmZpZyA9IHt9KSB7XG4gICAgY29uc3QgZGVmYXVsdENvbmZpZyA9IHtcbiAgICAgIHBvcnQ6IGNvbmZpZ2ZpbGUud3NQb3J0LFxuICAgICAgdGltZUludGVydmFsOiA1ICogMTAwMCxcbiAgICAgIGlzQXV0aDogdHJ1ZVxuICAgIH1cbiAgICAvLyDmnIDnu4jphY3nva5cbiAgICBjb25zdCBmaW5hbENvbmZpZyA9IHsgLi4uZGVmYXVsdENvbmZpZywgLi4uY29uZmlnIH1cbiAgICB0aGlzLndzcyA9IHt9XG4gICAgdGhpcy50aW1lSW50ZXJ2YWwgPSBmaW5hbENvbmZpZy50aW1lSW50ZXJ2YWxcbiAgICB0aGlzLmlzQXV0aCA9IGZpbmFsQ29uZmlnLmlzQXV0aFxuICAgIHRoaXMucG9ydCA9IGZpbmFsQ29uZmlnLnBvcnRcbiAgICB0aGlzLm9wdGlvbnMgPSBjb25maWcub3B0aW9ucyB8fCB7fVxuICB9XG5cbiAgLy8g5Yid5aeL5YyWd2Vic2NvZWt05pyN5YqhXG4gIGluaXQgKCkge1xuICAgIHRoaXMud3NzID0gbmV3IFdlYlNvY2tldC5TZXJ2ZXIoeyBwb3J0OiB0aGlzLnBvcnQsIC4uLnRoaXMub3B0aW9ucyB9KVxuXG4gICAgLy8g6L+e5o6l5L+h5oGvXG4gICAgdGhpcy53c3Mub24oJ2Nvbm5lY3Rpb24nLCAod3MpID0+IHtcbiAgICAgIC8vIOi/nuaOpeS4iuS5i+WQjumaj+WNs+WPkemAgeS4gOasoeW/g+i3s+ajgOa1i1xuICAgICAgd3MuaXNBbGl2ZSA9IHRydWVcbiAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBldmVudDogJ2hlYXJ0YmVhdCcsXG4gICAgICAgIG1lc3NhZ2U6ICdwaW5nJ1xuICAgICAgfSkpXG4gICAgICB3cy5vbignbWVzc2FnZScsIChtc2cpID0+IHRoaXMub25NZXNzYWdlKHdzLCBtc2cpKVxuICAgICAgd3Mub24oJ2Nsb3NlJywgKCkgPT4gdGhpcy5vbkNsb3NlKHdzKSlcbiAgICB9KVxuXG4gICAgLy8g5b+D6Lez5qOA5rWLXG4gICAgdGhpcy5oZWFydGJlYXQoKVxuICB9XG5cbiAgb25NZXNzYWdlICh3cywgbXNnKSB7XG4gICAgLy8g55So5oi36Ym05p2DIC0+IHRva2VuIC0+IF9pZFxuICAgIC8vIOW/g+i3s+ajgOa1i1xuICAgIC8vIOa2iOaBr+WPkemAgVxuICAgIGNvbnN0IG1zZ09iaiA9IEpTT04ucGFyc2UobXNnKVxuICAgIGNvbnN0IGV2ZW50cyA9IHtcbiAgICAgIGF1dGg6IGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBvYmogPSBhd2FpdCBnZXRKV1RQYXlsb2FkKG1zZ09iai5tZXNzYWdlKVxuICAgICAgICAgIGlmIChvYmopIHtcbiAgICAgICAgICAgIHdzLmlzQXV0aCA9IHRydWVcbiAgICAgICAgICAgIHdzLl9pZCA9IG9iai5faWRcbiAgICAgICAgICAgIGNvbnN0IG51bSA9IGF3YWl0IENvbW1lbnRzLmdldFRvdGFsKG9iai5faWQpXG4gICAgICAgICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgZXZlbnQ6ICdtZXNzYWdlJyxcbiAgICAgICAgICAgICAgbWVzc2FnZTogbnVtXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBldmVudDogJ25vYXV0aCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAncGxlYXNlIGF1dGggYWdhaW4nXG4gICAgICAgICAgfSkpXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBoZWFydGJlYXQ6ICgpID0+IHtcbiAgICAgICAgaWYgKG1zZ09iai5tZXNzYWdlID09PSAncG9uZycpIHtcbiAgICAgICAgICB3cy5pc0FsaXZlID0gdHJ1ZVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgbWVzc2FnZTogKCkgPT4ge1xuICAgICAgICAvLyDpibTmnYPmi6bmiKpcbiAgICAgICAgLy8gaWYgKCF3cy5pc0F1dGggJiYgdGhpcy5pc0F1dGgpIHtcbiAgICAgICAgLy8gICByZXR1cm5cbiAgICAgICAgLy8gfVxuICAgICAgICAvLyDmtojmga/lub/mkq1cbiAgICAgICAgLy8gdGhpcy53c3MuY2xpZW50cy5mb3JFYWNoKChjbGllbnQpID0+IHtcbiAgICAgICAgLy8gICBpZiAoY2xpZW50LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOICYmIGNsaWVudC5faWQgPT09IHdzLl9pZCkge1xuICAgICAgICAvLyAgICAgdGhpcy5zZW5kKG1zZylcbiAgICAgICAgLy8gICB9XG4gICAgICAgIC8vIH0pXG4gICAgICB9XG4gICAgfVxuICAgIGV2ZW50c1ttc2dPYmouZXZlbnRdKClcbiAgfVxuXG4gIC8vIOeCueWvueeCueeahOa2iOaBr+WPkemAgVxuICBzZW5kICh1aWQsIG1zZykge1xuICAgIHRoaXMud3NzLmNsaWVudHMuZm9yRWFjaCgoY2xpZW50KSA9PiB7XG4gICAgICBpZiAoY2xpZW50LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOICYmIGNsaWVudC5faWQgPT09IHVpZCkge1xuICAgICAgICBjbGllbnQuc2VuZChtc2cpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIC8vIOW5v+aSrea2iOaBryAtPiDmjqjpgIHns7vnu5/mtojmga9cbiAgYnJvYWRjYXN0IChtc2cpIHtcbiAgICB0aGlzLndzcy5jbGllbnRzLmZvckVhY2goKGNsaWVudCkgPT4ge1xuICAgICAgaWYgKGNsaWVudC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikge1xuICAgICAgICBjbGllbnQuc2VuZChtc2cpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIG9uQ2xvc2UgKCkge1xuXG4gIH1cblxuICAvLyDlv4Pot7Pmo4DmtYtcbiAgaGVhcnRiZWF0ICgpIHtcbiAgICBjbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpXG4gICAgdGhpcy5pbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIHRoaXMud3NzLmNsaWVudHMuZm9yRWFjaCgod3MpID0+IHtcbiAgICAgICAgaWYgKCF3cy5pc0FsaXZlKSB7XG4gICAgICAgICAgcmV0dXJuIHdzLnRlcm1pbmF0ZSgpXG4gICAgICAgIH1cbiAgICAgICAgLy8g5Li75Yqo5Y+R6YCB5b+D6Lez5qOA5rWL6K+35rGCXG4gICAgICAgIC8vIOW9k+WuouaIt+err+i/lOWbnuS6hua2iOaBr+S5i+WQju+8jOS4u+WKqOiuvue9rmZsYWfkuLrlnKjnur9cbiAgICAgICAgd3MuaXNBbGl2ZSA9IGZhbHNlXG4gICAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGV2ZW50OiAnaGVhcnRiZWF0JyxcbiAgICAgICAgICBtZXNzYWdlOiAncGluZydcbiAgICAgICAgfSkpXG4gICAgICB9KVxuICAgIH0sIHRoaXMudGltZUludGVydmFsKVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzPSBXZWJTb2NrZXRTZXJ2ZXJcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "WebSocket.js"
      ],
      "names": [
        "WebSocketServer",
        "constructor",
        "config",
        "defaultConfig",
        "port",
        "configfile",
        "wsPort",
        "timeInterval",
        "isAuth",
        "finalConfig",
        "wss",
        "options",
        "init",
        "WebSocket",
        "Server",
        "on",
        "ws",
        "isAlive",
        "send",
        "JSON",
        "stringify",
        "event",
        "message",
        "msg",
        "onMessage",
        "onClose",
        "heartbeat",
        "msgObj",
        "parse",
        "events",
        "auth",
        "obj",
        "_id",
        "num",
        "Comments",
        "getTotal",
        "error",
        "uid",
        "clients",
        "forEach",
        "client",
        "readyState",
        "OPEN",
        "broadcast",
        "clearInterval",
        "interval",
        "setInterval",
        "terminate",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/Users/admin/Documents/my-github/rangeland/rangeland-serve/src/config",
      "sourcesContent": [
        "import WebSocket from 'ws'\nimport { getJWTPayload } from '../common/Utils'\nimport Comments from '../model/Comments'\nimport configfile from './index'\n//\nclass WebSocketServer {\n  constructor (config = {}) {\n    const defaultConfig = {\n      port: configfile.wsPort,\n      timeInterval: 5 * 1000,\n      isAuth: true\n    }\n    // 最终配置\n    const finalConfig = { ...defaultConfig, ...config }\n    this.wss = {}\n    this.timeInterval = finalConfig.timeInterval\n    this.isAuth = finalConfig.isAuth\n    this.port = finalConfig.port\n    this.options = config.options || {}\n  }\n\n  // 初始化webscoekt服务\n  init () {\n    this.wss = new WebSocket.Server({ port: this.port, ...this.options })\n\n    // 连接信息\n    this.wss.on('connection', (ws) => {\n      // 连接上之后随即发送一次心跳检测\n      ws.isAlive = true\n      ws.send(JSON.stringify({\n        event: 'heartbeat',\n        message: 'ping'\n      }))\n      ws.on('message', (msg) => this.onMessage(ws, msg))\n      ws.on('close', () => this.onClose(ws))\n    })\n\n    // 心跳检测\n    this.heartbeat()\n  }\n\n  onMessage (ws, msg) {\n    // 用户鉴权 -> token -> _id\n    // 心跳检测\n    // 消息发送\n    const msgObj = JSON.parse(msg)\n    const events = {\n      auth: async () => {\n        try {\n          const obj = await getJWTPayload(msgObj.message)\n          if (obj) {\n            ws.isAuth = true\n            ws._id = obj._id\n            const num = await Comments.getTotal(obj._id)\n            ws.send(JSON.stringify({\n              event: 'message',\n              message: num\n            }))\n          }\n        } catch (error) {\n          ws.send(JSON.stringify({\n            event: 'noauth',\n            message: 'please auth again'\n          }))\n        }\n      },\n      heartbeat: () => {\n        if (msgObj.message === 'pong') {\n          ws.isAlive = true\n        }\n      },\n      message: () => {\n        // 鉴权拦截\n        // if (!ws.isAuth && this.isAuth) {\n        //   return\n        // }\n        // 消息广播\n        // this.wss.clients.forEach((client) => {\n        //   if (client.readyState === WebSocket.OPEN && client._id === ws._id) {\n        //     this.send(msg)\n        //   }\n        // })\n      }\n    }\n    events[msgObj.event]()\n  }\n\n  // 点对点的消息发送\n  send (uid, msg) {\n    this.wss.clients.forEach((client) => {\n      if (client.readyState === WebSocket.OPEN && client._id === uid) {\n        client.send(msg)\n      }\n    })\n  }\n\n  // 广播消息 -> 推送系统消息\n  broadcast (msg) {\n    this.wss.clients.forEach((client) => {\n      if (client.readyState === WebSocket.OPEN) {\n        client.send(msg)\n      }\n    })\n  }\n\n  onClose () {\n\n  }\n\n  // 心跳检测\n  heartbeat () {\n    clearInterval(this.interval)\n    this.interval = setInterval(() => {\n      this.wss.clients.forEach((ws) => {\n        if (!ws.isAlive) {\n          return ws.terminate()\n        }\n        // 主动发送心跳检测请求\n        // 当客户端返回了消息之后，主动设置flag为在线\n        ws.isAlive = false\n        ws.send(JSON.stringify({\n          event: 'heartbeat',\n          message: 'ping'\n        }))\n      })\n    }, this.timeInterval)\n  }\n}\n\nmodule.exports= WebSocketServer\n"
      ]
    },
    "sourceType": "script",
    "mtime": 1586662651679
  }
}